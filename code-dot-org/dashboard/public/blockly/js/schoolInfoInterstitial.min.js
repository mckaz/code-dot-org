webpackJsonp([37],{3458:function(o,t,e){e(151),e(152),o.exports=e(3459)},3459:function(o,t,e){"use strict";function n(o){return o&&o.__esModule?o:{default:o}}var r=e(1),s=n(r),a=e(32),l=n(a),i=e(3460),c=n(i),u=e(596),h=n(u);document.addEventListener("DOMContentLoaded",function(){function o(){l.default.unmountComponentAtNode(e),document.body.removeChild(e)}var t=(0,h.default)("schoolinfointerstitial"),e=document.createElement("div");document.body.appendChild(e),l.default.render(s.default.createElement(c.default,{scriptData:t,onClose:o}),e)})},3460:function(o,t,e){"use strict";function n(o){return o&&o.__esModule?o:{default:o}}function r(o,t,e){return t in o?Object.defineProperty(o,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[t]=e,o}function s(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function a(o,t){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?o:t}function l(o,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);o.prototype=Object.create(t&&t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(o,t):o.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n])}return o},c=e(1),u=n(c),h=e(35),d=n(h),f=e(40),p=n(f),y=e(44),S=n(y),_=e(500),m=n(_),g=e(220),b=n(g),C=e(2974),E=n(C),v=e(925),I=n(v),T={container:{margin:20,color:S.default.charcoal},heading:{fontSize:16,fontFamily:"'Gotham 5r', sans-serif"},middle:{marginTop:20,marginBottom:20,paddingBottom:20,paddingTop:20,borderTopWidth:1,borderBottomWidth:1,borderRightWidth:0,borderLeftWidth:0,borderStyle:"solid",borderColor:S.default.lighter_gray},bottom:{display:"flex",justifyContent:"flex-end"},error:{color:S.default.red}},w={SHOW:"show",SUBMIT:"submit",SAVE_SUCCESS:"save_success",SAVE_FAILURE:"save_failure"},U=function(o){function t(e){s(this,t);var n=a(this,o.call(this,e));n.handleSchoolInfoSubmit=function(){n.logEvent(w.SUBMIT,{attempt:n.state.showSchoolInfoUnknownError?2:1});var o=n.buildSchoolData(),t=n.props.scriptData,e=t.formUrl,s=t.authTokenName,a=t.authTokenValue;d.default.post({url:e+".json",dataType:"json",data:i(r({_method:"patch"},s,a),o)}).done(function(){n.logEvent(w.SAVE_SUCCESS,{attempt:n.state.showSchoolInfoUnknownError?2:1}),n.props.onClose()}).fail(function(){n.logEvent(w.SAVE_FAILURE,{attempt:n.state.showSchoolInfoUnknownError?2:1}),n.state.showSchoolInfoUnknownError?n.props.onClose():n.setState({showSchoolInfoUnknownError:!0})})},n.onCountryChange=function(o,t){var e=t?t.value:"";n.setState({country:e})},n.onSchoolTypeChange=function(o){var t=o?o.target.value:"";n.setState({schoolType:t})},n.onSchoolChange=function(o,t){var e=t?t.value:"";n.setState({ncesSchoolId:e})},n.onSchoolNotFoundChange=function(o,t){var e=t?t.target.value:"";n.setState(r({},o,e))};var l=n.props.scriptData.existingSchoolInfo,c=l.country||"";"US"===c&&(c="United States");var u=l.school_id?l.school_id:"United States"===l.country&&C.SCHOOL_TYPES_HAVING_NCES_SEARCH.includes(l.school_type)&&(l.school_name||l.full_address)?"-1":"";return n.state={country:c,schoolType:l.school_type||"",schoolName:l.school_name||"",schoolLocation:l.full_address||"",ncesSchoolId:u,showSchoolInfoUnknownError:!1},n}return l(t,o),t.prototype.logEvent=function(o){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};I.default.putRecord({study:"school_info_interstitial",study_group:"control",event:o,data_int:this.state.ncesSchoolId&&"-1"!==this.state.ncesSchoolId?1:0,data_json:JSON.stringify(i({isComplete:t.isSchoolInfoComplete(this.state)},e))})},t.isSchoolInfoComplete=function(o){return!!o.country&&("United States"!==o.country||(!!["homeschool","after school","organization","other"].includes(o.schoolType)||(!(!o.ncesSchoolId||"-1"===o.ncesSchoolId)||!!(o.country&&o.schoolType&&o.schoolName))))},t.prototype.componentDidMount=function(){this.logEvent(w.SHOW)},t.prototype.buildSchoolData=function(){var o=this.state,t=o.country,e=o.schoolType,n=o.ncesSchoolId;return n&&"-1"!==n?{"user[school_info_attributes][school_id]":n}:t&&e?"United States"===t&&C.SCHOOL_TYPES_HAVING_NCES_SEARCH.includes(e)&&""===n?{"user[school_info_attributes][country]":t,"user[school_info_attributes][school_type]":e,"user[school_info_attributes][school_id]":n}:{"user[school_info_attributes][country]":t,"user[school_info_attributes][school_type]":e,"user[school_info_attributes][school_name]":this.state.schoolName,"user[school_info_attributes][full_address]":this.state.schoolLocation}:{"user[school_info_attributes][country]":t,"user[school_info_attributes][school_type]":e}},t.prototype.render=function(){var o=this;return u.default.createElement(m.default,{useUpdatedStyles:!0,isOpen:!0,handleClose:this.props.onClose,uncloseable:!0},u.default.createElement("div",{style:T.container},u.default.createElement("div",{style:T.heading},p.default.schoolInfoInterstitialTitle()),this.state.showSchoolInfoUnknownError&&u.default.createElement("p",{style:T.error},p.default.schoolInfoInterstitialUnknownError()),u.default.createElement("div",{style:T.middle},u.default.createElement("p",null,p.default.schoolInfoInterstitialDescription()),u.default.createElement(E.default,{ref:function(t){return o.schoolInfoInputs=t},onCountryChange:this.onCountryChange,onSchoolTypeChange:this.onSchoolTypeChange,onSchoolChange:this.onSchoolChange,onSchoolNotFoundChange:this.onSchoolNotFoundChange,country:this.state.country,schoolType:this.state.schoolType,ncesSchoolId:this.state.ncesSchoolId,schoolName:this.state.schoolName,schoolLocation:this.state.schoolLocation,useGoogleLocationSearch:!0,showErrors:!1,showRequiredIndicator:!1})),u.default.createElement("div",{style:T.bottom},u.default.createElement(b.default,{onClick:this.handleSchoolInfoSubmit,text:p.default.save(),color:b.default.ButtonColor.orange}))))},t}(u.default.Component);U.propTypes={scriptData:c.PropTypes.shape({formUrl:c.PropTypes.string.isRequired,authTokenName:c.PropTypes.string.isRequired,authTokenValue:c.PropTypes.string.isRequired,existingSchoolInfo:c.PropTypes.shape({school_id:c.PropTypes.string,country:c.PropTypes.string,school_type:c.PropTypes.string,school_name:c.PropTypes.string,full_address:c.PropTypes.string}).isRequired}).isRequired,onClose:c.PropTypes.func.isRequired},t.default=U,o.exports=t.default}},[3458]);