webpackJsonp([17],{1746:function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e){for(var t=0;t<e.length;t++)e[t].position=t+1}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=s.default.cloneDeep(e);switch(t.type){case u:return t.stages;case b:var i=n[t.stage-1].levels,l=i.splice(t.originalPosition-1,1);i.splice(t.newPosition-1,0,l[0]),r(i);break;case d:n.push({flex_category:t.groupName,name:t.stageName,levels:[]}),r(n);break;case c:var o=n[t.position-1].flex_category;n.splice(t.position,0,{id:e.newStageId,name:t.stageName,flex_category:o,levels:[]}),r(n);break;case E:var L=n[t.stage-1].levels;L.push({ids:[S],activeId:S,expand:!0}),r(L);break;case v:n[t.stage-1].levels[t.level-1].ids.push(S);break;case g:n[t.stage-1].levels[t.level-1].activeId=t.id;break;case y:var P=Object.keys(t.modifier)[0];n[t.stage-1].levels[t.level-1][P]=t.modifier[P];break;case _:if("break"===function(){var e=n[t.position-1].flex_category;return n=n.filter(function(t){return t.flex_category!==e}),r(n),"break"}())break;case T:n.splice(t.position-1,1),r(n);break;case f:var R=n[t.stage-1].levels;R.splice(t.level-1,1),r(R);break;case m:var C=n[t.stage-1].levels[t.level-1];C.ids[t.variant]===C.activeId&&(C.activeId=t.value),C.ids[t.variant]=t.value;break;case h:n[t.stage-1].levels[t.level-1].kind=t.value;break;case p:var D=n[t.stage-1].levels[t.level-1];D.expand=!D.expand;break;case x:if("break"===function(){var e;if("up"!==t.direction&&t.position===n.length)return"break";var i=t.position-1,l=n[i].flex_category,o=n.map(function(e){return e.flex_category}),s=o.indexOf(l),u=o.filter(function(e){return e===l}).length,d=n.splice(s,u);o=n.map(function(e){return e.flex_category});var c=n["up"===t.direction?i-1:i].flex_category;return s=o.indexOf(c),u=o.filter(function(e){return e===c}).length,(e=n).splice.apply(e,["up"===t.direction?s:s+u,0].concat(a(d))),r(n),"break"}())break;case k:var A=t.position-1,V="up"===t.direction?A-1:A+1,O=n[A];n[A]=n[V],n[V]=O,r(n);break;case w:n[t.stage-1].lockable=t.lockable}return n}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case u:return t.levelKeyList}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.NEW_LEVEL_ID=t.setStageLockable=t.removeStage=t.removeGroup=t.moveStage=t.moveGroup=t.addLevel=t.reorderLevel=t.setField=t.setActiveVariant=t.addVariant=t.chooseLevel=t.chooseLevelType=t.removeLevel=t.toggleExpand=t.addStage=t.addGroup=t.init=void 0;var o=n(82),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u="scriptEditor/INIT",d="scriptEditor/ADD_GROUP",c="scriptEditor/ADD_STAGE",p="scriptEditor/TOGGLE_EXPAND",f="scriptEditor/REMOVE_LEVEL",h="scriptEditor/CHOOSE_LEVEL_TYPE",m="scriptEditor/CHOOSE_LEVEL",v="scriptEditor/ADD_VARIANT",g="scriptEditor/SET_ACTIVE_VARIANT",y="scriptEditor/SET_FIELD",b="scriptEditor/REORDER_LEVEL",E="scriptEditor/ADD_LEVEL",x="scriptEditor/MOVE_GROUP",k="scriptEditor/MOVE_STAGE",_="scriptEditor/REMOVE_GROUP",T="scriptEditor/REMOVE_STAGE",w="scriptEditor/SET_STAGE_LOCKABLE",S=(t.init=function(e,t){return{type:u,stages:e,levelKeyList:t}},t.addGroup=function(e,t){return{type:d,stageName:e,groupName:t}},t.addStage=function(e,t){return{type:c,position:e,stageName:t}},t.toggleExpand=function(e,t){return{type:p,stage:e,level:t}},t.removeLevel=function(e,t){return{type:f,stage:e,level:t}},t.chooseLevelType=function(e,t,n){return{type:h,stage:e,level:t,value:n}},t.chooseLevel=function(e,t,n,a){return{type:m,stage:e,level:t,variant:n,value:a}},t.addVariant=function(e,t){return{type:v,stage:e,level:t}},t.setActiveVariant=function(e,t,n){return{type:g,stage:e,level:t,id:n}},t.setField=function(e,t,n){return{type:y,stage:e,level:t,modifier:n}},t.reorderLevel=function(e,t,n){return{type:b,stage:e,originalPosition:t,newPosition:n}},t.addLevel=function(e){return{type:E,stage:e}},t.moveGroup=function(e,t){return{type:x,position:e,direction:t}},t.moveStage=function(e,t){return{type:k,position:e,direction:t}},t.removeGroup=function(e){return{type:_,position:e}},t.removeStage=function(e){return{type:T,position:e}},t.setStageLockable=function(e,t){return{type:w,stage:e,lockable:t}},t.NEW_LEVEL_ID=-1);t.default={stages:i,levelKeyList:l}},2156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlTypes=t.levelTokenMargin=t.borderRadius=void 0;var a=n(71);t.borderRadius=3,t.levelTokenMargin=7,t.ControlTypes=(0,a.makeEnum)("Group","Stage")},2970:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),r=function(e){return e&&e.__esModule?e:{default:e}}(a),i=n(53),l=n(2156),o=n(1746),s={controls:{float:"right"},controlIcon:{margin:"0 5px",cursor:"pointer"}},u=r.default.createClass({displayName:"OrderControls",propTypes:{move:a.PropTypes.func.isRequired,remove:a.PropTypes.func.isRequired,type:a.PropTypes.oneOf(Object.keys(l.ControlTypes)).isRequired,position:a.PropTypes.number.isRequired,total:a.PropTypes.number.isRequired},handleMoveUp:function(){1!==this.props.position&&this.props.move(this.props.type,this.props.position,"up")},handleMoveDown:function(){this.props.position!==this.props.total&&this.props.move(this.props.type,this.props.position,"down")},handleRemove:function(){this.props.remove(this.props.type,this.props.position)},render:function(){return r.default.createElement("div",{style:s.controls},r.default.createElement("i",{onMouseDown:this.handleMoveUp,style:s.controlIcon,className:"fa fa-caret-up"}),r.default.createElement("i",{onMouseDown:this.handleMoveDown,style:s.controlIcon,className:"fa fa-caret-down"}),r.default.createElement("i",{onMouseDown:this.handleRemove,style:s.controlIcon,className:"fa fa-trash"}))}});t.default=(0,i.connect)(function(e){return{}},function(e){return{move:function(t,n,a){e(t===l.ControlTypes.Group?(0,o.moveGroup)(n,a):(0,o.moveStage)(n,a))},remove:function(t,n){e(t===l.ControlTypes.Group?(0,o.removeGroup)(n):(0,o.removeStage)(n))}}})(u),e.exports=t.default},3392:function(e,t,n){n(151),n(152),e.exports=n(3393)},3393:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.script,n=e.stageLevelData,a=(t.stages||[]).filter(function(e){return e.id}).map(function(e){return{position:e.position,flex_category:e.flex_category,lockable:e.lockable,name:e.name,levels:e.levels.filter(function(e){return!e.uid||/_0$/.test(e.uid)}).map(function(e){return{position:e.position,activeId:e.activeId,ids:e.ids.slice(),kind:e.kind,skin:e.skin,videoKey:e.videoKey,concepts:e.concepts,conceptDifficulty:e.conceptDifficulty,progression:e.progression}})}});(0,c.registerReducers)(m.default);var r=(0,c.getStore)();r.dispatch((0,h.init)(a,e.levelKeyList));var l=(t.teacher_resources||[]).map(function(e){var t=i(e,2);return{type:t[0],link:t[1]}}),s=t.script_announcements||[];u.default.render(o.default.createElement(d.Provider,{store:r},o.default.createElement(g.default,{beta:e.beta,name:e.script.name,i18nData:e.i18n,hidden:(0,y.valueOr)(t.hidden,!0),loginRequired:t.loginRequired,hideableStages:t.hideable_stages,studentDetailProgressView:t.student_detail_progress_view,professionalLearningCourse:t.professionalLearningCourse,peerReviewsRequired:t.peerReviewsRequired,wrapupVideo:t.wrapupVideo,excludeCsfColumnInLegend:t.excludeCsfColumnInLegend,projectWidgetVisible:t.project_widget_visible,projectWidgetTypes:t.project_widget_types,teacherResources:l,stageExtrasAvailable:!!t.stage_extras_available,stageLevelData:n,hasVerifiedResources:t.has_verified_resources,hasLessonPlan:t.has_lesson_plan,announcements:s})),document.querySelector(".edit_container"))}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r;var l=n(1),o=a(l),s=n(32),u=a(s),d=n(53),c=n(237),p=n(596),f=a(p),h=n(1746),m=a(h),v=n(3394),g=a(v),y=n(71);r((0,f.default)("levelBuilderEditScript")),e.exports=t.default},3394:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),l=n(3395),o=a(l),s=n(3399),u=a(s),d=n(3400),c=a(d),p=n(3401),f=a(p),h=n(35),m=a(h),v=n(2971),g=a(v),y=n(1243),b=a(y),E=n(220),x=a(E),k=n(927),_=a(k),T=n(1003),w={input:{width:"100%",boxSizing:"border-box",padding:"4px 6px",color:"#555",border:"1px solid #ccc",borderRadius:4},checkbox:{margin:"0 0 0 7px"}},S=/video_key_for_next_level/g,L=i.default.createClass({displayName:"ScriptEditor",propTypes:{beta:r.PropTypes.bool,name:r.PropTypes.string.isRequired,i18nData:r.PropTypes.object.isRequired,hidden:r.PropTypes.bool,loginRequired:r.PropTypes.bool,hideableStages:r.PropTypes.bool,studentDetailProgressView:r.PropTypes.bool,professionalLearningCourse:r.PropTypes.bool,peerReviewsRequired:r.PropTypes.number,wrapupVideo:r.PropTypes.string,excludeCsfColumnInLegend:r.PropTypes.bool,projectWidgetVisible:r.PropTypes.bool,projectWidgetTypes:r.PropTypes.arrayOf(r.PropTypes.string),teacherResources:r.PropTypes.arrayOf(k.resourceShape).isRequired,stageExtrasAvailable:r.PropTypes.bool,stageLevelData:r.PropTypes.string,hasVerifiedResources:r.PropTypes.bool,hasLessonPlan:r.PropTypes.bool,announcements:r.PropTypes.arrayOf(T.announcementShape)},handleClearProjectWidgetSelectClick:function(){(0,m.default)(this.projectWidgetSelect).children("option").removeAttr("selected",!0)},presubmit:function(e){(this.props.stageLevelData.match(S)||[]).length!==(this.scriptTextArea.value.match(S)||[]).length&&(confirm("WARNING: adding or removing video keys will also affect uses of this level in other scripts. Are you sure you want to continue?")||e.preventDefault())},render:function(){var e=this,t=this.props.stageLevelData?this.props.stageLevelData.split("\n").length+5:10;return i.default.createElement("div",null,i.default.createElement("h2",null,"I18n Strings"),i.default.createElement("label",null,"Title",i.default.createElement("input",{name:"title",defaultValue:this.props.i18nData.title,style:w.input})),i.default.createElement("label",null,"Audience",i.default.createElement("input",{name:"description_audience",defaultValue:this.props.i18nData.descriptionAudience,style:w.input})),i.default.createElement("label",null,"Short Description",i.default.createElement("input",{name:"description_short",defaultValue:this.props.i18nData.descriptionShort,style:w.input})),i.default.createElement("label",null,"Description",i.default.createElement("textarea",{name:"description",defaultValue:this.props.i18nData.description,rows:5,style:w.input})),i.default.createElement(u.default,{scriptName:this.props.name,currentDescriptions:this.props.i18nData.stageDescriptions}),i.default.createElement(c.default,{defaultAnnouncements:this.props.announcements,inputStyle:w.input}),i.default.createElement("h2",null,"Basic Settings"),i.default.createElement("label",null,"Visible in Teacher Dashboard",i.default.createElement("input",{name:"visible_to_teachers",type:"checkbox",defaultChecked:!this.props.hidden,style:w.checkbox}),i.default.createElement("p",null,"If checked this script will show up in the dropdown on the Teacher Dashboard, for teachers to assign to students.")),i.default.createElement("label",null,"Login Required",i.default.createElement("input",{name:"login_required",type:"checkbox",defaultChecked:this.props.loginRequired,style:w.checkbox}),i.default.createElement("p",null,"Require users to log in before viewing this script.")),i.default.createElement("label",null,"Hideable Stages",i.default.createElement("input",{name:"hideable_stages",type:"checkbox",defaultChecked:this.props.hideableStages,style:w.checkbox}),i.default.createElement("p",null,"Allow teachers to toggle whether or not specific stages in this script are visible to students in their section.")),i.default.createElement("label",null,"Default Progress to Detail View",i.default.createElement("input",{name:"student_detail_progress_view",type:"checkbox",defaultChecked:this.props.studentDetailProgressView,style:w.checkbox}),i.default.createElement("p",null,"By default students start in the summary view. When this box is checked, we instead stick everyone into detail view to start for this script.")),i.default.createElement("label",null,"Lesson Extras Available",i.default.createElement("input",{name:"stage_extras_available",type:"checkbox",defaultChecked:this.props.stageExtrasAvailable,style:w.checkbox}),i.default.createElement("p",null,"If also enabled by the teacher, show the lesson extras page at the end of each stage.")),i.default.createElement("label",null,"Verified Resources",i.default.createElement("input",{name:"has_verified_resources",type:"checkbox",defaultChecked:this.props.hasVerifiedResources,style:w.checkbox}),i.default.createElement("p",null,"Check if this course has resources for verified teachers, and we want to notify non-verified teachers that this is the case.")),i.default.createElement("label",null,"Lesson Plan",i.default.createElement("input",{name:"has_lesson_plan",type:"checkbox",defaultChecked:this.props.hasLessonPlan,style:w.checkbox}),i.default.createElement("p",null,"Check if this course has lesson plans (on Curriculum Builder or in PDF form) that we should provide links to.")),i.default.createElement("label",null,"Professional Learning Course. When filled out, the course unit associated with this script will be associated with the course named in this box. If the course unit does not exist, and if the course does not exist it will be created.",i.default.createElement("input",{name:"professional_learning_course",defaultValue:this.props.professionalLearningCourse,style:w.input})),i.default.createElement("label",null,"Peer Reviews to Complete. Currently only supported for professional learning courses",i.default.createElement("input",{name:"peer_reviews_to_complete",defaultValue:this.props.peerReviewsRequired,style:w.input})),i.default.createElement("label",null,"Wrap-up Video",i.default.createElement("input",{name:"wrapup_video",defaultValue:this.props.wrapupVideo,style:w.input})),i.default.createElement(f.default,{excludeCsf:this.props.excludeCsfColumnInLegend,inputStyle:w.checkbox}),i.default.createElement("h3",null,"Project widget options"),i.default.createElement("label",null,"Project widget visible",i.default.createElement("input",{name:"project_widget_visible",type:"checkbox",defaultChecked:this.props.projectWidgetVisible,style:w.checkbox}),i.default.createElement("p",null,"If checked this script will have the projects widget (recent projects and new project buttons) visible in stage extras.")),i.default.createElement("label",null,"Project widget new project types",i.default.createElement("p",null,"Select up to 4 project type options to appear in the 'Start a new project' section. Select",i.default.createElement("a",{onClick:this.handleClearProjectWidgetSelectClick}," none "),"or shift-click or cmd-click to select multiple."),i.default.createElement("select",{name:"project_widget_types[]",multiple:!0,defaultValue:this.props.projectWidgetTypes,ref:function(t){return e.projectWidgetSelect=t}},i.default.createElement("option",{value:"playlab"},"Play Lab"),i.default.createElement("option",{value:"playlab_k1"},"Play Lab K1"),i.default.createElement("option",{value:"artist"},"Artist"),i.default.createElement("option",{value:"artist_k1"},"Artist K1"),i.default.createElement("option",{value:"applab"},"App Lab"),i.default.createElement("option",{value:"gamelab"},"Game Lab"),i.default.createElement("option",{value:"weblab"},"Web Lab"),i.default.createElement("option",{value:"calc"},"Calc"),i.default.createElement("option",{value:"eval"},"Eval"),i.default.createElement("option",{value:"frozen"},"Frozen"),i.default.createElement("option",{value:"minecraft_adventurer"},"Minecraft Adventurer"),i.default.createElement("option",{value:"minecraft_designer"},"Minecraft Designer"),i.default.createElement("option",{value:"minecraft_hero"},"Minecraft Hero"),i.default.createElement("option",{value:"starwars"},"Star Wars"),i.default.createElement("option",{value:"starwarsblocks"},"Star Wars Blocks"),i.default.createElement("option",{value:"flappy"},"Flappy"),i.default.createElement("option",{value:"sports"},"Sports"),i.default.createElement("option",{value:"basketball"},"Basketball"),i.default.createElement("option",{value:"bounce"},"Bounce"),i.default.createElement("option",{value:"infinity"},"Infinity"),i.default.createElement("option",{value:"iceage"},"Ice Age"),i.default.createElement("option",{value:"gumball"},"Gumball"))),i.default.createElement("div",null,i.default.createElement("h4",null,"Teacher Resources"),i.default.createElement("div",null,"Select the Teacher Resources buttons you'd like to have show up on the top of the course overview page"),i.default.createElement(g.default,{inputStyle:w.input,resources:this.props.teacherResources,maxResources:Object.keys(_.default).length,renderPreview:function(e){return i.default.createElement(b.default,{text:"Teacher resources",color:x.default.ButtonColor.blue},e.map(function(e,t){var n=e.type,a=e.link;return i.default.createElement("a",{key:t,href:a},k.stringForType[n])}))}})),i.default.createElement("h2",null,"Stages and Levels"),this.props.beta?i.default.createElement(o.default,null):i.default.createElement("div",null,i.default.createElement("a",{href:"?beta=true"},"Try the beta Script Editor (will reload the page without saving)"),i.default.createElement("textarea",{id:"script_text",name:"script_text",rows:t,style:{width:700},defaultValue:this.props.stageLevelData||"stage 'new stage'\n",ref:function(t){return e.scriptTextArea=t}})),i.default.createElement("button",{className:"btn btn-primary",type:"submit",style:{margin:0},onClick:this.presubmit},"Save Changes"))}});t.default=L,e.exports=t.default},3395:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),l=n(53),o=n(82),s=a(o),u=n(44),d=a(u),c=n(2156),p=n(2970),f=a(p),h=n(3396),m=a(h),v=n(1746),g=n(503),y={groupHeader:{fontSize:18,color:"white",background:d.default.cyan,borderTopLeftRadius:c.borderRadius,borderTopRightRadius:c.borderRadius,padding:10},groupBody:{background:d.default.lightest_cyan,borderBottomLeftRadius:c.borderRadius,borderBottomRightRadius:c.borderRadius,padding:10,marginBottom:20},addGroup:{fontSize:14,color:"white",background:d.default.cyan,border:"1px solid "+d.default.cyan,boxShadow:"none",margin:"0 0 30px 0"},addStage:{fontSize:14,color:"#5b6770",background:"white",border:"1px solid #ccc",boxShadow:"none",margin:"0 10px 10px 10px"}},b=i.default.createClass({displayName:"FlexGroup",propTypes:{addGroup:r.PropTypes.func.isRequired,addStage:r.PropTypes.func.isRequired,stages:r.PropTypes.array.isRequired,levelKeyList:r.PropTypes.array.isRequired},handleAddGroup:function(){this.props.addGroup(prompt("Enter new stage name"),prompt("Enter new group name"))},handleAddStage:function(e){this.props.addStage(e,prompt("Enter new stage name"))},serializeStages:function(e){var t=this,n=[];return e.forEach(function(e){var a="stage '"+e.name+"'";e.lockable&&(a+=", lockable: true"),e.flex_category&&(a+=", flex_category: '"+e.flex_category+"'"),n.push(a),e.levels.forEach(function(e){e.ids.length>1?(n.push("variants"),e.ids.forEach(function(a){n=n.concat(t.serializeLevel(a,e,e.activeId===a))}),n.push("endvariants")):n=n.concat(t.serializeLevel(e.ids[0],e))}),n.push("")}),n.join("\n")},serializeLevel:function(e,t,n){if(e!==v.NEW_LEVEL_ID){var a=[],r=this.props.levelKeyList[e];/^blockly:/.test(r)&&(t.skin&&a.push("skin '"+t.skin+"'"),t.videoKey&&a.push("video_key_for_next_level '"+t.videoKey+"'"),t.concepts&&a.push("concepts "+t.concepts),t.conceptDifficulty&&a.push("level_concept_difficulty '"+t.conceptDifficulty+"'"));var i=this.normalizeLevelKind(t.kind)+" '"+r.replace(/'/,"\\'")+"'";return!1===n&&(i+=", active: false"),t.progression&&(i+=", progression: '"+t.progression+"'"),a.push(i),a}},normalizeLevelKind:function(e){return e&&e!==g.LevelKind.puzzle&&e!==g.LevelKind.unplugged?e:g.LevelKind.level},render:function(){var e=this,t=s.default.groupBy(this.props.stages,function(e){return e.flex_category||"Default"}),n=0,a=1;return i.default.createElement("div",null,s.default.map(t,function(r,l){return i.default.createElement("div",{key:l},i.default.createElement("div",{style:y.groupHeader},"Group ",++n,": ",l,i.default.createElement(f.default,{type:c.ControlTypes.Group,position:a,total:Object.keys(t).length})),i.default.createElement("div",{style:y.groupBody},r.map(function(t,n){return a++,i.default.createElement(m.default,{key:"stage-"+n,stagesCount:e.props.stages.length,stage:t})}),i.default.createElement("button",{onMouseDown:e.handleAddStage.bind(null,a-1),className:"btn",style:y.addStage,type:"button"},i.default.createElement("i",{style:{marginRight:7},className:"fa fa-plus-circle"}),"Add Stage")))}),i.default.createElement("button",{onMouseDown:this.handleAddGroup,className:"btn",style:y.addGroup,type:"button"},i.default.createElement("i",{style:{marginRight:7},className:"fa fa-plus-circle"}),"Add Group"),i.default.createElement("input",{type:"hidden",name:"script_text",value:this.serializeStages(this.props.stages)}))}});t.default=(0,l.connect)(function(e){return{levelKeyList:e.levelKeyList,stages:e.stages}},function(e){return{addGroup:function(t,n){e((0,v.addGroup)(t,n))},addStage:function(t,n){e((0,v.addStage)(t,n))}}})(b),e.exports=t.default},3396:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),l=n(32),o=a(l),s=n(53),u=n(2156),d=n(2970),c=a(d),p=n(3397),f=a(p),h=n(1746),m={checkbox:{margin:"0 0 0 7px"},stageCard:{fontSize:18,background:"white",border:"1px solid #ccc",borderRadius:u.borderRadius,padding:20,margin:10},stageCardHeader:{color:"#5b6770",marginBottom:15},stageLockable:{fontSize:13,marginTop:3},addLevel:{fontSize:14,background:"#eee",border:"1px solid #ddd",boxShadow:"inset 0 1px 0 0 rgba(255, 255, 255, 0.8)",margin:"5px 0"}},v=i.default.createClass({displayName:"StageCard",propTypes:{reorderLevel:r.PropTypes.func.isRequired,addLevel:r.PropTypes.func.isRequired,setStageLockable:r.PropTypes.func.isRequired,stagesCount:r.PropTypes.number.isRequired,stage:r.PropTypes.object.isRequired},metrics:{},getInitialState:function(){return{currentPositions:[],drag:null,dragHeight:null,initialPageY:null,initialScroll:null,newPosition:null,startingPositions:null}},handleDragStart:function(e,t){var n=this,a=t.pageY,r=this.props.stage.levels.map(function(e){var t=n.metrics[e.position];return t.top+t.height/2});this.setState({drag:e,dragHeight:this.metrics[e].height+u.levelTokenMargin,initialPageY:a,initialScroll:document.body.scrollTop,newPosition:e,startingPositions:r}),window.addEventListener("selectstart",this.preventSelect),window.addEventListener("mousemove",this.handleDrag),window.addEventListener("mouseup",this.handleDragStop)},handleDrag:function(e){var t=this,n=e.pageY,a=document.body.scrollTop-this.state.initialScroll,r=n-this.state.initialPageY,i=this.metrics[this.state.drag].top+a,l=this.state.drag,o=this.state.startingPositions.map(function(e,n){var a=n+1;return a===t.state.drag?r:a<t.state.drag&&i<e?(l--,t.state.dragHeight):a>t.state.drag&&i+t.state.dragHeight>e?(l++,-t.state.dragHeight):0});this.setState({currentPositions:o,newPosition:l})},handleDragStop:function(){this.state.drag!==this.state.newPosition&&this.props.reorderLevel(this.props.stage.position,this.state.drag,this.state.newPosition),this.setState({drag:null,newPosition:null,currentPositions:[]}),window.removeEventListener("selectstart",this.preventSelect),window.removeEventListener("mousemove",this.handleDrag),window.removeEventListener("mouseup",this.handleDragStop)},handleAddLevel:function(){this.props.addLevel(this.props.stage.position)},handleLockableChanged:function(){this.props.setStageLockable(this.props.stage.position,this.refs.lockable.checked)},preventSelect:function(e){e.preventDefault()},render:function(){var e=this;return i.default.createElement("div",{style:m.stageCard},i.default.createElement("div",{style:m.stageCardHeader},"Stage ",this.props.stage.position,": ",this.props.stage.name,i.default.createElement(c.default,{type:u.ControlTypes.Stage,position:this.props.stage.position,total:this.props.stagesCount}),i.default.createElement("div",{style:m.stageLockable},"Require teachers to unlock this stage before students in their section can access it",i.default.createElement("input",{ref:"lockable",defaultChecked:this.props.stage.lockable,onChange:this.handleLockableChanged,type:"checkbox",style:m.checkbox}))),this.props.stage.levels.map(function(t){return i.default.createElement(f.default,{ref:function(n){if(n){var a=o.default.findDOMNode(n).getBoundingClientRect();e.metrics[t.position]=a}},key:t.position+"_"+t.ids[0],level:t,stagePosition:e.props.stage.position,dragging:!!e.state.drag,drag:t.position===e.state.drag,delta:e.state.currentPositions[t.position-1]||0,handleDragStart:e.handleDragStart})}),i.default.createElement("button",{onMouseDown:this.handleAddLevel,className:"btn",style:m.addLevel,type:"button"},i.default.createElement("i",{style:{marginRight:7},className:"fa fa-plus-circle"}),"Add Level"))}});t.default=(0,s.connect)(function(e){return{}},function(e){return{reorderLevel:function(t,n,a){e((0,h.reorderLevel)(t,n,a))},addLevel:function(t){e((0,h.addLevel)(t))},setStageLockable:function(t,n){e((0,h.setStageLockable)(t,n))}}})(v),e.exports=t.default},3397:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),l=n(53),o=n(1725),s=n(44),u=a(s),d=n(2156),c=n(3398),p=a(c),f=n(1746),h={levelToken:{position:"relative",fontSize:13,background:"#eee",borderRadius:d.borderRadius,margin:d.levelTokenMargin+"px 0"},reorder:{fontSize:16,display:"table-cell",background:"#ddd",border:"1px solid #bbb",boxShadow:"inset 0 1px 0 0 rgba(255, 255, 255, 0.6)",padding:"7px 15px",borderTopLeftRadius:d.borderRadius,borderBottomLeftRadius:d.borderRadius,cursor:"ns-resize"},levelTokenName:{padding:7,display:"table-cell",boxShadow:"inset 0 1px 0 0 rgba(255, 255, 255, 0.8)",width:"100%",borderTop:"1px solid #ddd",borderBottom:"1px solid #ddd",cursor:"text"},variants:{color:"white",background:u.default.purple,padding:"3px 5px",lineHeight:"12px",borderRadius:5,float:"right"},remove:{fontSize:14,display:"table-cell",color:"white",background:"#c00",border:"1px solid #a00",boxShadow:"inset 0 1px 0 0 rgba(255, 255, 255, 0.6)",padding:"7px 13px",borderTopRightRadius:d.borderRadius,borderBottomRightRadius:d.borderRadius,cursor:"pointer"}},m=i.default.createClass({displayName:"LevelToken",propTypes:{levelKeyList:r.PropTypes.object.isRequired,toggleExpand:r.PropTypes.func.isRequired,removeLevel:r.PropTypes.func.isRequired,level:r.PropTypes.object.isRequired,stagePosition:r.PropTypes.number.isRequired,dragging:r.PropTypes.bool.isRequired,drag:r.PropTypes.bool.isRequired,delta:r.PropTypes.number,handleDragStart:r.PropTypes.func.isRequired},handleDragStart:function(e){this.props.handleDragStart(this.props.level.position,e)},toggleExpand:function(){this.props.toggleExpand(this.props.stagePosition,this.props.level.position)},handleRemove:function(){this.props.removeLevel(this.props.stagePosition,this.props.level.position)},render:function(){var e=this,t={stiffness:1e3,damping:80};return i.default.createElement(o.Motion,{style:this.props.drag?{y:this.props.dragging?this.props.delta:0,scale:(0,o.spring)(1.02,t),shadow:(0,o.spring)(5,t)}:{y:this.props.dragging?(0,o.spring)(this.props.delta,t):0,scale:1,shadow:0},key:this.props.level.position},function(t){var n=t.y,a=t.scale,r=t.shadow;return i.default.createElement("div",{style:Object.assign({},h.levelToken,{transform:"translate3d(0, "+n+"px, 0) scale("+a+")",boxShadow:u.default.shadow+" 0 "+r+"px "+3*r+"px",zIndex:e.props.drag?1e3:500-e.props.level.position})},i.default.createElement("div",{style:h.reorder,onMouseDown:e.handleDragStart},i.default.createElement("i",{className:"fa fa-arrows-v"})),i.default.createElement("span",{style:h.levelTokenName,onMouseDown:e.toggleExpand},e.props.levelKeyList[e.props.level.activeId],e.props.level.ids.length>1&&i.default.createElement("span",{style:h.variants},e.props.level.ids.length," variants")),i.default.createElement("div",{style:h.remove,onMouseDown:e.handleRemove},i.default.createElement("i",{className:"fa fa-times"})),e.props.level.expand&&i.default.createElement(p.default,{level:e.props.level,stagePosition:e.props.stagePosition}))})}});t.default=(0,l.connect)(function(e){return{levelKeyList:e.levelKeyList}},function(e){return{toggleExpand:function(t,n){e((0,f.toggleExpand)(t,n))},removeLevel:function(t,n){e((0,f.removeLevel)(t,n))}}})(m),e.exports=t.default},3398:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),l=a(i),o=n(53),s=n(922),u=a(s);n(842),n(806),n(843);var d=n(82),c=a(d),p=n(1746),f={checkbox:{margin:"0 0 0 7px"},levelTokenActive:{padding:7,background:"#f4f4f4",border:"1px solid #ddd",borderTop:0},levelFieldLabel:{display:"inline-block",lineHeight:"36px",margin:"0 7px 0 5px"},levelTypeSelect:{width:"calc(100% - 80px)",margin:"0 0 5px 80px"},textInput:{height:34,width:350,boxSizing:"border-box",verticalAlign:"baseline",margin:"7px 0 10px 0"},divider:{borderColor:"#ddd",margin:"7px 0"},addVariant:{fontSize:14,background:"white",border:"1px solid #ddd",boxShadow:"inset 0 1px 0 0 rgba(255, 255, 255, 0.6)",margin:"0"},progression:{paddingTop:5}},h=function(e){var t=e.onMouseDown;return l.default.createElement("i",{className:"fa fa-chevron-down",onMouseDown:t})};h.propTypes={onMouseDown:i.PropTypes.func.isRequried};var m=l.default.createClass({displayName:"LevelTokenDetails",propTypes:{levelKeyList:i.PropTypes.object.isRequired,chooseLevelType:i.PropTypes.func.isRequired,chooseLevel:i.PropTypes.func.isRequired,addVariant:i.PropTypes.func.isRequired,setActiveVariant:i.PropTypes.func.isRequired,setField:i.PropTypes.func.isRequired,level:i.PropTypes.object.isRequired,stagePosition:i.PropTypes.number.isRequired},levelKindOptions:[{label:"Puzzle",value:"puzzle"},{label:"Assessment",value:"assessment"},{label:"Named Level",value:"named_level"},{label:"Unplugged",value:"unplugged"}],componentWillMount:function(){this.levelKeyOptions=c.default.map(this.props.levelKeyList,function(e,t){return{label:e,value:+t}})},containsLegacyLevel:function(){var e=this;return this.props.level.ids.some(function(t){return/^blockly:/.test(e.props.levelKeyList[t])})},handleLevelTypeSelected:function(e){var t=e.value;this.props.chooseLevelType(this.props.stagePosition,this.props.level.position,t)},handleLevelSelected:function(e,t){var n=t.value;this.props.chooseLevel(this.props.stagePosition,this.props.level.position,e,n)},handleAddVariant:function(){this.props.addVariant(this.props.stagePosition,this.props.level.position)},handleActiveVariantChanged:function(e){this.props.setActiveVariant(this.props.stagePosition,this.props.level.position,e)},handleFieldChange:function(e){var t=this[e+"Input"];t&&this.props.setField(this.props.stagePosition,this.props.level.position,r({},e,t.value))},render:function(){var e=this;return l.default.createElement("div",{style:f.levelTokenActive},l.default.createElement("span",{style:Object.assign({float:"left"},f.levelFieldLabel)},"Level type"),l.default.createElement(u.default,{value:this.props.level.kind,options:this.levelKindOptions,onChange:this.handleLevelTypeSelected,clearable:!1,arrowRenderer:h,style:f.levelTypeSelect}),this.containsLegacyLevel()&&l.default.createElement("div",null,l.default.createElement("span",{style:f.levelFieldLabel},"Skin"),l.default.createElement("input",{defaultValue:this.props.level.skin,type:"text",style:f.textInput,ref:function(t){return e.skinInput=t},onChange:this.handleFieldChange.bind(this,"skin")}),l.default.createElement("div",{style:{float:"right"}},l.default.createElement("span",{style:f.levelFieldLabel},"Video key"),l.default.createElement("input",{defaultValue:this.props.level.videoKey,type:"text",style:f.textInput,ref:function(t){return e.videoKeyInput=t},onChange:this.handleFieldChange.bind(this,"videoKey")})),l.default.createElement("div",{style:{clear:"both"}}),l.default.createElement("span",{style:f.levelFieldLabel},"Difficulty"),l.default.createElement("input",{defaultValue:this.props.level.conceptDifficulty,type:"text",style:f.textInput,ref:function(t){return e.conceptDifficultyInput=t},onChange:this.handleFieldChange.bind(this,"conceptDifficulty")}),l.default.createElement("div",{style:{float:"right"}},l.default.createElement("span",{style:f.levelFieldLabel},"Concepts"),l.default.createElement("input",{defaultValue:this.props.level.concepts,type:"text",style:Object.assign({},f.textInput,{width:320}),ref:function(t){return e.conceptsInput=t},onChange:this.handleFieldChange.bind(this,"concepts")}))),this.props.level.ids.map(function(t,n){return l.default.createElement("div",{key:t},e.props.level.ids.length>1&&l.default.createElement("div",null,l.default.createElement("hr",{style:f.divider}),l.default.createElement("span",{style:f.levelFieldLabel},"Active"),l.default.createElement("input",{type:"radio",onChange:e.handleActiveVariantChanged.bind(e,t),defaultChecked:t===e.props.level.activeId,style:f.checkbox,name:"radio-"+e.props.stagePosition+"-"+e.props.level.position})),l.default.createElement(u.default,{options:e.levelKeyOptions,value:t,onChange:e.handleLevelSelected.bind(null,n),clearable:!1,arrowRenderer:h}))}),this.props.level.progression&&l.default.createElement("div",{style:f.progression},"Progression Name: ",this.props.level.progression),l.default.createElement("hr",{style:f.divider}),l.default.createElement("button",{onMouseDown:this.handleAddVariant,className:"btn",style:f.addVariant,type:"button"},l.default.createElement("i",{style:{marginRight:7},className:"fa fa-plus-circle"}),"Add Variant"))}});t.default=(0,o.connect)(function(e){return{levelKeyList:e.levelKeyList}},function(e){return{chooseLevelType:function(t,n,a){e((0,p.chooseLevelType)(t,n,a))},chooseLevel:function(t,n,a,r){e((0,p.chooseLevel)(t,n,a,r))},addVariant:function(t,n){e((0,p.addVariant)(t,n))},setActiveVariant:function(t,n,a){e((0,p.setActiveVariant)(t,n,a))},setField:function(t,n,a){e((0,p.setField)(t,n,a))}}})(m),e.exports=t.default},3399:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),l=n(35),o=a(l),s=n(44),u=a(s),d={main:{border:"1px solid "+u.default.light_gray,padding:10},stage:{paddingTop:10,paddingBottom:10},stageName:{fontSize:16,textDecoration:"underline"},original:{backgroundColor:u.default.lightest_gray},update:{backgroundColor:"lightgreen"},diff:{backgroundColor:u.default.realyellow},expander:{paddingLeft:10},collapsed:{display:"none"},mismatch:{backgroundColor:u.default.realyellow}},c=i.default.createClass({displayName:"StageDescriptions",propTypes:{scriptName:r.PropTypes.string.isRequired,currentDescriptions:r.PropTypes.arrayOf(r.PropTypes.shape({name:r.PropTypes.string.isRequired,descriptionStudent:r.PropTypes.string.isRequired,descriptionTeacher:r.PropTypes.string.isRequired})).isRequired},getInitialState:function(){return{collapsed:!0,buttonText:null,importedDescriptions:[],mismatchedStages:[]}},expand:function(){this.setState({collapsed:!1})},processImport:function(e){var t=[],n=this.props.currentDescriptions,a=[];e.lessons.forEach(function(e,r){if(r>=n.length)return void a.push(e.title);n[r].name!==e.title&&a.push(e.title),t.push({name:e.title,descriptionStudent:e.student_desc,descriptionTeacher:e.teacher_desc})}),this.setState({buttonText:"Imported",importedDescriptions:t,mismatchedStages:a})},importDescriptions:function(){var e=this;this.setState({buttonText:"Querying server..."}),o.default.getJSON("https://curriculum.code.org/metadata/"+this.props.scriptName+".json").done(this.processImport).fail(function(t){e.setState({buttonText:t.statusText})})},updatedStageDescriptions:function(){var e=this.props.currentDescriptions,t=this.state.importedDescriptions;return e.map(function(e,n){return{name:e.name,descriptionStudent:t[n].descriptionStudent,descriptionTeacher:t[n].descriptionTeacher}})},render:function(){var e=this.props.currentDescriptions,t=this.state.importedDescriptions,n=t.length>0;return i.default.createElement("div",null,i.default.createElement("h4",null,"Stage Descriptions"),i.default.createElement("div",{style:d.main},this.state.collapsed&&i.default.createElement("button",{className:"btn",onClick:this.expand},"Click to Expand"),!this.state.collapsed&&i.default.createElement("div",null,e.map(function(e,a){var r=e.descriptionStudent,l=e.descriptionTeacher,o=t[a],s=n&&o.descriptionStudent,u=n&&o.descriptionTeacher;return i.default.createElement("div",{style:d.stage,key:a},i.default.createElement("div",{style:d.stageName},e.name),n&&o.name!==e.name&&i.default.createElement("div",null,"Lesson name on Curriculum Builder:"," ",i.default.createElement("span",{style:d.diff},o.name)),i.default.createElement("label",null,"Student Description",i.default.createElement("div",{style:d.original},r||" "),n&&s!==r&&i.default.createElement("div",{style:d.update},s)),i.default.createElement("label",null,"Teacher Description",i.default.createElement("div",{style:d.original},l||" "),n&&u!==l&&i.default.createElement("div",{style:d.update},u)))}),this.state.mismatchedStages.length>0&&i.default.createElement("div",{style:d.mismatch},i.default.createElement("div",{style:{fontWeight:"bold"}},"Curriculum Builder stages with different names than their levelbuilder counterparts. If there are a lot of these, it may indicate them being ordered differently in the two environments."),this.state.mismatchedStages.map(function(e,t){return i.default.createElement("div",{key:t},"- ",e)})),n&&i.default.createElement("input",{name:"stage_descriptions",type:"hidden",defaultValue:JSON.stringify(this.updatedStageDescriptions())}),i.default.createElement("button",{className:"btn",disabled:!!this.state.buttonText,onClick:this.importDescriptions},this.state.buttonText||"Import from Curriculum Builder"))))}});t.default=c,e.exports=t.default},3400:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),u=a(s),d=n(1003),c=n(1723),p=a(c),f=n(815),h={announcement:{border:"1px solid #ccc",padding:5,marginBottom:10},preview:{marginTop:10}},m=function(e){var t=e.announcement,n=e.inputStyle,a=e.index,r=e.onChange,i=e.onRemove;return u.default.createElement("div",{style:h.announcement},u.default.createElement("h5",null,"Announcement #",a+1),u.default.createElement("label",null,"Notice",u.default.createElement("input",{value:t.notice,style:n,onChange:function(e){return r(a,"notice",e.target.value)}})),u.default.createElement("label",null,"Details",u.default.createElement("input",{value:t.details,style:n,onChange:function(e){return r(a,"details",e.target.value)}})),u.default.createElement("label",null,"Link",u.default.createElement("input",{value:t.link,style:n,onChange:function(e){return r(a,"link",e.target.value)}})),u.default.createElement("label",null,"Type",u.default.createElement("div",null,u.default.createElement("select",{value:t.type,onChange:function(e){return r(a,"type",e.target.value)}},Object.values(f.NotificationType).map(function(e){return u.default.createElement("option",{key:e,value:e},e)})))),u.default.createElement("button",{className:"btn",onClick:function(){return i(a)}},"Remove"))};m.propTypes={announcement:d.announcementShape,inputStyle:s.PropTypes.object.isRequired,index:s.PropTypes.number.isRequired,onRemove:s.PropTypes.func.isRequired,onChange:s.PropTypes.func.isRequired};var v=function(e){function t(n){i(this,t);var a=l(this,e.call(this,n));return a.add=function(){a.setState({announcements:a.state.announcements.concat({notice:"",details:"",link:"",type:f.NotificationType.information})})},a.remove=function(e){var t=[].concat(r(a.state.announcements));t.splice(e,1),a.setState({announcements:t})},a.change=function(e,t,n){var i=[].concat(r(a.state.announcements));i[e][t]=n,a.setState({announcements:i})},a.state={announcements:n.defaultAnnouncements},a}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.inputStyle,n=this.state.announcements;return u.default.createElement("div",null,u.default.createElement("input",{type:"hidden",name:"script_announcements",value:JSON.stringify(n)}),u.default.createElement("h4",null,"Script Announcements"),u.default.createElement("div",null,"This can be used to provide one or more announcements that will show up for signed in teachers on the script overview page."),n.map(function(n,a){return u.default.createElement(m,{key:a,index:a,announcement:n,inputStyle:t,onChange:e.change,onRemove:e.remove})}),u.default.createElement("button",{className:"btn",onClick:this.add},"Additional Announcement"),n.length>0&&u.default.createElement("div",{style:h.preview},u.default.createElement("div",null,"Preview:"),u.default.createElement(p.default,{announcements:n})))},t}(s.Component);v.propTypes={defaultAnnouncements:s.PropTypes.arrayOf(d.announcementShape),inputStyle:s.PropTypes.object.isRequired},t.default=v,e.exports=t.default},3401:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=a(o),u=n(1721),d=a(u),c=function(e){function t(n){r(this,t);var a=i(this,e.call(this,n));return a.handleChange=function(){a.setState({checked:!a.state.checked})},a.state={checked:a.props.excludeCsf},a}return l(t,e),t.prototype.render=function(){var e=this.props.inputStyle;return s.default.createElement("label",null,"Exclude CSF Progress Bubbles From Legend",s.default.createElement("input",{name:"exclude_csf_column_in_legend",type:"checkbox",checked:this.state.checked,onChange:this.handleChange,style:e}),s.default.createElement(d.default,{excludeCsfColumn:this.state.checked}))},t}(o.Component);c.propTypes={excludeCsf:o.PropTypes.bool.isRequired,inputStyle:o.PropTypes.object},t.default=c,e.exports=t.default}},[3392]);