webpackJsonp([7],{1016:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r,s){i(this,t);var l=n(this,e.call(this,o,a,s));return l.actionCallback=r,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.actionCallback()},t}(r)},1269:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(1270);e.exports=function(){function e(t){i(this,e),this.gameController=t,this.game=t.game,this.reset(),this.repeatCommands=[],this.setUnshiftState=!1,this.highPriorityCommands=[]}return e.prototype.addCommand=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.repeat=t,this.whileCommandQueue?this.whileCommandQueue.addCommand(e):this.setUnshiftState?this.highPriorityCommands.push(e):this.commandList_.push(e)},e.prototype.setWhileCommandInsertState=function(e){this.whileCommandQueue=e},e.prototype.begin=function(){this.state=n.WORKING},e.prototype.reset=function(){this.state=n.NOT_STARTED,this.currentCommand=null,this.commandList_=[],this.highPriorityCommands=[],this.whileCommandQueue&&this.whileCommandQueue.reset(),this.repeatCommands=[],this.whileCommandQueue=null},e.prototype.startPushHighPriorityCommands=function(){this.setUnshiftState=!0,this.highPriorityCommands=[]},e.prototype.endPushHighPriorityCommands=function(){for(var e=this.highPriorityCommands.length-1;e>=0;e--)this.commandList_.unshift(this.highPriorityCommands[e]);this.setUnshiftState=!1},e.prototype.tick=function(){if(this.state===n.WORKING){if(!this.currentCommand){if(0===this.commandList_.length){0===this.repeatCommands.length&&(this.state=n.SUCCESS),this.gameController.startPushRepeatCommand();for(var e=0;e<this.repeatCommands.length;e++)this.repeatCommands[e][1]>0?(this.repeatCommands[e][0](),this.repeatCommands[e][1]--):-1===this.repeatCommands[e][1]?this.repeatCommands[e][0]():this.repeatCommands.splice(e,1);return void this.gameController.endPushRepeatCommand()}this.currentCommand=this.commandList_.shift()}this.currentCommand.isStarted()?this.currentCommand.tick():this.currentCommand.begin(),this.currentCommand.isSucceeded()?this.currentCommand=null:this.currentCommand.isFailed()&&(this.state=n.FAILURE)}},e.prototype.getLength=function(){return this.commandList_?this.commandList_.length:0},e.prototype.isStarted=function(){return this.state!==n.NOT_STARTED},e.prototype.isFinished=function(){return this.isSucceeded()||this.isFailed()},e.prototype.isSucceeded=function(){return this.state===n.SUCCESS},e.prototype.isFailed=function(){return this.state===n.FAILURE},e.prototype.addRepeatCommands=function(e,t){if(-1===t)for(var o=0;o<this.repeatCommands.length;o++)if(-1===this.repeatCommands[o][1]){this.repeatCommands.splice(o,1);break}this.repeatCommands.push([e,t]),this.begin()},e}()},1270:function(e,t,o){"use strict";e.exports=Object.freeze({NOT_STARTED:0,WORKING:1,SUCCESS:2,FAILURE:3})},1271:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(799),a=n.North,r=n.South,s=n.East,l=n.West;e.exports=function(){function e(t){i(this,e),this.blockType=t,this.isEntity=!1,this.isWalkable=!1,this.isPlacable=!1,this.isDestroyable=!0,this.isUsable=!0,this.isEmpty=!1,this.isEmissive=!1,this.isTransparent=!1,this.isRedstone=!1,this.isPowered=!1,this.isConnectedToRedstone=!1,this.isRedstoneBattery=!1,this.isOpen=!1,this.isRail=!1,this.isSolid=!0,this.isWeaklyPowerable=!0,this.isStickable=!0,""===t&&(this.isWalkable=!0,this.isDestroyable=!1,this.isEmpty=!0,this.isPlacable=!0,this.isUsable=!1,this.isWeaklyPowerable=!1),this.getIsMiniblock()&&(this.isEntity=!0,this.isWalkable=!0,this.isDestroyable=!1,this.isPlacable=!0,this.isUsable=!1,this.isTransparent=!0),t.match("torch")&&(this.isWalkable=!0,this.isPlacable=!0,this.isStickable=!1),"rails"===t.substring(0,5)&&(this.isWeaklyPowerable="railsRedstoneTorch"===t,this.isStickable="railsRedstoneTorch"!==t,this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!0,this.isTransparent=!0,this.isRail="railsRedstoneTorch"!==t,this.isConnectedToRedstone=/^rails(RedstoneTorch|Unpowered|Powered)/.test(t),this.isRedstoneBattery="railsRedstoneTorch"===t,this.connectionA=void 0,this.connectionB=void 0),"sheep"===t&&(this.isEntity=!0,this.isDestroyable=!1,this.isUsable=!0),"invisible"===t&&(this.isDestroyable=!1,this.isUsable=!1,this.isWeaklyPowerable=!1,this.isEmissive=!0),t.startsWith("glass")&&(this.isSolid=!1),t.startsWith("ice")&&(this.isSolid=!1),"creeper"===t&&(this.isEntity=!0),"bedrock"===t&&(this.isDestroyable=!1),"lava"===t&&(this.isEmissive=!0,this.isWalkable=!0,this.isPlacable=!0),"water"===t&&(this.isPlacable=!0),"torch"===t&&(this.isEmissive=!0,this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!1,this.isTransparent=!0),"cropWheat"===t&&(this.isEmissive=!1,this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!1,this.isTransparent=!0),"tnt"===t&&(this.isUsable=!0,this.isDestroyable=!0),"door"===t&&(this.isWeaklyPowerable=!1,this.isSolid=!1,this.isEntity=!0,this.isWalkable=!1,this.isUsable=!0,this.isDestroyable=!1,this.isTransparent=!0,this.isStickable=!1),"doorIron"===t&&(this.isWeaklyPowerable=!1,this.isSolid=!1,this.isEntity=!0,this.isWalkable=!1,this.isDestroyable=!1,this.isTransparent=!0,this.isConnectedToRedstone=!0,this.isStickable=!1),t.startsWith("redstoneWire")&&(this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!0,this.isTransparent=!0,this.isRedstone=!0,this.isStickable=!1),t.startsWith("pressurePlate")&&(this.isWeaklyPowerable="pressurePlateUp"!==t,this.isEntity=!0,this.isWalkable=!0,this.isDestroyable=!1,this.isTransparent=!0,this.isConnectedToRedstone=!0,this.isRedstoneBattery="pressurePlateUp"!==t,this.isStickable=!1),"glowstone"===t&&(this.isEntity=!0),"bedFoot"!==t&&"bedHead"!==t||(this.isEntity=!0),t.startsWith("piston")&&(this.isWeaklyPowerable=!1,this.isSolid=!1,this.isDestroyable=!1,this.isConnectedToRedstone=!t.startsWith("pistonArm"),("On"===t.substring(t.length-2,t.length)||t.startsWith("pistonArm")||"OnSticky"===t.substring(t.length-8,t.length))&&(this.isEntity=!0)),t.startsWith("flower")&&(this.isWalkable=!0)}return e.prototype.isFlat=function(){return this.isRail||this.isRedstone||this.blockType.startsWith("pressurePlate")},e.prototype.notValidOnGroundPlane=function(){return this.blockType.startsWith("rails")||this.blockType.startsWith("redstone")},e.prototype.skipsDestructionOverlay=function(){return this.isRedstone||"torch"===this.blockType||"railsRedstoneTorch"===this.blockType},e.prototype.shouldRenderOnGroundPlane=function(){return this.isFlat()},e.prototype.getIsPowerableRail=function(){return this.isRail&&this.isConnectedToRedstone},e.prototype.getIsHorizontal=function(){return this.blockType.match("East|West")},e.prototype.getIsVertical=function(){return this.blockType.match("North|South")},e.prototype.getIsStickyPiston=function(){return"Sticky"===this.blockType.substring(this.blockType.length-6,this.blockType.length)},e.prototype.canHoldCharge=function(){return this.isSolid},e.prototype.getIsMiniblock=function(){return e.isMiniblock(this.blockType)},e.prototype.getIsTree=function(){return!!this.blockType.match(/^tree/)},e.prototype.getIsDoor=function(){return this.blockType.startsWith("door")},e.prototype.getIsLiquid=function(){return"water"===this.blockType||"lava"===this.blockType},e.prototype.getCanFall=function(){return"sand"===this.blockType||"gravel"===this.blockType},e.prototype.getIsPlaceableInLiquid=function(){return!(this.isRedstone||this.getIsPiston()||this.isRail||"torch"===this.blockType||"railsRedstoneTorch"===this.blockType||"pressurePlateUp"===this.blockType)},e.prototype.getIsPiston=function(){return this.blockType.startsWith("piston")},e.prototype.getIsPistonArm=function(){return this.blockType.startsWith("pistonArm")},e.prototype.getIsPushable=function(){return""!==this.blockType&&!this.isDestroyableUponPush()},e.prototype.isDestroyableUponPush=function(){return this.blockType.startsWith("redstone")||this.blockType.startsWith("door")||this.blockType.startsWith("railsRedstone")||this.blockType.startsWith("pressure")},e.prototype.needToRefreshRedstone=function(){return!!(this.isRedstone||""===this.blockType||this.isConnectedToRedstone&&!this.blockType.startsWith("piston"))},e.prototype.getPistonDirection=function(){if(this.blockType.startsWith("piston")){switch(this.blockType.substring(6,7)){case"D":return r;case"U":return a;case"L":return l;case"R":return s}}},e.prototype.getIsEmptyOrEntity=function(){return this.isEmpty||this.isEntity},e.getCanFall=function(t){return new e(t).getCanFall()},e.getIsPlaceableInLiquid=function(t){return new e(t).getIsPlaceableInLiquid()},e.isWalkable=function(t){return new e(t).isWalkable},e.isMiniblock=function(e){return e.endsWith("Miniblock")},e.isFlat=function(t){return new e(t).isFlat()},e.skipsDestructionOverlay=function(t){return new e(t).skipsDestructionOverlay()},e.notValidOnGroundPlane=function(t){return new e(t).notValidOnGroundPlane()},e.getMiniblockFrame=function(t){if("railsRedstoneTorch"===t)return"redstoneTorch";if(t.startsWith("rails"))return"railNormal";if(!t.startsWith("glass")&&!t.startsWith("ice")){if("redstoneWire"===t.substring(0,12))return"redstoneDust";if(e.isMiniblock(t))return t.replace("Miniblock","");var o=t;switch(o){case"treeAcacia":case"treeBirch":case"treeJungle":case"treeOak":case"treeSpruce":case"treeSpruceSnowy":o="log"+o.substring(4);break;case"stone":o="cobblestone";break;case"oreCoal":o="coal";break;case"oreDiamond":o="diamond";break;case"oreIron":o="ingotIron";break;case"oreLapis":o="lapisLazuli";break;case"oreGold":o="ingotGold";break;case"oreEmerald":o="emerald";break;case"oreRedstone":o="redstoneDust";break;case"grass":o="dirt";break;case"wool_orange":o="wool";break;case"tnt":o="gunPowder"}return o}},e}()},1272:function(e,t,o){"use strict";var i=function(){function e(e,t){var o=[],i=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=o(799);e.exports.convertActionPlaneEntitiesToConfig=function(e){var t=e.gridWidth&&e.gridHeight?[e.gridWidth,e.gridHeight]:[10,10],o=i(t,2),a=o[0],r=o[1];[e.actionPlane].forEach(function(t){for(var o=0;o<t.length;o++){var i=t[o];if(i.match(/sheep|zombie|ironGolem|creeper|cow|chicken|ghast/)){var s={Up:n.North,Down:n.South,Left:n.West,Right:n.East};e.entities=e.entities||[];var l=o%a,c=Math.floor(o/r),p=i.match(/(.*)(Right|Left|Up|Down)/),d=p?s[p[2]]:n.East,u=p?p[1]:i;e.entities.push([u,l,c,d]),t[o]=""}}})},e.exports.randomInt=function(e,t){return Math.floor(Math.random()*(t-e))+e}},1951:function(e,t,o){"use strict";function i(e,t){return a.default.load(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.load=i;var n=o(744),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},1952:function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){var o=[],i=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=o(1269),s=o(1016),l=o(1159),c=o(799),p=o(838),d=o(2711),u=o(2716),h=o(2718),f=o(2726),m=o(2727),g=400,y=400,v=function(){function e(t){var o=this;n(this,e),this.DEBUG=t.debug,window.PhaserGlobal={disableAudio:!0,disableWebAudio:!0,hideBanner:!this.DEBUG},this.codeOrgAPI=m.get(this);var i=t.Phaser;this.game=new i.Game({forceSetTimeOut:t.forceSetTimeOut,width:g,height:y,renderer:i.CANVAS,parent:t.containerId,state:"earlyLoad",preserveDrawingBuffer:!0}),this.specialLevelType=null,this.queue=new r(this),this.OnCompleteCallback=null,this.assetRoot=t.assetRoot,this.audioPlayer=t.audioPlayer,this.afterAssetsLoaded=t.afterAssetsLoaded,this.assetLoader=new f(this),this.earlyLoadAssetPacks=t.earlyLoadAssetPacks||[],this.earlyLoadNiceToHaveAssetPacks=t.earlyLoadNiceToHaveAssetPacks||[],this.resettableTimers=[],this.timeouts=[],this.timeout=0,this.initializeCommandRecord(),this.score=0,this.useScore=!1,this.scoreText=null,this.onScoreUpdate=t.onScoreUpdate,this.events=[],this.assumedSlowMotion=1.5,this.initialSlowMotion=t.customSlowMotion||this.assumedSlowMotion,this.tweenTimeScale=1.5/this.initialSlowMotion,this.playerDelayFactor=1,this.dayNightCycle=!1,this.player=null,this.agent=null,this.timerSprite=null,this.game.state.add("earlyLoad",{preload:function(){o.game.load.resetLocked=!0,o.assetLoader.loadPacks(o.earlyLoadAssetPacks)},create:function(){o.assetLoader.loadPacks(o.earlyLoadNiceToHaveAssetPacks),o.game.load.start()}}),this.game.state.add("levelRunner",{preload:this.preload.bind(this),create:this.create.bind(this),update:this.update.bind(this),render:this.render.bind(this)})}return e.prototype.getIsDirectPlayerControl=function(){return this.levelData.isEventLevel||this.levelData.isAgentLevel},e.prototype.loadLevel=function(e){this.levelData=Object.freeze(e),this.levelEntity=new h(this),this.levelModel=new d(this.levelData,this),this.levelView=new u(this),this.specialLevelType=e.specialLevelType,this.timeout=e.levelVerificationTimeout,void 0!==e.useScore&&(this.useScore=e.useScore),this.timeoutResult=e.timeoutResult,this.onDayCallback=e.onDayCallback,this.onNightCallback=e.onNightCallback,this.game.state.start("levelRunner")},e.prototype.reset=function(){var e=this;this.dayNightCycle=!1,this.queue.reset(),this.levelEntity.reset(),this.levelModel.reset(),this.levelView.reset(this.levelModel),this.levelEntity.loadData(this.levelData),this.player=this.levelModel.player,this.agent=this.levelModel.agent,this.resettableTimers.forEach(function(e){e.stop(!0)}),this.timeouts.forEach(function(e){clearTimeout(e)}),this.timerSprite&&this.timerSprite.kill(),this.timerSprite=null,this.timeouts=[],this.resettableTimers.length=0,this.events.length=0,this.score=0,this.useScore&&this.updateScore(),this.getIsDirectPlayerControl()||this.events.push(function(t){t.eventType===l.WhenUsed&&"sheep"===t.targetType&&e.codeOrgAPI.drop(null,"wool",t.targetIdentifier),t.eventType===l.WhenTouched&&"creeper"===t.targetType&&(e.codeOrgAPI.flashEntity(null,t.targetIdentifier),e.codeOrgAPI.explodeEntity(null,t.targetIdentifier))}),this.initializeCommandRecord()},e.prototype.preload=function(){this.game.load.resetLocked=!0,this.game.time.advancedTiming=this.DEBUG,this.game.stage.disableVisibilityChange=!0,this.assetLoader.loadPacks(this.levelData.assetPacks.beforeLoad)},e.prototype.create=function(){var e=this;this.levelView.create(this.levelModel),this.game.time.slowMotion=this.initialSlowMotion,this.addCheatKeys(),this.assetLoader.loadPacks(this.levelData.assetPacks.afterLoad),this.game.load.image("timer",this.assetRoot+"images/placeholderTimer.png"),this.game.load.onLoadComplete.addOnce(function(){e.afterAssetsLoaded&&e.afterAssetsLoaded()}),this.levelEntity.loadData(this.levelData),this.game.load.start()},e.prototype.run=function(){var e=this;this.events.forEach(function(e){return e({eventType:l.WhenRun,targetIdentifier:void 0})});var t=!0,o=!1,i=void 0;try{for(var n,a=this.levelEntity.entityMap[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var r=n.value,s=r[1];this.events.forEach(function(e){return e({eventType:l.WhenSpawned,targetType:s.type,targetIdentifier:s.identifier})}),s.queue.begin()}}catch(e){o=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw i}}if(!isNaN(this.timeout)&&this.timeout>0){this.timerSprite=this.game.add.sprite(-50,390,"timer");var c=this.levelView.addResettableTween(this.timerSprite).to({x:-450,alpha:.5},this.timeout,Phaser.Easing.Linear.None);c.onComplete.add(function(){e.endLevel(e.timeoutResult(e.levelModel))}),c.start()}},e.prototype.followingPlayer=function(){return!!this.levelData.gridDimensions&&!this.checkMinecartLevelEndAnimation()},e.prototype.update=function(){this.queue.tick(),this.levelEntity.tick(),this.levelModel.usePlayer&&this.player.updateMovement(),this.levelModel.usingAgent&&this.agent.updateMovement(),this.levelView.update(),(this.getIsDirectPlayerControl()||this.player.queue.state>1)&&this.checkSolution()},e.prototype.addCheatKeys=function(){var e,t=this;if(this.levelModel.usePlayer){var o=(e={},i(e,Phaser.Keyboard.UP,c.North),i(e,Phaser.Keyboard.W,c.North),i(e,Phaser.Keyboard.RIGHT,c.East),i(e,Phaser.Keyboard.D,c.East),i(e,Phaser.Keyboard.DOWN,c.South),i(e,Phaser.Keyboard.S,c.South),i(e,Phaser.Keyboard.LEFT,c.West),i(e,Phaser.Keyboard.A,c.West),i(e,Phaser.Keyboard.SPACEBAR,-2),e);Object.keys(o).forEach(function(e){var i=o[e];t.game.input.keyboard.addKey(e).onDown.add(function(){t.player.movementState=i,t.player.updateMovement()}),t.game.input.keyboard.addKey(e).onUp.add(function(){t.player.movementState===i&&(t.player.movementState=-1),t.player.updateMovement()})})}},e.prototype.handleEndState=function(e){this.OnCompleteCallback&&(this.OnCompleteCallback(e,this.levelModel),this.OnCompleteCallback=null)},e.prototype.render=function(){this.DEBUG&&this.game.debug.text(this.game.time.fps||"--",2,14,"#00ff00"),this.levelView.render()},e.prototype.scaleFromOriginal=function(){var e=this.levelData.gridDimensions||[10,10],t=a(e,2);return[t[0]/10,t[1]/10]},e.prototype.getScreenshot=function(){return this.game.canvas.toDataURL("image/png")},e.prototype.initializeCommandRecord=function(){var e=["moveAway","moveToward","moveForward","turn","turnRandom","explode","wait","flash","drop","spawn","destroy","playSound","attack","addScore"];this.commandRecord=new Map,this.repeatCommandRecord=new Map,this.isRepeat=!1;for(var t=0;t<e.length;t++)this.commandRecord.set(e[t],new Map),this.commandRecord.get(e[t]).set("count",0),this.repeatCommandRecord.set(e[t],new Map),this.repeatCommandRecord.get(e[t]).set("count",0)},e.prototype.startPushRepeatCommand=function(){this.isRepeat=!0},e.prototype.endPushRepeatCommand=function(){this.isRepeat=!1},e.prototype.addCommandRecord=function(e,t,o){var i=o?this.repeatCommandRecord:this.commandRecord;if(i.has(e)){var n=i.get(e);if(n.set("count",n.get("count")+1),n.has(t)?n.set(t,n.get(t)+1):n.set(t,1),this.DEBUG){var a=o?"Repeat ":"Command :";console.log(a+e+" executed in mob type : "+t+" updated count : "+n.get(t))}}},e.prototype.getCommandCount=function(e,t,o){var i=o?this.repeatCommandRecord:this.commandRecord;if(i.has(e)){var n=i.get(e);return void 0===t?n.get("count"):n.has(t)?n.get(t):0}return 0},e.prototype.getEntity=function(e){void 0===e&&(e="Player");var t=this.levelEntity.entityMap.get(e);return void 0===t&&console.log("Debug GetEntity: there is no entity : "+e+"\n"),t},e.prototype.getEntities=function(e){return this.levelEntity.getEntitiesOfType(e)},e.prototype.isType=function(e){return"string"==typeof e&&"Player"!==e&&"PlayerAgent"!==e},e.prototype.printErrorMsg=function(e){this.DEBUG&&this.game.debug.text(e)},e.prototype.moveAway=function(e,t){var o=this,i=e.target;if(void 0===i){var n=this.levelEntity.entityMap,a=!0,r=!1,l=void 0;try{for(var c,p=n[Symbol.iterator]();!(a=(c=p.next()).done);a=!0){var d;!function(){d=c.value;var i=d[1],n=new s(o,function(){},function(){o.moveAway(n,t)},i.identifier);i.addCommand(n,e.repeat)}()}}catch(e){r=!0,l=e}finally{try{!a&&p.return&&p.return()}finally{if(r)throw l}}e.succeeded()}else{var u=this.isType(i),h=this.isType(t);if(i===t)return this.printErrorMsg("Debug MoveAway: Can't move away entity from itself\n"),void e.succeeded();if(u||h)if(u&&!h){var f=this.getEntities(i),m=this.getEntity(t);if(void 0!==m)for(var g=0;g<f.length;g++){(function(){if(f[g].identifier===m.identifier)return"continue";var i=new s(o,function(){},function(){o.moveAway(i,t)},f[g].identifier);f[g].addCommand(i,e.repeat)})()}e.succeeded()}else if(!u&&h){var y=this.getEntity(i),v=this.getEntities(t);if(v.length>0){for(var b=[Number.MAX_VALUE,-1],k=0;k<v.length;k++)if(y.identifier!==v[k].identifier){var _=y.getDistance(v[k]);_<b[0]&&(b=[_,k])}-1!==b[1]&&y.moveAway(e,v[b[1]])}else e.succeeded()}else!function(){var n=o.getEntities(i),a=o.getEntities(t);if(a.length>0&&n.length>0){for(var r=0;r<n.length;r++)!function(t){for(var i=n[t],r=[Number.MAX_VALUE,-1],l=0;l<a.length;l++)if(a[t].identifier!==i.identifier){var c=i.getDistance(a[l]);c<r[0]&&(r=[c,l])}-1!==r?function(){var t=new s(o,function(){},function(){o.moveAway(t,a[r[1]].identifier)},i.identifier);i.addCommand(t,e.repeat)}():e.succeeded()}(r);e.succeeded()}}();else{var w=this.getEntity(i),P=this.getEntity(t);if(w===P)return void e.succeeded();w.moveAway(e,P)}}},e.prototype.moveToward=function(e,t){var o=this,i=e.target;if(void 0===i){var n=this.levelEntity.entityMap,a=!0,r=!1,l=void 0;try{for(var c,p=n[Symbol.iterator]();!(a=(c=p.next()).done);a=!0){var d;!function(){d=c.value;var i=d[1],n=new s(o,function(){},function(){o.moveToward(n,t)},i.identifier);i.addCommand(n,e.repeat)}()}}catch(e){r=!0,l=e}finally{try{!a&&p.return&&p.return()}finally{if(r)throw l}}e.succeeded()}else{var u=this.isType(i),h=this.isType(t);if(i===t)return void e.succeeded();if(u||h)if(u&&!h){var f=this.getEntities(i),m=this.getEntity(t);if(void 0!==m){for(var g=0;g<f.length;g++){(function(i){if(f[i].identifier===m.identifier)return"continue";var n=new s(o,function(){},function(){o.moveToward(n,t)},f[i].identifier);f[i].addCommand(n,e.repeat)})(g)}e.succeeded()}}else if(!u&&h){var y=this.getEntity(i),v=this.getEntities(t);if(v.length>0){for(var b=[Number.MAX_VALUE,-1],k=0;k<v.length;k++)if(v[k].identifier!==y.identifier){var _=y.getDistance(v[k]);_<b[0]&&(b=[_,k])}-1!==b[1]?y.moveToward(e,v[b[1]]):e.succeeded()}else e.succeeded()}else!function(){var n=o.getEntities(i),a=o.getEntities(t);if(a.length>0&&n.length>0){for(var r=0;r<n.length;r++)!function(t){for(var i=n[t],r=[Number.MAX_VALUE,-1],l=0;l<a.length;l++)if(a[t].identifier!==i.identifier){var c=i.getDistance(a[l]);c<r[0]&&(r=[c,l])}-1!==r[1]&&function(){var t=new s(o,function(){},function(){o.moveToward(t,a[r[1]].identifier)},i.identifier);i.addCommand(t,e.repeat)}()}(r);e.succeeded()}}();else{var w=this.getEntity(i),P=this.getEntity(t);w.moveToward(e,P)}}},e.prototype.positionEquivalence=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.prototype.execute=function(e,t){for(var o=arguments.length,i=Array(o>2?o-2:0),n=2;n<o;n++)i[n-2]=arguments[n];var a=this,r=e.target;if(this.isType(r)){for(var l=this.getEntities(r),c=0;c<l.length;c++)!function(o){var n=new s(a,function(){},function(){a.execute.apply(a,[n,t].concat(i))},l[o].identifier);l[o].addCommand(n,e.repeat)}(c);e.succeeded()}else if(void 0===r){var p=this.levelEntity.entityMap,d=!0,u=!1,h=void 0;try{for(var f,m=p[Symbol.iterator]();!(d=(f=m.next()).done);d=!0)!function(){var o=f.value,n=o[1],r=new s(a,function(){},function(){a.execute.apply(a,[r,t].concat(i))},n.identifier);n.addCommand(r,e.repeat)}()}catch(e){u=!0,h=e}finally{try{!d&&m.return&&m.return()}finally{if(u)throw h}}e.succeeded()}else{var g=this.getEntity(r);g[t].apply(g,[e].concat(i))}},e.prototype.moveForward=function(e){this.execute(e,"moveForward")},e.prototype.moveBackward=function(e){this.execute(e,"moveBackward")},e.prototype.moveDirection=function(e,t){var o=this.levelModel.player;this.levelModel.shouldRide(t)?(o.handleGetOnRails(t),e.succeeded()):this.execute(e,"moveDirection",t)},e.prototype.turn=function(e,t){this.execute(e,"turn",t)},e.prototype.turnRandom=function(e){this.execute(e,"turnRandom")},e.prototype.flashEntity=function(e){var t=this,o=e.target;if(this.isType(o)){for(var i=this.getEntities(o),n=0;n<i.length;n++)!function(o){var n=new s(t,function(){},function(){t.flashEntity(n)},i[o].identifier);i[o].addCommand(n,e.repeat)}(n);e.succeeded()}else if(void 0===o){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var p,d=a[Symbol.iterator]();!(r=(p=d.next()).done);r=!0)!function(){var o=p.value,i=o[1],n=new s(t,function(){},function(){t.flashEntity(n)},i.identifier);i.addCommand(n,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&d.return&&d.return()}finally{if(l)throw c}}e.succeeded()}else{var u=this.getEntity(o),h=this.levelView.flashSpriteToWhite(u.sprite);this.addCommandRecord("flash",u.type,e.repeat),this.delayBy(h,function(){e.succeeded()})}},e.prototype.explodeEntity=function(e){var t=this,o=e.target;if(this.isType(o)){for(var i=this.getEntities(o),n=0;n<i.length;n++)!function(o){var n=new s(t,function(){},function(){t.explodeEntity(n)},i[o].identifier);i[o].addCommand(n,e.repeat)}(n);e.succeeded()}else{if(void 0===o){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var p,d=a[Symbol.iterator]();!(r=(p=d.next()).done);r=!0)!function(){var o=p.value,i=o[1],n=new s(t,function(){},function(){t.explodeEntity(n)},i.identifier);i.addCommand(n,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&d.return&&d.return()}finally{if(l)throw c}}e.succeeded()}else!function(){var i=t.getEntity(o);t.levelView.playExplosionCloudAnimation(i.position),t.addCommandRecord("explode",i.type,e.repeat),t.levelView.audioPlayer.play("explode");var n=t.levelEntity.entityMap,a=!0,r=!1,l=void 0;try{for(var c,p=n[Symbol.iterator]();!(a=(c=p.next()).done);a=!0)for(var d=c.value,u=d[1],h=-1;h<=1;h++)for(var f=-1;f<=1;f++)if(0!==h||0!==f){var m=[i.position[0]+h,i.position[1]+f];t.destroyBlockWithoutPlayerInteraction(m),u.position[0]===i.position[0]+h&&u.position[1]===i.position[1]+f&&u.blowUp(e,i.position)}}catch(e){r=!0,l=e}finally{try{!a&&p.return&&p.return()}finally{if(r)throw l}}var g=new s(t,function(){},function(){t.destroyEntity(g,i.identifier)},i.identifier);i.queue.startPushHighPriorityCommands(),i.addCommand(g,e.repeat),i.queue.endPushHighPriorityCommands()}();e.succeeded(),this.updateFowPlane(),this.updateShadingPlane()}},e.prototype.wait=function(e,t){var o=this,i=e.target;if(this.isType(i)){for(var n=this.getEntities(i),a=0;a<n.length;a++)!function(i){var a=new s(o,function(){},function(){o.wait(a,t)},n[i].identifier);n[i].addCommand(a,e.repeat)}(a);e.succeeded()}else{var r=this.getEntity(i);this.addCommandRecord("wait",r.type,e.repeat),setTimeout(function(){e.succeeded()},1e3*t/this.tweenTimeScale)}},e.prototype.spawnEntity=function(e,t,o){this.addCommandRecord("spawn",t,e.repeat);var i=this.levelEntity.spawnEntity(t,o);null!==i&&this.events.forEach(function(e){return e({eventType:l.WhenSpawned,targetType:t,targetIdentifier:i.identifier})}),e.succeeded()},e.prototype.spawnEntityAt=function(e,t,o,i,n){var a=this.levelEntity.spawnEntityAt(t,o,i,n);null!==a&&this.events.forEach(function(e){return e({eventType:l.WhenSpawned,targetType:t,targetIdentifier:a.identifier})}),e.succeeded()},e.prototype.destroyEntity=function(e,t){var o=this;if(this.isType(t)){for(var i=this.getEntities(t),n=0;n<i.length;n++)!function(t){var n=i[t],a=new s(o,function(){},function(){o.destroyEntity(a,n.identifier)},n.identifier);n.addCommand(a,e.repeat)}(n);e.succeeded()}else if(void 0===t){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var p,d=a[Symbol.iterator]();!(r=(p=d.next()).done);r=!0)!function(){var t=p.value,i=t[1],n=new s(o,function(){},function(){o.destroyEntity(n,i.identifier)},i.identifier);i.addCommand(n,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&d.return&&d.return()}finally{if(l)throw c}}e.succeeded()}else{this.addCommandRecord("destroy",this.type,e.repeat);var u=this.getEntity(t);void 0!==u?(u.healthPoint=1,u.takeDamage(e)):e.succeeded()}},e.prototype.drop=function(e,t){var o=this,i=e.target;if(this.isType(i)){for(var n=this.getEntities(i),a=0;a<n.length;a++)!function(i){var a=new s(o,function(){},function(){o.drop(a,t)},n[i].identifier);n[i].addCommand(a,e.repeat)}(a);e.succeeded()}else if(void 0===i){var r=this.levelEntity.entityMap,l=!0,c=!1,p=void 0;try{for(var d,u=r[Symbol.iterator]();!(l=(d=u.next()).done);l=!0)!function(){var i=d.value,n=i[1],a=new s(o,function(){},function(){o.drop(a,t)},n.identifier);n.addCommand(a,e.repeat)}()}catch(e){c=!0,p=e}finally{try{!l&&u.return&&u.return()}finally{if(c)throw p}}e.succeeded()}else{var h=this.getEntity(i);h.drop(e,t)}},e.prototype.attack=function(e){var t=this,o=e.target;if(this.isType(o)){for(var i=this.getEntities(o),n=0;n<i.length;n++)!function(o){var n=new s(t,function(){},function(){t.attack(n)},i[o].identifier);i[o].addCommand(n,e.repeat)}(n);e.succeeded()}else if(void 0===o){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var p,d=a[Symbol.iterator]();!(r=(p=d.next()).done);r=!0)!function(){var o=p.value,i=o[1],n=new s(t,function(){},function(){t.attack(n)},i.identifier);i.addCommand(n,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&d.return&&d.return()}finally{if(l)throw c}}e.succeeded()}else{var u=this.getEntity(o);"Player"===u.identifier?(this.codeOrgAPI.destroyBlock(function(){},u.identifier),e.succeeded()):u.attack(e)}},e.prototype.playSound=function(e,t){this.addCommandRecord("playSound",void 0,e.repeat),this.levelView.audioPlayer.play(t),e.succeeded()},e.prototype.use=function(e){var t=this,o=this.levelModel.player,i=this.levelModel.getMoveForwardPosition(o),n=this.levelEntity.getEntityAt(i),a=this.levelModel.actionPlane.getBlockAt(i),r=void 0!==a&&"door"===a.blockType;null!==n&&n!==this.agent?(this.levelView.setSelectionIndicatorPosition(i[0],i[1]),this.levelView.onAnimationEnd(this.levelView.playPlayerAnimation("punch",o.position,o.facing,!1),function(){n.queue.startPushHighPriorityCommands();var i=new s(t,function(){},function(){n.use(i,o)},n.identifier);t.levelEntity.isFriendlyEntity(n.type)||function(){var e=o.facing,i=new s(t,function(){},function(){n.pushBack(i,e,150)},n.identifier);n.addCommand(i)}(),n.addCommand(i),n.queue.endPushHighPriorityCommands(),t.levelView.playPlayerAnimation("idle",o.position,o.facing,!1),t.getIsDirectPlayerControl()?t.delayPlayerMoveBy(0,0,function(){e.succeeded()}):e.waitForOtherQueue=!0,setTimeout(function(){t.levelView.setSelectionIndicatorPosition(o.position[0],o.position[1])},0)})):r?(this.levelView.setSelectionIndicatorPosition(i[0],i[1]),this.levelView.onAnimationEnd(this.levelView.playPlayerAnimation("punch",o.position,o.facing,!1),function(){t.audioPlayer.play("doorOpen");var n=!a.isWalkable;t.levelView.playDoorAnimation(i,n,function(){a.isWalkable=!a.isWalkable,t.levelView.playIdleAnimation(o.position,o.facing,o.isOnBlock),t.levelView.setSelectionIndicatorPosition(o.position[0],o.position[1]),e.succeeded()})})):a&&a.isRail?(this.levelView.playTrack(i,o.facing,!0,o,null),e.succeeded()):this.levelView.playPunchDestroyAirAnimation(o.position,o.facing,this.levelModel.getMoveForwardPosition(),function(){t.levelView.setSelectionIndicatorPosition(o.position[0],o.position[1]),t.levelView.playIdleAnimation(o.position,o.facing,o.isOnBlock),t.delayPlayerMoveBy(0,0,function(){e.succeeded()})})},e.prototype.destroyBlock=function(e){var t=this,o=this.getEntity(e.target);if(this.levelModel.canDestroyBlockForward(o)){var i=this.levelModel.actionPlane.getBlockAt(this.levelModel.getMoveForwardPosition(o));if(null!==i){var n=this.levelModel.getMoveForwardPosition(o),a=i.blockType;if(i.isDestroyable){switch(a){case"logAcacia":case"treeAcacia":a="planksAcacia";break;case"logBirch":case"treeBirch":a="planksBirch";break;case"logJungle":case"treeJungle":a="planksJungle";break;case"logOak":case"treeOak":a="planksOak";break;case"logSpruce":case"treeSpruce":a="planksSpruce"}this.levelView.playDestroyBlockAnimation(o.position,o.facing,n,a,o,function(){e.succeeded()})}else if(i.isUsable)switch(a){case"sheep":this.levelView.playShearSheepAnimation(o.position,o.facing,n,a,function(){e.succeeded()});break;default:e.succeeded()}else e.succeeded()}}else this.levelView.playPunchDestroyAirAnimation(o.position,o.facing,this.levelModel.getMoveForwardPosition(o),function(){t.levelView.setSelectionIndicatorPosition(o.position[0],o.position[1]),t.levelView.playIdleAnimation(o.position,o.facing,o.isOnBlock,o),t.delayPlayerMoveBy(0,0,function(){e.succeeded()})},o)},e.prototype.destroyBlockWithoutPlayerInteraction=function(e){if(this.levelModel.inBounds(e)){var t=this.levelModel.actionPlane.getBlockAt(e);if(null!==t&&void 0!==t){var o=e,i=t.blockType;if(t.isDestroyable){switch(i){case"logAcacia":case"treeAcacia":i="planksAcacia";break;case"logBirch":case"treeBirch":i="planksBirch";break;case"logJungle":case"treeJungle":i="planksJungle";break;case"logOak":case"treeOak":i="planksOak";break;case"logSpruce":case"treeSpruce":case"logSpruceSnowy":case"treeSpruceSnowy":i="planksSpruce"}this.levelView.destroyBlockWithoutPlayerInteraction(o),this.levelView.playExplosionAnimation(this.levelModel.player.position,this.levelModel.player.facing,e,i,function(){},!1),this.levelView.createMiniBlock(o[0],o[1],i),this.updateFowPlane(),this.updateShadingPlane()}else if(t.isUsable)switch(i){case"sheep":this.levelView.playShearAnimation(this.levelModel.player.position,this.levelModel.player.facing,e,i,function(){})}}this.levelModel.destroyBlock(e)}},e.prototype.checkTntAnimation=function(){return"freeplay"===this.specialLevelType},e.prototype.checkMinecartLevelEndAnimation=function(){return"minecart"===this.specialLevelType},e.prototype.checkHouseBuiltEndAnimation=function(){return"houseBuild"===this.specialLevelType},e.prototype.checkAgentSpawn=function(){return"agentSpawn"===this.specialLevelType},e.prototype.placeBlock=function(e,t){var o=this,i=this.getEntity(e.target),n=i.position,a=this.levelModel.actionPlane.getBlockAt(n),r=a.blockType;this.levelModel.canPlaceBlock(i,a)?(""!==r&&this.levelModel.destroyBlock(n),"cropWheat"!==t||"farmlandWet"===this.levelModel.groundPlane.getBlockAt(i.position).blockType?(this.levelModel.player.updateHidingBlock(i.position),this.checkMinecartLevelEndAnimation()&&"rail"===t&&(t=i.position[1]<7?"railsUnpoweredVertical":"rails"),this.levelView.playPlaceBlockAnimation(i.position,i.facing,t,r,i,function(){o.levelModel.placeBlock(t,i),o.updateFowPlane(),o.updateShadingPlane(),o.delayBy(200,function(){o.levelView.playIdleAnimation(i.position,i.facing,!1,i)}),o.delayPlayerMoveBy(200,400,function(){e.succeeded()})})):function(){var t=o.levelView.playPlayerAnimation("jumpUp",i.position,i.facing,!1,i).onLoop.add(function(){o.levelView.playIdleAnimation(i.position,i.facing,!1,i),t.detach(),o.delayBy(800,function(){return e.succeeded()})},o)}()):e.succeeded()},e.prototype.setPlayerActionDelayByQueueLength=function(){if(this.levelModel.usePlayer){var e=this.levelModel.player.queue.getLength(),t=Math.min(Math.max(e-10,0),10);this.playerDelayFactor=1-t/10}},e.prototype.delayBy=function(e,t){var o=this.game.time.create(!0);o.add(this.originalMsToScaled(e),t,this),o.start(),this.resettableTimers.push(o)},e.prototype.delayPlayerMoveBy=function(e,t,o){this.delayBy(Math.max(e,t*this.playerDelayFactor),o)},e.prototype.originalMsToScaled=function(e){return e/this.assumedSlowMotion*this.game.time.slowMotion},e.prototype.originalFpsToScaled=function(e){return e*this.assumedSlowMotion/this.game.time.slowMotion},e.prototype.placeBlockForward=function(e,t){this.placeBlockDirection(e,t,0)},e.prototype.placeBlockDirection=function(e,t,o){var i=this,n=this.getEntity(e.target),a=void 0,r=void 0,s=function(){};if(!this.levelModel.canPlaceBlockDirection(t,n,o))return void this.levelView.playPunchAirAnimation(n.position,n.facing,n.position,function(){i.levelView.playIdleAnimation(n.position,n.facing,!1,n),e.succeeded()},n);a=this.levelModel.getMoveDirectionPosition(n,o),r=this.levelModel.getPlaneToPlaceOn(a,n,t),this.levelModel.isBlockOfTypeOnPlane(a,"lava",r)&&(s=function(){return i.levelView.audioPlayer.play("fizz")}),this.levelView.playPlaceBlockInFrontAnimation(n,n.position,n.facing,a,function(){i.levelModel.placeBlockDirection(t,r,n,o),i.levelView.refreshGroundGroup(),i.updateFowPlane(),i.updateShadingPlane(),s(),i.delayBy(200,function(){i.levelView.playIdleAnimation(n.position,n.facing,!1,n)}),i.delayPlayerMoveBy(200,400,function(){e.succeeded()})})},e.prototype.checkSolution=function(){var e=this;if(this.attemptRunning&&!this.resultReported)if(this.levelModel.isSolved()){var t,o,i,n,a,r;!function(){var s=e.levelModel.player;if(e.checkHouseBuiltEndAnimation())e.resultReported=!0,t=e.levelModel.getHouseBottomRight(),o=new p(t.x-1,t.y+2),i=new p(t.x,t.y),n=new p(t.x-1,t.y+1),e.levelModel.moveTo(o),e.levelView.playSuccessHouseBuiltAnimation(s.position,s.facing,s.isOnBlock,e.levelModel.houseGroundToFloorBlocks(t),[i,n],function(){e.endLevel(!0)},function(){e.levelModel.destroyBlock(i),e.levelModel.destroyBlock(n),e.updateFowPlane(),e.updateShadingPlane()});else if(e.checkMinecartLevelEndAnimation())e.resultReported=!0,e.levelView.playMinecartAnimation(s.isOnBlock,function(){e.handleEndState(!0)});else if(e.checkAgentSpawn()){e.resultReported=!0;var l=e.levelView.playLevelEndAnimation(s.position,s.facing,s.isOnBlock);l.onComplete.add(function(){e.levelModel.spawnAgent(null,new p(3,4),2),e.levelView.agent=e.agent,e.levelView.resetEntity(e.agent),e.updateFowPlane(),e.updateShadingPlane(),e.delayBy(200,function(){e.endLevel(!0)})})}else e.checkTntAnimation()?(e.resultReported=!0,e.levelView.scaleShowWholeWorld(function(){}),a=e.levelModel.getTnt(),r=s.isOnBlock,e.levelView.playDestroyTntAnimation(s.position,s.facing,s.isOnBlock,e.levelModel.getTnt(),e.levelModel.shadingPlane,function(){for(var t in a){a[t].x===e.levelModel.player.position.x&&a[t].y===e.levelModel.player.position.y&&(e.levelModel.player.isOnBlock=!1);var o=e.levelModel.getAllBorderingPositionNotOfType(a[t],"tnt");e.levelModel.destroyBlock(a[t]);for(var i=1;i<o.length;++i)o[i][0]&&e.destroyBlockWithoutPlayerInteraction(o[i][1])}!s.isOnBlock&&r&&e.levelView.playPlayerJumpDownVerticalAnimation(s.facing,s.position),e.updateFowPlane(),e.updateShadingPlane(),e.delayBy(200,function(){e.levelView.playSuccessAnimation(s.position,s.facing,s.isOnBlock,function(){e.endLevel(!0)})})})):e.endLevel(!0)}()}else!this.levelModel.isFailed()&&this.getIsDirectPlayerControl()||this.endLevel(!1)},e.prototype.endLevel=function(e){var t=this;if(!this.levelModel.usePlayer)return e?this.levelView.audioPlayer.play("success"):this.levelView.audioPlayer.play("failure"),this.resultReported=!0,void this.handleEndState(e);e?function(){var e=t.levelModel.player,o=new s(t,function(){},function(){t.levelView.playSuccessAnimation(e.position,e.facing,e.isOnBlock,function(){t.handleEndState(!0)})},e.identifier);e.queue.startPushHighPriorityCommands(),e.addCommand(o,t.isRepeat),e.queue.endPushHighPriorityCommands()}():function(){var e=t.levelModel.player,o=new s(t,function(){},function(){t.destroyEntity(o,e.identifier)},e.identifier);e.queue.startPushHighPriorityCommands(),e.addCommand(o,t.isRepeat),e.queue.endPushHighPriorityCommands()}()},e.prototype.addScore=function(e,t){this.addCommandRecord("addScore",void 0,e.repeat),this.useScore&&(this.score+=t,this.updateScore()),e.succeeded()},e.prototype.updateScore=function(){this.onScoreUpdate&&this.onScoreUpdate(this.score)},e.prototype.isPathAhead=function(e){return this.levelModel.isForwardBlockOfType(e)},e.prototype.addCommand=function(e){if(void 0!==e.target){this.getEntity(e.target).addCommand(e,this.isRepeat)}else this.queue.addCommand(e,this.isRepeat),this.queue.begin()},e.prototype.addGlobalCommand=function(e){var t=this.levelEntity.entityMap.get(e.target);void 0!==t?t.addCommand(e,this.isRepeat):(this.queue.addCommand(e,this.isRepeat),this.queue.begin())},e.prototype.startDay=function(e){var t=this;if(this.levelModel.isDaytime)void 0!==e&&null!==e&&e.succeeded(),this.DEBUG&&this.game.debug.text("Impossible to start day since it's already day time\n");else{void 0!==this.onDayCallback&&this.onDayCallback(),this.levelModel.isDaytime=!0,this.levelModel.clearFow(),this.levelView.updateFowGroup(this.levelModel.fowPlane),this.events.forEach(function(e){return e({eventType:l.WhenDayGlobal})});var o=this.levelEntity.entityMap,i=!0,n=!1,a=void 0;try{for(var r,s=o[Symbol.iterator]();!(i=(r=s.next()).done);i=!0)!function(){var e=r.value,o=e[1];t.events.forEach(function(e){return e({eventType:l.WhenDay,targetIdentifier:o.identifier,targetType:o.type})})}()}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}for(var c=this.levelEntity.getEntitiesOfType("zombie"),p=0;p<c.length;p++)c[p].setBurn(!0);void 0!==e&&null!==e&&e.succeeded()}},e.prototype.startNight=function(e){var t=this;if(this.levelModel.isDaytime){void 0!==this.onNightCallback&&this.onNightCallback(),this.levelModel.isDaytime=!1,this.levelModel.computeFowPlane(),this.levelView.updateFowGroup(this.levelModel.fowPlane),this.events.forEach(function(e){return e({eventType:l.WhenNightGlobal})});var o=this.levelEntity.entityMap,i=!0,n=!1,a=void 0;try{for(var r,s=o[Symbol.iterator]();!(i=(r=s.next()).done);i=!0)!function(){var e=r.value,o=e[1];t.events.forEach(function(e){return e({eventType:l.WhenNight,targetIdentifier:o.identifier,targetType:o.type})})}()}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}for(var c=this.levelEntity.getEntitiesOfType("zombie"),p=0;p<c.length;p++)c[p].setBurn(!1);void 0!==e&&null!==e&&e.succeeded()}else void 0!==e&&null!==e&&e.succeeded(),this.DEBUG&&this.game.debug.text("Impossible to start night since it's already night time\n")},e.prototype.initiateDayNightCycle=function(e,t,o){var i=this;"day"===o||"Day"===o?this.timeouts.push(setTimeout(function(){i.startDay(null),i.setDayNightCycle(t,"night")},1e3*e)):"night"!==o&&"Night"!==o||this.timeouts.push(setTimeout(function(){i.startNight(null),i.setDayNightCycle(t,"day")},1e3*e))},e.prototype.setDayNightCycle=function(e,t){var o=this;this.dayNightCycle&&("day"===t||"Day"===t?this.timeouts.push(setTimeout(function(){o.dayNightCycle&&(o.startDay(null),o.setDayNightCycle(e,"night"))},1e3*e)):"night"!==t&&"Night"!==t||this.timeouts.push(setTimeout(function(){o.dayNightCycle&&(o.startNight(null),o.setDayNightCycle(e,"day"))},1e3*e)))},e.prototype.arrowDown=function(e){this.levelModel.usePlayer&&(this.player.movementState=e,this.player.updateMovement())},e.prototype.arrowUp=function(e){this.levelModel.usePlayer&&(this.player.movementState===e&&(this.player.movementState=-1),this.player.updateMovement())},e.prototype.clickDown=function(){this.levelModel.usePlayer&&(this.player.movementState=-2,this.player.updateMovement())},e.prototype.clickUp=function(){this.levelModel.usePlayer&&(-2===this.player.movementState&&(this.player.movementState=-1),this.player.updateMovement())},e.prototype.updateFowPlane=function(){this.levelModel.computeFowPlane(),this.levelView.updateFowGroup(this.levelModel.fowPlane)},e.prototype.updateShadingPlane=function(){this.levelModel.computeShadingPlane(),this.levelView.updateShadingGroup(this.levelModel.shadingPlane)},e}();window.GameController=v,e.exports=v},2129:function(e,t,o){var i;/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(n,a,r,s){"use strict";function l(e,t,o){return setTimeout(h(e,o),t)}function c(e,t,o){return!!Array.isArray(e)&&(p(e,o[t],o),!0)}function p(e,t,o){var i;if(e)if(e.forEach)e.forEach(t,o);else if(e.length!==s)for(i=0;i<e.length;)t.call(o,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(o,e[i],i,e)}function d(e,t,o){var i="DEPRECATED METHOD: "+t+"\n"+o+" AT \n";return function(){var t=new Error("get-stack-trace"),o=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=n.console&&(n.console.warn||n.console.log);return a&&a.call(n.console,i,o),e.apply(this,arguments)}}function u(e,t,o){var i,n=t.prototype;i=e.prototype=Object.create(n),i.constructor=e,i._super=n,o&&fe(i,o)}function h(e,t){return function(){return e.apply(t,arguments)}}function f(e,t){return typeof e==ye?e.apply(t?t[0]||s:s,t):e}function m(e,t){return e===s?t:e}function g(e,t,o){p(k(t),function(t){e.addEventListener(t,o,!1)})}function y(e,t,o){p(k(t),function(t){e.removeEventListener(t,o,!1)})}function v(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function b(e,t){return e.indexOf(t)>-1}function k(e){return e.trim().split(/\s+/g)}function _(e,t,o){if(e.indexOf&&!o)return e.indexOf(t);for(var i=0;i<e.length;){if(o&&e[i][o]==t||!o&&e[i]===t)return i;i++}return-1}function w(e){return Array.prototype.slice.call(e,0)}function P(e,t,o){for(var i=[],n=[],a=0;a<e.length;){var r=t?e[a][t]:e[a];_(n,r)<0&&i.push(e[a]),n[a]=r,a++}return o&&(i=t?i.sort(function(e,o){return e[t]>o[t]}):i.sort()),i}function S(e,t){for(var o,i,n=t[0].toUpperCase()+t.slice(1),a=0;a<me.length;){if(o=me[a],(i=o?o+n:t)in e)return i;a++}return s}function A(){return Pe++}function C(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||n}function T(e,t){var o=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){f(e.options.enable,[e])&&o.handler(t)},this.init()}function E(e){var t=e.options.inputClass;return new(t||(Ce?W:Te?q:Ae?Y:V))(e,R)}function R(e,t,o){var i=o.pointers.length,n=o.changedPointers.length,a=t&Re&&i-n==0,r=t&(Oe|Me)&&i-n==0;o.isFirst=!!a,o.isFinal=!!r,a&&(e.session={}),o.eventType=t,D(e,o),e.emit("hammer.input",o),e.recognize(o),e.session.prevInput=o}function D(e,t){var o=e.session,i=t.pointers,n=i.length;o.firstInput||(o.firstInput=B(t)),n>1&&!o.firstMultiple?o.firstMultiple=B(t):1===n&&(o.firstMultiple=!1);var a=o.firstInput,r=o.firstMultiple,s=r?r.center:a.center,l=t.center=x(i);t.timeStamp=ke(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=U(s,l),t.distance=N(s,l),O(o,t),t.offsetDirection=j(t.deltaX,t.deltaY);var c=I(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=be(c.x)>be(c.y)?c.x:c.y,t.scale=r?L(r.pointers,i):1,t.rotation=r?F(r.pointers,i):0,t.maxPointers=o.prevInput?t.pointers.length>o.prevInput.maxPointers?t.pointers.length:o.prevInput.maxPointers:t.pointers.length,M(o,t);var p=e.element;v(t.srcEvent.target,p)&&(p=t.srcEvent.target),t.target=p}function O(e,t){var o=t.center,i=e.offsetDelta||{},n=e.prevDelta||{},a=e.prevInput||{};t.eventType!==Re&&a.eventType!==Oe||(n=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:o.x,y:o.y}),t.deltaX=n.x+(o.x-i.x),t.deltaY=n.y+(o.y-i.y)}function M(e,t){var o,i,n,a,r=e.lastInterval||t,l=t.timeStamp-r.timeStamp;if(t.eventType!=Me&&(l>Ee||r.velocity===s)){var c=t.deltaX-r.deltaX,p=t.deltaY-r.deltaY,d=I(l,c,p);i=d.x,n=d.y,o=be(d.x)>be(d.y)?d.x:d.y,a=j(c,p),e.lastInterval=t}else o=r.velocity,i=r.velocityX,n=r.velocityY,a=r.direction;t.velocity=o,t.velocityX=i,t.velocityY=n,t.direction=a}function B(e){for(var t=[],o=0;o<e.pointers.length;)t[o]={clientX:ve(e.pointers[o].clientX),clientY:ve(e.pointers[o].clientY)},o++;return{timeStamp:ke(),pointers:t,center:x(t),deltaX:e.deltaX,deltaY:e.deltaY}}function x(e){var t=e.length;if(1===t)return{x:ve(e[0].clientX),y:ve(e[0].clientY)};for(var o=0,i=0,n=0;n<t;)o+=e[n].clientX,i+=e[n].clientY,n++;return{x:ve(o/t),y:ve(i/t)}}function I(e,t,o){return{x:t/e||0,y:o/e||0}}function j(e,t){return e===t?Be:be(e)>=be(t)?e<0?xe:Ie:t<0?je:Ne}function N(e,t,o){o||(o=Ve);var i=t[o[0]]-e[o[0]],n=t[o[1]]-e[o[1]];return Math.sqrt(i*i+n*n)}function U(e,t,o){o||(o=Ve);var i=t[o[0]]-e[o[0]],n=t[o[1]]-e[o[1]];return 180*Math.atan2(n,i)/Math.PI}function F(e,t){return U(t[1],t[0],We)+U(e[1],e[0],We)}function L(e,t){return N(t[0],t[1],We)/N(e[0],e[1],We)}function V(){this.evEl=He,this.evWin=qe,this.pressed=!1,T.apply(this,arguments)}function W(){this.evEl=Xe,this.evWin=Je,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function G(){this.evTarget=Ze,this.evWin=Qe,this.started=!1,T.apply(this,arguments)}function H(e,t){var o=w(e.touches),i=w(e.changedTouches);return t&(Oe|Me)&&(o=P(o.concat(i),"identifier",!0)),[o,i]}function q(){this.evTarget=et,this.targetIds={},T.apply(this,arguments)}function z(e,t){var o=w(e.touches),i=this.targetIds;if(t&(Re|De)&&1===o.length)return i[o[0].identifier]=!0,[o,o];var n,a,r=w(e.changedTouches),s=[],l=this.target;if(a=o.filter(function(e){return v(e.target,l)}),t===Re)for(n=0;n<a.length;)i[a[n].identifier]=!0,n++;for(n=0;n<r.length;)i[r[n].identifier]&&s.push(r[n]),t&(Oe|Me)&&delete i[r[n].identifier],n++;return s.length?[P(a.concat(s),"identifier",!0),s]:void 0}function Y(){T.apply(this,arguments);var e=h(this.handler,this);this.touch=new q(this.manager,e),this.mouse=new V(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function X(e,t){e&Re?(this.primaryTouch=t.changedPointers[0].identifier,J.call(this,t)):e&(Oe|Me)&&J.call(this,t)}function J(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var o={x:t.clientX,y:t.clientY};this.lastTouches.push(o);var i=this.lastTouches,n=function(){var e=i.indexOf(o);e>-1&&i.splice(e,1)};setTimeout(n,tt)}}function K(e){for(var t=e.srcEvent.clientX,o=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var n=this.lastTouches[i],a=Math.abs(t-n.x),r=Math.abs(o-n.y);if(a<=ot&&r<=ot)return!0}return!1}function Z(e,t){this.manager=e,this.set(t)}function Q(e){if(b(e,st))return st;var t=b(e,lt),o=b(e,ct);return t&&o?st:t||o?t?lt:ct:b(e,rt)?rt:at}function $(e){this.options=fe({},this.defaults,e||{}),this.id=A(),this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=dt,this.simultaneous={},this.requireFail=[]}function ee(e){return e&gt?"cancel":e&ft?"end":e&ht?"move":e&ut?"start":""}function te(e){return e==Ne?"down":e==je?"up":e==xe?"left":e==Ie?"right":""}function oe(e,t){var o=t.manager;return o?o.get(e):e}function ie(){$.apply(this,arguments)}function ne(){ie.apply(this,arguments),this.pX=null,this.pY=null}function ae(){ie.apply(this,arguments)}function re(){$.apply(this,arguments),this._timer=null,this._input=null}function se(){ie.apply(this,arguments)}function le(){ie.apply(this,arguments)}function ce(){$.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function pe(e,t){return t=t||{},t.recognizers=m(t.recognizers,pe.defaults.preset),new de(e,t)}function de(e,t){this.options=fe({},pe.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=E(this),this.touchAction=new Z(this,this.options.touchAction),ue(this,!0),p(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ue(e,t){var o=e.element;if(o.style){var i;p(e.options.cssProps,function(n,a){i=S(o.style,a),t?(e.oldCssProps[i]=o.style[i],o.style[i]=n):o.style[i]=e.oldCssProps[i]||""}),t||(e.oldCssProps={})}}function he(e,t){var o=a.createEvent("Event");o.initEvent(e,!0,!0),o.gesture=t,t.target.dispatchEvent(o)}var fe,me=["","webkit","Moz","MS","ms","o"],ge=a.createElement("div"),ye="function",ve=Math.round,be=Math.abs,ke=Date.now;fe="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),o=1;o<arguments.length;o++){var i=arguments[o];if(i!==s&&null!==i)for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t}:Object.assign;var _e=d(function(e,t,o){for(var i=Object.keys(t),n=0;n<i.length;)(!o||o&&e[i[n]]===s)&&(e[i[n]]=t[i[n]]),n++;return e},"extend","Use `assign`."),we=d(function(e,t){return _e(e,t,!0)},"merge","Use `assign`."),Pe=1,Se=/mobile|tablet|ip(ad|hone|od)|android/i,Ae="ontouchstart"in n,Ce=S(n,"PointerEvent")!==s,Te=Ae&&Se.test(navigator.userAgent),Ee=25,Re=1,De=2,Oe=4,Me=8,Be=1,xe=2,Ie=4,je=8,Ne=16,Ue=xe|Ie,Fe=je|Ne,Le=Ue|Fe,Ve=["x","y"],We=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(C(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(C(this.element),this.evWin,this.domHandler)}};var Ge={mousedown:Re,mousemove:De,mouseup:Oe},He="mousedown",qe="mousemove mouseup";u(V,T,{handler:function(e){var t=Ge[e.type];t&Re&&0===e.button&&(this.pressed=!0),t&De&&1!==e.which&&(t=Oe),this.pressed&&(t&Oe&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var ze={pointerdown:Re,pointermove:De,pointerup:Oe,pointercancel:Me,pointerout:Me},Ye={2:"touch",3:"pen",4:"mouse",5:"kinect"},Xe="pointerdown",Je="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(Xe="MSPointerDown",Je="MSPointerMove MSPointerUp MSPointerCancel"),u(W,T,{handler:function(e){var t=this.store,o=!1,i=e.type.toLowerCase().replace("ms",""),n=ze[i],a=Ye[e.pointerType]||e.pointerType,r="touch"==a,s=_(t,e.pointerId,"pointerId");n&Re&&(0===e.button||r)?s<0&&(t.push(e),s=t.length-1):n&(Oe|Me)&&(o=!0),s<0||(t[s]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),o&&t.splice(s,1))}});var Ke={touchstart:Re,touchmove:De,touchend:Oe,touchcancel:Me},Ze="touchstart",Qe="touchstart touchmove touchend touchcancel";u(G,T,{handler:function(e){var t=Ke[e.type];if(t===Re&&(this.started=!0),this.started){var o=H.call(this,e,t);t&(Oe|Me)&&o[0].length-o[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:o[0],changedPointers:o[1],pointerType:"touch",srcEvent:e})}}});var $e={touchstart:Re,touchmove:De,touchend:Oe,touchcancel:Me},et="touchstart touchmove touchend touchcancel";u(q,T,{handler:function(e){var t=$e[e.type],o=z.call(this,e,t);o&&this.callback(this.manager,t,{pointers:o[0],changedPointers:o[1],pointerType:"touch",srcEvent:e})}});var tt=2500,ot=25;u(Y,T,{handler:function(e,t,o){var i="touch"==o.pointerType,n="mouse"==o.pointerType;if(!(n&&o.sourceCapabilities&&o.sourceCapabilities.firesTouchEvents)){if(i)X.call(this,t,o);else if(n&&K.call(this,o))return;this.callback(e,t,o)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var it=S(ge.style,"touchAction"),nt=it!==s,at="auto",rt="manipulation",st="none",lt="pan-x",ct="pan-y",pt=function(){if(!nt)return!1;var e={},t=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(o){e[o]=!t||n.CSS.supports("touch-action",o)}),e}();Z.prototype={set:function(e){"compute"==e&&(e=this.compute()),nt&&this.manager.element.style&&pt[e]&&(this.manager.element.style[it]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,function(t){f(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Q(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,o=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var i=this.actions,n=b(i,st)&&!pt[st],a=b(i,ct)&&!pt[ct],r=b(i,lt)&&!pt[lt];if(n){var s=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(s&&l&&c)return}return r&&a?void 0:n||a&&o&Ue||r&&o&Fe?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var dt=1,ut=2,ht=4,ft=8,mt=ft,gt=16;$.prototype={defaults:{},set:function(e){return fe(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(c(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=oe(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return c(e,"dropRecognizeWith",this)?this:(e=oe(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(c(e,"requireFailure",this))return this;var t=this.requireFail;return e=oe(e,this),-1===_(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(c(e,"dropRequireFailure",this))return this;e=oe(e,this);var t=_(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){o.manager.emit(t,e)}var o=this,i=this.state;i<ft&&t(o.options.event+ee(i)),t(o.options.event),e.additionalEvent&&t(e.additionalEvent),i>=ft&&t(o.options.event+ee(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|dt)))return!1;e++}return!0},recognize:function(e){var t=fe({},e);if(!f(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(mt|gt|32)&&(this.state=dt),this.state=this.process(t),this.state&(ut|ht|ft|gt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},u(ie,$,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,o=e.eventType,i=t&(ut|ht),n=this.attrTest(e);return i&&(o&Me||!n)?t|gt:i||n?o&Oe?t|ft:t&ut?t|ht:ut:32}}),u(ne,ie,{defaults:{event:"pan",threshold:10,pointers:1,direction:Le},getTouchAction:function(){var e=this.options.direction,t=[];return e&Ue&&t.push(ct),e&Fe&&t.push(lt),t},directionTest:function(e){var t=this.options,o=!0,i=e.distance,n=e.direction,a=e.deltaX,r=e.deltaY;return n&t.direction||(t.direction&Ue?(n=0===a?Be:a<0?xe:Ie,o=a!=this.pX,i=Math.abs(e.deltaX)):(n=0===r?Be:r<0?je:Ne,o=r!=this.pY,i=Math.abs(e.deltaY))),e.direction=n,o&&i>t.threshold&&n&t.direction},attrTest:function(e){return ie.prototype.attrTest.call(this,e)&&(this.state&ut||!(this.state&ut)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=te(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),u(ae,ie,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&ut)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),u(re,$,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[at]},process:function(e){var t=this.options,o=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime>t.time;if(this._input=e,!i||!o||e.eventType&(Oe|Me)&&!n)this.reset();else if(e.eventType&Re)this.reset(),this._timer=l(function(){this.state=mt,this.tryEmit()},t.time,this);else if(e.eventType&Oe)return mt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===mt&&(e&&e.eventType&Oe?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ke(),this.manager.emit(this.options.event,this._input)))}}),u(se,ie,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&ut)}}),u(le,ie,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ue|Fe,pointers:1},getTouchAction:function(){return ne.prototype.getTouchAction.call(this)},attrTest:function(e){var t,o=this.options.direction;return o&(Ue|Fe)?t=e.overallVelocity:o&Ue?t=e.overallVelocityX:o&Fe&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&o&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&be(t)>this.options.velocity&&e.eventType&Oe},emit:function(e){var t=te(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),u(ce,$,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rt]},process:function(e){var t=this.options,o=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime<t.time;if(this.reset(),e.eventType&Re&&0===this.count)return this.failTimeout();if(i&&n&&o){if(e.eventType!=Oe)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||N(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,r&&a?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=l(function(){this.state=mt,this.tryEmit()},t.interval,this),ut):mt}return 32},failTimeout:function(){return this._timer=l(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==mt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),pe.VERSION="2.0.7",pe.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[se,{enable:!1}],[ae,{enable:!1},["rotate"]],[le,{direction:Ue}],[ne,{direction:Ue},["swipe"]],[ce],[ce,{event:"doubletap",taps:2},["tap"]],[re]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};de.prototype={set:function(e){return fe(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var o,i=this.recognizers,n=t.curRecognizer;(!n||n&&n.state&mt)&&(n=t.curRecognizer=null);for(var a=0;a<i.length;)o=i[a],2===t.stopped||n&&o!=n&&!o.canRecognizeWith(n)?o.reset():o.recognize(e),!n&&o.state&(ut|ht|ft)&&(n=t.curRecognizer=o),a++}},get:function(e){if(e instanceof $)return e;for(var t=this.recognizers,o=0;o<t.length;o++)if(t[o].options.event==e)return t[o];return null},add:function(e){if(c(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(c(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,o=_(t,e);-1!==o&&(t.splice(o,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var o=this.handlers;return p(k(e),function(e){o[e]=o[e]||[],o[e].push(t)}),this}},off:function(e,t){if(e!==s){var o=this.handlers;return p(k(e),function(e){t?o[e]&&o[e].splice(_(o[e],t),1):delete o[e]}),this}},emit:function(e,t){this.options.domEvents&&he(e,t);var o=this.handlers[e]&&this.handlers[e].slice();if(o&&o.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<o.length;)o[i](t),i++}},destroy:function(){this.element&&ue(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},fe(pe,{INPUT_START:Re,INPUT_MOVE:De,INPUT_END:Oe,INPUT_CANCEL:Me,STATE_POSSIBLE:dt,STATE_BEGAN:ut,STATE_CHANGED:ht,STATE_ENDED:ft,STATE_RECOGNIZED:mt,STATE_CANCELLED:gt,STATE_FAILED:32,DIRECTION_NONE:Be,DIRECTION_LEFT:xe,DIRECTION_RIGHT:Ie,DIRECTION_UP:je,DIRECTION_DOWN:Ne,DIRECTION_HORIZONTAL:Ue,DIRECTION_VERTICAL:Fe,DIRECTION_ALL:Le,Manager:de,Input:T,TouchAction:Z,TouchInput:q,MouseInput:V,PointerEventInput:W,TouchMouseInput:Y,SingleTouchInput:G,Recognizer:$,AttrRecognizer:ie,Tap:ce,Pan:ne,Swipe:le,Pinch:ae,Rotate:se,Press:re,on:g,off:y,each:p,merge:we,extend:_e,assign:fe,inherit:u,bindFn:h,prefixed:S}),(void 0!==n?n:"undefined"!=typeof self?self:{}).Hammer=pe,(i=function(){return pe}.call(t,o,t,e))!==s&&(e.exports=i)}(window,document)},2131:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__(35),_jquery2=_interopRequireDefault(_jquery),_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(32),_reactDom2=_interopRequireDefault(_reactDom),_hammerjs=__webpack_require__(2129),_hammerjs2=_interopRequireDefault(_hammerjs),_trackEvent=__webpack_require__(601),_trackEvent2=_interopRequireDefault(_trackEvent),_utils=__webpack_require__(71),_StudioApp=__webpack_require__(597),_locale=__webpack_require__(1955),_locale2=_interopRequireDefault(_locale),_CustomMarshalingInterpreter=__webpack_require__(850),_CustomMarshalingInterpreter2=_interopRequireDefault(_CustomMarshalingInterpreter),_GameController=__webpack_require__(1952),_GameController2=_interopRequireDefault(_GameController),_FacingDirection=__webpack_require__(799),_FacingDirection2=_interopRequireDefault(_FacingDirection),_EventType=__webpack_require__(1159),_EventType2=_interopRequireDefault(_EventType),_Utils=__webpack_require__(1272),_dom=__webpack_require__(594),_dom2=_interopRequireDefault(_dom),_MusicController=__webpack_require__(1954),_MusicController2=_interopRequireDefault(_MusicController),_reactRedux=__webpack_require__(53),_AppView=__webpack_require__(944),_AppView2=_interopRequireDefault(_AppView),_CraftVisualizationColumn=__webpack_require__(2740),_CraftVisualizationColumn2=_interopRequireDefault(_CraftVisualizationColumn),_redux=__webpack_require__(237),_Sounds=__webpack_require__(764),_Sounds2=_interopRequireDefault(_Sounds),_constants=__webpack_require__(216),_thumbnail=__webpack_require__(1158),_progressRedux=__webpack_require__(498),MEDIA_URL="/blockly/media/craft/",ArrowIds={LEFT:"leftButton",UP:"upButton",RIGHT:"rightButton",DOWN:"downButton"},interfaceImages={DEFAULT:[MEDIA_URL+"Sliced_Parts/MC_Loading_Spinner.gif",MEDIA_URL+"Sliced_Parts/Frame_Large_Plus_Logo.png",MEDIA_URL+"Sliced_Parts/Pop_Up_Slice.png",MEDIA_URL+"Sliced_Parts/X_Button.png",MEDIA_URL+"Sliced_Parts/Button_Grey_Slice.png",MEDIA_URL+"Sliced_Parts/Run_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Run_Arrow_Icon_Smaller.png",MEDIA_URL+"Sliced_Parts/Run_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Reset_Arrow_Icon.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Callout_Tail.png"],1:[MEDIA_URL+"Sliced_Parts/Steve_Character_Select.png",MEDIA_URL+"Sliced_Parts/Alex_Character_Select.png",MEDIA_URL+"Sliced_Parts/Agent_Fail.png",MEDIA_URL+"Sliced_Parts/Agent_Neutral.png",MEDIA_URL+"Sliced_Parts/Agent_Success.png"]},MUSIC_METADATA=[{volume:1,hasOgg:!0,name:"vignette1"},{volume:1,hasOgg:!0,name:"vignette2-quiet"},{volume:1,hasOgg:!0,name:"vignette3"},{volume:1,hasOgg:!0,name:"vignette4-intro"},{volume:1,hasOgg:!0,name:"vignette5-shortpiano"},{volume:1,hasOgg:!0,name:"vignette7-funky-chirps-short"},{volume:1,hasOgg:!0,name:"vignette8-free-play"},{volume:1,hasOgg:!0,name:"nether2"}],CHARACTER_STEVE="Steve",CHARACTER_ALEX="Alex",DEFAULT_CHARACTER=CHARACTER_STEVE,directionToFacing={upButton:_FacingDirection2.default.North,downButton:_FacingDirection2.default.South,leftButton:_FacingDirection2.default.West,rightButton:_FacingDirection2.default.East},Craft=function(){function Craft(){_classCallCheck(this,Craft)}return Craft.init=function(e){1===e.level.puzzle_number&&1===e.level.stage_total&&(e.level.puzzle_number=999),e.level.isTestLevel&&(e.level.customSlowMotion=.1),e.level.disableFinalStageMessage=!0,e.showInstructionsInTopPane=!0;var t=function(){return document.documentMode}();t&&(0,_jquery2.default)("body").addClass("ieVersion"+t),e.level.isAgentLevel&&(0,_jquery2.default)("body").addClass("minecraft-agent");var o=document.body;o.className=o.className+" minecraft",e.level.afterVideoBeforeInstructionsFn=function(t){Craft.beginBackgroundMusic(),e.level.showPopupOnLoad?"playerSelection"===e.level.showPopupOnLoad&&Craft.showPlayerSelectionPopup(function(o){(0,_trackEvent2.default)("Minecraft","ChoseCharacter",o),Craft.clearPlayerState(),(0,_utils.trySetLocalStorage)("craftSelectedPlayer",o),Craft.initializeAppLevel(e.level),t()}):t()},Craft.initialConfig=e,(0,_StudioApp.singleton)().reset=Craft.reset.bind(Craft),(0,_StudioApp.singleton)().runButtonClick=Craft.runButtonClick.bind(Craft),(0,_StudioApp.singleton)().setCheckForEmptyBlocks(!0),Craft.level=e.level,Craft.skin=e.skin;var i=[];Craft.level.songs&&MUSIC_METADATA&&(i=MUSIC_METADATA.filter(function(e){return-1!==Craft.level.songs.indexOf(e.name)})),Craft.musicController=new _MusicController2.default(_Sounds2.default.getSingleton(),function(t){return e.skin.assetUrl("music/"+t)},i,i.length>1?7500:null),e.skin.staticAvatar=MEDIA_URL+"Sliced_Parts/Agent_Neutral.png",e.skin.smallStaticAvatar=MEDIA_URL+"Sliced_Parts/Agent_Neutral.png",e.skin.failureAvatar=MEDIA_URL+"Sliced_Parts/Agent_Fail.png",e.skin.winAvatar=MEDIA_URL+"Sliced_Parts/Agent_Success.png";var n=function(){(0,_StudioApp.singleton)().init(Object.assign({},e,{forceInsertTopBlock:"when_run",appStrings:{generatedCodeDescription:_locale2.default.generatedCodeDescription()},loadAudio:function(){},afterInject:function(){var t;e.level.showMovementBanner&&(0,_StudioApp.singleton)().displayWorkspaceAlert("warning",_react2.default.createElement("div",null,_locale2.default.useArrowKeys()));var o=parseFloat((location.search.split("customSlowMotion=")[1]||"").split("&")[0]);if(Craft.gameController=new _GameController2.default({Phaser:window.Phaser,containerId:"phaser-game",assetRoot:Craft.skin.assetUrl(""),audioPlayer:{register:(0,_StudioApp.singleton)().registerAudio.bind((0,_StudioApp.singleton)()),play:(0,_StudioApp.singleton)().playAudio.bind((0,_StudioApp.singleton)())},debug:!1,customSlowMotion:e.level.isTestLevel?.5:o,earlyLoadAssetPacks:Craft.earlyLoadAssetsForLevel(e.level.puzzle_number),afterAssetsLoaded:function(){window.addEventListener("displayHintPath",function(e){Craft.gameController.levelView.drawHintPath(e.detail)}),window.addEventListener("craftCollectibleCollected",function(e){"diamondMiniblock"===e.blockType&&Craft.setSessionDiamondCollected()}),Craft.musicController.preload()},earlyLoadNiceToHaveAssetPacks:Craft.niceToHaveAssetsForLevel(e.level.puzzle_number)}),e.level.showPopupOnLoad||Craft.initializeAppLevel(e.level),(0,_StudioApp.singleton)().hideSource){document.getElementById("visualizationColumn").style.width=this.nativeVizWidth+"px"}for(var i in ArrowIds)_dom2.default.addMouseUpTouchEvent(document.getElementById(ArrowIds[i]),function(e){return function(){Craft.onArrowButtonUp(ArrowIds[e])}}(i)),_dom2.default.addMouseDownTouchEvent(document.getElementById(ArrowIds[i]),function(e){return function(t){Craft.onArrowButtonDown(t,ArrowIds[e])}}(i));_dom2.default.addMouseUpTouchEvent(document,Craft.onDocumentMouseUp,!1),(0,_jquery2.default)("#soft-buttons").removeClass("soft-buttons-none").addClass("soft-buttons-4"),(0,_jquery2.default)(".arrow").prop("disabled",!1);var n=document.getElementById("resetButton");_dom2.default.addClickTouchEvent(n,Craft.resetButtonClick);var a=document.getElementById("phaser-game"),r=(t={},_defineProperty(t,_hammerjs2.default.DIRECTION_LEFT,"leftButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_RIGHT,"rightButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_UP,"upButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_DOWN,"downButton"),t),s=function(e){r[e.direction]&&Craft.gameController.codeOrgAPI.arrowDown(directionToFacing[r[e.direction]]),e.preventDefault()},l=function(e){r[e.direction]&&Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[r[e.direction]]),e.preventDefault()},c=new _hammerjs2.default.Manager(a);c.add(new _hammerjs2.default.Pan({direction:_hammerjs2.default.DIRECTION_ALL})),c.add(new _hammerjs2.default.Press({time:150})),c.add(new _hammerjs2.default.Tap),c.on("pan",s),c.on("panend pancancel",l),c.on("press",function(){return Craft.gameController.codeOrgAPI.clickDown(function(){})}),c.on("tap",function(){Craft.gameController.codeOrgAPI.clickDown(function(){}),Craft.gameController.codeOrgAPI.clickUp(function(){})}),c.on("pressup",function(){return Craft.gameController.codeOrgAPI.clickUp(function(){})})},twitter:{text:"Share on Twitter",hashtag:"Craft"}}));var t=[];t=t.concat(interfaceImages.DEFAULT),e.level.puzzle_number&&interfaceImages[e.level.puzzle_number]&&(t=t.concat(interfaceImages[e.level.puzzle_number])),t.forEach(function(e){(new Image).src=e});var o=(0,_jquery2.default)(".mc-share-button");o.length&&_dom2.default.addClickTouchEvent(o[0],function(){Craft.reportResult(!0)})};(0,_StudioApp.singleton)().setPageConstants(e,{isMinecraft:!0,hideRunButton:"agentSpawn"===e.level.specialLevelType}),_reactDom2.default.render(_react2.default.createElement(_reactRedux.Provider,{store:(0,_redux.getStore)()},_react2.default.createElement(_AppView2.default,{visualizationColumn:_react2.default.createElement(_CraftVisualizationColumn2.default,{showFinishButton:!e.level.isProjectLevel}),onMount:n})),document.getElementById(e.containerId))},Craft.beginBackgroundMusic=function(){_Sounds2.default.getSingleton().whenAudioUnlocked(function(){var e=Craft.level.songs&&Craft.level.songs.length>1,t=e?Craft.level.songs[0]:null;Craft.musicController.play(t)})},Craft.onArrowButtonDown=function(e,t){Craft.gameController.codeOrgAPI.arrowDown(directionToFacing[t]),e.preventDefault()},Craft.onArrowButtonUp=function(e){Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[e])},Craft.onDocumentMouseUp=function(){if(Craft.phaserLoaded()&&Craft.levelInitialized())for(var e in directionToFacing)Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[e])},Craft.characterAssetPackName=function(e){return"player"+e},Craft.getCurrentCharacter=function(){return window.localStorage.getItem("craftSelectedPlayer")||DEFAULT_CHARACTER},Craft.getSessionDiamondCollectedLevels=function(){return JSON.parse((0,_utils.tryGetLocalStorage)("craftSessionDiamondCollectedLevels","[]"))||[]},Craft.setSessionDiamondCollected=function(){var e=Craft.getSessionDiamondCollectedLevels();return!e.includes(Craft.initialConfig.serverLevelId)&&(e.push(Craft.initialConfig.serverLevelId),(0,_utils.trySetLocalStorage)("craftSessionDiamondCollectedLevels",JSON.stringify(e)),!0)},Craft.showPlayerSelectionPopup=function(e){var t=DEFAULT_CHARACTER,o=document.createElement("div");o.innerHTML=__webpack_require__(2741)({image:(0,_StudioApp.singleton)().assetUrl()});var i=(0,_StudioApp.singleton)().createModalDialog({contentDiv:o,defaultBtnSelector:"#choose-steve",onHidden:function(){e(t)},id:"craft-popup-player-selection"});_dom2.default.addClickTouchEvent((0,_jquery2.default)("#close-character-select")[0],function(){i.hide()}),_dom2.default.addClickTouchEvent((0,_jquery2.default)("#choose-steve")[0],function(){t=CHARACTER_STEVE,(0,_trackEvent2.default)("MinecraftAgent","ClickedCharacter",t),i.hide()}),_dom2.default.addClickTouchEvent((0,_jquery2.default)("#choose-alex")[0],function(){t=CHARACTER_ALEX,(0,_trackEvent2.default)("MinecraftAgent","ClickedCharacter",t),i.hide()}),i.show()},Craft.clearPlayerState=function(){window.localStorage.removeItem("craftSelectedPlayer")},Craft.initializeAppLevel=function initializeAppLevel(levelConfig){(0,_Utils.convertActionPlaneEntitiesToConfig)(levelConfig);for(var fluffPlane=[],i=0;i<(levelConfig.gridWidth||10)*(levelConfig.gridHeight||10);i++)fluffPlane.push("");var levelAssetPacks={beforeLoad:Craft.minAssetsForLevelWithCharacter(levelConfig.puzzle_number),afterLoad:Craft.afterLoadAssetsForLevel(levelConfig.puzzle_number)};Craft.gameController.loadLevel({isDaytime:levelConfig.isDaytime,groundPlane:levelConfig.groundPlane,groundDecorationPlane:levelConfig.groundDecorationPlane,actionPlane:levelConfig.actionPlane,fluffPlane:fluffPlane,entities:levelConfig.entities,useAgent:!!levelConfig.agentStartPosition,usePlayer:!!levelConfig.playerStartPosition,playerStartPosition:levelConfig.playerStartPosition,playerStartDirection:levelConfig.playerStartDirection,agentStartPosition:levelConfig.agentStartPosition,agentStartDirection:levelConfig.agentStartDirection,playerName:Craft.getCurrentCharacter(),assetPacks:levelAssetPacks,specialLevelType:levelConfig.specialLevelType,isAgentLevel:levelConfig.isAgentLevel,gridDimensions:levelConfig.gridWidth&&levelConfig.gridHeight?[levelConfig.gridWidth,levelConfig.gridHeight]:null,levelVerificationTimeout:levelConfig.levelVerificationTimeout,verificationFunction:eval("["+levelConfig.verificationFunction+"]")[0],failureCheckFunction:eval("["+levelConfig.failureCheckFunction+"]")[0],timeoutResult:eval("["+(levelConfig.timeoutVerificationFunction||"function() { return false; }")+"]")[0]})},Craft.minAssetsForLevelWithCharacter=function(e){return Craft.minAssetsForLevelNumber(e).concat([Craft.characterAssetPackName(Craft.getCurrentCharacter())])},Craft.minAssetsForLevelNumber=function(e){return["heroAllAssetsMinusPlayer","playerAgent"]},Craft.afterLoadAssetsForLevel=function(e){return["heroAllAssetsMinusPlayer","playerAgent"]},Craft.earlyLoadAssetsForLevel=function(e){return Craft.minAssetsForLevelWithCharacter(e)},Craft.niceToHaveAssetsForLevel=function(e){switch(e){case 1:return["playerSteve","playerAlex"];default:return["heroAllAssetsMinusPlayer"]}},Craft.reset=function(e){e||((0,_thumbnail.captureThumbnailFromCanvas)((0,_jquery2.default)("#minecraft-frame canvas")[0]),Craft.gameController.codeOrgAPI.resetAttempt())},Craft.phaserLoaded=function(){return Craft.gameController&&Craft.gameController.game&&Craft.gameController.game.load&&!Craft.gameController.game.load.isLoading},Craft.levelInitialized=function(){return Craft.gameController&&Craft.gameController.levelModel},Craft.resetButtonClick=function(){(0,_jquery2.default)(".arrow").prop("disabled",!1)},Craft.isPreAnimationFailure=function(e){switch(e){case _constants.TestResults.QUESTION_MARKS_IN_NUMBER_FIELD:case _constants.TestResults.EMPTY_FUNCTIONAL_BLOCK:case _constants.TestResults.EXTRA_TOP_BLOCKS_FAIL:case _constants.TestResults.EXAMPLE_FAILED:case _constants.TestResults.EMPTY_BLOCK_FAIL:case _constants.TestResults.EMPTY_FUNCTION_NAME:return!0;default:return!1}},Craft.runButtonClick=function(){if(Craft.phaserLoaded()&&((0,_StudioApp.singleton)().toggleRunReset("reset"),Blockly.mainBlockSpace.traceOn(!0),(0,_StudioApp.singleton)().attempts++,Craft.executeUserCode(),Craft.level.freePlay&&!(0,_StudioApp.singleton)().hideSource)){var e=(0,_jquery2.default)("#right-button-cell");if(e.length&&!e.hasClass("right-button-cell-enabled")){e.addClass("right-button-cell-enabled"),(0,_StudioApp.singleton)().onResize();var t=document.createEvent("Event");t.initEvent("finishButtonShown",!0,!0),document.dispatchEvent(t)}}},Craft.executeUserCode=function(){if(Craft.initialConfig.level.edit_blocks)return void Craft.reportResult(!0);var e=(0,_StudioApp.singleton)().getTestResults(!1);if(Craft.isPreAnimationFailure(e))return void Craft.reportResult(!1);(0,_StudioApp.singleton)().playAudio("start"),Blockly.mainBlockSpace.traceOn(!0);var t=Craft.gameController.codeOrgAPI;t.startCommandCollection(),t.registerEventCallback(null,function(e){e.eventType===_EventType2.default.WhenUsed&&"sheep"===e.targetType&&t.drop(null,"wool",e.targetIdentifier),e.eventType===_EventType2.default.WhenTouched&&"creeper"===e.targetType&&(t.flashEntity(null,e.targetIdentifier),t.explodeEntity(null,e.targetIdentifier))});var o="",i=Blockly.mainBlockSpace.getTopBlocks(!0);(0,_StudioApp.singleton)().initializationBlocks&&(i=(0,_StudioApp.singleton)().initializationBlocks.concat(i)),o=Blockly.Generator.blocksToCode("JavaScript",i),_CustomMarshalingInterpreter2.default.evalWith(o,{moveForward:function(e){t.moveForward((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},moveBackward:function(e){t.moveBackward((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},turnLeft:function(e){t.turnLeft((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},turnRight:function(e){t.turnRight((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},destroyBlock:function(e){t.destroyBlock((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},whilePathAhead:function(e,o){t.whilePathAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"","PlayerAgent",o)},whileBlockAhead:function(e,o,i){t.whilePathAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),o,"PlayerAgent",i)},ifLavaAhead:function(e,o){t.ifBlockAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),o),"lava","PlayerAgent",e)},ifBlockAhead:function(e,o,i){t.ifBlockAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),e,"PlayerAgent",o)},placeBlock:function(e,o){t.placeBlock((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),o),e,"PlayerAgent")},placeDirection:function(e,o,i){t.placeDirection((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),e,"PlayerAgent",o)},moveDirection:function(e,o,i){var n={up:_FacingDirection2.default.North,down:_FacingDirection2.default.South,left:_FacingDirection2.default.West,right:_FacingDirection2.default.East};t.moveDirection((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),n[e],o)}}),Craft.gameController.codeOrgAPI.startAttempt(function(e){Craft.level.freePlay||Craft.reportResult(e)})},Craft.getTestResultFrom=function(e,t){return t===_constants.TestResults.LEVEL_INCOMPLETE_FAIL?_constants.TestResults.APP_SPECIFIC_FAIL:Craft.initialConfig.level.freePlay?_constants.TestResults.FREE_PLAY:t},Craft.reportResult=function(e){var t=(0,_StudioApp.singleton)().getTestResults(e),o=Craft.getTestResultFrom(e,t),i=Craft.initialConfig.level.freePlay?Craft.gameController.getScreenshot():null,n=i?encodeURIComponent(i.split(",")[1]):null,a=void 0;if(o===_constants.TestResults.APP_SPECIFIC_FAIL)a=_locale2.default.agentGenericFailureMessage();else if(o===_constants.TestResults.TOO_FEW_BLOCKS_FAIL)a=_locale2.default.agentTooFewBlocksFailureMessage();else if(o===_constants.TestResults.ALL_PASS){var r=Craft.getSessionDiamondCollectedLevels();r.includes(Craft.initialConfig.serverLevelId)&&(a=_locale2.default.agentDiamondPathCongrats({count:r.length}))}(0,_StudioApp.singleton)().report({app:"craft",level:Craft.initialConfig.level.id,result:!!Craft.initialConfig.level.freePlay||e,testResult:o,image:n,program:encodeURIComponent(Blockly.Xml.domToText(Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace))),onComplete:function(e){var t=Craft.initialConfig.level.freePlay;t&&e.level_source&&(0,_utils.trySetLocalStorage)("craftHeroShareLink",e.level_source);var n=(0,_redux.getStore)().getState().progress.signInState===_progressRedux.SignInState.SignedIn;(0,_StudioApp.singleton)().displayFeedback({feedbackType:o,response:e,level:Craft.initialConfig.level,defaultToContinue:Craft.shouldDefaultToContinue(o),message:a,appStrings:{reinfFeedbackMsg:_locale2.default.reinfFeedbackMsg(),nextLevelMsg:_locale2.default.nextLevelMsg({puzzleNumber:Craft.initialConfig.level.puzzle_number}),tooManyBlocksFailMsgFunction:_locale2.default.tooManyBlocksFail,generatedCodeDescription:_locale2.default.generatedCodeDescription()},feedbackImage:i,showingSharing:t,saveToProjectGallery:!0,disableSaveToGallery:!n})}})},Craft.shouldDefaultToContinue=function(e){var t=e===_constants.TestResults.FREE_PLAY;return e>_constants.TestResults.APP_SPECIFIC_ACCEPTABLE_FAIL&&!t},Craft}();exports.default=Craft,module.exports=exports.default},2151:function(e,t,o){"use strict";function i(e){e.preloadAssets=!0,e.sortDrawOrder=!0,e.hideIconInClearPuzzle=!0,e.defaultBackground="endor",e.projectileFrames=10,e.itemFrames=10,e.instructions2ImageSubstitutions={pufferpig:e.assetUrl("instructions_pufferpig.png"),mynock:e.assetUrl("instructions_mynock.png"),rebelpilot:e.assetUrl("instructions_rebelpilot.png"),stormtrooper:e.assetUrl("instructions_stormtrooper.png"),mousedroid:e.assetUrl("instructions_mousedroid.png"),tauntaun:e.assetUrl("instructions_tauntaun.png"),probot:e.assetUrl("instructions_probot.png")},e.ProjectileClassNames=[],e.ItemClassNames=["pufferpig","stormtrooper","tauntaun","mynock","probot","mousedroid","rebelpilot"],e.AutohandlerTouchItems={whenTouchPufferPig:"pufferpig",whenTouchStormtrooper:"stormtrooper",whenTouchTauntaun:"tauntaun",whenTouchMynock:"mynock",whenTouchProbot:"probot",whenTouchMouseDroid:"mousedroid",whenTouchRebelPilot:"rebelpilot",whenGetPufferPig:"pufferpig",whenGetStormtrooper:"stormtrooper",whenGetTauntaun:"tauntaun",whenGetMynock:"mynock",whenGetProbot:"probot",whenGetMouseDroid:"mousedroid",whenGetRebelPilot:"rebelpilot"},e.AutohandlerGetAllItems={whenGetAllPufferPigs:"pufferpig",whenGetAllStormtroopers:"stormtrooper",whenGetAllTauntauns:"tauntaun",whenGetAllMynocks:"mynock",whenGetAllProbots:"probot",whenGetAllMouseDroids:"mousedroid",whenGetAllRebelPilots:"rebelpilot"},e.specialItemProperties={pufferpig:{frames:12,width:100,height:100,scale:1,renderOffset:{x:0,y:-15},activity:"roam",speed:a.SpriteSpeed.VERY_SLOW,spritesCounterclockwise:!0},stormtrooper:{frames:12,width:100,height:100,scale:1.1,renderOffset:{x:0,y:-15},activity:"chase",speed:a.SpriteSpeed.VERY_SLOW,spritesCounterclockwise:!0},tauntaun:{frames:15,width:100,height:100,scale:1.6,renderOffset:{x:0,y:20},activity:"roam",speed:a.SpriteSpeed.SLOW,spritesCounterclockwise:!0},mynock:{frames:8,width:100,height:100,scale:.9,renderOffset:{x:0,y:-20},activity:"roam",speed:a.SpriteSpeed.SLOW,spritesCounterclockwise:!0},probot:{frames:12,width:100,height:100,scale:1.2,renderOffset:{x:0,y:-10},activity:"chase",speed:a.SpriteSpeed.LITTLE_SLOW,spritesCounterclockwise:!0},mousedroid:{frames:1,width:100,height:100,scale:.5,renderOffset:{x:0,y:-20},activity:"flee",speed:a.SpriteSpeed.LITTLE_SLOW,spritesCounterclockwise:!0},rebelpilot:{frames:13,width:100,height:100,scale:1,renderOffset:{x:0,y:-20},activity:"flee",speed:a.SpriteSpeed.SLOW,spritesCounterclockwise:!0}},e.customObstacleZones={endor:{},hoth:{},starship:{}},e.customObstacleZones.endor.grid=e.customObstacleZones.hoth.grid=e.customObstacleZones.starship.grid=function(){for(var e=[],t=0;t<4;t++)for(var o=0;o<4;o++){var i={minX:50+100*o+5,maxX:50+100*o+49-5,minY:50+100*t+15,maxY:50+100*t+49-5};e.push(i)}return e}(),e.customObstacleZones.endor.blobs=[{minX:346,maxX:413,minY:261,maxY:344},{minX:318,maxX:404,minY:342,maxY:397},{minX:308,maxX:348,minY:72,maxY:110},{minX:264,maxX:348,minY:112,maxY:197},{minX:96,maxX:149,minY:289,maxY:349},{minX:96,maxX:199,minY:238,maxY:288},{minX:83,maxX:125,minY:125,maxY:147},{minX:58,maxX:99,minY:72,maxY:91},{minX:57,maxX:149,minY:92,maxY:123}],e.customObstacleZones.endor.horizontal=[{minX:51,maxX:299,minY:269,maxY:293},{minX:150,maxX:348,minY:168,maxY:189},{minX:53,maxX:97,minY:159,maxY:199},{minX:50,maxX:198,minY:71,maxY:94},{minX:255,maxX:345,minY:71,maxY:94}],e.customObstacleZones.endor.circle=[{minX:251,maxX:317,minY:332,maxY:348},{minX:83,maxX:198,minY:332,maxY:348},{minX:250,maxX:317,minY:77,maxY:93},{minX:313,maxX:337,minY:77,maxY:348},{minX:163,maxX:236,minY:202,maxY:244},{minX:83,maxX:200,minY:77,maxY:93},{minX:62,maxX:85,minY:77,maxY:348}],e.customObstacleZones.hoth.blobs=[{minX:100,maxX:142,minY:283,maxY:342},{minX:100,maxX:187,minY:226,maxY:281},{minX:356,maxX:394,minY:264,maxY:311},{minX:311,maxX:393,minY:313,maxY:388},{minX:310,maxX:344,minY:61,maxY:106},{minX:258,maxX:344,minY:108,maxY:192},{minX:117,maxX:146,minY:120,maxY:132},{minX:57,maxX:117,minY:70,maxY:132}],e.customObstacleZones.hoth.horizontal=[{minX:54,maxX:299,minY:268,maxY:294},{minX:150,maxX:350,minY:171,maxY:198},{minX:53,maxX:99,minY:171,maxY:198},{minX:252,maxX:350,minY:66,maxY:92},{minX:54,maxX:195,minY:66,maxY:92}],e.customObstacleZones.hoth.circle=[{minX:250,maxX:298,minY:312,maxY:342},{minX:300,maxX:346,minY:65,maxY:342},{minX:252,maxX:302,minY:65,maxY:100},{minX:99,maxX:192,minY:311,maxY:342},{minX:101,maxX:196,minY:65,maxY:91},{minX:50,maxX:100,minY:65,maxY:342},{minX:163,maxX:242,minY:188,maxY:238}],e.customObstacleZones.starship.blobs=[{minX:301,maxX:344,minY:58,maxY:120},{minX:353,maxX:405,minY:260,maxY:308},{minX:306,maxX:405,minY:310,maxY:393},{minX:101,maxX:144,minY:300,maxY:350},{minX:101,maxX:197,minY:208,maxY:299},{minX:261,maxX:344,minY:120,maxY:192},{minX:55,maxX:133,minY:77,maxY:141}],e.customObstacleZones.starship.horizontal=[{minX:52,maxX:298,minY:267,maxY:300},{minX:151,maxX:351,minY:167,maxY:198},{minX:49,maxX:99,minY:165,maxY:201},{minX:51,maxX:199,minY:66,maxY:102},{minX:251,maxX:351,minY:68,maxY:104}],e.customObstacleZones.starship.circle=[{minX:251,maxX:316,minY:315,maxY:351},{minX:153,maxX:242,minY:165,maxY:251},{minX:252,maxX:314,minY:66,maxY:100},{minX:310,maxX:339,minY:66,maxY:351},{minX:80,maxX:200,minY:316,maxY:351},{minX:82,maxX:200,minY:66,maxY:100},{minX:63,maxX:86,minY:66,maxY:351}],e.explosion=e.assetUrl("vanish.png"),e.explosionFrames=17,e.animatedGoal=e.assetUrl("goal_idle.png"),e.goalSpriteWidth=100,e.goalSpriteHeight=100,e.animatedGoalFrames=16,e.timePerGoalAnimationFrame=100,e.finishCollideDistanceScaling=.8,e.goalCollisionRectWidth=50,e.goalCollisionRectHeight=75,e.fadeOutGoal=!0,e.goalSuccess=null,e.goalRenderOffsetX=-25,e.goalRenderOffsetY=-45,e.projectileSpriteWidth=70,e.projectileSpriteHeight=70,e.itemCollisionRectWidth=50,e.itemCollisionRectHeight=50,e.spriteCollisionRectWidth=50,e.spriteCollisionRectHeight=50,e.wallCollisionRectOffsetX=0,e.wallCollisionRectOffsetY=24,e.wallCollisionRectWidth=30,e.wallCollisionRectHeight=20,e.gridSpriteRenderOffsetX=-30,e.gridSpriteRenderOffsetY=-40,e.avatarList=["r2-d2","c-3po"],e.avatarList.forEach(function(t){e[t]={sprite:e.assetUrl("avatar_"+t+".png"),walk:e.assetUrl("walk_"+t+".png"),dropdownThumbnail:e.assetUrl("avatar_"+t+"_thumb.png"),frameCounts:{normal:"r2-d2"===t?14:16,turns:8,emotions:0,walk:"r2-d2"===t?14:8},animations:{turns:8},animationFrameDuration:3}}),e["r2-d2"].movementAudio=[{begin:"r2-d2_move1_start",loop:"r2-d2_move1_loop",end:"r2-d2_move1_end",volume:2.2},{begin:"r2-d2_move2_start",loop:"r2-d2_move2_loop",end:"r2-d2_move2_end",volume:2.2},{begin:"r2-d2_move3_start",loop:"r2-d2_move3_loop",end:"r2-d2_move3_end",volume:2.2}],e["c-3po"].movementAudio=[{loop:"c-3po_move_loop",end:"c-3po_move_end",volume:.6}],e.preventProjectileLoop=function(e){return""===e},e.preventItemLoop=function(e){return""===e},e.winAvatar=null,e.failureAvatar=null,e.pufferpig=e.assetUrl("walk_pufferpig.png"),e.stormtrooper=e.assetUrl("walk_stormtrooper.png"),e.tauntaun=e.assetUrl("walk_tauntaun.png"),e.mynock=e.assetUrl("walk_mynock.png"),e.probot=e.assetUrl("walk_probot.png"),e.mousedroid=e.assetUrl("walk_mousedroid.png"),e.rebelpilot=e.assetUrl("walk_rebelpilot.png"),e.endor={background:e.assetUrl("background_endor.jpg"),tiles:e.assetUrl("tiles_endor.png"),jumboTiles:e.assetUrl("jumbotiles_endor.png"),jumboTilesAddOffset:-5,jumboTilesSize:60,jumboTilesRows:4,jumboTilesCols:4,clouds:[e.assetUrl("cloud_light.png"),e.assetUrl("cloud_light2.png")]},e.hoth={background:e.assetUrl("background_hoth.jpg"),tiles:e.assetUrl("tiles_hoth.png"),jumboTiles:e.assetUrl("jumbotiles_hoth.png"),jumboTilesAddOffset:-5,jumboTilesSize:60,jumboTilesRows:4,jumboTilesCols:4,clouds:[e.assetUrl("cloud_dark.png"),e.assetUrl("cloud_dark2.png")]},e.starship={background:e.assetUrl("background_starship.jpg"),tiles:e.assetUrl("tiles_starship.png"),jumboTiles:e.assetUrl("jumbotiles_starship.png"),jumboTilesAddOffset:-5,jumboTilesSize:60,jumboTilesRows:4,jumboTilesCols:4},e.enlargeWallTiles={minCol:0,maxCol:3,minRow:3,maxRow:5},e.getMap=function(e,t){return"hoth"!==e||"circle"!==t&&"horizontal"!==t?t:t+"_nonjumbo"},e.blank=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],e.circle_nonjumbo=[[0,0,0,0,0,0,0,0],[0,17,2,3,0,68,69,0],[0,4,0,0,0,0,3,0],[0,20,0,289,289,0,5,0],[0,2,0,289,289,0,21,0],[0,3,0,0,0,0,2,0],[0,36,37,2,0,52,53,0],[0,0,0,0,0,0,0,0]],e.circle=[[0,0,0,0,0,0,0,0],[0,512,531,531,0,531,513,0],[0,530,0,0,0,0,530,0],[0,530,0,289,289,0,530,0],[0,530,0,289,289,0,530,0],[0,530,0,0,0,0,530,0],[0,514,531,531,0,531,515,0],[0,0,0,0,0,0,0,0]],e.horizontal_nonjumbo=[[0,0,0,0,0,0,0,0],[0,2,3,32,0,36,37,0],[0,0,0,0,0,0,0,0],[0,16,0,52,53,32,35,0],[0,0,0,0,0,0,0,0],[0,3,2,34,32,33,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],e.horizontal=[[0,0,0,0,0,0,0,0],[0,531,531,531,0,531,531,0],[0,0,0,0,0,0,0,0],[0,48,0,531,531,531,531,0],[0,0,0,0,0,0,0,0],[0,531,531,531,531,531,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],e.grid=[[0,0,0,0,0,0,0,0],[0,33,0,16,0,32,0,3],[0,0,0,0,0,0,0,0],[0,2,0,17,0,33,0,2],[0,0,0,0,0,0,0,0],[0,3,0,32,0,34,0,17],[0,0,0,0,0,0,0,0],[0,16,0,33,0,35,0,16]],e.blobs=[[0,0,0,0,0,0,0,0],[0,259,259,0,0,0,34,0],[0,259,259,0,0,272,272,0],[0,0,0,0,0,272,272,0],[0,0,306,306,0,0,0,0],[0,0,306,306,0,0,0,35],[0,0,49,0,0,0,289,289],[0,0,0,0,0,0,289,289]],e.sounds=["R2-D2sound1","R2-D2sound2","R2-D2sound3","R2-D2sound4","R2-D2sound5","R2-D2sound6","R2-D2sound7","R2-D2sound8","R2-D2sound9","C-3POsound1","C-3POsound2","C-3POsound3","C-3POsound4","PufferPigSound1","PufferPigSound2","PufferPigSound3","PufferPigSound4","TauntaunSound1","TauntaunSound2","TauntaunSound3","TauntaunSound4","MynockSound1","MynockSound2","MynockSound3","ProbotSound1","ProbotSound2","ProbotSound3","MouseDroidSound1","MouseDroidSound2","MouseDroidSound3","alert1","alert2","alert3","alert4","applause"],e.soundGroups={"R2-D2sound":{randomValue:"R2-D2random",minSuffix:1,maxSuffix:9},"C-3POsound":{randomValue:"C-3POrandom",minSuffix:1,maxSuffix:4},PufferPigSound:{randomValue:"PufferPigRandom",minSuffix:1,maxSuffix:4},TauntaunSound:{randomValue:"TauntaunRandom",minSuffix:1,maxSuffix:4},MynockSound:{randomValue:"MynockRandom",minSuffix:1,maxSuffix:3},ProbotSound:{randomValue:"ProbotSoundRandom",minSuffix:1,maxSuffix:3},MouseDroidSound:{randomValue:"MouseDroidSoundRandom",minSuffix:1,maxSuffix:3}},e.soundChoices=[[s.default.playSoundRandom(),a.RANDOM_VALUE],[s.default.playSoundR2D2Random(),"R2-D2random"],[s.default.playSoundR2D2Sound1(),"R2-D2sound1"],[s.default.playSoundR2D2Sound2(),"R2-D2sound2"],[s.default.playSoundR2D2Sound3(),"R2-D2sound3"],[s.default.playSoundR2D2Sound4(),"R2-D2sound4"],[s.default.playSoundR2D2Sound5(),"R2-D2sound5"],[s.default.playSoundR2D2Sound6(),"R2-D2sound6"],[s.default.playSoundR2D2Sound7(),"R2-D2sound7"],[s.default.playSoundR2D2Sound8(),"R2-D2sound8"],[s.default.playSoundR2D2Sound9(),"R2-D2sound9"],[s.default.playSoundC3PORandom(),"C-3POrandom"],[s.default.playSoundC3POSound1(),"C-3POsound1"],[s.default.playSoundC3POSound2(),"C-3POsound2"],[s.default.playSoundC3POSound3(),"C-3POsound3"],[s.default.playSoundC3POSound4(),"C-3POsound4"],[s.default.playSoundPufferPigRandom(),"PufferPigRandom"],[s.default.playSoundPufferPigSound1(),"PufferPigSound1"],[s.default.playSoundPufferPigSound2(),"PufferPigSound2"],[s.default.playSoundPufferPigSound3(),"PufferPigSound3"],[s.default.playSoundPufferPigSound4(),"PufferPigSound4"],[s.default.playSoundTauntaunRandom(),"TauntaunRandom"],[s.default.playSoundTauntaunSound1(),"TauntaunSound1"],[s.default.playSoundTauntaunSound2(),"TauntaunSound2"],[s.default.playSoundTauntaunSound3(),"TauntaunSound3"],[s.default.playSoundTauntaunSound4(),"TauntaunSound4"],[s.default.playSoundMynockRandom(),"MynockRandom"],[s.default.playSoundMynockSound1(),"MynockSound1"],[s.default.playSoundMynockSound2(),"MynockSound2"],[s.default.playSoundMynockSound3(),"MynockSound3"],[s.default.playSoundProbotRandom(),"ProbotRandom"],[s.default.playSoundProbotSound1(),"ProbotSound1"],[s.default.playSoundProbotSound2(),"ProbotSound2"],[s.default.playSoundProbotSound3(),"ProbotSound3"],[s.default.playSoundMouseDroidRandom(),"MouseDroidRandom"],[s.default.playSoundMouseDroidSound1(),"MouseDroidSound1"],[s.default.playSoundMouseDroidSound2(),"MouseDroidSound2"],[s.default.playSoundMouseDroidSound3(),"MouseDroidSound3"],[s.default.playSoundAlert1(),"alert1"],[s.default.playSoundAlert2(),"alert2"],[s.default.playSoundAlert3(),"alert3"],[s.default.playSoundAlert4(),"alert4"],[s.default.playSoundApplause(),"applause"]],e.soundChoicesK1=[],e.soundMetadata=[{name:"start",volume:.2},{name:"win",volume:.2},{name:"failure",volume:.2},{name:"flag",volume:.2},{name:"R2-D2sound1",volume:.2},{name:"R2-D2sound2",volume:.2},{name:"R2-D2sound3",volume:.2},{name:"R2-D2sound4",volume:.2},{name:"R2-D2sound5",volume:.2},{name:"R2-D2sound6",volume:.2},{name:"R2-D2sound7",volume:.2},{name:"R2-D2sound8",volume:.2},{name:"R2-D2sound9",volume:.2},{name:"C-3POsound1",volume:.2},{name:"C-3POsound2",volume:.2},{name:"C-3POsound3",volume:.2},{name:"C-3POsound4",volume:.2},{name:"PufferPigSound1",volume:.2},{name:"PufferPigSound2",volume:.2},{name:"PufferPigSound3",volume:.2},{name:"PufferPigSound4",volume:.2},{name:"TauntaunSound1",volume:.2},{name:"TauntaunSound2",volume:.2},{name:"TauntaunSound3",volume:.2},{name:"TauntaunSound4",volume:.2},{name:"MynockSound1",volume:.2},{name:"MynockSound2",volume:.2},{name:"MynockSound3",volume:.2},{name:"ProbotSound1",volume:.2},{name:"ProbotSound2",volume:.2},{name:"ProbotSound3",volume:.2},{name:"MouseDroidSound1",volume:.2},{name:"MouseDroidSound2",volume:.2},{name:"MouseDroidSound3",volume:.2},{name:"alert1",volume:.2},{name:"alert2",volume:.2},{name:"alert3",volume:.2},{name:"alert4",volume:.2},{name:"applause",volume:.2}],e.musicMetadata=l,e.playFinalGoalSound=!0,e.mapChoices=[[s.default.setMapRandom(),a.RANDOM_VALUE],[s.default.setMapBlank(),"blank"],[s.default.setMapCircle(),"circle"],[s.default.setMapHorizontal(),"horizontal"],[s.default.setMapGrid(),"grid"],[s.default.setMapBlobs(),"blobs"]],e.backgroundChoices=[[s.default.setBackgroundRandom(),a.RANDOM_VALUE],[s.default.setBackgroundEndor(),'"endor"'],[s.default.setBackgroundHoth(),'"hoth"'],[s.default.setBackgroundStarship(),'"starship"']],e.backgroundChoicesK1=[[e.endor.background,'"endor"'],[e.hoth.background,'"hoth"'],[e.starship.background,'"starship"'],[e.randomPurpleIcon,a.RANDOM_VALUE]],e.spriteChoices=[[s.default.setDroidHidden(),a.HIDDEN_VALUE],[s.default.setDroidRandom(),a.RANDOM_VALUE],[s.default.setDroidR2D2(),'"r2-d2"'],[s.default.setDroidC3PO(),'"c-3po"']],e.setSpritePrefix=s.default.setDroid(),e.projectileChoices=[],e.itemChoices=[[s.default.itemStormtrooper(),'"stormtrooper"'],[s.default.itemRebelPilot(),'"rebelpilot"'],[s.default.itemPufferPig(),'"pufferpig"'],[s.default.itemMynock(),'"mynock"'],[s.default.itemMouseDroid(),'"mousedroid"'],[s.default.itemTauntaun(),'"tauntaun"'],[s.default.itemProbot(),'"probot"'],[s.default.itemRandom(),a.RANDOM_VALUE]],e.msgOverrides={ifSprite:s.default.ifDroid,ifSpriteN:s.default.ifDroidN,moveSprite:s.default.moveDroid,moveSpriteN:s.default.moveDroidN,setSpriteN:s.default.setDroidN,stopSprite:s.default.stopDroid,stopSpriteN:s.default.stopDroidN,whenSpriteClicked:s.default.whenDroidClicked,whenSpriteClickedN:s.default.whenDroidClickedN}}function n(e){e.preloadAssets=!0,e.sortDrawOrder=!0,e.gridAlignedMovement=!0,e.gridAlignedExtraPauseSteps=1,e.slowExecutionFactor=10,e.hideIconInClearPuzzle=!0,e.defaultBackground="main",e.projectileFrames=10,e.itemFrames=10,e.instructions2ImageSubstitutions={bb8:e.assetUrl("instructions_bb8.png"),hazard:e.assetUrl("instructions_hazard.png"),scrapmetal1:e.assetUrl("goal1.png"),scrapmetal2:e.assetUrl("goal2.png")},e.blankAvatar=e.assetUrl("blank.png"),e.avatarAllowedScripts=["starwars","starwarsblocks"],e.ProjectileClassNames=[],e.ItemClassNames=["hazard"],e.AutohandlerTouchItems={},e.AutohandlerGetAllItems={},e.specialItemProperties={hazard:{frames:13,animationFrameDuration:6,width:100,height:100,scale:1.3,renderOffset:{x:0,y:-25},activity:a.BEHAVIOR_WATCH_ACTOR,speed:a.SpriteSpeed.VERY_SLOW,isHazard:!0}},e.goal1=e.assetUrl("goal1.png"),e.goal2=e.assetUrl("goal2.png"),e.goalSpriteWidth=50,e.goalSpriteHeight=50,e.animatedGoalFrames=1,e.disableClipRectOnGoals=!0,e.goalEffect="glow",e.timePerGoalAnimationFrame=100,e.goalCollisionRectWidth=50,e.goalCollisionRectHeight=50,e.fadeOutGoal=!0,e.goalSuccess=null,e.goalRenderOffsetX=0,e.goalRenderOffsetY=0,e.projectileSpriteWidth=70,e.projectileSpriteHeight=70,e.itemCollisionRectWidth=50,e.itemCollisionRectHeight=50,e.spriteCollisionRectWidth=50,e.spriteCollisionRectHeight=50,e.wallCollisionRectOffsetX=0,e.wallCollisionRectOffsetY=24,e.wallCollisionRectWidth=30,e.wallCollisionRectHeight=20,e.gridSpriteRenderOffsetX=-20,e.gridSpriteRenderOffsetY=-40,e.avatarList=["bb-8"],e.avatarList.forEach(function(t){e[t]={sprite:e.assetUrl("avatar_"+t+".png"),walk:e.assetUrl("walk_"+t+".png"),dropdownThumbnail:e.assetUrl("avatar_"+t+"_thumb.png"),frameCounts:{normal:21,turns:8,emotions:0,walk:19},drawScale:2,animations:{turns:8},animationFrameDuration:3}}),e["bb-8"].movementAudio=[{begin:"move1",volume:.3},{begin:"move2",volume:.3},{begin:"move3",volume:.3},{begin:"move4",volume:.3}],e.preventProjectileLoop=function(e){return""===e},e.preventItemLoop=function(e){return""===e},e.winAvatar=null,e.hazard=e.assetUrl("hazard_idle.png"),e.main={background:e.assetUrl("background_background1.jpg"),tiles:e.assetUrl("tiles_background1.png"),clouds:[e.assetUrl("cloud_light.png"),e.assetUrl("cloud_light2.png")]},e.enlargeWallTiles={minCol:0,maxCol:3,minRow:3,maxRow:5},e.sounds=["move1","move2","move3","move4"],e.soundChoices=[],e.soundChoicesK1=[],e.musicMetadata=l,e.playFinalGoalSound=!0,e.mapChoices=[],e.backgroundChoices=[],e.backgroundChoicesK1=[],e.spriteChoices=[[s.default.setDroidHidden(),a.HIDDEN_VALUE],[s.default.setDroidRandom(),a.RANDOM_VALUE],[s.default.setDroidBB8(),'"bb-8"']],e.setSpritePrefix=s.default.setDroid(),e.projectileChoices=[],e.itemChoices=[]}Object.defineProperty(t,"__esModule",{value:!0}),t.loadStarWarsEvents=i,t.loadStarWarsGrid=n;var a=o(789),r=o(1706),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=[{name:"song1",volume:.5},{name:"song2",volume:.5},{name:"song3",volume:.5},{name:"song4",volume:.4},{name:"song5",volume:.4},{name:"song6",volume:.5},{name:"song7",volume:.4},{name:"song8",volume:.4},{name:"song9",volume:.4},{name:"song10",volume:.5},{name:"song11",volume:.45},{name:"song12",volume:.4},{name:"song13",volume:.4},{name:"song14",volume:.5},{name:"song15",volume:.55}]},2152:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){var o=i.load(e,t);o.linePatterns={rainbowMenu:e("media/common_images/rainbow-menuicon.png"),ropeMenu:e("media/common_images/rope-menuicon.png"),squigglyMenu:e("media/common_images/squiggly-menuicon.png"),swirlyMenu:e("media/common_images/swirlyline-menuicon.png"),patternDefault:e("media/common_images/defaultline-menuicon.png"),rainbowLine:e("media/common_images/rainbow.png"),ropeLine:e("media/common_images/rope.png"),squigglyLine:e("media/common_images/squiggly.png"),swirlyLine:e("media/common_images/swirlyline.png")};var n={anna:{speedModifier:10,avatarSettings:{width:73,height:100,numHeadings:36,numFrames:10,visible:!0},smoothAnimate:!0,consolidateTurnAndMove:!0,linePatterns:{annaLine:o.assetUrl("annaline.png"),annaLine_2x:o.assetUrl("annaline_2x.png")},lineStylePatternOptions:[[o.assetUrl("annaline-menuicon.png"),"annaLine"]],artistOptions:["anna","elsa"],avatarAllowedScripts:["frozen"],blankAvatar:o.assetUrl("blank.png")},elsa:{speedModifier:10,avatarSettings:{width:73,height:100,numHeadings:18,numFrames:20,visible:!0},smoothAnimate:!0,consolidateTurnAndMove:!0,linePatterns:{elsaLine:o.assetUrl("elsaline.png"),elsaLine_2x:o.assetUrl("elsaline_2x.png")},lineStylePatternOptions:[[o.assetUrl("elsaline-menuicon.png"),"elsaLine"]],artistOptions:["anna","elsa"],avatarAllowedScripts:["frozen"],blankAvatar:o.assetUrl("blank.png")},artist:{lineStylePatternOptions:[[o.linePatterns.rainbowMenu,"rainbowLine"],[o.linePatterns.ropeMenu,"ropeLine"],[o.linePatterns.squigglyMenu,"squigglyLine"],[o.linePatterns.swirlyMenu,"swirlyLine"]]}};o.stickers=function(){var t,o,i=["Alien","Bat","Bird","Cat","Caveboy","Cavegirl","Dinosaur","Dog","Dragon","Ghost","Knight","Monster","Ninja","Octopus","Penguin","Pirate","Princess","Robot","Soccerboy","Soccergirl","Spacebot","Squirrel","Tennisboy","Tennisgirl","Unicorn","Witch","Wizard","Zombie"],n=["Beaver","Bunny","Chicken","Elephant","Giraffe","Goat","Grasshopper","Hippo","Lion","Llama","Monkey","Moose","Mouse","Owl","Peacock","Rocket","Triceratops","Turtle","Zebra"],a={};for(t=0;t<i.length;t++)o=i[t],a[o]=e("media/skins/studio/"+o.toLowerCase()+"_thumb.png");for(t=0;t<n.length;t++)o=n[t],a[o]=e("media/common_images/stickers/"+o.toLowerCase()+".png");return a}();var a=n[o.id];o.speedModifier=1,o.avatarSettings={width:70,height:51,numHeadings:180,numFrames:1,visible:!0};for(var r in a)o[r]=a[r];var s=[[o.linePatterns.patternDefault,"DEFAULT"]];return a&&a.lineStylePatternOptions&&(s=s.concat(a.lineStylePatternOptions)),o.lineStylePatternOptions=s,o}},2709:function(e,t,o){"use strict";var i=o(744),n=o(2127),a={bounce:{nonDisappearingPegmanHittingObstacle:!0,backgrounds:["hardcourt","retro"],balls:["hardcourt","retro"],ballYOffset:10,drawTiles:!0,markerHeight:43,markerWidth:50,blockMsgs:{launchBall:n.launchBall(),launchBallTooltip:n.launchBallTooltip(),paddleCollide:n.whenPaddleCollided(),paddleCollideTooltip:n.whenPaddleCollidedTooltip(),paddleMiss:n.whenBallMissesPaddle(),paddleSpeedRandom:n.setPaddleSpeedRandom(),paddleSpeedVerySlow:n.setPaddleSpeedVerySlow(),paddleSpeedSlow:n.setPaddleSpeedSlow(),paddleSpeedNormal:n.setPaddleSpeedNormal(),paddleSpeedFast:n.setPaddleSpeedFast(),paddleSpeedVeryFast:n.setPaddleSpeedVeryFast(),paddleSpeedTooltip:n.setPaddleSpeedTooltip(),setPaddle:n.setPaddle()},customSounds:{ballstart:{filenames:["ball_start.mp3","ball_start.ogg"]},flag:{filenames:["win_goal.mp3","win_goal.ogg"]},hit:{msg:n.playSoundHit(),filenames:["2_wall_bounce.mp3","2_wall_bounce.ogg"]},wood:{msg:n.playSoundWood(),filenames:["1_paddle_bounce.mp3","1_paddle_bounce.ogg"]},retro:{msg:n.playSoundRetro(),filenames:["2_paddle_bounce.mp3","2_paddle_bounce.ogg"]},slap:{msg:n.playSoundSlap(),filenames:["1_wall_bounce.mp3","1_wall_bounce.ogg"]},rubber:{msg:n.playSoundRubber(),filenames:["wall.mp3","wall.ogg"]},crunch:{msg:n.playSoundCrunch(),filenames:["wall0.mp3","wall0.ogg"]},winpoint:{msg:n.playSoundWinPoint(),filenames:["1_we_win.mp3","1_we_win.ogg"]},winpoint2:{msg:n.playSoundWinPoint2(),filenames:["2_we_win.mp3","2_we_win.ogg"]},losepoint:{msg:n.playSoundLosePoint(),filenames:["1_we_lose.mp3","1_we_lose.ogg"]},losepoint2:{msg:n.playSoundLosePoint2(),filenames:["2_we_lose.mp3","2_we_lose.ogg"]},goal1:{msg:n.playSoundGoal1(),filenames:["1_goal.mp3","1_goal.ogg"]},goal2:{msg:n.playSoundGoal2(),filenames:["2_goal.mp3","2_goal.ogg"]}}},basketball:{drawTiles:!0,goalSuccess:"goal.png",paddle:"hand_1.png",markerHeight:61,markerWidth:54,balls:["hardcourt","retro"],paddles:["hand_1","hand_2","hand_3"],teams:["Atlanta Dream","Atlanta Hawks","Boston Celtics","Brooklyn Nets","Charlotte Hornets","Chicago Bulls","Chicago Sky","Cleveland Cavaliers","Connecticut Sun","Dallas Mavericks","Dallas Wings","Denver Nuggets","Detroit Pistons","Golden State Warriors","Houston Rockets","Indiana Fever","Indiana Pacers","Los Angeles Clippers","Los Angeles Lakers","Los Angeles Sparks","Memphis Grizzlies","Miami Heat","Milwaukee Bucks","Minnesota Lynx","Minnesota Timberwolves","New Orleans Pelicans","New York Knicks","New York Liberty","Oklahoma City Thunder","Orlando Magic","Philadelphia 76ers","Phoenix Mercury","Phoenix Suns","Portland Trail Blazers","Sacramento Kings","San Antonio Spurs","San Antonio Stars","Seattle Storm","Toronto Raptors","Utah Jazz","Washington Mystics","Washington Wizards"],blockMsgs:{launchBall:n.basketballLaunchBall(),launchBallTooltip:n.basketballLaunchBallTooltip(),paddleCollide:n.basketballWhenPaddleCollided(),paddleCollideTooltip:n.whenPaddleCollidedTooltip(),paddleMiss:n.basketballWhenBallMissesPaddle(),paddleSpeedRandom:n.basketballSetPaddleSpeedRandom(),paddleSpeedVerySlow:n.basketballSetPaddleSpeedVerySlow(),paddleSpeedSlow:n.basketballSetPaddleSpeedSlow(),paddleSpeedNormal:n.basketballSetPaddleSpeedNormal(),paddleSpeedFast:n.basketballSetPaddleSpeedFast(),paddleSpeedVeryFast:n.basketballSetPaddleSpeedVeryFast(),paddleSpeedTooltip:n.basketballSetPaddleSpeedTooltip(),setPaddle:n.basketballSetPaddle()},customSounds:{bounce:{msg:n.playSoundBounce(),filenames:["bounce.mp3","bounce.ogg"]},cheer:{msg:n.playSoundCheer(),filenames:["cheer.mp3","cheer.ogg"]},whistle:{msg:n.playSoundWhistle(),filenames:["whistle.mp3","whistle.ogg"]},swish:{msg:n.playSoundSwish(),filenames:["swish.mp3","swish.ogg"]}}},sports:{drawTiles:!0,backgrounds:["basketball","football","hockey","soccer"],balls:["basketball","football","hockey","soccer"],paddles:["hand_1","hand_2","hand_3","hockey_stick","foot"],background:"basketball_background.png",ball:"basketball_ball.png",paddle:"basketball_paddle.png",blockMsgs:{launchBall:n.basketballLaunchBall(),launchBallTooltip:n.basketballLaunchBallTooltip(),paddleCollide:n.whenPlayerCollided(),paddleCollideTooltip:n.whenPlayerCollidedTooltip(),paddleMiss:n.whenBallMissesPlayer(),paddleSpeedRandom:n.setPlayerSpeedRandom(),paddleSpeedVerySlow:n.setPlayerSpeedVerySlow(),paddleSpeedSlow:n.setPlayerSpeedSlow(),paddleSpeedNormal:n.setPlayerSpeedNormal(),paddleSpeedFast:n.setPlayerSpeedFast(),paddleSpeedVeryFast:n.setPlayerSpeedVeryFast(),paddleSpeedTooltip:n.setPlayerSpeedTooltip(),setPaddle:n.setPlayer()},customSounds:{bounce:{msg:n.playSoundBounce(),filenames:["bounce.mp3","bounce.ogg"]},cheer:{msg:n.playSoundCheer(),filenames:["cheer.mp3","cheer.ogg"]},whistle:{msg:n.playSoundWhistle(),filenames:["whistle.mp3","whistle.ogg"]},swish:{msg:n.playSoundSwish(),filenames:["swish.mp3","swish.ogg"]},slapshot:{msg:n.playSoundSlapshot(),filenames:["slapshot.mp3","slapshot.ogg"]},kick:{msg:n.playSoundKick(),filenames:["kick.mp3","kick.ogg"]}}}};t.load=function(e,t){var o=i.load(e,t),n=a[o.id];o.retro={background:o.assetUrl("retro_background.png"),tiles:o.assetUrl("retro_tiles_wall.png"),goalTiles:o.assetUrl("retro_tiles_goal.png"),paddle:o.assetUrl("retro_paddle.png"),ball:o.assetUrl("retro_ball.png")},o.hand_1={paddle:o.assetUrl("hand_1.png")},o.hand_2={paddle:o.assetUrl("hand_2.png")},o.hand_3={paddle:o.assetUrl("hand_3.png")},o.hockey_stick={paddle:o.assetUrl("hockey_paddle.png")},o.foot={paddle:o.assetUrl("soccer_paddle.png")},o.basketball={background:o.assetUrl("basketball_background.png"),ball:o.assetUrl("basketball_ball.png"),paddle:o.hand_1.paddle},o.soccer={background:o.assetUrl("soccer_background.png"),ball:o.assetUrl("soccer_ball.png"),drawTiles:!1,paddle:o.foot.paddle},o.hockey={background:o.assetUrl("hockey_background.png"),ball:o.assetUrl("hockey_ball.png"),drawTiles:!1,paddle:o.hockey_stick.paddle},o.football={background:o.assetUrl("football_background.png"),ball:o.assetUrl("football_ball.png"),drawTiles:!1,paddle:o.foot.paddle,rotateBall:!0},o.tiles=o.assetUrl(n.tiles||"tiles_wall.png"),o.goalTiles=o.assetUrl(n.goalTiles||"tiles_goal.png"),o.goal=o.assetUrl(n.goal||"goal.png"),o.goalSuccess=o.assetUrl(n.goalSuccess||"goal_success.png"),o.flagGoal=o.assetUrl("flag_goal.png"),o.flagGoalSuccess=o.assetUrl("flag_goal_success.png"),o.ball=o.assetUrl(n.ball||"ball.png"),o.paddle=o.assetUrl(n.paddle||"paddle.png"),o.obstacle=o.assetUrl(n.obstacle||"obstacle.png"),o.background=o.assetUrl(n.background||"background.png"),o.nonDisappearingPegmanHittingObstacle=!!n.nonDisappearingPegmanHittingObstacle,o.obstacleScale=n.obstacleScale||1,o.largerObstacleAnimationTiles=o.assetUrl(n.largerObstacleAnimationTiles),o.hittingWallAnimation=o.assetUrl(n.hittingWallAnimation),o.approachingGoalAnimation=o.assetUrl(n.approachingGoalAnimation),o.drawTiles=n.drawTiles,o.backgrounds=n.backgrounds||[],o.balls=n.balls||[],o.paddles=n.paddles||["paddle"],o.teams=n.teams||[],o.teamBackgrounds={},o.teams.forEach(function(e){return o.teamBackgrounds[e]=o.assetUrl("teams/"+e+".png")}),o.blockMsgs=n.blockMsgs,o.customSounds=n.customSounds||{};for(var r in o.customSounds)o.customSounds[r].urls=o.customSounds[r].filenames.map(o.assetUrl);return o.pegmanHeight=n.pegmanHeight||52,o.pegmanWidth=n.pegmanWidth||49,o.ballYOffset=n.ballYOffset||0,o.paddleYOffset=n.paddleYOffset||0,o.markerHeight=n.markerHeight||50,o.markerWidth=n.markerWidth||50,o.flagHeight=43,o.flagWidth=50,o}},2711:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(2712),a=o(1271),r=o(799),s=o(838),l=o(2714),c=o(2715);e.exports=function(){function e(t,o){i(this,e),this.planeWidth=t.gridDimensions?t.gridDimensions[0]:10,this.planeHeight=t.gridDimensions?t.gridDimensions[1]:10,this.controller=o,this.player={},this.agent={},this.usingAgent=!1,this.initialLevelData=Object.create(t),this.reset(),this.initialPlayerState=Object.create(this.player),this.initialAgentState=Object.create(this.agent)}return e.prototype.planeArea=function(){return this.planeWidth*this.planeHeight},e.prototype.inBounds=function(e){var t=e[0],o=e[1];return t>=0&&t<this.planeWidth&&o>=0&&o<this.planeHeight},e.prototype.reset=function(){var e=this;this.groundPlane=new n(this.initialLevelData.groundPlane,this.planeWidth,this.planeHeight,this,"groundPlane"),this.groundDecorationPlane=new n(this.initialLevelData.groundDecorationPlane,this.planeWidth,this.planeHeight,this,"decorationPlane"),this.shadingPlane=[],this.actionPlane=new n(this.initialLevelData.actionPlane,this.planeWidth,this.planeHeight,this,"actionPlane"),this.actionPlane.powerRedstone(),this.actionPlane.getAllPositions().forEach(function(t){e.actionPlane.getBlockAt(t).isRedstone&&e.actionPlane.determineRedstoneSprite(t),e.actionPlane.getBlockAt(t).isRail&&e.actionPlane.determineRailType(t)}),this.fluffPlane=new n(this.initialLevelData.fluffPlane,this.planeWidth,this.planeHeight),this.fowPlane=[],this.isDaytime=void 0===this.initialLevelData.isDaytime||this.initialLevelData.isDaytime;var t=Object.create(this.initialLevelData);if(void 0!==this.initialLevelData.usePlayer?this.usePlayer=this.initialLevelData.usePlayer:this.usePlayer=!0,this.usePlayer){var o=s.fromArray(t.playerStartPosition);this.player=new l(this.controller,"Player",o.x,o.y,this.initialLevelData.playerName||"Steve",!this.actionPlane.getBlockAt(o).getIsEmptyOrEntity(),t.playerStartDirection),this.controller.levelEntity.pushEntity(this.player),this.controller.player=this.player,t.useAgent&&this.spawnAgent(t)}!t.useAgent&&this.usingAgent&&this.destroyAgent(),this.computeShadingPlane(),this.computeFowPlane()},e.prototype.spawnAgent=function(e,t,o){this.usingAgent=!0;var i=void 0!==t?t:s.fromArray(e.agentStartPosition),n=void 0!==o?o:e.agentStartDirection,a=this.actionPlane.getBlockAt(i);this.agent=new c(this.controller,"PlayerAgent",i.x,i.y,"Agent",!a.getIsEmptyOrEntity(),n),this.controller.levelEntity.pushEntity(this.agent),this.controller.agent=this.agent},e.prototype.destroyAgent=function(){this.controller.agent=void 0,this.controller.levelEntity.destroyEntity(this.agent.identifier),this.agent=void 0,this.usingAgent=!1},e.prototype.yToIndex=function(e){return e*this.planeWidth},e.prototype.isSolved=function(){return this.initialLevelData.verificationFunction(this)},e.prototype.isFailed=function(){return void 0!==this.initialLevelData.failureCheckFunction&&this.initialLevelData.failureCheckFunction(this)},e.prototype.getHouseBottomRight=function(){return s.fromArray(this.initialLevelData.houseBottomRight)},e.prototype.isPlayerNextTo=function(e){var t=this;return!!this.usePlayer&&s.getOrthogonalPositions(this.player.position).some(function(o){return t.inBounds(o)&&(t.isBlockOfType(o,e)||t.isEntityOfType(o,e)||t.groundPlane.getBlockAt(o).blockType===e)})},e.prototype.isEntityNextTo=function(e,t){var o=this;return this.controller.levelEntity.getEntitiesOfType(e).some(function(e){return s.getOrthogonalPositions(e.position).some(function(e){return o.inBounds(e)&&(o.isBlockOfType(e,t)||o.isEntityOfType(e,t)||o.groundPlane.getBlockAt(e).blockType===t)})})},e.prototype.isEntityOnBlocktype=function(e,t){for(var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=this.controller.levelEntity.getEntitiesOfType(e),n=0,a=0;a<i.length;a++){var r=i[a];(this.isBlockOfType(r.position,t)||this.groundPlane.getBlockAt(r.position).blockType===t)&&n++}return n>=o},e.prototype.isEntityAt=function(e,t){Array.isArray(t)&&(t=s.fromArray(t));for(var o=this.controller.levelEntity.getEntitiesOfType(e),i=0;i<o.length;i++){var n=o[i];if(s.equals(n.position,t))return!0}return!1},e.prototype.isEntityTypeRunning=function(e){for(var t=this.controller.levelEntity.getEntitiesOfType(e),o=0;o<t.length;o++){var i=t[o],n=!i.queue.isStarted(),a=!i.queue.isFinished();if(n&&i.queue.commandList_.length>0||a)return!0}return!1},e.prototype.isEntityDied=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=this.controller.levelEntity.entityDeathCount;return!!(o.has(e)&&o.get(e)>=t)},e.prototype.getScore=function(){return this.controller.score},e.prototype.shouldRide=function(e){var t=this.player,o=this.getNextRailPosition(t,e),i=this.actionPlane.getBlockAt(o);return this.isNextRailValid(i,e)},e.prototype.isNextRailValid=function(e,t){if(e)return r.opposite(e.connectionA)===t||r.opposite(e.connectionB)===t||e.connectionA===t||e.connectionB===t},e.prototype.getNextRailPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1],o=s.directionToOffsetPosition(t)||new s(0,0);return s.add(e.position,o)},e.prototype.getEntityCount=function(e){return this.controller.levelEntity.getEntitiesOfType(e).length},e.prototype.getCommandExecutedCount=function(e,t){return this.controller.getCommandCount(e,t,!1)},e.prototype.getRepeatCommandExecutedCount=function(e,t){return this.controller.getCommandCount(e,t,!0)},e.prototype.getTurnRandomCount=function(){return this.controller.turnRandomCount},e.prototype.getInventoryAmount=function(e){if(!this.usePlayer)return 0;if("all"===e||"All"===e){var t=this.player.inventory,o=0;for(var i in t)o+=t[i];return o}return this.player.inventory[e]},e.prototype.getInventoryTypes=function(){return this.usePlayer?Object.keys(this.player.inventory):[]},e.prototype.countOfTypeOnMap=function(e){var t=this;return this.actionPlane.getAllPositions().filter(function(o){return t.actionPlane.getBlockAt(o).blockType===e}).length},e.prototype.isPlayerAt=function(e){return!!this.usePlayer&&(Array.isArray(e)&&(e=s.fromArray(e)),s.equals(this.player.position,e))},e.prototype.spritePositionToIndex=function(e,t){var o=s.subtract(t,e);return new s(o.x/40,o.y/40)},e.prototype.solutionMapMatchesResultMap=function(e){for(var t=0;t<this.planeArea();t++){var o=e[t],i=this.actionPlane.indexToCoordinates(t);if(""!==o)if("empty"===o){if(!this.actionPlane.getBlockAt(i).isEmpty)return!1}else if("any"===o){if(this.actionPlane.getBlockAt(i).isEmpty)return!1}else if(this.actionPlane.getBlockAt(i).blockType!==o)return!1}return!0},e.prototype.getTnt=function(){var e=this;return this.actionPlane.getAllPositions().filter(function(t){var o=e.actionPlane.getBlockAt(t);return o&&"tnt"===o.blockType})},e.prototype.getMoveForwardPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;return s.forward(e.position,e.facing)},e.prototype.getMoveDirectionPosition=function(e,t){for(var o=e.facing,i=0;i<t;++i)o=r.turn(o,"right");return s.forward(e.position,o)},e.prototype.isForwardBlockOfType=function(e){var t=this.getMoveForwardPosition(),o=this.isBlockOfTypeOnPlane(t,"empty",this.actionPlane);return!(""!==e||!o)||(o?this.isBlockOfTypeOnPlane(t,e,this.groundPlane):this.isBlockOfTypeOnPlane(t,e,this.actionPlane))},e.prototype.getForwardBlockType=function(){return this.getForwardBlock().blockType},e.prototype.getForwardBlock=function(){var e=this.getMoveForwardPosition();return this.actionPlane.getBlockAt(e)},e.prototype.isBlockOfType=function(e,t){return this.isBlockOfTypeOnPlane(e,t,this.actionPlane)},e.prototype.isEntityOfType=function(e,t){return this.controller.levelEntity.getEntitiesOfType(t).some(function(t){return s.equals(e,t.position)})},e.prototype.isBlockOfTypeOnPlane=function(e,t,o){var i=!1;return this.inBounds(e)&&(i="empty"===t?o.getBlockAt(e).isEmpty:"tree"===t?o.getBlockAt(e).getIsTree():t===o.getBlockAt(e).blockType),i},e.prototype.isPlayerStandingInWater=function(){return"water"===this.groundPlane.getBlockAt(this.player.position).blockType},e.prototype.isPlayerStandingInLava=function(){return"lava"===this.groundPlane.getBlockAt(this.player.position).blockType},e.prototype.coordinatesToIndex=function(e){return this.yToIndex(e[1])+e[0]},e.prototype.checkPositionForTypeAndPush=function(e,t,o){return!e&&""!==this.actionPlane.getBlockAt(t).blockType||this.isBlockOfType(t,e)?(o.push([!0,t]),!0):(o.push([!1,null]),!1)},e.prototype.houseGroundToFloorHelper=function(e,t,o){var i,n,a,r,s,l=0,c=o,p=this.yToIndex(e[2])+e[1];44===p&&(p=44),n=[0,e[1],e[2]+1],n[0]=this.yToIndex(n[2])+n[1],a=[0,e[1],e[2]-1],a[0]=this.yToIndex(a[2])+a[1],r=[0,e[1]+1,e[2]],r[0]=this.yToIndex(r[2])+r[1],s=[0,e[1]-1,e[2]],r[0]=this.yToIndex(r[2])+r[1],i=this.actionPlane.getBlockAt(this.actionPlane.indexToCoordinates(p));for(var d=0;d<c.length;++d)if(c[d][0]===p){l=-1;break}return""!==i.blockType?{}:c.length>0&&-1===l?{}:(c.push(e),c.concat(this.houseGroundToFloorHelper(n,t,c)),c.concat(this.houseGroundToFloorHelper(a,t,c)),c.concat(this.houseGroundToFloorHelper(r,t,c)),c.concat(this.houseGroundToFloorHelper(s,t,c)),c)},e.prototype.houseGroundToFloorBlocks=function(e){var t=[0,e[0],e[1]];return this.houseGroundToFloorHelper(t,"wool_orange",[])},e.prototype.getEntityAt=function(e){var t=!0,o=!1,i=void 0;try{for(var n,a=this.controller.levelEntity.entityMap[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var r=n.value;if(s.equals(r[1].position,e))return r[1]}}catch(e){o=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw i}}},e.prototype.getAllBorderingPositionNotOfType=function(e,t){for(var o=this.getAllBorderingPosition(e,null),i=1;i<o.length;++i)o[i][0]&&this.actionPlane.getBlockAt(o[i][1]).blockType===t&&(o[i][0]=!1);return o},e.prototype.getAllBorderingPosition=function(e,t){var o=this,i=[!1];return s.getSurroundingPositions(e).forEach(function(e){o.checkPositionForTypeAndPush(t,e,i)&&(i[0]=!0)}),i},e.prototype.canMoveForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveForwardPosition(e);return!(!this.controller.followingPlayer()&&(t.x>9||t.y>9))&&this.isPositionEmpty(t,e)},e.prototype.canMoveBackward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveDirectionPosition(e,2);return this.isPositionEmpty(t,e)},e.prototype.isPositionEmpty=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player,o=[!1];if(this.inBounds(e)){if(this.actionPlane.getBlockAt(e).isWalkable||o.push("notWalkable"),!this.actionPlane.getBlockAt(e).isEmpty){if(this.player.isOnBlock)return[!0];o.push("notEmpty")}if("water"===this.groundPlane.getBlockAt(e).blockType){if(!this.controller.getIsDirectPlayerControl())return[!0];o.push("water")}else if("lava"===this.groundPlane.getBlockAt(e).blockType){if(!this.controller.getIsDirectPlayerControl())return[!0];o.push("lava")}var i=this.getEntityAt(e);void 0!==i&&(o.push("frontEntity"),o.push(i));var n=this.groundPlane.getBlockAt(e),a=this.actionPlane.getBlockAt(e);o[0]=t.hasPermissionToWalk(a,i,n)}else o.push("outBound");return o},e.prototype.canMoveDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1],o=e.facing;this.turnToDirection(e,t);var i=this.canMoveForward(e);return this.turnToDirection(e,o),i},e.prototype.canPlaceBlock=function(e,t){return e.canPlaceBlock(t)},e.prototype.canPlaceBlockDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],o=arguments[2];return!t.isOnBlock&&!(this.getPlaneToPlaceOn(this.getMoveDirectionPosition(t,o),t,e)===this.groundPlane&&a.notValidOnGroundPlane(e)&&this.groundPlane.getBlockAt(this.getMoveDirectionPosition(t,o))||this.checkEntityConflict(this.getMoveDirectionPosition(t,o))||null===this.getPlaneToPlaceOn(this.getMoveDirectionPosition(t,o),t,e))},e.prototype.checkEntityConflict=function(e){var t=!1;return this.controller.levelEntity.entityMap.forEach(function(o){s.equals(o.position,e)&&(t=!0)}),t},e.prototype.canPlaceBlockForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;return this.canPlaceBlockDirection(e,t,0)},e.prototype.getPlaneToPlaceOn=function(e,t,o){if(this.inBounds(e)){var i=this.actionPlane.getBlockAt(e);if(t===this.agent&&i.isEmpty){if(this.groundPlane.getBlockAt(e).getIsLiquid()){if(a.getCanFall(o))return this.groundPlane;if(!a.getIsPlaceableInLiquid(o))return null}return this.actionPlane}if(i.isPlacable){return this.groundPlane.getBlockAt(e).isPlacable?this.groundPlane:this.actionPlane}}return null},e.prototype.canDestroyBlockForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=!1;if(!e.isOnBlock){var o=this.getMoveForwardPosition(e);if(this.inBounds(o)){var i=this.actionPlane.getBlockAt(o);t=!i.isEmpty&&(i.isDestroyable||i.isUsable)}}return t},e.prototype.moveForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveForwardPosition(e);this.moveTo(t,e)},e.prototype.moveBackward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveDirectionPosition(e,2);this.moveTo(t,e)},e.prototype.moveTo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;t.setMovePosition(e),this.actionPlane.getBlockAt(e).isEmpty&&(t.isOnBlock=!1)},e.prototype.turnLeft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;e.facing=r.turn(e.facing,"left")},e.prototype.turnRight=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;e.facing=r.turn(e.facing,"right")},e.prototype.turnToDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1];e.facing=t},e.prototype.moveDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1];this.turnToDirection(e,t),this.moveForward()},e.prototype.placeBlock=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player,o=t.position,i=null,n=this.groundPlane.getBlockAt(o),r=this.actionPlane.getBlockAt(o),s=new a(e),l=t.canPlaceBlockOver(s,n);if(l.canPlace&&!r.getIsMiniblock())switch(l.plane){case"actionPlane":i=this.actionPlane.setBlockAt(o,s),t.walkableCheck(s);break;case"groundPlane":this.groundPlane.setBlockAt(o,s)}return i},e.prototype.placeBlockForward=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player;return this.placeBlockDirection(e,t,o,0)},e.prototype.placeBlockDirection=function(e,t,o,i){var n=this.getMoveDirectionPosition(o,i);return"watering"===e&&(e="farmlandWet",t=this.groundPlane),t.setBlockAt(n,new a(e))},e.prototype.destroyBlock=function(e){var t=null;return this.inBounds(e)&&null!==(t=this.actionPlane.getBlockAt(e))&&(t.position=e,t.isDestroyable&&this.actionPlane.setBlockAt(e,new a(""))),t},e.prototype.destroyBlockForward=function(e){var t=null,o=this.getMoveForwardPosition(e);return this.inBounds(o)&&null!==(t=this.actionPlane.getBlockAt(o))&&t.isDestroyable&&this.actionPlane.setBlockAt(o,new a("")),t},e.prototype.solveFOWTypeForMap=function(){var e,t;e=this.getAllEmissives(),t=this.findBlocksAffectedByEmissives(e);for(var o in t)t.hasOwnProperty(o)&&this.solveFOWTypeFor(t[o],e)},e.prototype.solveFOWTypeFor=function(e,t){var o,i,n,a=!1,r=!1,s=!1,l=!1,c=!1,p=!1,d=!1,u=!1,h=0,f=this.coordinatesToIndex(e);o=this.findEmissivesThatTouch(e,t);for(var m in o){var g=o[m];n=e[1],i=e[0],h=Math.atan2(g[1]-e[1],g[0]-e[0]),h=-h,h<0&&(h+=2*Math.PI),h*=360/(2*Math.PI),!p&&h>32.5&&h<=57.5&&(l=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_InCorner_TopRight",precedence:0})),!s&&h>122.5&&h<=147.5&&(a=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_InCorner_TopLeft",precedence:0})),!s&&h>212.5&&h<=237.5&&(r=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_InCorner_BottomLeft",precedence:0})),!p&&h>302.5&&h<=317.5&&(c=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_InCorner_BottomRight",precedence:0})),(h>=327.5||h<=32.5)&&(p=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Right",precedence:1})),h>237.5&&h<=302.5&&(u=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Bottom",precedence:1})),h>147.5&&h<=212.5&&(s=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Left",precedence:1})),h>57.5&&h<=122.5&&(d=!0,this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Top",precedence:1}))}a&&r&&this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Left",precedence:1}),l&&c&&this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Right",precedence:1}),a&&l&&this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Top",precedence:1}),c&&r&&this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Bottom",precedence:1}),c&&a||r&&l||s&&p||d&&u||p&&u&&a||u&&l&&a||d&&c&&r||s&&l&&c||s&&u&&l?this.fowPlane[f]="":u&&s||u&&a||s&&c?this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Bottom_Left",precedence:2}):u&&p||u&&l||p&&r?this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Bottom_Right",precedence:2}):d&&p||d&&c||p&&a?this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Top_Right",precedence:2}):(d&&s||d&&r||s&&l)&&this.pushIfHigherPrecedence(f,{x:i,y:n,type:"FogOfWar_Top_Left",precedence:2})},e.prototype.pushIfHigherPrecedence=function(e,t){if(""===t)return void(this.fowPlane[e]="");var o=this.fowPlane[e];o&&o.precedence>t.precedence||(this.fowPlane[e]=t)},e.prototype.getAllEmissives=function(){for(var e=[],t=0;t<this.planeHeight;++t)for(var o=0;o<this.planeWidth;++o){var i=new s(o,t);(!this.actionPlane.getBlockAt(i).isEmpty&&this.actionPlane.getBlockAt(i).isEmissive||this.groundPlane.getBlockAt(i).isEmissive&&this.actionPlane.getBlockAt(i).isEmpty)&&e.push(i)}return e},e.prototype.findBlocksAffectedByEmissives=function(e){var t={};for(var o in e)for(var i=e[o],n=i.x,a=i.y,r=i.y-2;r<=a+2;++r)for(var l=i.x-2;l<=n+2;++l){var c=new s(l,r);this.inBounds(c)&&(r>=a-1&&r<=a+1&&l>=n-1&&l<=n+1||(t[r.toString()+l.toString()]=c))}return t},e.prototype.findEmissivesThatTouch=function(e,t){for(var o=[],i=e.y,n=e.x,a=i-2;a<=i+2;++a)for(var r=n-2;r<=n+2;++r){var l=new s(r,a);if(this.inBounds(l)&&!(a>=i-1&&a<=i+1&&r>=n-1&&r<=n+1))for(var c in t)s.equals(t[c],l)&&o.push(t[c])}return o},e.prototype.computeFowPlane=function(){var e,t;if(this.fowPlane=[],!this.isDaytime){for(t=0;t<this.planeHeight;++t)for(e=0;e<this.planeWidth;++e)this.fowPlane.push({x:e,y:t,type:"FogOfWar_Center"});for(this.solveFOWTypeForMap(),t=0;t<this.planeHeight;++t)for(e=0;e<this.planeWidth;++e){var o=new s(e,t),i=this.groundPlane.getBlockAt(o),n=this.actionPlane.getBlockAt(o);(i.isEmissive&&n.isEmpty||!n.isEmpty&&n.isEmissive)&&this.clearFowAround(e,t)}}},e.prototype.clearFowAround=function(e,t){var o,i;for(i=-1;i<=1;++i)for(o=-1;o<=1;++o)this.clearFowAt(e+o,t+i)},e.prototype.clearFowAt=function(e,t){if(e>=0&&e<this.planeWidth&&t>=0&&t<this.planeHeight){var o=this.yToIndex(t)+e;this.fowPlane[o]=""}},e.prototype.clearFow=function(){for(var e=0;e<this.planeWidth;e++)for(var t=0;t<this.planeHeight;t++){var o=this.yToIndex(t)+e;this.fowPlane[o]=""}},e.prototype.computeShadingPlane=function(){this.shadingPlane=[],this.computeShading(this.actionPlane),this.computeShading(this.groundPlane)},e.prototype.occludedBy=function(e){return e&&!e.getIsEmptyOrEntity()&&!e.getIsLiquid()},e.prototype.computeShading=function(e){var t,o,i,n;for(i=0;i<this.planeArea();++i){t=i%this.planeWidth,o=Math.floor(i/this.planeWidth);var a=new s(t,o);n=!1;var r=e.getBlockAt(a),l=this.groundPlane.getBlockAt(a);if(r.isEmpty||r.isTransparent||r.getIsLiquid()){var c="AO";"lava"===r.blockType?c="LavaGlow":"water"===r.blockType&&(c="WaterAO"),r!==l&&l.getIsLiquid()||(0===o&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Bottom"}),o===this.planeHeight-1&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Top"}),0===t&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Right"}),t===this.planeWidth-1&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Left"}));var p=e.getSurroundingBlocks(a);t<this.planeWidth-1&&this.occludedBy(p.east)&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Left"}),t>0&&this.occludedBy(p.west)&&(this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Right"}),r.getIsLiquid()||(this.shadingPlane.push({x:t,y:o,atlas:"blockShadows",type:"Shadow_Parts_Fade_base.png"}),o>0&&t>0&&e.getBlockAt(s.north(s.west(a))).getIsEmptyOrEntity()&&this.shadingPlane.push({x:t,y:o,atlas:"blockShadows",type:"Shadow_Parts_Fade_top.png"})),n=!0),o>0&&this.occludedBy(p.north)?this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Bottom"}):o>0&&(t<this.planeWidth-1&&this.occludedBy(p.northEast)&&!this.occludedBy(p.east)&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_BottomLeft"}),!n&&t>0&&this.occludedBy(p.northWest)&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_BottomRight"})),o<this.planeHeight-1&&this.occludedBy(p.south)?this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_Top"}):o<this.planeHeight-1&&(t<this.planeWidth-1&&this.occludedBy(p.southEast)&&!this.occludedBy(p.east)&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_TopLeft"}),!n&&t>0&&this.occludedBy(p.southWest)&&this.shadingPlane.push({x:t,y:o,atlas:c,type:"AOeffect_TopRight"}))}}},e}()},2712:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){var o=[],i=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=o(1271),r=o(799),s=r.North,l=r.South,c=r.East,p=r.West,d=r.opposite,u=r.turnDirection,h=r.turn,f=r.directionToRelative,m=o(838),g=o(2713),y=function(e){switch(e){case s:return"North";case l:return"South";case c:return"East";case p:return"West";default:return""}},v=["","Vertical","Vertical","Vertical","Horizontal","UpRight","DownRight","TRight","Horizontal","UpLeft","DownLeft","TLeft","Horizontal","TUp","TDown","Cross"],b=[[],[s],[l],[s,l],[c],[s,c],[l,c],[l,c],[p],[s,p],[l,p],[l,p],[c,p],[s,c],[l,c],[s,c]],k=[[],[s],[l],[s,l],[c],[c,p],[c,p],[c,p],[p],[c,p],[c,p],[c,p],[c,p],[c,p],[c,p],[c,p]];e.exports=function(){function e(t,o,n,r,s){i(this,e),this._data=[],this.width=o,this.height=n,this.levelModel=r,this.planeType=s,this.playPistonOn=!1,this.playPistonOff=!1;for(var l=0;l<t.length;++l){var c=new a(t[l]);this._data.push(c)}this.isActionPlane()&&(this.redstoneAdjacencySet=this.createRedstoneAdjacencySet())}return e.prototype.inBounds=function(e){return e.x>=0&&e.x<this.width&&e.y>=0&&e.y<this.height},e.prototype.coordinatesToIndex=function(e){return e.y*this.width+e.x},e.prototype.indexToCoordinates=function(e){var t=Math.floor(e/this.width),o=e-t*this.width;return new m(o,t)},e.prototype.getAllPositions=function(){var e=this;return this._data.map(function(t,o){return e.indexToCoordinates(o)})},e.prototype.getBlockAt=function(e){if(e=m.fromArray(e),this.inBounds(e))return this._data[this.coordinatesToIndex(e)]},e.prototype.isActionPlane=function(){return"actionPlane"===this.planeType},e.prototype.isDecorationPlane=function(){return"decorationPlane"===this.planeType},e.prototype.isGroundPlane=function(){return"groundPlane"===this.planeType},e.prototype.setBlockAt=function(e,t){var o=this;if(e=m.fromArray(e),this.inBounds(e)){if(this._data[this.coordinatesToIndex(e)]=t,this.isActionPlane()){t.isRedstone||t.isRedstoneBattery?this.redstoneAdjacencySet.add(e):this.redstoneAdjacencySet.remove(e);var i=[];if(t.needToRefreshRedstone()&&(i=this.refreshRedstone()),this.updateWeakCharge(e,t),t.isEmpty&&[s,l,c,p].forEach(function(t){var i=m.directionToOffsetPosition(t),n=o.getBlockAt(m.add(e,i));n&&n.isRail&&(n.connectionA===d(t)&&(n.connectionA=void 0),n.connectionB===d(t)&&(n.connectionB=void 0))}),this.determineRailType(e,!0),this.levelModel&&this.levelModel.controller.levelView){var n=m.north(m.east(e)),a=m.south(m.west(e)),r=m.getOrthogonalPositions(e).concat([e,n,a]);this.levelModel.controller.levelView.refreshActionGroup(r),this.levelModel.controller.levelView.refreshActionGroup(i)}}else this.isGroundPlane()&&this.levelModel.controller.levelView.refreshGroundGroup();return t}},e.prototype.getOrthogonalBlocks=function(e){return{north:{block:this.getBlockAt(m.north(e)),relative:l},south:{block:this.getBlockAt(m.south(e)),relative:s},east:{block:this.getBlockAt(m.east(e)),relative:p},west:{block:this.getBlockAt(m.west(e)),relative:c}}},e.prototype.getSurroundingBlocks=function(e){return{north:this.getBlockAt(m.north(e)),northEast:this.getBlockAt(m.north(m.east(e))),east:this.getBlockAt(m.east(e)),southEast:this.getBlockAt(m.south(m.east(e))),south:this.getBlockAt(m.south(e)),southWest:this.getBlockAt(m.south(m.west(e))),west:this.getBlockAt(m.west(e)),northWest:this.getBlockAt(m.north(m.west(e)))}},e.prototype.getOrthogonalMask=function(e,t){var o=this.getOrthogonalBlocks(e);return(t(o.north)<<0)+(t(o.south)<<1)+(t(o.east)<<2)+(t(o.west)<<3)},e.prototype.getMinecartTrack=function(e,t){var o=this.getBlockAt(e);if(o.isRail){if(o.connectionA===t||o.connectionB===t)return["",m.forward(e,t),t,300];var i=d(t);if(o.connectionA===i&&void 0!==o.connectionB){var n=u(t,o.connectionB);return["turn_"+n,e,h(t,n),300]}if(o.connectionB===i&&void 0!==o.connectionA){var a=u(t,o.connectionA);return["turn_"+a,e,h(t,a),300]}}},e.prototype.getPoweredRailsConnected=function(e,t){if(!m.isAdjacent(e,t))return!1;var o=this.getBlockAt(e),i=this.getBlockAt(t);return!(!o.getIsPowerableRail()||!i.getIsPowerableRail())&&(o.getIsHorizontal()&&i.getIsHorizontal()?m.equals(m.forward(e,c),t)||m.equals(m.forward(e,p),t):!(!o.getIsVertical()||!i.getIsVertical())&&(m.equals(m.forward(e,s),t)||m.equals(m.forward(e,l),t)))},e.prototype.powerRedstone=function(){var e=this;return this.redstoneAdjacencySet.sets.forEach(function(t){var o=t.some(function(t){return e.getBlockAt(t).isRedstoneBattery});t.forEach(function(t){e.getBlockAt(t).isPowered=o,e.determineRedstoneSprite(t)})}),this.redstoneAdjacencySet.flattenSets()},e.prototype.createRedstoneAdjacencySet=function(){var e=this,t=this.getAllPositions().filter(function(t){var o=e.getBlockAt(t);return o.isRedstone||o.isRedstoneBattery});return new g(t)},e.prototype.powerRails=function(){var e=this,t=this.getAllPositions().filter(function(t){return e.getBlockAt(t).getIsPowerableRail()});return t.forEach(function(t){e.determineRailType(t)}),new g(t,this.getPoweredRailsConnected.bind(this)).sets.forEach(function(t){t.some(function(t){return e.getBlockAt(t).isPowered})&&t.forEach(function(t){e.getBlockAt(t).isPowered=!0})}),t.forEach(function(t){e.determineRailType(t)}),t},e.prototype.determineRailType=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getBlockAt(e);if(i&&i.isRail){var a="",r=b;if(i.getIsPowerableRail()&&(a=i.isPowered?"Powered":"Unpowered",r=k),void 0===i.connectionA||void 0===i.connectionB){var s=this.getOrthogonalMask(e,function(e){var t=e.block,o=e.relative;if(!t||!t.isRail)return!1;var i=void 0===t.connectionA||t.connectionA===o,n=void 0===t.connectionB||t.connectionB===o;return i||n}),l=n(r[s],2);i.connectionA=l[0],i.connectionB=l[1]}var c=y(i.connectionA)+y(i.connectionB);i.blockType="rails"+a+c,o&&m.getOrthogonalPositions(e).forEach(function(e){t.determineRailType(e)})}},e.prototype.determineRedstoneSprite=function(e){var t=this.getBlockAt(e);if(t&&t.isRedstone){var o=this.getOrthogonalMask(e,function(e){var t=e.block;return t&&(t.isRedstone||t.isConnectedToRedstone)}),i=v[o],n=t.isPowered?"On":"";return t.blockType="redstoneWire"+i+n,"redstoneWire"+i}},e.prototype.refreshRedstone=function(){var e=this,t=this.powerRedstone();this.powerAllBlocks();var o=this.powerRails(),i=t.concat(o);return this.getAllPositions().forEach(function(t){e.getIronDoors(t),e.getPistonState(t)}),this.playPistonSound(),i},e.prototype.playPistonSound=function(){this.levelModel&&(this.playPistonOn?this.levelModel.controller.audioPlayer.play("pistonOut"):this.playPistonOff&&this.levelModel.controller.audioPlayer.play("pistonIn"),this.playPistonOn=!1,this.playPistonOff=!1)},e.prototype.checkEntityConflict=function(e){var t=this;if(this.levelModel){var o=!1;return this.levelModel.controller.levelEntity.entityMap.forEach(function(i){t.levelModel.controller.positionEquivalence(e,i.position)&&(o=!0)}),o}},e.prototype.getIronDoors=function(e){e=m.fromArray(e);var t=this.getBlockAt(e),o=this.coordinatesToIndex(e);"doorIron"===t.blockType&&(t.isPowered=this.powerCheck(e,!0),t.isPowered&&!t.isOpen?(t.isOpen=!0,this.levelModel&&this.levelModel.controller.levelView.animateDoor(o,!0)):!t.isPowered&&t.isOpen&&this.levelModel&&(this.checkEntityConflict(e)||(t.isOpen=!1,this.levelModel.controller.levelView.animateDoor(o,!1))))},e.prototype.getPistonState=function(e){var t=this.getBlockAt(e);t.getIsPiston()&&!t.getIsPistonArm()&&(t.isPowered=this.powerCheck(e,!0),t.isPowered?this.activatePiston(e):t.isPowered||this.deactivatePiston(e),this.levelModel&&(this.levelModel.controller.updateFowPlane(),this.levelModel.controller.updateShadingPlane()))},e.prototype.findDoorToAnimate=function(e){var t=this;this.getAllPositions().forEach(function(o){var i=t.getBlockAt(o),n=t.coordinatesToIndex(o);"doorIron"===i.blockType&&o!==e&&(i.isPowered=t.powerCheck(o,!0),i.isPowered&&!i.isOpen?(i.isOpen=!0,t.levelModel&&t.levelModel.controller.levelView.animateDoor(n,!0)):i.isPowered||!i.isOpen||t.checkEntityConflict(o)||(i.isOpen=!1,t.levelModel&&t.levelModel.controller.levelView.animateDoor(n,!1)))})},e.prototype.activatePiston=function(e){var t=this.getBlockAt(e),o=t.blockType;t.getIsStickyPiston()&&(o=o.substring(0,o.length-6)),"On"===o.substring(o.length-2,o.length)&&(o=o.substring(0,o.length-2));var i=t.getPistonDirection(),n="pistonArm"+f(i),r=m.directionToOffsetPosition(i),s=m.forward(e,i),l=this.getBlockAt(s);if(!this.pistonArmBlocked(e,r))if(l.isDestroyableUponPush())this.setBlockAt(s,new a("")),this.playPistonOn=!0,this.levelModel&&this.levelModel.controller.levelView.playExplosionAnimation(s,2,s,l.blockType,null,null,this.player);else if(""===l.blockType||l.getIsPistonArm()){if(""===l.blockType){var c="On";t.getIsStickyPiston()&&(c+="Sticky",n+="Sticky");var p=new a(n),d=new a(o+=c);this.setBlockAt(s,p),this.setBlockAt(e,d),this.playPistonOn=!0}}else{var u=this.getBlocksToPush(s,r),h="On";t.getIsStickyPiston()&&(h+="Sticky");var g=new a(o+=h);this.setBlockAt(e,g),this.pushBlocks(u,r),this.playPistonOn=!0}},e.prototype.pistonArmBlocked=function(e,t){var o=m.add(e,t);return this.checkEntityConflict(o)},e.prototype.deactivatePiston=function(e){var t=this.getBlockAt(e);if(t.getIsPiston()&&t.blockType.match("On")){var o=t.getPistonDirection();void 0!==o&&this.retractArm(m.forward(e,o),e)}},e.prototype.retractArm=function(e,t){var o=new a(""),i=this.getBlockAt(t),n="",r="";this.getBlockAt(t).getIsStickyPiston()?(n="Sticky",r=i.blockType.substring(0,i.blockType.length-8)):r=i.blockType.substring(0,i.blockType.length-2);var s=r+n,l=new a(s);if(this.getBlockAt(e).getIsPistonArm())if(this.getBlockAt(t).getIsStickyPiston()){var c=m.directionToOffsetPosition(i.getPistonDirection()),p=m.add(e,c);this.inBounds(p)&&this.getBlockAt(p).isStickable?(this.setBlockAt(e,this.getBlockAt(p)),this.setBlockAt(p,o)):(this.setBlockAt(e,o),this.playPistonOff=!0)}else this.setBlockAt(e,o),this.playPistonOff=!0;this.setBlockAt(t,l)},e.prototype.pushBlocks=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],o="",i=!1;1===t[0]?o="pistonArmRight":-1===t[0]?o="pistonArmLeft":1===t[1]?o="pistonArmDown":-1===t[1]&&(o="pistonArmUp");for(var n=new a(o),r=e.length-1;r>=0;--r){var s=m.add(e[r],m.fromArray(t)),l=this.getBlockAt(e[r]);this.inBounds(s)&&this.getBlockAt(s).isDestroyableUponPush()&&(this.levelModel&&this.levelModel.controller.levelView.playExplosionAnimation(s,2,s,l.blockType,null,null,this.player),i=!0),this.setBlockAt(s,this.getBlockAt(e[r])),0===r&&this.setBlockAt(e[r],n)}i&&this.refreshRedstone()},e.prototype.getBlocksToPush=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],o=[],i=e;this.inBounds(i)&&this.getBlockAt(i).getIsPushable();)o.push(i),i=m.add(i,m.fromArray(t));return o},e.prototype.powerCheck=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return m.getOrthogonalPositions(e).some(function(i){var n=t.getBlockAt(i);if(n){if(!n.isWeaklyPowerable)return!1;if(t.getBlockAt(e).getIsPiston()){var a=t.getBlockAt(e),r=m.directionToOffsetPosition(a.getPistonDirection())||new m(0,0),s=m.add(e,r);if(m.equals(i,s))return!1}return o?n.isPowered||n.isRedstoneBattery:n.isRedstone&&n.isPowered||n.isRedstoneBattery}})},e.prototype.powerAllBlocks=function(){var e=this;this.getAllPositions().forEach(function(t){var o=e.getBlockAt(t);""!==o.blockType&&o.canHoldCharge()&&(o.isPowered=e.powerCheck(t))})},e.prototype.updateWeakCharge=function(e,t){var o=this;t.isWeaklyPowerable&&(t.isPowered=this.powerCheck(e)),t.isPowered&&m.getOrthogonalPositions(e).forEach(function(e){o.inBounds(e)&&(o.getIronDoors(e),o.getPistonState(e))})},e}()},2713:function(e,t,o){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=o(838);e.exports=function(){function e(t,o){var i=this;n(this,e),this.comparisonFunction=o||a.isAdjacent,this.sets=[],t&&t.forEach(function(e){i.add(e)})}return e.prototype.flattenSets=function(){return this.sets.reduce(function(e,t){return e.concat(t)},[])},e.prototype.add=function(e){var t=this;if(this.find(e))return!1;var o=this.sets.filter(function(o){return o.some(function(o){return t.comparisonFunction(e,o)})});return 1===o.length?o[0].push(e):o.length>1?function(){var n=[];o.forEach(function(e){t.sets.splice(t.sets.indexOf(e),1),n.push.apply(n,i(e))}),n.push(e),t.sets.push(n)}():this.sets.push([e]),!0},e.prototype.find=function(e){return this.sets.find(function(t){return t.some(function(t){return a.equals(e,t)})})},e.prototype.remove=function(t){var o=this.find(t);if(!o)return!1;this.sets.splice(this.sets.indexOf(o),1);var n=o.filter(function(e){return!a.equals(t,e)});if(n.length){var r,s=new e(n,this.comparisonFunction).sets;(r=this.sets).push.apply(r,i(s))}return!0},e}()},2714:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){var o=[],i=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=o(794),l=o(1016),c=o(838);e.exports=function(e){function t(o,a,r,s,l,c,p){i(this,t);var d=n(this,e.call(this,o,a,"Player",r,s,p));return d.offset=[-18,-32],d.name=l,d.isOnBlock=c,d.inventory={},d.movementState=-1,d.onTracks=!1,d.getOffTrack=!1,o.getIsDirectPlayerControl()?(d.moveDelayMin=0,d.moveDelayMax=0):(d.moveDelayMin=30,d.moveDelayMax=200),d}return a(t,e),t.prototype.canPlaceBlockOver=function(e,t){var o={canPlace:!1,plane:""};return t.getIsLiquid()?(o.canPlace=!0,o.plane="groundPlane"):(o.canPlace=!0,o.plane="actionPlane"),"cropWheat"===e.blockType&&(o.canPlace="farmlandWet"===t.blockType),o},t.prototype.canPlaceBlock=function(e){return e.isEmpty},t.prototype.shouldUpdateSelectionIndicator=function(){return!0},t.prototype.setMovePosition=function(t){e.prototype.setMovePosition.call(this,t),this.collectItems(this.position)},t.prototype.walkableCheck=function(e){this.isOnBlock=!e.isWalkable},t.prototype.updateMovement=function(){var e=this;this.controller.attemptRunning&&this.controller.getIsDirectPlayerControl()&&(this.onTracks&&this.collectItems(this.position),this.canUpdateMovement()&&(this.movementState>=0?function(){var t=e.movementState,o=new l(e,function(){},function(){e.lastMovement=+new Date,e.controller.moveDirection(o,t)},e.identifier);e.addCommand(o)}():function(){var t=new l(e,function(){},function(){e.lastMovement=+new Date,e.controller.use(t)},e.identifier);e.addCommand(t)}()))},t.prototype.canUpdateMovement=function(){var e=this.queue.isFinished()||!this.queue.isStarted(),t=-1!==this.movementState,o=this.queue.currentCommand&&0===this.queue.getLength(),i=+new Date-this.lastMovement,n=i>300;return t&&i>800&&(this.getOffTrack=!0),!this.onTracks&&(e||o&&n)&&t},t.prototype.doMoveForward=function(e){var t,o,i=this,n=this,a=this.controller.levelModel,r=this.controller.levelView,s=n.isOnBlock,l=this.position;a.moveForward(),o=s&&s!==n.isOnBlock,t=n.isOnBlock||o?a.actionPlane.getBlockAt(n.position).blockType:a.groundPlane.getBlockAt(n.position).blockType,r.playMoveForwardAnimation(n,l,n.facing,o,n.isOnBlock,t,function(){r.playIdleAnimation(n.position,n.facing,n.isOnBlock),a.isPlayerStandingInWater()?r.playDrownFailureAnimation(n.position,n.facing,n.isOnBlock,function(){i.controller.handleEndState(!1)}):a.isPlayerStandingInLava()?r.playBurnInLavaAnimation(n.position,n.facing,n.isOnBlock,function(){i.controller.handleEndState(!1)}):i.controller.delayPlayerMoveBy(i.moveDelayMin,i.moveDelayMax,function(){e.succeeded()})}),this.updateHidingTree(),this.updateHidingBlock(l)},t.prototype.doMoveBackward=function(e){var t,o,i=this,n=this,a=this.controller.levelModel,r=this.controller.levelView,s=n.isOnBlock,l=this.position;a.moveBackward(this),o=s&&s!==n.isOnBlock,t=(n.isOnBlock,a.actionPlane.getBlockAt(n.position).blockType),r.playMoveBackwardAnimation(n,l,n.facing,o,n.isOnBlock,t,function(){r.playIdleAnimation(n.position,n.facing,n.isOnBlock,n),a.isPlayerStandingInWater()?r.playDrownFailureAnimation(n.position,n.facing,n.isOnBlock,function(){i.controller.handleEndState(!1)}):a.isPlayerStandingInLava()?r.playBurnInLavaAnimation(n.position,n.facing,n.isOnBlock,function(){i.controller.handleEndState(!1)}):i.controller.delayPlayerMoveBy(i.moveDelayMin,i.moveDelayMax,function(){e.succeeded()})}),this.updateHidingTree(),this.updateHidingBlock(l)},t.prototype.bump=function(e){var t=this,o=this.controller.levelView,i=this.controller.levelModel;o.playBumpAnimation(this.position,this.facing,!1);var n=this.controller.levelEntity.getEntityAt(i.getMoveForwardPosition(this));if(null!==n){if(this.controller.levelEntity.isFriendlyEntity(n.type)){var a;!function(){var e=t.facing;a=new l(t,function(){},function(){n.pushBack(a,e,250)},n.identifier),n.queue.startPushHighPriorityCommands(),n.addCommand(a),n.queue.endPushHighPriorityCommands()}()}}this.controller.delayPlayerMoveBy(200,400,function(){e.succeeded()})},t.prototype.collectItems=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.position,t=this.controller.levelView.collectibleItems,o=0;o<t.length;o++){var i=r(t[o],4),n=i[0],a=i[1],s=i[2],l=i[3];if(null===n)t.splice(o,1);else{var p=this.controller.levelModel.spritePositionToIndex(a,new c(n.x,n.y));c.absoluteDistanceSquare(e,p)<l&&(this.controller.levelView.playItemAcquireAnimation(this.position,this.facing,n,function(){},s),t.splice(o,1))}}},t.prototype.takeDamage=function(e){var t=this,o=this.controller.levelView.getDirectionName(this.facing);this.healthPoint--,this.healthPoint>0?(this.controller.levelView.playScaledSpeed(this.sprite.animations,"hurt"+o),e.succeeded()):(this.sprite.animations.stop(null,!0),this.controller.levelView.playFailureAnimation(this.position,this.facing,this.isOnBlock,function(){e.failed(),t.controller.handleEndState(!1)}))},t.prototype.canTriggerPressurePlates=function(){return!0},t}(s)},2715:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794),s=o(1016);e.exports=function(e){function t(o,a,r,s,l,c,p){i(this,t);var d=n(this,e.call(this,o,a,"PlayerAgent",r,s,p));return d.offset=[-16,-15],d.name=l,d.isOnBlock=c,d.inventory={},d.movementState=-1,d.moveDelayMin=20,d.moveDelayMax=150,d}return a(t,e),t.prototype.canPlaceBlockOver=function(e,t){var o={canPlace:!1,plane:""};return t.getIsLiquid()?e.getIsPlaceableInLiquid()&&(o.canPlace=!0,o.plane="groundPlane"):e.isWalkable&&(o.canPlace=!0,o.plane="actionPlane"),o},t.prototype.canPlaceBlock=function(e){return e.isEmpty},t.prototype.canMoveThrough=function(){return!0},t.prototype.getSortOrderOffset=function(){return e.prototype.getSortOrderOffset.call(this)-1},t.prototype.updateMovement=function(){var e=this;if(this.controller.attemptRunning&&this.controller.getIsDirectPlayerControl()){var t=this.queue.isFinished()||!this.queue.isStarted(),o=-1!==this.movementState,i=this.queue.currentCommand&&0===this.queue.getLength(),n=+new Date-this.lastMovement,a=n>300;(t||i&&a)&&o&&(this.movementState>=0?function(){var t=e.movementState,o=new s(e,function(){},function(){e.lastMovement=+new Date,e.controller.moveDirection(o,t)},e.identifier);e.addCommand(o)}():function(){var t=new s(e,function(){},function(){e.lastMovement=+new Date,e.controller.use(t)},e.identifier);e.addCommand(t)}())}},t.prototype.doMove=function(e,t){var o=this,i=void 0,n=this.controller.levelModel,a=this.controller.levelView,r=this.isOnBlock,s=this.position;n["move"+t](this);var l=r&&r!==this.isOnBlock;i=this.isOnBlock||l?n.actionPlane.getBlockAt(this.position).blockType:n.groundPlane.getBlockAt(this.position).blockType,a["playMove"+t+"Animation"](this,s,this.facing,l,this.isOnBlock,i,function(){a.playIdleAnimation(o.position,o.facing,o.isOnBlock,o),o.controller.delayPlayerMoveBy(o.moveDelayMin,o.moveDelayMax,function(){e.succeeded()})}),this.updateHidingTree(),this.updateHidingBlock(s)},t.prototype.doMoveForward=function(e){this.doMove(e,"Forward")},t.prototype.doMoveBackward=function(e){this.doMove(e,"Backward")},t.prototype.bump=function(e){var t=this,o=this.controller.levelView,i=this.controller.levelModel;o.playBumpAnimation(this.position,this.facing,!1,this);var n=this.controller.levelEntity.getEntityAt(i.getMoveForwardPosition(this));if(null!==n){if(this.controller.levelEntity.isFriendlyEntity(n.type)){var a;!function(){var e=t.facing;a=new s(t,function(){},function(){n.pushBack(a,e,250)},n.identifier),n.queue.startPushHighPriorityCommands(),n.addCommand(a),n.queue.endPushHighPriorityCommands()}()}}this.controller.delayPlayerMoveBy(200,400,function(){e.succeeded()})},t.prototype.takeDamage=function(e){var t=this,o=this.controller.levelView.getDirectionName(this.facing);this.healthPoint--,this.healthPoint>0?(this.controller.levelView.playScaledSpeed(this.sprite.animations,"hurt"+o),e.succeeded()):(this.sprite.animations.stop(null,!0),this.controller.levelView.playFailureAnimation(this.position,this.facing,this.isOnBlock,function(){e.failed(),t.controller.handleEndState(!1)}))},t.prototype.hasPermissionToWalk=function(e){return e.isWalkable},t.prototype.canTriggerPressurePlates=function(){return!0},t}(r)},2716:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){var o=[],i=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=o(1271),r=o(799),s=o(838),l=o(2717).createEvent,c=o(1272).randomInt;e.exports=function(){function e(t){i(this,e),this.controller=t,this.audioPlayer=t.audioPlayer,this.game=t.game,this.baseShading=null,this.player=null,this.agent=null,this.selectionIndicator=null,this.groundGroup=null,this.shadingGroup=null,this.actionGroup=null,this.fluffGroup=null,this.fowGroup=null,this.collectibleItems=[],this.trees=[],this.miniBlocks={dirt:["Miniblocks",0,5],dirtCoarse:["Miniblocks",6,11],sand:["Miniblocks",12,17],gravel:["Miniblocks",18,23],bricks:["Miniblocks",24,29],logAcacia:["Miniblocks",30,35],logBirch:["Miniblocks",36,41],logJungle:["Miniblocks",42,47],logOak:["Miniblocks",48,53],logSpruce:["Miniblocks",54,59],logSpruceSnowy:["Miniblocks",54,59],planksAcacia:["Miniblocks",60,65],planksBirch:["Miniblocks",66,71],planksJungle:["Miniblocks",72,77],planksOak:["Miniblocks",78,83],planksSpruce:["Miniblocks",84,89],cobblestone:["Miniblocks",90,95],sandstone:["Miniblocks",96,101],wool:["Miniblocks",102,107],redstoneDust:["Miniblocks",108,113],lapisLazuli:["Miniblocks",114,119],ingotIron:["Miniblocks",120,125],ingotGold:["Miniblocks",126,131],emerald:["Miniblocks",132,137],diamond:["Miniblocks",138,143],coal:["Miniblocks",144,149],bucketWater:["Miniblocks",150,155],bucketLava:["Miniblocks",156,161],gunPowder:["Miniblocks",162,167],wheat:["Miniblocks",168,173],potato:["Miniblocks",174,179],carrots:["Miniblocks",180,185],milk:["Miniblocks",186,191],egg:["Miniblocks",192,197],poppy:["Miniblocks",198,203],daisy:["Miniblocks",204,209],dandelion:["Miniblocks",210,215],bed:["Miniblocks",216,221],cactus:["Miniblocks",222,227],clay:["Miniblocks",228,233],deadbush:["Miniblocks",234,239],doorIron:["Miniblocks",240,245],doorOak:["Miniblocks",246,251],glowstoneDust:["Miniblocks",252,257],hardenedClay:["Miniblocks",258,263],hardenedClayBlack:["Miniblocks",264,269],hardenedClayBlue:["Miniblocks",270,275],hardenedClayBrown:["Miniblocks",276,281],hardenedClayCyan:["Miniblocks",282,287],hardenedClayGray:["Miniblocks",288,293],hardenedClayGreen:["Miniblocks",294,299],hardenedClayLightBlue:["Miniblocks",300,305],hardenedClayLime:["Miniblocks",306,311],hardenedClayMagenta:["Miniblocks",312,317],hardenedClayOrange:["Miniblocks",318,323],hardenedClayPink:["Miniblocks",324,329],hardenedClayPurple:["Miniblocks",330,335],hardenedClayRed:["Miniblocks",336,341],hardenedClaySilver:["Miniblocks",342,347],hardenedClayWhite:["Miniblocks",348,353],hardenedClayYellow:["Miniblocks",354,359],netherbrick:["Miniblocks",360,365],netherrack:["Miniblocks",366,371],obsidian:["Miniblocks",372,377],piston:["Miniblocks",378,383],pressurePlateOak:["Miniblocks",384,389],netherQuartz:["Miniblocks",390,395],railGolden:["Miniblocks",396,401],railNormal:["Miniblocks",402,407],redstoneTorch:["Miniblocks",408,413],reeds:["Miniblocks",414,419],seedsWheat:["Miniblocks",420,425],snow:["Miniblocks",426,431],snowBall:["Miniblocks",432,437],woolBlack:["Miniblocks",438,443],woolBlue:["Miniblocks",444,449],woolBrown:["Miniblocks",450,455],woolCyan:["Miniblocks",456,461],woolGray:["Miniblocks",462,467],woolGreen:["Miniblocks",468,473],woolLightBlue:["Miniblocks",474,479],woolLime:["Miniblocks",480,485],woolMagenta:["Miniblocks",486,491],woolOrange:["Miniblocks",492,497],woolPink:["Miniblocks",498,503],woolLPurple:["Miniblocks",504,509],woolRed:["Miniblocks",510,515],woolSilver:["Miniblocks",516,521],woolYellow:["Miniblocks",522,527],bookEnchanted:["Miniblocks",528,533],bucketEmpty:["Miniblocks",534,539],chest:["Miniblocks",540,545],compass:["Miniblocks",546,551],axeDiamond:["Miniblocks",552,557],pickaxeDiamond:["Miniblocks",558,563],shovelDiamond:["Miniblocks",564,569],flintAndSteel:["Miniblocks",570,575],flint:["Miniblocks",576,581],mapEmpty:["Miniblocks",582,587],minecart:["Miniblocks",588,593],potionBottleDrinkable:["Miniblocks",594,599]},this.blocks={bedrock:["blocks","Bedrock",-13,0],bricks:["blocks","Bricks",-13,0],oreCoal:["blocks","Coal_Ore",-13,0],dirtCoarse:["blocks","Coarse_Dirt",-13,0],cobblestone:["blocks","Cobblestone",-13,0],oreDiamond:["blocks","Diamond_Ore",-13,0],dirt:["blocks","Dirt",-13,0],oreEmerald:["blocks","Emerald_Ore",-13,0],farmlandWet:["blocks","Farmland_Wet",-13,0],flowerDandelion:["blocks","Flower_Dandelion",-13,0],flowerOxeeye:["blocks","Flower_Oxeeye",-13,0],flowerRose:["blocks","Flower_Rose",-13,0],glass:["blocks","Glass",-13,0],oreGold:["blocks","Gold_Ore",-13,0],grass:["blocks","Grass",-13,0],gravel:["blocks","Gravel",-13,0],oreIron:["blocks","Iron_Ore",-13,0],oreLapis:["blocks","Lapis_Ore",-13,0],lava:["blocks","Lava_0",-13,0],logAcacia:["blocks","Log_Acacia",-13,0],logBirch:["blocks","Log_Birch",-13,0],logJungle:["blocks","Log_Jungle",-13,0],logOak:["blocks","Log_Oak",-13,0],logSpruce:["blocks","Log_Spruce",-13,0],logSpruceSnowy:["blocks","Log_Spruce",-13,0],obsidian:["blocks","Obsidian",-13,0],planksAcacia:["blocks","Planks_Acacia",-13,0],planksBirch:["blocks","Planks_Birch",-13,0],planksJungle:["blocks","Planks_Jungle",-13,0],planksOak:["blocks","Planks_Oak",-13,0],planksSpruce:["blocks","Planks_Spruce",-13,0],oreRedstone:["blocks","Redstone_Ore",-13,0],sand:["blocks","Sand",-13,0],sandstone:["blocks","Sandstone",-13,0],stone:["blocks","Stone",-13,0],tnt:["tnt","TNTexplosion0",-80,-58],water:["blocks","Water_0",-13,0],wool:["blocks","Wool_White",-13,0],wool_orange:["blocks","Wool_Orange",-13,0],wool_black:["blocks","Wool_Black",-13,0],wool_blue:["blocks","Wool_Blue",-13,0],wool_brown:["blocks","Wool_Brown",-13,0],wool_cyan:["blocks","Wool_Cyan",-13,0],wool_gray:["blocks","Wool_Gray",-13,0],wool_green:["blocks","Wool_Green",-13,0],wool_light_blue:["blocks","Wool_LightBlue",-13,0],wool_lime:["blocks","Wool_Lime",-13,0],wool_magenta:["blocks","Wool_Magenta",-13,0],wool_pink:["blocks","Wool_Pink",-13,0],wool_purple:["blocks","Wool_Purple",-13,0],wool_red:["blocks","Wool_Red",-13,0],wool_silver:["blocks","Wool_Silver",-13,0],wool_yellow:["blocks","Wool_Yellow",-13,0],leavesAcacia:["leavesAcacia","Leaves_Acacia0.png",-100,0],leavesBirch:["leavesBirch","Leaves_Birch0.png",-100,0],leavesJungle:["leavesJungle","Leaves_Jungle0.png",-100,0],leavesOak:["leavesOak","Leaves_Oak0.png",-100,0],leavesSpruce:["leavesSpruce","Leaves_Spruce0.png",-100,0],leavesSpruceSnowy:["leavesSpruceSnowy","Leaves_SpruceSnowy0.png",-100,36],watering:["blocks","Water_0",-13,0],cropWheat:["blocks","Wheat0",-13,0],torch:["torch","Torch0",-13,0],tallGrass:["tallGrass","",-13,0],lavaPop:["lavaPop","LavaPop01",-13,0],redstoneSparkle:["redstoneSparkle","redstone_sparkle1.png",7,23],fire:["fire","",-11,135],bubbles:["bubbles","",-11,135],explosion:["explosion","",-70,60],door:["door","",-12,-15],doorIron:["doorIron","",-12,-15],rails:["blocks","Rails_Vertical",-13,-0],railsNorthEast:["blocks","Rails_BottomLeft",-13,0],railsNorthWest:["blocks","Rails_BottomRight",-13,0],railsEast:["blocks","Rails_Horizontal",-13,0],railsWest:["blocks","Rails_Horizontal",-13,0],railsEastWest:["blocks","Rails_Horizontal",-13,0],railsSouthEast:["blocks","Rails_TopLeft",-13,0],railsSouthWest:["blocks","Rails_TopRight",-13,0],railsNorth:["blocks","Rails_Vertical",-13,-0],railsSouth:["blocks","Rails_Vertical",-13,-0],railsNorthSouth:["blocks","Rails_Vertical",-13,-0],railsUnpowered:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredNorth:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredSouth:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredNorthSouth:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredEast:["blocks","Rails_UnpoweredHorizontal",-13,0],railsUnpoweredWest:["blocks","Rails_UnpoweredHorizontal",-13,0],railsUnpoweredEastWest:["blocks","Rails_UnpoweredHorizontal",-13,0],railsPowered:["blocks","Rails_PoweredVertical",-13,0],railsPoweredNorth:["blocks","Rails_PoweredVertical",-13,0],railsPoweredSouth:["blocks","Rails_PoweredVertical",-13,0],railsPoweredNorthSouth:["blocks","Rails_PoweredVertical",-13,0],railsPoweredEast:["blocks","Rails_PoweredHorizontal",-13,0],railsPoweredWest:["blocks","Rails_PoweredHorizontal",-13,0],railsPoweredEastWest:["blocks","Rails_PoweredHorizontal",-13,0],railsRedstoneTorch:["blocks","Rails_RedstoneTorch",-12,9],redstoneWire:["blocks","redstone_dust_dot_off",-13,0],redstoneWireHorizontal:["blocks","redstone_dust_line_h_off",-13,0],redstoneWireVertical:["blocks","redstone_dust_line_v_off",-13,0],redstoneWireUpRight:["blocks","redstone_dust_corner_BottomLeft_off",-13,0],redstoneWireUpLeft:["blocks","redstone_dust_corner_BottomRight_off",-13,0],redstoneWireDownRight:["blocks","redstone_dust_corner_TopLeft_off",-13,0],redstoneWireDownLeft:["blocks","redstone_dust_corner_TopRight_off",-13,0],redstoneWireTUp:["blocks","redstone_dust_cross_up_off",-13,0],redstoneWireTDown:["blocks","redstone_dust_cross_down_off",-13,0],redstoneWireTLeft:["blocks","redstone_dust_cross_left_off",-13,0],redstoneWireTRight:["blocks","redstone_dust_cross_right_off",-13,0],redstoneWireCross:["blocks","redstone_dust_cross_off",-13,0],redstoneWireOn:["blocks","redstone_dust_dot",-13,0],redstoneWireHorizontalOn:["blocks","redstone_dust_line_h",-13,0],redstoneWireVerticalOn:["blocks","redstone_dust_line_v",-13,0],redstoneWireUpRightOn:["blocks","redstone_dust_corner_BottomLeft",-13,0],redstoneWireUpLeftOn:["blocks","redstone_dust_corner_BottomRight",-13,0],redstoneWireDownRightOn:["blocks","redstone_dust_corner_TopLeft",-13,0],redstoneWireDownLeftOn:["blocks","redstone_dust_corner_TopRight",-13,0],redstoneWireTUpOn:["blocks","redstone_dust_cross_up",-13,0],redstoneWireTDownOn:["blocks","redstone_dust_cross_down",-13,0],redstoneWireTLeftOn:["blocks","redstone_dust_cross_left",-13,0],redstoneWireTRightOn:["blocks","redstone_dust_cross_right",-13,0],redstoneWireCrossOn:["blocks","redstone_dust_cross",-13,0],pressurePlateUp:["blocks","PressurePlate_Up",-13,0],pressurePlateDown:["blocks","PressurePlate_Down",-13,0],pistonUp:["blocks","piston_up",-13,0],pistonDown:["blocks","piston_down",-13,0],pistonLeft:["blocks","piston_left",-13,0],pistonRight:["blocks","piston_right",-13,0],pistonUpOn:["blocks","piston_base_up",-26,-13],pistonDownOn:["blocks","piston_base_down",-26,-13],pistonLeftOn:["blocks","piston_base_left",-26,-13],pistonRightOn:["blocks","piston_base_right",-26,-13],pistonArmLeft:["blocks","piston_arm_left",-26,-13],pistonArmRight:["blocks","piston_arm_right",-26,-13],pistonArmUp:["blocks","piston_arm_up",-26,-13],pistonArmDown:["blocks","piston_arm_down",-26,-13],pistonUpSticky:["blocks","piston_up",-13,0],pistonDownSticky:["blocks","piston_down_sticky",-13,0],pistonLeftSticky:["blocks","piston_left",-13,0],pistonRightSticky:["blocks","piston_right",-13,0],pistonUpOnSticky:["blocks","piston_base_up",-26,-13],pistonDownOnSticky:["blocks","piston_base_down_sticky",-26,-13],pistonLeftOnSticky:["blocks","piston_base_left",-26,-13],pistonRightOnSticky:["blocks","piston_base_right",-26,-13],pistonArmLeftSticky:["blocks","piston_arm_left",-26,-13],pistonArmRightSticky:["blocks","piston_arm_right",-26,-13],pistonArmUpSticky:["blocks","piston_arm_up",-26,-13],pistonArmDownSticky:["blocks","piston_arm_down_sticky",-26,-13],cactus:["blocks","cactus",-13,0],deadBush:["blocks","dead_bush",-13,0],glowstone:["blocks","glowstone",-13,0],grassPath:["blocks","grass_path",-13,0],ice:["blocks","ice",-13,0],netherrack:["blocks","netherrack",-13,0],netherBrick:["blocks","nether_brick",-13,0],quartzOre:["blocks","quartz_ore",-13,0],snow:["blocks","snow",-13,0],snowyGrass:["blocks","snowy_grass",-13,0],topSnow:["blocks","top_snow",-13,0],Nether_Portal:["blocks","Nether_Portal0",0,-58],bedFoot:["blocks","Bed_Foot",-13,0],bedHead:["blocks","Bed_Head",-13,10],clay:["blocks","Clay",-13,0],glassBlack:["blocks","Glass_Black",-13,0],glassBlue:["blocks","Glass_Blue",-13,0],glassBrown:["blocks","Glass_Brown",-13,0],glassCyan:["blocks","Glass_Cyan",-13,0],glassGray:["blocks","Glass_Gray",-13,0],glassGreen:["blocks","Glass_Green",-13,0],glassLightBlue:["blocks","Glass_LightBlue",-13,0],glassLime:["blocks","Glass_Lime",-13,0],glassMagenta:["blocks","Glass_Magenta",-13,0],glassOrange:["blocks","Glass_Orange",-13,0],glassPink:["blocks","Glass_Pink",-13,0],glassPurple:["blocks","Glass_Purple",-13,0],glassRed:["blocks","Glass_Red",-13,0],glassSilver:["blocks","Glass_Silver",-13,0],glassWhite:["blocks","Glass_White",-13,0],glassYellow:["blocks","Glass_Yellow",-13,0],terracotta:["blocks","Terracotta",-13,0],terracottaBlack:["blocks","Terracotta_Black",-13,0],terracottaBlue:["blocks","Terracotta_Blue",-13,0],terracottaBrown:["blocks","Terracotta_Brown",-13,0],terracottaCyan:["blocks","Terracotta_Cyan",-13,0],terracottaGray:["blocks","Terracotta_Gray",-13,0],terracottaGreen:["blocks","Terracotta_Green",-13,0],terracottaLightBlue:["blocks","Terracotta_LightBlue",-13,0],terracottaLime:["blocks","Terracotta_Lime",-13,0],terracottaMagenta:["blocks","Terracotta_Magenta",-13,0],terracottaOrange:["blocks","Terracotta_Orange",-13,0],terracottaPink:["blocks","Terracotta_Pink",-13,0],terracottaPurple:["blocks","Terracotta_Purple",-13,0],terracottaRed:["blocks","Terracotta_Red",-13,0],terracottaSilver:["blocks","Terracotta_Silver",-13,0],terracottaWhite:["blocks","Terracotta_White",-13,0],terracottaYellow:["blocks","Terracotta_Yellow",-13,0],invisible:["blocks","Invisible",0,0]},this.actionPlaneBlocks=[],this.toDestroy=[],this.resettableTweens=[],this.treeFluffTypes={treeAcacia:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2]],treeBirch:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3]],treeJungle:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3],[1,-3]],treeOak:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[0,-3]],treeSpruce:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3]],treeSpruceSnowy:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3]]}}return e.prototype.yToIndex=function(e){return this.controller.levelModel.yToIndex(e)},e.prototype.create=function(e){this.createGroups(),this.reset(e)},e.prototype.resetEntity=function(e){this.preparePlayerSprite(e.name,e),e.sprite.animations.stop(),this.setPlayerPosition(e.position,e.isOnBlock,e),e.shouldUpdateSelectionIndicator()&&(this.setSelectionIndicatorPosition(e.position[0],e.position[1]),this.selectionIndicator.visible=!0),this.playIdleAnimation(e.position,e.facing,e.isOnBlock,e)},e.prototype.reset=function(e){this.player=e.player,this.agent=e.agent,this.resettableTweens.forEach(function(e){e.stop(!1)}),this.resettableTweens.length=0,this.collectibleItems=[],this.trees=[],this.resetGroups(e),e.usePlayer&&(this.resetEntity(this.player),e.usingAgent&&this.resetEntity(this.agent)),this.updateShadingGroup(e.shadingPlane),this.updateFowGroup(e.fowPlane),this.controller.followingPlayer()?(this.game.world.setBounds(0,0,40*e.planeWidth,40*e.planeHeight),this.game.camera.follow(this.player.sprite),this.game.world.scale.x=1,this.game.world.scale.y=1):this.game.world.setBounds(0,0,400,400)},e.prototype.update=function(){var e;for(e=0;e<this.toDestroy.length;++e)this.toDestroy[e].destroy();this.toDestroy=[]},e.prototype.render=function(){this.actionGroup.sort("sortOrder"),this.fluffGroup.sort("z")},e.prototype.scaleShowWholeWorld=function(e){var t=this.controller.scaleFromOriginal(),o=n(t,2),i=o[0],a=o[1],r=this.addResettableTween(this.game.world.scale).to({x:1/i,y:1/a},1e3,Phaser.Easing.Exponential.Out);this.game.camera.unfollow();var s=this.addResettableTween(this.game.camera).to({x:0,y:0},1e3,Phaser.Easing.Exponential.Out);r.onComplete.addOnce(function(){e()}),s.start(),r.start()},e.prototype.getDirectionName=function(e){return"_"+r.directionToRelative(e).toLowerCase()},e.prototype.updatePlayerDirection=function(e,t){var o=this.getDirectionName(t);this.setSelectionIndicatorPosition(e[0],e[1]),this.playScaledSpeed(this.player.sprite.animations,"idle"+o)},e.prototype.playDoorAnimation=function(e,t,o){var i=this.yToIndex(e[1])+e[0],n=this.actionPlaneBlocks[i],a=t?"open":"close",r=this.playScaledSpeed(n.animations,a);this.onAnimationEnd(r,function(){r.updateCurrentFrame(),o()})},e.prototype.playPlayerAnimation=function(e,t,o){var i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player),n=this.getDirectionName(o);i.sprite.sortOrder=this.yToIndex(t[1])+i.getSortOrderOffset();var a=e+n;return this.playScaledSpeed(i.sprite.animations,a)},e.prototype.playIdleAnimation=function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.player;this.playPlayerAnimation("idle",e,t,o,i)},e.prototype.playSuccessAnimation=function(e,t,o,i){var n=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.controller.delayBy(250,function(){n.audioPlayer.play("success"),n.onAnimationEnd(n.playPlayerAnimation("celebrate",e,t,o,a),function(){i()})})},e.prototype.playFailureAnimation=function(e,t,o,i){var n=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.controller.delayBy(500,function(){n.audioPlayer.play("failure"),n.onAnimationEnd(n.playPlayerAnimation("fail",e,t,o,a),function(){n.controller.delayBy(800,i)})})},e.prototype.playBumpAnimation=function(e,t,o){var i=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.player,a=this.playPlayerAnimation("bump",e,t,o,n);return a.onComplete.add(function(){i.playIdleAnimation(e,t,o,n)}),a},e.prototype.playDrownFailureAnimation=function(e,t,o,i){var a,r;this.playPlayerAnimation("fail",e,t,o),this.createBlock(this.fluffGroup,e[0],e[1],"bubbles"),a=this.fluffGroup.create(0,0,"finishOverlay");var s=this.controller.scaleFromOriginal(),l=n(s,2),c=l[0],p=l[1];a.scale.x=c,a.scale.y=p,a.alpha=0,a.tint=3296255,r=this.addResettableTween(a).to({alpha:.5},200,Phaser.Easing.Linear.None),r.onComplete.add(function(){i()}),r.start()},e.prototype.playBurnInLavaAnimation=function(e,t,o,i){var a,r;this.playPlayerAnimation("jumpUp",e,t,o),this.createBlock(this.fluffGroup,e[0],e[1],"fire"),a=this.fluffGroup.create(0,0,"finishOverlay");var s=this.controller.scaleFromOriginal(),l=n(s,2),c=l[0],p=l[1];a.scale.x=c,a.scale.y=p,a.alpha=0,a.tint=13719565,r=this.addResettableTween(a).to({alpha:.5},200,Phaser.Easing.Linear.None),r.onComplete.add(function(){i()}),r.start()},e.prototype.playDestroyTntAnimation=function(e,t,o,i,n,a){var r,s,l=this;if(0===i.length)return void a();this.audioPlayer.play("fuse");for(var c in i)r=this.actionPlaneBlocks[this.coordinatesToIndex(i[c])],s=this.playScaledSpeed(r.animations,"explode");this.onAnimationEnd(s,function(){l.audioPlayer.play("explode"),a()})},e.prototype.playCreeperExplodeAnimation=function(e,t,o,i,n){var a=this;this.controller.delayBy(180,function(){a.playPlayerAnimation("bump",e,t,!1).onComplete.add(function(){a.audioPlayer.play("fuse"),a.playExplodingCreeperAnimation(e,t,o,i,n,a),a.controller.delayBy(200,function(){a.onAnimationLoopOnce(a.playPlayerAnimation("jumpUp",e,t,!1),function(){a.playIdleAnimation(e,t,i)})})})})},e.prototype.flashEntity=function(e){return this.flashSpriteToWhite(e.sprite)},e.prototype.flashBlock=function(e){var t=this.yToIndex(e[1])+e[0],o=this.actionPlaneBlocks[t];return this.flashSpriteToWhite(o)},e.prototype.flashSpriteToWhite=function(e){var t=this.game.add.bitmapData(e.width,e.height);t.fill(255,255,255,255);var o=this.game.add.bitmapData(e.width,e.height),i={x:0,y:0,width:e.width,height:e.height},n={x:0,y:0,width:e.texture.crop.width,height:e.texture.crop.height};o.alphaMask(t,e,i,n);var a=e.addChild(this.game.make.sprite(0,0,o.texture));a.alpha=0;var r=0,s={alpha:1},l={alpha:0},c=this.game.add.tween(a).to(s,60,Phaser.Easing.Linear.None),p=this.game.add.tween(a).to(l,60,Phaser.Easing.Linear.None);r=120,c.chain(p);for(var d=p,u=0;u<2;u++){var h=this.game.add.tween(a).to(l,240,Phaser.Easing.Linear.None),f=this.game.add.tween(a).to(s,60,Phaser.Easing.Linear.None),m=this.game.add.tween(a).to(l,60,Phaser.Easing.Linear.None);r+=360,d.chain(h),h.chain(f),f.chain(m),d=m}return d.onComplete.add(function(){a.destroy()}),c.start(),2*r},e.prototype.playExplodingCreeperAnimation=function(e,t,o,i,n){var a=this,r=this.yToIndex(o[1])+o[0],s=this.actionPlaneBlocks[r],l=s.animations.getAnimation("explode");l.onComplete.add(function(){s.kill(),a.playExplosionAnimation(e,t,o,i,function(){a.controller.delayBy(100,function(){a.playFailureAnimation(e,t,!1,n)})},!1),a.audioPlayer.play("explode"),a.playExplosionCloudAnimation(o)}),l.play()},e.prototype.playExplosionCloudAnimation=function(e){this.createBlock(this.fluffGroup,e[0],e[1],"explosion")},e.prototype.coordinatesToIndex=function(e){return this.yToIndex(e[1])+e[0]},e.prototype.playMinecartTurnAnimation=function(e,t,o,i,n){var a=t?r.North:r.South;return this.playPlayerAnimation("mineCart_turn"+n,e,a,!1)},e.prototype.playMinecartMoveForwardAnimation=function(e,t,o,i,n,a){var r;return this.audioPlayer.play("minecart"),this.playPlayerAnimation("mineCart",e,t,!1),r=this.addResettableTween(this.player.sprite).to(this.positionToScreen(n),a,Phaser.Easing.Linear.None),r.start(),this.player.sprite.sortOrder=this.yToIndex(n[1])+10,r},e.prototype.playMinecartAnimation=function(e,t){var o=this,i=new s(3,2);this.setPlayerPosition(i,e),this.player.facing=2;var n=this.playLevelEndAnimation(i,this.player.facing,e,t,!1);this.game.world.setBounds(0,0,440,400),this.game.camera.follow(this.player.sprite),n.onComplete.add(function(){o.playTrack(i,o.player.facing,e,o.player,t)})},e.prototype.playTrack=function(e,t,o){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.player,l=arguments[4];a.onTracks=!0;var c=this.controller.levelModel.actionPlane.getMinecartTrack(e,t),p=s.forward(a.position,t);if(a.getOffTrack||!c&&!this.isFirstTimeOnRails(e,p))return a.getOffTrack=!1,a.onTracks=!1,void(l&&l());if(void 0===c&&void 0===(c=this.controller.levelModel.actionPlane.getMinecartTrack(p,t)))return a.getOffTrack=!1,a.onTracks=!1,void(l&&l());var d=void 0,u=c,h=n(u,4),f=h[0],m=h[1],g=h[2],y=h[3];if(this.player.position=m,"turn"===f.substring(0,4)){d=f.substring(5);var v=t===r.North||g===r.North;this.onAnimationEnd(this.playMinecartTurnAnimation(e,v,o,l,d),function(){i.playTrack(m,g,o,a,l)})}else this.onAnimationEnd(this.playMinecartMoveForwardAnimation(e,t,o,l,m,y),function(){i.playTrack(m,g,o,a,l)})},e.prototype.isFirstTimeOnRails=function(e,t){var o=this.controller.levelModel.actionPlane.getBlockAt(t),i=this.controller.levelModel.actionPlane.getBlockAt(e);return!(!o||!i||i.isRail||!o.isRail)},e.prototype.addHouseBed=function(e){var t=e[1]-1;this.actionGroup.create(38*e[0],35*t,"bed").sortOrder=this.yToIndex(e[1])},e.prototype.addDoor=function(e){var t,o=this.actionPlaneBlocks[this.coordinatesToIndex(e)];this.createActionPlaneBlock(e,"door"),t=this.createBlock(this.groundGroup,e[0],e[1],"wool_orange"),o.kill(),t.sortOrder=this.yToIndex(6)},e.prototype.playSuccessHouseBuiltAnimation=function(e,t,o,i,n,a,r){var s=this;this.playLevelEndAnimation(e,t,o,function(){s.controller.delayBy(4e3,a)},!0).onComplete.add(function(){s.audioPlayer.play("houseSuccess");for(var e,t,o,a=0;a<i.length;++a)e=i[a][1],t=i[a][2],o=s.createBlock(s.groundGroup,e,t,"wool_orange"),o.sortOrder=s.yToIndex(t);s.addHouseBed(n[0]),s.addDoor(n[1]),s.groundGroup.sort("sortOrder"),r()})},e.prototype.playLevelEndAnimation=function(e,t,o,i,a){var r,s,l,c=this;r=this.fluffGroup.create(0,0,"finishOverlay");var p=this.controller.scaleFromOriginal(),d=n(p,2),u=d[0],h=d[1];return r.scale.x=u,r.scale.y=h,r.alpha=0,s=this.tweenToWhite(r),l=this.tweenFromWhiteToClear(r),s.onComplete.add(function(){c.selectionIndicator.visible=!1,c.setPlayerPosition(e,o),l.start()}),a&&l.onComplete.add(function(){c.playSuccessAnimation(e,t,o,i)}),s.start(),s},e.prototype.tweenFromWhiteToClear=function(e){return this.addResettableTween(e).to({alpha:0},700,Phaser.Easing.Linear.None)},e.prototype.tweenToWhite=function(e){var t;return t=this.addResettableTween(e).to({alpha:1},300,Phaser.Easing.Linear.None),t},e.prototype.playBlockSound=function(e){var t=e.substring(0,3);"water"!==e&&"lava"!==e&&("stone"===e||"cobblestone"===e||"bedrock"===e||"ore"===t||"bricks"===e?this.audioPlayer.play("stepStone"):"grass"===e||"dirt"===e||"dirtCoarse"===e||"wool_orange"===e||"wool"===e?this.audioPlayer.play("stepGrass"):"gravel"===e?this.audioPlayer.play("stepGravel"):"farmlandWet"===e?this.audioPlayer.play("stepFarmland"):this.audioPlayer.play("stepWood"))},e.prototype.playMoveForwardAnimation=function(e,t,o,i,n,a,s){var l=e.position[1]+(o===r.North?1:0);this.playWalkAnimation(e,t,o,i,n,a,l,s)},e.prototype.playMoveBackwardAnimation=function(e,t,o,i,n,a,s){var l=e.position[1]+(o===r.South?1:0);this.playWalkAnimation(e,t,o,i,n,a,l,s)},e.prototype.playWalkAnimation=function(e,t,o,i,n,a,r,s){var l=this,c=void 0,p=e.position;if(this.playBlockSound(a),e.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(p[0],p[1]),i)c=this.playPlayerJumpDownVerticalAnimation(o,p,t);else{var d="walk"+this.getDirectionName(o);this.playScaledSpeed(e.sprite.animations,d),c=this.addResettableTween(e.sprite).to(this.positionToScreen(p,n,e),180,Phaser.Easing.Linear.None)}c.onUpdateCallback(function(t,o){o>=.75&&(e.sprite.sortOrder=l.yToIndex(r)+e.getSortOrderOffset(),t.onUpdateCallback(null))}),c.onComplete.add(function(){s()}),c.start()},e.prototype.playPlayerJumpDownVerticalAnimation=function(e,t){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n="jumpDown"+this.getDirectionName(e);this.playScaledSpeed(this.player.sprite.animations,n);var a=this.positionToScreen(i),r=this.positionToScreen(t),s=this.addResettableTween(this.player.sprite).to({x:[a.x,r.x,r.x],y:[a.y,r.y-50,r.y]},300,Phaser.Easing.Linear.None).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});return s.onComplete.addOnce(function(){o.audioPlayer.play("fall")}),s.start(),s},e.prototype.playPlaceBlockAnimation=function(e,t,o,i,n,r){var s,l=this,c=this.yToIndex(e[1])+e[0];if(n.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(e[0],e[1]),n===this.agent||a.isWalkable(o))var p=this.playPlayerAnimation("punch",e,t,!1,n).onComplete.add(function(){p.detach(),r()});else{this.audioPlayer.play("placeBlock");s="jumpUp"+this.getDirectionName(t),""!==i&&this.playExplosionAnimation(e,t,e,i,function(){},!1),this.playScaledSpeed(this.player.sprite.animations,s);var d=this.addResettableTween(this.player.sprite).to({y:40*e[1]-55},125,Phaser.Easing.Cubic.EaseOut);d.onComplete.addOnce(function(){d=null,""!==i&&l.actionPlaneBlocks[c].kill(),r()}),d.start()}},e.prototype.playPlaceBlockInFrontAnimation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1],o=arguments[2],i=arguments[3],n=arguments[4];this.setSelectionIndicatorPosition(i[0],i[1]),this.playPlayerAnimation("punch",t,o,!1,e).onComplete.addOnce(function(){n()})},e.prototype.correctForShadowOverlay=function(e,t){e.startsWith("piston")&&(t.sortOrder-=.1)},e.prototype.createActionPlaneBlock=function(e,t){var o=new a(t),i=this.yToIndex(e[1])+e[0];if(this.actionGroup.remove(this.actionPlaneBlocks[i]),this.groundGroup.remove(this.actionPlaneBlocks[i]),o.isEmpty)return void(this.actionPlaneBlocks[i]=null);var n=void 0;if(o.getIsMiniblock())n=this.createMiniBlock(e[0],e[1],t,{collectibleDistance:1,xOffsetRange:10,yOffsetRange:10});else{var r=o.shouldRenderOnGroundPlane()?this.groundGroup:this.actionGroup,s=o.shouldRenderOnGroundPlane()?-.5:0;n=this.createBlock(r,e[0],e[1]+s,t)}n&&(n.sortOrder=this.yToIndex(e[1]),this.correctForShadowOverlay(t,n)),this.actionPlaneBlocks[i]=n},e.prototype.playShearAnimation=function(e,t,o,i,n){var a=this,r=this.yToIndex(o[1])+o[0],s=this.actionPlaneBlocks[r];s.animations.stop(null,!0),this.onAnimationLoopOnce(this.playScaledSpeed(s.animations,"used"),function(){a.playScaledSpeed(s.animations,"face")}),this.playExplosionAnimation(e,t,o,i,n,!0)},e.prototype.playShearSheepAnimation=function(e,t,o,i,n){var a=this;this.setSelectionIndicatorPosition(o[0],o[1]),this.onAnimationEnd(this.playPlayerAnimation("punch",e,t,!1),function(){var r=a.yToIndex(o[1])+o[0],s=a.actionPlaneBlocks[r];s.animations.stop(null,!0),a.onAnimationLoopOnce(a.playScaledSpeed(s.animations,"used"),function(){a.playScaledSpeed(s.animations,"face")}),a.playExplosionAnimation(e,t,o,i,n,!0)})},e.prototype.destroyBlockWithoutPlayerInteraction=function(e){var t=this,o=this.yToIndex(e[1])+e[0],i=this.actionPlaneBlocks[o],n=this.actionGroup.create(40*e[0]-12,40*e[1]-22,"destroyOverlay","destroy1");n.sortOrder=this.yToIndex(e[1])+2,this.onAnimationEnd(n.animations.add("destroy",Phaser.Animation.generateFrameNames("destroy",1,12,"",0),30,!1),function(){t.actionPlaneBlocks[o]=null,i.hasOwnProperty("onBlockDestroy")&&i.onBlockDestroy(i),i.kill(),n.kill(),t.toDestroy.push(i),t.toDestroy.push(n),t.audioPlayer.play("dig_wood1")}),this.playScaledSpeed(n.animations,"destroy")},e.prototype.playDestroyBlockAnimation=function(e,t,o,i,n,a){n.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(o[0],o[1]);var r=void 0;r=n===this.agent?"punchDestroy":i.match(/(ore|stone|clay|bricks|bedrock)/)?"mine":"punchDestroy",this.playPlayerAnimation(r,e,t,!1,n),this.playMiningParticlesAnimation(t,o),this.playBlockDestroyOverlayAnimation(e,t,o,i,n,a)},e.prototype.playPunchDestroyAirAnimation=function(e,t,o,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.playPunchAnimation(e,t,o,"punchDestroy",i,n)},e.prototype.playPunchAirAnimation=function(e,t,o,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.playPunchAnimation(e,t,o,"punch",i,n)},e.prototype.playPunchAnimation=function(e,t,o,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.player;a.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(o[0],o[1]),this.onAnimationEnd(this.playPlayerAnimation(i,e,t,!1,a),function(){n()})},e.prototype.playBlockDestroyOverlayAnimation=function(e,t,o,i,n,r){var s=this,l=this.yToIndex(o[1])+o[0],c=this.actionPlaneBlocks[l],p=function(){c.hasOwnProperty("onBlockDestroy")&&c.onBlockDestroy(c),s.controller.levelModel.destroyBlockForward(n),s.controller.updateShadingPlane(),s.controller.updateFowPlane(),n.shouldUpdateSelectionIndicator()&&s.setSelectionIndicatorPosition(e[0],e[1]),s.audioPlayer.play("dig_wood1"),s.playExplosionAnimation(e,t,o,i,r,!0,n)};a.skipsDestructionOverlay(i)?p():function(){var e=s.actionGroup.create(40*o[0]-12,40*o[1]-22,"destroyOverlay","destroy1");if(a.isFlat(i)){var t=new Phaser.Rectangle(0,0,60,40);e.position.y+=20,e.crop(t)}e.sortOrder=s.yToIndex(o[1])+2,s.onAnimationEnd(e.animations.add("destroy",Phaser.Animation.generateFrameNames("destroy",1,12,"",0),30,!1),function(){e.kill(),s.toDestroy.push(e),p()}),s.playScaledSpeed(e.animations,"destroy")}()},e.prototype.playMiningParticlesAnimation=function(e,t){var o=this,i=[[24,-100,-80],[12,-120,-80],[0,-60,-80],[36,-80,-60]],n=this.getDirectionName(e),a="_left"===n?0:"_bottom"===n?1:"_right"===n?2:3,r=i[a][0],s=i[a][1],l=i[a][2],c=this.actionGroup.create(s+40*t[0],l+40*t[1],"miningParticles","MiningParticles"+r);c.sortOrder=this.yToIndex(t[1])+2,this.onAnimationEnd(c.animations.add("miningParticles",Phaser.Animation.generateFrameNames("MiningParticles",r,r+11,"",0),30,!1),function(){c.kill(),o.toDestroy.push(c)}),this.playScaledSpeed(c.animations,"miningParticles")},e.prototype.playExplosionAnimation=function(e,t,o,i,n,a){var r=this,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.player,l=this.actionGroup.create(40*o[0]-36,40*o[1]-30,"blockExplode","BlockBreakParticle0");switch(i){case"treeAcacia":case"logAcacia":l.tint=7103834;break;case"treeBirch":case"logBirch":l.tint=14341836;break;case"treeJungle":case"logJungle":l.tint=6967089;break;case"treeOak":case"logOak":l.tint=6771249;break;case"treeSpruce":case"logSpruce":l.tint=4929827;break;case"planksAcacia":l.tint=12215095;break;case"planksBirch":l.tint=14142349;break;case"planksJungle":l.tint=12093284;break;case"planksOak":l.tint=11833434;break;case"planksSpruce":l.tint=8412726;break;case"stone":case"oreCoal":case"oreDiamond":case"oreIron":case"oreGold":case"oreEmerald":case"oreRedstone":l.tint=13027014;break;case"grass":case"cropWheat":l.tint=6131491;break;case"dirt":l.tint=9068083;break;case"redstoneWireOn":case"redstoneWireHorizontalOn":case"redstoneWireVerticalOn":case"redstoneWireUpRightOn":case"redstoneWireUpLeftOn":case"redstoneWireDownRightOn":case"redstoneWireDownLeftOn":case"redstoneWireTUpOn":case"redstoneWireTDownOn":case"redstoneWireTLeftOn":case"redstoneWireTRightOn":case"redstoneWireCrossOn":l.tint=10028807;break;case"redstoneWire":case"redstoneWireHorizontal":case"redstoneWireVertical":case"redstoneWireUpRight":case"redstoneWireUpLeft":case"redstoneWireDownRight":case"redstoneWireDownLeft":case"redstoneWireTUp":case"redstoneWireTDown":case"redstoneWireTLeft":case"redstoneWireTRight":case"redstoneWireCross":l.tint=2687490}l.sortOrder=this.yToIndex(o[1])+2,this.onAnimationEnd(l.animations.add("explode",Phaser.Animation.generateFrameNames("BlockBreakParticle",0,7,"",0),30,!1),function(){l.kill(),r.toDestroy.push(l),a&&(r.controller.getIsDirectPlayerControl()||r.playPlayerAnimation("idle",e,t,!1,s),null!==n&&r.playItemDropAnimation(o,i,n))}),this.playScaledSpeed(l.animations,"explode"),this.controller.getIsDirectPlayerControl()^!a&&n&&n()},e.prototype.playItemDropAnimation=function(e,t,o){var i=this,n=this.createMiniBlock(e[0],e[1],t);n&&(n.sortOrder=this.yToIndex(e[1])+2),this.controller.getIsDirectPlayerControl()?o&&o():this.onAnimationEnd(this.playScaledSpeed(n.animations,"animate"),function(){var e=i.controller.levelModel.player;i.playItemAcquireAnimation(e.position,e.facing,n,o,t)})},e.prototype.playScaledSpeed=function(e,t){var o=e.getAnimation(t);if(null!==o){o.originalFps||(o.originalFps=1e3/o.delay);var i=this.controller.originalFpsToScaled(o.originalFps);return e.play(t,i)}console.log("can't find animation name : "+t)},e.prototype.playItemAcquireAnimation=function(e,t,o,i,n){var a,r=this;a=this.addResettableTween(o).to(this.positionToScreen(e),200,Phaser.Easing.Linear.None),a.onComplete.add(function(){var t=s.equals(r.player.position,e);if(o.alive&&t){r.audioPlayer.play("collectedBlock"),r.player.inventory[n]=(r.player.inventory[n]||0)+1,o.kill(),r.toDestroy.push(o);var a=l("craftCollectibleCollected");a.blockType=n,window.dispatchEvent(a),i&&i()}else r.playItemAcquireAnimation(r.player.position,r.player.facing,o,i,n)}),a.start()},e.prototype.positionToScreen=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player,i=e[0],n=e[1];return{x:o.offset[0]+40*i,y:o.offset[1]+(t?-23:0)+40*n}},e.prototype.setPlayerPosition=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player,i=this.positionToScreen(e,t,o);o.sprite.x=i.x,o.sprite.y=i.y,o.sprite.sortOrder=this.yToIndex(i.y)+o.getSortOrderOffset()},e.prototype.setSelectionIndicatorPosition=function(e,t){this.selectionIndicator.x=40*e-12,this.selectionIndicator.y=40*t-12},e.prototype.drawHintPath=function(e){this.hintGroup.removeAll(!0);var t=this.game.world.bounds,o=this.game.add.bitmapData(t.width,t.height),i=o.context;i.setLineDash([10,10]),i.lineDashOffset=5,i.lineWidth=2,i.strokeStyle="#fff",i.shadowColor="#000",i.shadowOffsetY=7,i.shadowBlur=4,i.beginPath(),e.forEach(function(e){var t=n(e,2),o=t[0],a=t[1];i.lineTo(40*o+19,40*a+19)}),i.stroke();var a=this.hintGroup.create(0,0,o);a.alpha=0,this.addResettableTween(a).to({alpha:1},830,Phaser.Easing.Quadratic.Out).to({alpha:.4},500,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)},e.prototype.createGroups=function(){this.groundGroup=this.game.add.group(),this.groundGroup.yOffset=-2,this.shadingGroup=this.game.add.group(),this.shadingGroup.yOffset=-2,this.hintGroup=this.game.add.group(),this.actionGroup=this.game.add.group(),this.actionGroup.yOffset=-22,this.fluffGroup=this.game.add.group(),this.fluffGroup.yOffset=-160,this.fowGroup=this.game.add.group(),this.fowGroup.yOffset=0},e.prototype.resetGroups=function(e){var t,o,i;for(this.groundGroup.removeAll(!0),this.actionGroup.removeAll(!0),this.hintGroup.removeAll(!0),this.fluffGroup.removeAll(!0),this.shadingGroup.removeAll(!0),this.fowGroup.removeAll(!0),this.baseShading=this.game.add.group(),this.actionPlaneBlocks=[],this.refreshGroundGroup(),i=0;i<this.controller.levelModel.planeHeight;++i)for(o=0;o<this.controller.levelModel.planeWidth;++o){var n=new s(o,i);t=null;var a=e.groundDecorationPlane.getBlockAt(n);a.isEmpty||(t=this.createBlock(this.actionGroup,o,i,a.blockType))&&(t.sortOrder=this.yToIndex(i));var r=e.actionPlane.getBlockAt(n);r.shouldRenderOnGroundPlane()||this.createActionPlaneBlock(n,r.blockType)}for(i=0;i<this.controller.levelModel.planeHeight;++i)for(o=0;o<this.controller.levelModel.planeWidth;++o){var l=new s(o,i);e.fluffPlane.getBlockAt(l).isEmpty||(t=this.createBlock(this.fluffGroup,o,i,e.fluffPlane.getBlockAt(l).blockType))}},e.prototype.refreshGroundGroup=function(){this.groundGroup.removeAll(!0);for(var e=0;e<this.controller.levelModel.planeHeight;++e)for(var t=0;t<this.controller.levelModel.planeWidth;++t){var o=new s(t,e),i=this.controller.levelModel.groundPlane.getBlockAt(o),n=this.createBlock(this.groundGroup,t,e,i.blockType);n&&(n.sortOrder=this.yToIndex(e));var a=this.controller.levelModel.actionPlane.getBlockAt(o);a&&a.shouldRenderOnGroundPlane()&&this.createActionPlaneBlock(o,a.blockType)}},e.prototype.refreshActionGroup=function(e){for(var t=this,o=0;o<e.length;++o){var i=s.south(e[o]);if(this.controller.levelModel.actionPlane.inBounds(i)){""===this.controller.levelModel.actionPlane.getBlockAt(i).blockType||e.push(i)}}e.forEach(function(e){if(e){var o=t.controller.levelModel.actionPlane.getBlockAt(e);if(o&&o.getIsDoor())return;if(o&&o.getIsMiniblock()||o&&o.getIsTree())return;if(o&&o.blockType)t.createActionPlaneBlock(e,o.blockType);else if(o){var i=t.coordinatesToIndex(e);t.actionGroup.remove(t.actionPlaneBlocks[i]),t.groundGroup.remove(t.actionPlaneBlocks[i])}}})},e.prototype.updateShadingGroup=function(e){var t,o,i,n,a;for(this.shadingGroup.removeAll(),this.shadingGroup.add(this.baseShading),this.selectionIndicator&&this.shadingGroup.add(this.selectionIndicator),t=0;t<e.length;++t){o=e[t],a=o.atlas,i=40*o.x,n=40*o.y;var r=this.shadingGroup.create(i,n,a,o.type);"WaterAO"===a&&(r.tint=5592405)}},e.prototype.updateFowGroup=function(e){var t,o,i,n;for(this.fowGroup.removeAll(),t=0;t<e.length;++t){var a=e[t];if(""!==a){n="undergroundFow",o=40*a.x-40,i=40*a.y-40,a.type;this.fowGroup.create(o,i,n,a.type).alpha=.8}}},e.prototype.playRandomPlayerIdle=function(e){var t,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;switch(t=this.getDirectionName(e),Math.trunc(4*Math.random())+1){case 1:o="idle";break;case 2:o="lookLeft";break;case 3:o="lookRight";break;case 4:o="lookAtCam"}o+=t,this.playScaledSpeed(i.sprite.animations,o)},e.prototype.generatePlayerCelebrateFrames=function(){for(var e=[],t=0;t<6;++t)e.push("Player_001");return e=e.concat("Player_259"),e=e.concat("Player_260"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e.push("Player_001"),e.push("Player_001"),e.push("Player_001"),e.push("Player_001"),e.push("Player_001"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e},e.prototype.generateFramesWithEndDelay=function(e,t,o,i,n,a){for(var r=Phaser.Animation.generateFrameNames(e,t,o,"",n),s=0;s<a;++s)r.push(i);return r},e.prototype.generateReverseFrames=function(e,t,o,i,n){return Phaser.Animation.generateFrameNames(e,t,o,i,n).concat(Phaser.Animation.generateFrameNames(e,o-1,t,i,n))},e.prototype.preparePlayerSprite=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;o.sprite=this.actionGroup.create(0,0,"player"+e,"Player_121"),this.controller.followingPlayer()&&o===this.player&&this.game.camera.follow(o.sprite),o.shouldUpdateSelectionIndicator()&&(this.selectionIndicator=this.shadingGroup.create(24,44,"selectionIndicator")),this.generateAnimations(r.South,0,o),this.generateAnimations(r.East,60,o),this.generateAnimations(r.North,120,o),this.generateAnimations(r.West,180,o);var i=void 0;i=this.generateFramesWithEndDelay("Player_",263,262,"Player_262",3,5),i.push("Player_263"),o.sprite.animations.add("lookAtCam_down",i,10,!1).onComplete.add(function(){t.playScaledSpeed(o.sprite.animations,"idlePause_down")}),i=this.generateFramesWithEndDelay("Player_",270,269,"Player_269",3,5),i.push("Player_270"),o.sprite.animations.add("lookAtCam_right",i,10,!1).onComplete.add(function(){t.playScaledSpeed(o.sprite.animations,"idlePause_right")}),i=this.generateFramesWithEndDelay("Player_",277,276,"Player_276",3,5),i.push("Player_277"),o.sprite.animations.add("lookAtCam_up",i,10,!1).onComplete.add(function(){t.playScaledSpeed(o.sprite.animations,"idlePause_up")}),i=this.generateFramesWithEndDelay("Player_",284,283,"Player_283",3,5),i.push("Player_284"),o.sprite.animations.add("lookAtCam_left",i,10,!1).onComplete.add(function(){t.playScaledSpeed(o.sprite.animations,"idlePause_left")}),o.sprite.animations.add("mine_down",Phaser.Animation.generateFrameNames("Player_",241,244,"",3),20,!0),o.sprite.animations.add("mine_right",Phaser.Animation.generateFrameNames("Player_",245,248,"",3),20,!0),o.sprite.animations.add("mine_up",Phaser.Animation.generateFrameNames("Player_",249,252,"",3),20,!0),o.sprite.animations.add("mine_left",Phaser.Animation.generateFrameNames("Player_",253,256,"",3),20,!0),o.sprite.animations.add("mineCart_down",Phaser.Animation.generateFrameNames("Minecart_",5,5,"",2),20,!1),o.sprite.animations.add("mineCart_turnleft_down",Phaser.Animation.generateFrameNames("Minecart_",6,6,"",2),20,!1),o.sprite.animations.add("mineCart_turnright_down",Phaser.Animation.generateFrameNames("Minecart_",12,12,"",2),20,!1),o.sprite.animations.add("mineCart_right",Phaser.Animation.generateFrameNames("Minecart_",7,7,"",2),20,!1),o.sprite.animations.add("mineCart_left",Phaser.Animation.generateFrameNames("Minecart_",11,11,"",2),20,!1),o.sprite.animations.add("mineCart_up",Phaser.Animation.generateFrameNames("Minecart_",9,9,"",2),20,!1),o.sprite.animations.add("mineCart_turnleft_up",Phaser.Animation.generateFrameNames("Minecart_",10,10,"",2),20,!1),o.sprite.animations.add("mineCart_turnright_up",Phaser.Animation.generateFrameNames("Minecart_",8,8,"",2),20,!1)},e.prototype.playerFrameName=function(e){return Phaser.Animation.generateFrameNames("Player_",e,e,"",3)},e.prototype.generateAnimations=function(e,t){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player,n=this.getDirectionName(e),a=[];a.push(this.playerFrameName(t+1)),a.push(this.playerFrameName(t+3)),a.push(this.playerFrameName(t+1)),a.push(this.playerFrameName(t+7)),a.push(this.playerFrameName(t+9)),a.push(this.playerFrameName(t+7));for(var r=0;r<5;++r)a.push(this.playerFrameName(t+1));i.sprite.animations.add("idle"+n,a,20/3,!1).onComplete.add(function(){o.playRandomPlayerIdle(e,i)}),a=this.generateFramesWithEndDelay("Player_",t+6,t+5,this.playerFrameName(t+5),3,5),a.push(this.playerFrameName(t+6)),i.sprite.animations.add("lookLeft"+n,a,10,!1).onComplete.add(function(){o.playScaledSpeed(i.sprite.animations,"idlePause"+n)}),a=this.generateFramesWithEndDelay("Player_",t+12,t+11,this.playerFrameName(t+11),3,5),a.push(this.playerFrameName(t+12)),i.sprite.animations.add("lookRight"+n,a,10,!1).onComplete.add(function(){o.playScaledSpeed(i.sprite.animations,"idlePause"+n)}),a=[];for(var s=0;s<13;++s)a.push(this.playerFrameName(t+1));i.sprite.animations.add("idlePause"+n,a,20/3,!1).onComplete.add(function(){o.playRandomPlayerIdle(e,i)}),i.sprite.animations.add("walk"+n,Phaser.Animation.generateFrameNames("Player_",t+13,t+20,"",3),20,!0);var l=Phaser.Animation.generateFrameNames("Player_",t+21,t+24,"",3);i.sprite.animations.add("punch"+n,l,20,!1).onComplete.add(function(){o.audioPlayer.play("punch")}),i.sprite.animations.add("punchDestroy"+n,l.concat(l).concat(l),20,!1),i.sprite.animations.add("hurt"+n,Phaser.Animation.generateFrameNames("Player_",t+25,t+28,"",3),20,!1).onComplete.add(function(){o.playScaledSpeed(i.sprite.animations,"idlePause"+n)}),i.sprite.animations.add("crouch"+n,Phaser.Animation.generateFrameNames("Player_",t+29,t+32,"",3),20,!0),i.sprite.animations.add("jumpUp"+n,Phaser.Animation.generateFrameNames("Player_",t+33,t+36,"",3),10,!0),i.sprite.animations.add("fail"+n,Phaser.Animation.generateFrameNames("Player_",t+45,t+48,"",3),20,!1),i.sprite.animations.add("celebrate"+n,this.generatePlayerCelebrateFrames(),10,!1),i.sprite.animations.add("bump"+n,Phaser.Animation.generateFrameNames("Player_",t+49,t+54,"",3),20,!1).onStart.add(function(){o.audioPlayer.play("bump")}),i.sprite.animations.add("jumpDown"+n,Phaser.Animation.generateFrameNames("Player_",t+55,t+60,"",3),20,!0)},e.prototype.createMiniBlock=function(e,t,o){var i=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=null,l=void 0,c=n.collectibleDistance||2,p=n.xOffsetRange||40,d=n.yOffsetRange||40,u=a.getMiniblockFrame(o);if(!u||!this.miniBlocks[u])return r;var h=this.miniBlocks[u][0],f=this.miniBlocks[u][1],m=this.miniBlocks[u][2],g=-10-p/2+Math.random()*p,y=0-d/2+Math.random()*d+this.actionGroup.yOffset,v=new s(g,y);l=Phaser.Animation.generateFrameNames(h,f,m,".png",3),r=this.actionGroup.create(g+40*e,y+40*t,"miniBlocks","");var b=r.animations.add("animate",l,10,!1);return this.controller.getIsDirectPlayerControl()&&function(){var n=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},a=i.controller.levelModel.spritePositionToIndex(v,new s(r.x,r.y));i.collectibleItems.push([r,v,o,c]),b.onComplete.add(function(){i.controller.levelModel.usePlayer&&n(i.player.position,a)<c&&i.player.collectItems(new s(e,t))})}(),this.playScaledSpeed(r.animations,"animate"),r},e.prototype.playAnimationWithOffset=function(e,t,o,i){var n=Math.trunc(Math.random()*o)+i;this.playScaledSpeed(e.animations,t).setFrame(n,!0)},e.prototype.psuedoRandomTint=function(e,t,o,i){var n=Math.pow(10*o+i,5)%251,a=n/12;e===this.groundGroup?a+=24:a*=.75;var r=Math.floor(255-a).toString(16);t.tint="0x"+r+r+r},e.prototype.createBlock=function(e,t,o,i){var n,r,l,c,p,d,u=this,h=new s(t,o),f=null,m=function(n,a){var r=i.substring(4);f=n.createBlock(e,t,o,"log"+r),f.fluff=n.createBlock(n.fluffGroup,t,o,"leaves"+r),f.onBlockDestroy=function(e){e.fluff.animations.add("despawn",Phaser.Animation.generateFrameNames("Leaves_"+r,a[0],a[1],".png",0),10,!1).onComplete.add(function(){n.toDestroy.push(e.fluff),e.fluff.kill()}),n.playScaledSpeed(e.fluff.animations,"despawn")},n.trees.push({sprite:f,type:i,position:h})},g=function(n,a){l=u.blocks[i][0],c=u.blocks[i][1],p=u.blocks[i][2],d=u.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=[];for(var s=Phaser.Animation.generateFrameNames(a,0,3,"",1),h=0;h<5;++h)r.push(a+"0");r=r.concat(s),f.animations.add("open",r),r=[],s=Phaser.Animation.generateFrameNames(a,3,0,"",1);for(var m=0;m<5;++m)r.push(a+"3");return r=r.concat(s),f.animations.add("close",r),f};switch(i){case"treeAcacia":m(this,[0,7]);break;case"treeBirch":m(this,[0,8]);break;case"treeJungle":m(this,[0,9]);break;case"treeOak":m(this,[0,6]);break;case"treeSpruce":case"treeSpruceSnowy":m(this,[0,8]);break;case"cropWheat":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Wheat",0,2,"",0),f.animations.add("idle",r,.4,!1),this.playScaledSpeed(f.animations,"idle");break;case"torch":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Torch",0,23,"",0),f.animations.add("idle",r,15,!0),this.playScaledSpeed(f.animations,"idle");break;case"water":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Water_",0,5,"",0),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"watering":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),f.kill(),this.toDestroy.push(f),this.createBlock(this.groundGroup,t,o,"farmlandWet"),this.refreshGroundGroup();break;case"lava":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Lava_",0,5,"",0),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"Nether_Portal":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Nether_Portal",0,5,"",0),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"lavaPop":for(l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("LavaPop",1,7,"",2),n=0;n<4;++n)r.push("LavaPop07");for(r=r.concat(Phaser.Animation.generateFrameNames("LavaPop",8,13,"",2)),n=0;n<3;++n)r.push("LavaPop13");for(r=r.concat(Phaser.Animation.generateFrameNames("LavaPop",14,30,"",2)),n=0;n<8;++n)r.push("LavaPop01");f.animations.add("idle",r,5,!0),this.playAnimationWithOffset(f,"idle",29,1);break;case"fire":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Fire",0,14,"",2),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"bubbles":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Bubbles",0,14,"",2),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"explosion":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("Explosion",0,16,"",1),f.animations.add("idle",r,15,!1).onComplete.add(function(){u.toDestroy.push(f),f.kill()}),this.playScaledSpeed(f.animations,"idle");break;case"door":f=g(0,"Door");break;case"doorIron":f=g(0,"DoorIron"),this.blockReceivesCornerShadow(t,o)&&f.addChild(this.game.make.sprite(-40,55,"blockShadows","Shadow_Parts_Fade_overlap.png"));break;case"tnt":l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),r=Phaser.Animation.generateFrameNames("TNTexplosion",0,8,"",0),f.animations.add("explode",r,7,!1).onComplete.add(function(){u.playExplosionCloudAnimation(h),f.kill(),u.toDestroy.push(f),u.actionPlaneBlocks[u.coordinatesToIndex(h)]=null});break;default:if(l=this.blocks[i][0],c=this.blocks[i][1],p=this.blocks[i][2],d=this.blocks[i][3],f=e.create(p+40*t,d+e.yOffset+40*o,l,c),e!==this.actionGroup&&e!==this.groundGroup||a.isWalkable(i)||this.psuedoRandomTint(e,f,t,o),e===this.actionGroup&&!a.isWalkable(i)&&this.blockReceivesCornerShadow(t,o)){var y=-39,v=40;i.startsWith("pistonArm")&&(y=-26,v=53),f.addChild(this.game.make.sprite(y,v,"blockShadows","Shadow_Parts_Fade_overlap.png"))}i.startsWith("redstoneWire")&&i.endsWith("On")&&f.addChild(this.addRedstoneSparkle())}return f},e.prototype.addRedstoneSparkle=function(){for(var e=this,t="redstone_sparkle99.png",o=this.game.make.sprite(20,25,"redstoneSparkle",t),i=0;i<3;i++){var n=8*i,a=[t].concat(Phaser.Animation.generateFrameNames("redstone_sparkle",n,n+7,".png"),t);o.animations.add("fizz_"+i,a,7)}return function t(){setTimeout(function(){if(o.alive){var i=Math.floor(3*Math.random());e.onAnimationEnd(e.playScaledSpeed(o.animations,"fizz_"+i),t),o.position.x=Math.random()>.5?20:40,o.position.y=Math.random()>.5?25:45}},c(500,7e3)/e.controller.tweenTimeScale)}(),o},e.prototype.blockReceivesCornerShadow=function(e,t){var o=this.controller.levelModel.actionPlane.getBlockAt([e,t+1]);if(!o||o.blockType&&!o.isWalkable)return!1;var i=this.controller.levelModel.actionPlane.getBlockAt([e-1,t+1]);return i&&i.blockType&&!i.isWalkable},e.prototype.isUnderTree=function(e,t){if(e>=this.trees.length||e<0)return!1;for(var o=this.treeFluffTypes[this.trees[e].type],i=0;i<o.length;i++)if(this.trees[e].position[0]+o[i][0]===t[0]&&this.trees[e].position[1]+o[i][1]===t[1])return!0;return!1},e.prototype.changeTreeAlpha=function(e,t){this.controller.levelView.addResettableTween(this.trees[e].sprite.fluff).to({alpha:t},300,Phaser.Easing.Linear.None).start()},e.prototype.onAnimationEnd=function(e,t){var o=e.onComplete.add(function(){o.detach(),t()})},e.prototype.onAnimationStart=function(e,t){var o=e.onStart.add(function(){o.detach(),t()})},e.prototype.onAnimationLoopOnce=function(e,t){var o=e.onLoop.add(function(){o.detach(),t()})},e.prototype.addResettableTween=function(e){var t=this.game.add.tween(e);return t.timeScale=this.controller.tweenTimeScale,this.resettableTweens.push(t),t},e.prototype.animateDoor=function(e,t){var o=this,i=this.controller.levelModel.player;this.setSelectionIndicatorPosition(this.controller.levelModel.actionPlane.indexToCoordinates(e)[0],this.controller.levelModel.actionPlane.indexToCoordinates(e)[1]),this.controller.audioPlayer.play("doorOpen");var n=this.controller.levelModel.actionPlane.indexToCoordinates(e);this.playDoorAnimation(n,t,function(){var e=o.controller.levelModel.actionPlane.getBlockAt(n);e.isWalkable=e.isOpen,"doorIron"!==e.blockType&&o.playIdleAnimation(i.position,i.facing,i.isOnBlock,i),o.setSelectionIndicatorPosition(i.position[0],i.position[1])})},e}()},2717:function(e,t,o){"use strict";e.exports={},e.exports.createEvent=function(e){var t,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{t=new Event(e,{bubbles:o,cancelable:i})}catch(n){t=document.createEvent("Event"),t.initEvent(e,o,i)}return t},e.exports.bisect=function(e,t){return[e.filter(function(e){return t(e)}),e.filter(function(e){return!t(e)})]}},2718:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(794),a=o(2719),r=o(2720),s=o(2721),l=o(2722),c=o(2723),p=o(2724),d=o(2725),u=o(838);e.exports=function(){function e(t){i(this,e),this.controller=t,this.game=t.game,this.entityMap=new Map,this.entityDeathCount=new Map,this.sprite=null,this.id=0}return e.prototype.loadData=function(e){if(void 0!==e.entities)for(var t=0;t<e.entities.length;t++){var o=e.entities[t],i=this.createEntity(o[0],this.id++,o[1],o[2],o[3],o[4]);i.updateHidingTree(),i.updateHidingBlock()}},e.prototype.tick=function(){var e=function(e){e.tick()};this.entityMap.forEach(e)},e.prototype.pushEntity=function(e){this.entityMap.has(e.identifier)?this.controller.DEBUG&&this.game.debug.text("Duplicate entity name : "+e.identifier+"\n"):this.entityMap.set(e.identifier,e)},e.prototype.isFriendlyEntity=function(e){for(var t=["sheep","ironGolem","cow","chicken"],o=0;o<t.length;o++)if(e===t[o])return!0;return!1},e.prototype.createEntity=function(e,t,o,i,u,h){var f=null;if(this.entityMap.has(t))this.controller.DEBUG&&this.game.debug.text("Duplicate entity name : "+t+"\n");else{switch(e){case"sheep":f=new a(this.controller,e,t,o,i,u);break;case"zombie":f=new r(this.controller,e,t,o,i,u);break;case"ironGolem":f=new s(this.controller,e,t,o,i,u);break;case"creeper":f=new l(this.controller,e,t,o,i,u);break;case"cow":f=new c(this.controller,e,t,o,i,u);break;case"chicken":f=new p(this.controller,e,t,o,i,u);break;case"ghast":f=new d(this.controller,e,t,o,i,u,h);break;default:f=new n(this.controller,e,t,o,i,u)}this.controller.DEBUG&&console.log("Create Entity type : "+e+" "+o+","+i),this.entityMap.set(t,f)}return f},e.prototype.isSpawnableInBetween=function(e,t,o,i){for(var n=e;n<=o;n++)for(var a=t;a<=i;a++)if(this.controller.levelModel.isPositionEmpty(new u(n,a))[0])return!0;return!1},e.prototype.spawnEntity=function(e,t){var o=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},i=this.controller.levelModel,n=i.planeWidth,a=i.planeHeight;if("middle"===t){if(this.isSpawnableInBetween(Math.floor(.25*n),Math.floor(.25*a),Math.floor(.75*n),Math.floor(.75*a))){for(var r=new u(o(Math.floor(.25*n),Math.floor(.75*n)),o(Math.floor(.25*a),Math.floor(.75*a)));!i.isPositionEmpty(r)[0];)r=new u(o(Math.floor(.25*n),Math.floor(.75*n)),o(Math.floor(.25*a),Math.floor(.75*a)));return this.createEntity(e,this.id++,r.x,r.y,o(0,3))}if(!this.isSpawnableInBetween(1,1,n-2,a-2))return null;for(var s=new u(o(1,n-2),o(1,a-2));!i.isPositionEmpty(s)[0];)s=new u(o(1,n-2),o(1,a-2));return this.createEntity(e,this.id++,s.x,s.y,o(0,3))}if("left"===t){for(var l=0,c=!0;l<n&&c;){c=!0;for(var p=0;p<a;p++)if(i.isPositionEmpty(new u(l,p))[0]){c=!1;break}c&&l++}if(l<n){for(var d=new u(l,o(0,a-1));!i.isPositionEmpty(d)[0];)d=new u(l,o(0,a-1));return this.createEntity(e,this.id++,d.x,d.y,o(0,3))}}else if("right"===t){for(var h=n-1,f=!0;h>-1&&f;){f=!0;for(var m=0;m<a;m++)if(i.isPositionEmpty(new u(h,m))[0]){f=!1;break}f&&h--}if(h>-1){for(var g=new u(h,o(0,a-1));!i.isPositionEmpty(g)[0];)g=new u(h,o(0,a-1));return this.createEntity(e,this.id++,g.x,g.y,o(0,3))}}else if("up"===t){for(var y=0,v=!0;y<a&&v;){v=!0;for(var b=0;b<n;b++)if(i.isPositionEmpty(new u(b,y))[0]){v=!1;break}v&&y++}if(y<a){for(var k=new u(o(0,a-1),y);!i.isPositionEmpty(k)[0];)k=new u(o(0,a-1),y);return this.createEntity(e,this.id++,k.x,k.y,o(0,3))}}else if("down"===t){for(var _=a-1,w=!0;_>-1&&w;){w=!0;for(var P=0;P<n;P++)if(i.isPositionEmpty(new u(P,_))[0]){w=!1;break}w&&_--}if(_>-1){for(var S=new u(o(0,a-1),_);!i.isPositionEmpty(S)[0];)S=new u(o(0,a-1),_);return this.createEntity(e,this.id++,S.x,S.y,o(0,3))}}return null},e.prototype.spawnEntityAt=function(e,t,o,i){return this.createEntity(e,this.id++,t,o,i)},e.prototype.destroyEntity=function(e){if(this.entityMap.has(e)){var t=this.entityMap.get(e);this.entityDeathCount.has(t.type)?this.entityDeathCount.set(t.type,this.entityDeathCount.get(t.type)+1):this.entityDeathCount.set(t.type,1),t.reset(),t.sprite.animations.stop(null,!0),t.sprite.destroy(),this.entityMap.delete(e)}else this.controller.DEBUG&&this.game.debug.text("It's impossible to delete since entity name : "+e+" is not existing\n")},e.prototype.getEntityAt=function(e){var t=!0,o=!1,i=void 0;try{for(var n,a=this.entityMap[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var r=n.value,s=r[1];if(u.equals(e,s.position))return s}}catch(e){o=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw i}}return null},e.prototype.getEntitiesOfType=function(e){if("all"===e){var t=[],o=!0,i=!1,n=void 0;try{for(var a,r=this.entityMap[Symbol.iterator]();!(o=(a=r.next()).done);o=!0){var s=a.value,l=s[1];"Player"!==l.type&&t.push(l)}}catch(e){i=!0,n=e}finally{try{!o&&r.return&&r.return()}finally{if(i)throw n}}return t}var c=[],p=!0,d=!1,u=void 0;try{for(var h,f=this.entityMap[Symbol.iterator]();!(p=(h=f.next()).done);p=!0){var m=h.value,g=m[1];g.type===e&&c.push(g)}}catch(e){d=!0,u=e}finally{try{!p&&f.return&&f.return()}finally{if(d)throw u}}return c},e.prototype.reset=function(){this.entityMap.clear(),this.entityDeathCount=new Map},e}()},2719:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794),s=o(1159);e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-43,-55],p.controller.levelView&&(p.prepareSprite(),p.sprite.sortOrder=p.controller.levelView.yToIndex(p.position.y)),p.naked=!1,p}return a(t,e),t.prototype.use=function(e,t){var o=this,i=this.getNakedSuffix()+"lookAtCam"+this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,i),this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenUsed,targetType:o.type,eventSenderIdentifier:t.identifier,targetIdentifier:o.identifier})}),this.queue.endPushHighPriorityCommands(),e.succeeded()},t.prototype.getWalkAnimation=function(){return this.getNakedSuffix()+e.prototype.getWalkAnimation.call(this)},t.prototype.getIdleAnimation=function(){return this.getNakedSuffix()+e.prototype.getIdleAnimation.call(this)},t.prototype.bump=function(e){var t=this,o=this.getNakedSuffix()+"bump",i=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,o+i);var n=this.controller.levelModel.getMoveForwardPosition(this),a=this.controller.levelEntity.getEntityAt(n);null!==a&&(this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenTouched,targetType:t.type,targetIdentifier:t.identifier,eventSenderIdentifier:a.identifier})}),this.queue.endPushHighPriorityCommands()),this.controller.delayPlayerMoveBy(400,800,function(){e.succeeded()})},t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[],n="ShadowSheep_2016";this.sprite=o.create(0,0,"sheep","ShadowSheep_2016001.png");for(var a=["ShadowSheep_2016217.png","ShadowSheep_2016109.png","ShadowSheep_2016001.png","ShadowSheep_2016325.png"],r=[[[252,261],[220,222],[228,231],[276,279],[270,275],[282,293],[294,305],[306,317],[318,323],[234,243],[880,887]],[[144,153],[112,114],[120,123],[168,171],[162,167],[174,185],[186,197],[198,209],[210,215],[126,135],[872,879]],[[36,45],[3,6],[12,15],[60,63],[54,59],[66,77],[78,89],[90,101],[102,108],[18,26],[864,871]],[[360,369],[328,330],[336,339],[384,387],[378,383],[390,401],[402,413],[414,425],[426,431],[342,351],[888,895]]],s=0;s<4;s++){var l=this.controller.levelView.getDirectionName(s);i=Phaser.Animation.generateFrameNames(n,r[s][0][0],r[s][0][1],".png",3);for(var c=0;c<8;c++)i.push(a[s]);this.sprite.animations.add("idle"+l,i,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames(n,r[s][1][0],r[s][1][1],".png",3),this.sprite.animations.add("lookLeft"+l,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.naked?e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2"):e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,r[s][1][1],r[s][1][0],".png",3),this.sprite.animations.add("lookLeft"+l+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][2][0],r[s][2][1],".png",3),this.sprite.animations.add("lookRight"+l,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.naked?e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2"):e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,r[s][2][1],r[s][2][0],".png",3),this.sprite.animations.add("lookRight"+l+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][3][0],r[s][3][1],".png",3),this.sprite.animations.add("lookAtCam"+l,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.naked?e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2"):e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,r[s][3][1],r[s][3][0],".png",3),this.sprite.animations.add("lookAtCam"+l+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][4][0],r[s][4][1],".png",3),this.sprite.animations.add("lookDown"+l,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][5][0],r[s][5][1],".png",3),this.sprite.animations.add("walk"+l,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][6][0],r[s][6][1],".png",3),this.sprite.animations.add("attack"+l,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][7][0],r[s][7][1],".png",3),this.sprite.animations.add("hurt"+l,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[s][8][0],r[s][8][1],".png",3),this.sprite.animations.add("die"+l,i,10,!1),i=this.controller.levelView.generateReverseFrames(n,r[s][9][0],r[s][9][1],".png",3),this.sprite.animations.add("eat"+l,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=this.controller.levelView.generateReverseFrames(n,r[s][10][0],r[s][10][1],".png",3),this.sprite.animations.add("bump"+l,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}r=[[[684,693],[652,654],[660,663],[708,711],[702,707],[714,725],[726,737],[738,749],[750,755],[666,675],[912,919]],[[576,585],[544,546],[552,555],[600,603],[594,599],[606,617],[618,629],[630,641],[642,647],[558,567],[904,911]],[[468,477],[436,438],[444,447],[492,495],[486,491],[498,509],[510,521],[522,533],[534,539],[450,459],[896,903]],[[792,801],[760,762],[768,771],[816,819],[810,815],[822,833],[834,845],[846,857],[858,863],[774,783],[920,927]]],a=["ShadowSheep_2016649.png","ShadowSheep_2016541.png","ShadowSheep_2016433.png","ShadowSheep_2016757.png"];for(var p=0;p<4;p++){var d=this.controller.levelView.getDirectionName(p);i=Phaser.Animation.generateFrameNames(n,r[p][0][0],r[p][0][1],".png",3);for(var u=0;u<8;u++)i.push(a[p]);this.sprite.animations.add("naked_idle"+d,i,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames(n,r[p][1][0],r[p][1][1],".png",3),this.sprite.animations.add("naked_lookLeft"+d,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,r[p][1][1],r[p][1][0],".png",3),this.sprite.animations.add("naked_lookLeft"+d+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[p][2][0],r[p][2][1],".png",3),this.sprite.animations.add("naked_lookRight"+d,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,r[p][2][1],r[p][2][0],".png",3),this.sprite.animations.add("naked_lookRight"+d+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[p][3][0],r[p][3][1],".png",3),this.sprite.animations.add("naked_lookAtCam"+d,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,r[p][3][1],r[p][3][0],".png",3),this.sprite.animations.add("naked_lookAtCam"+d+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[p][4][0],r[p][4][1],".png",3),this.sprite.animations.add("naked_lookDown"+d,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[p][5][0],r[p][5][1],".png",3),this.sprite.animations.add("naked_walk"+d,i,10,!0),i=Phaser.Animation.generateFrameNames(n,r[p][6][0],r[p][6][1],".png",3),this.sprite.animations.add("naked_attack"+d,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[p][7][0],r[p][7][1],".png",3),this.sprite.animations.add("naked_hurt_"+d,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,r[p][8][0],r[p][8][1],".png",3),this.sprite.animations.add("naked_die"+d,i,10,!1),i=this.controller.levelView.generateReverseFrames(n,r[p][9][0],r[p][9][1],".png",3),this.sprite.animations.add("naked_eat"+d,i,10,!1).onComplete.add(function(){e.naked=!1,e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=this.controller.levelView.generateReverseFrames(n,r[p][10][0],r[p][10][1],".png",3),this.sprite.animations.add("naked_bump"+d,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t.prototype.playRandomIdle=function(e){var t,o=this.getNakedSuffix();switch(t=this.controller.levelView.getDirectionName(e),Math.trunc(6*Math.random())+1){case 1:o+="idle";break;case 2:o+="lookLeft";break;case 3:o+="lookRight";break;case 4:o+="lookAtCam";break;case 5:o+="lookDown";break;case 6:o+="eat"}o+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,o),this.controller.printErrorMsg(this.type+" calls animation : "+o+"\n")},t.prototype.attack=function(e){var t=this,o=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.onAnimationEnd(this.controller.levelView.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"attack"+o),function(){var i=t.controller.levelEntity.getEntityAt(t.controller.levelModel.getMoveForwardPosition(t));null!==i&&t.controller.levelView.onAnimationEnd(t.controller.levelView.playScaledSpeed(i.sprite.animations,t.getNakedSuffix()+"hurt"+o),function(){t.controller.events.forEach(function(e){return e({eventType:s.WhenAttacked,targetType:t.type,eventSenderIdentifier:t.identifier,targetIdentifier:i.identifier})})}),e.succeeded()})},t.prototype.updateAnimationDirection=function(){var e=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"idle"+e)},t.prototype.drop=function(t,o){if(this.naked)return!1;if(t&&e.prototype.drop.call(this,t,o),"wool"===o&&(this.naked=!0,this.controller.levelView)){var i=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"naked_idle"+i,function(){})}return!0},t.prototype.takeDamage=function(e){var t=this,o=this.controller.levelView,i=o.getDirectionName(this.facing);this.healthPoint>1?(o.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"hurt"+i),setTimeout(function(){t.healthPoint--,e.succeeded()},1500)):(this.healthPoint--,this.sprite.animations.stop(null,!0),this.controller.levelView.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"die"+i),setTimeout(function(){var e=t.controller.levelView.addResettableTween(t.sprite).to({alpha:0},500,Phaser.Easing.Linear.None);e.onComplete.add(function(){t.controller.levelEntity.destroyEntity(t.identifier)}),e.start()},1500))},t.prototype.getNakedSuffix=function(){return this.naked?"naked_":""},t}(r)},2720:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794);e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-43,-45],p.burningSprite=[null,null],p.burningSpriteGhost=[null,null],p.burningSpriteOffset=[47,40],p.prepareSprite(),p}return a(t,e),t.prototype.tick=function(){e.prototype.tick.call(this)},t.prototype.reset=function(){for(var e=0;e<2;e++)this.burningSprite[e]&&this.burningSprite[e].destroy()},t.prototype.playMoveForwardAnimation=function(t,o,i,n){var a=this;e.prototype.playMoveForwardAnimation.call(this,t,o,i,n),this.burningSprite[0].sortOrder=this.sprite.sortOrder+1,this.burningSprite[1].sortOrder=this.sprite.sortOrder-1,setTimeout(function(){for(var e=0;e<2;e++){var o=a.controller.levelView.addResettableTween(a.burningSprite[e]).to({x:a.offset[0]+a.burningSpriteOffset[0]+40*t[0],y:a.offset[1]+a.burningSpriteOffset[1]+40*t[1]},300,Phaser.Easing.Linear.None);o.onComplete.add(function(){}),o.start()}},50/this.controller.tweenTimeScale)},t.prototype.setBurn=function(e){if(e)for(var t=0;t<2;t++)this.burningSprite[t].alpha=1;else for(var o=0;o<2;o++)this.burningSprite[o].alpha=0},t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[];this.sprite=o.create(0,0,"zombie","Zombie_001.png"),this.sprite.sortOrder=this.controller.levelView.yToIndex(this.position.y),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y,this.burningSprite=[o.create(this.sprite.x+this.burningSpriteOffset[0],this.sprite.y+this.burningSpriteOffset[1],"burningInSun","BurningFront_001.png"),o.create(this.sprite.x+this.burningSpriteOffset[0],this.sprite.y+this.burningSpriteOffset[1],"burningInSun","BurningBehind_001.png")],i=Phaser.Animation.generateFrameNames("BurningFront_",1,15,".png",3),this.burningSprite[0].animations.add("burn",i,10,!0),i=Phaser.Animation.generateFrameNames("BurningBehind_",1,15,".png",3),this.burningSprite[1].animations.add("burn",i,10,!0),this.controller.levelView.playScaledSpeed(this.burningSprite[0].animations,"burn"),this.controller.levelView.playScaledSpeed(this.burningSprite[1].animations,"burn"),this.burningSprite[0].sortOrder=this.sprite.sortOrder+1,this.burningSprite[1].sortOrder=this.sprite.sortOrder-1;for(var n=["Zombie_056.png","Zombie_166.png","Zombie_001.png","Zombie_111.png"],a=[[[73,79],[57,59],[61,63],[69,71],[65,67],[80,88],[89,91],[93,101],[102,110],[229,236]],[[183,189],[167,169],[171,173],[179,181],[175,177],[190,198],[199,201],[203,211],[212,220],[245,252]],[[18,24],[2,4],[6,8],[14,16],[10,12],[25,33],[34,36],[38,46],[47,55],[221,228]],[[128,134],[112,114],[116,118],[124,126],[120,122],[135,143],[144,146],[148,156],[158,165],[237,244]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);i=Phaser.Animation.generateFrameNames("Zombie_",a[r][0][0],a[r][0][1],".png",3);for(var l=0;l<8;l++)i.push(n[r]);this.sprite.animations.add("idle"+s,i,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][1][0],a[r][1][1],".png",3),this.sprite.animations.add("lookLeft"+s,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][1][1],a[r][1][0],".png",3),this.sprite.animations.add("lookLeft"+s+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][2][0],a[r][2][1],".png",3),this.sprite.animations.add("lookRight"+s,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][2][1],a[r][2][0],".png",3),this.sprite.animations.add("lookRight"+s+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][3][0],a[r][3][1],".png",3),this.sprite.animations.add("lookAtCam"+s,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][3][1],a[r][3][0],".png",3),this.sprite.animations.add("lookAtCam"+s+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][4][0],a[r][4][1],".png",3),this.sprite.animations.add("lookDown"+s,i,10/3,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][5][0],a[r][5][1],".png",3),this.sprite.animations.add("walk"+s,i,10,!0),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][6][0],a[r][6][1],".png",3),this.sprite.animations.add("attack"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][7][0],a[r][7][1],".png",3),this.sprite.animations.add("hurt"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Zombie_",a[r][8][0],a[r][8][1],".png",3),this.sprite.animations.add("die"+s,i,10,!1),i=this.controller.levelView.generateReverseFrames("Zombie_",a[r][9][0],a[r][9][1],".png",3),this.sprite.animations.add("bump"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.setBurn(this.controller.levelModel.isDaytime)},t.prototype.takeDamage=function(e){var t=this,o=this.controller.levelView,i=o.getDirectionName(this.facing);this.healthPoint>1?(o.playScaledSpeed(this.sprite.animations,"hurt"+i),setTimeout(function(){t.healthPoint--,e.succeeded()},1500/this.controller.tweenTimeScale)):(this.healthPoint--,this.controller.levelView.playScaledSpeed(this.sprite.animations,"die"+i),setTimeout(function(){var e=t.controller.levelView.addResettableTween(t.sprite).to({alpha:0},500,Phaser.Easing.Linear.None);e.onComplete.add(function(){t.controller.levelEntity.destroyEntity(t.identifier)}),e.start();for(var o=0;o<2;o++)e=t.controller.levelView.addResettableTween(t.burningSprite[o]).to({alpha:0},500,Phaser.Easing.Linear.None),e.start()},1500/this.controller.tweenTimeScale))},t}(r)},2721:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794);e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-43,-55],p.prepareSprite(),p.sprite.sortOrder=p.controller.levelView.yToIndex(p.position.y),p}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[],n="Iron_Golem_Anims";this.sprite=o.create(0,0,"ironGolem","Iron_Golem_Anims001.png");for(var a=[[[45,45],[46,48],[50,52],[58,60],[54,56],[62,70],[71,74],[77,81],[82,88],[185,192]],[[133,133],[134,136],[138,140],[146,148],[142,144],[150,158],[159,162],[165,169],[170,176],[201,208]],[[1,1],[2,4],[6,8],[14,16],[10,12],[18,26],[27,30],[33,37],[38,44],[177,184]],[[89,89],[90,92],[94,96],[102,104],[98,100],[106,114],[115,118],[121,125],[126,132],[193,200]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);i=Phaser.Animation.generateFrameNames(n,a[r][0][0],a[r][0][1],".png",3);for(var l=0;l<12;l++)i.push(i[0]);this.sprite.animations.add("idle"+s,i,8,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames(n,a[r][1][0],a[r][1][1],".png",3),this.sprite.animations.add("lookLeft"+s,i,8,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,a[r][1][1],a[r][1][0],".png",3),this.sprite.animations.add("lookLeft"+s+"_2",i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][2][0],a[r][2][1],".png",3),this.sprite.animations.add("lookRight"+s,i,8,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,a[r][2][1],a[r][2][0],".png",3),this.sprite.animations.add("lookRight"+s+"_2",i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][3][0],a[r][3][1],".png",3),this.sprite.animations.add("lookAtCam"+s,i,8,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,a[r][3][1],a[r][3][0],".png",3),this.sprite.animations.add("lookAtCam"+s+"_2",i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][4][0],a[r][4][1],".png",3),this.sprite.animations.add("lookDown"+s,i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookDown_2"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][4][1],a[r][4][0],".png",3),this.sprite.animations.add("lookDown_2"+s,i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][5][0],a[r][5][1],".png",3),this.sprite.animations.add("walk"+s,i,8,!0),i=Phaser.Animation.generateFrameNames(n,a[r][6][0],a[r][6][1],".png",3),this.sprite.animations.add("attack"+s,i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][7][0],a[r][7][1],".png",3),this.sprite.animations.add("hurt"+s,i,16/3,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][8][0],a[r][8][1],".png",3),this.sprite.animations.add("die"+s,i,16/3,!1),i=this.controller.levelView.generateReverseFrames(n,a[r][9][0],a[r][9][1],".png",3),this.sprite.animations.add("bump"+s,i,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position[0],this.sprite.y=this.offset[1]+40*this.position[1]},t}(r)},2722:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794);e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-43,-55],p.prepareSprite(),p.sprite.sortOrder=p.controller.levelView.yToIndex(p.position.y),p}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[],n="ShadowCreeper_2016_";this.sprite=o.create(0,0,"creeper","ShadowCreeper_2016_000.png");for(var a=[[[128,128],[128,131],[134,137],[140,143],[146,149],[152,163],[164,167],[164,178],[179,184],[185,191],[272,279]],[[64,64],[64,67],[70,73],[76,89],[82,85],[88,99],[100,103],[100,114],[115,120],[121,127],[264,271]],[[0,0],[0,3],[6,10],[12,16],[18,21],[24,35],[36,39],[36,50],[51,56],[57,63],[256,263]],[[192,192],[192,195],[198,201],[204,207],[210,213],[216,227],[228,231],[228,242],[243,248],[249,255],[280,287]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);i=Phaser.Animation.generateFrameNames(n,a[r][0][0],a[r][0][1],".png",3);for(var l=0;l<12;l++)i.push(i[0]);this.sprite.animations.add("idle"+s,i,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames(n,a[r][1][0],a[r][1][1],".png",3),this.sprite.animations.add("lookLeft"+s,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,a[r][1][1],a[r][1][0],".png",3),this.sprite.animations.add("lookLeft"+s+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][2][0],a[r][2][1],".png",3),this.sprite.animations.add("lookRight"+s,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,a[r][2][1],a[r][2][0],".png",3),this.sprite.animations.add("lookRight"+s+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][3][0],a[r][3][1],".png",3),this.sprite.animations.add("lookAtCam"+s,i,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames(n,a[r][3][1],a[r][3][0],".png",3),this.sprite.animations.add("lookAtCam"+s+"_2",i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][4][0],a[r][4][1],".png",3),this.sprite.animations.add("lookDown"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookDown_2"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][4][1],a[r][4][0],".png",3),this.sprite.animations.add("lookDown_2"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][5][0],a[r][5][1],".png",3),this.sprite.animations.add("walk"+s,i,10,!0),i=Phaser.Animation.generateFrameNames(n,a[r][6][0],a[r][6][1],".png",3),this.sprite.animations.add("attack"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][7][0],a[r][7][1],".png",3),this.sprite.animations.add("explode"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][8][0],a[r][8][1],".png",3),this.sprite.animations.add("hurt"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames(n,a[r][9][0],a[r][9][1],".png",3),this.sprite.animations.add("die"+s,i,10,!1),i=this.controller.levelView.generateReverseFrames(n,a[r][10][0],a[r][10][1],".png",3),this.sprite.animations.add("bump"+s,i,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t}(r)},2723:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794);e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-43,-55],p.prepareSprite(),p.sprite.sortOrder=p.controller.levelView.yToIndex(p.position.y),p}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[];this.sprite=o.create(0,0,"cow","Cow0001.png");for(var n=["Cow0222.png","Cow0111.png","Cow0001.png","Cow0333.png"],a=[[[258,264],[225,227],[224,226],[285,287],[240,241],[291,302],[303,313],[314,326],[327,332],[460,467],[276,282],[240,249]],[[147,153],[114,116],[129,130],[174,176],[129,130],[180,191],[192,202],[203,215],[216,221],[452,459],[165,171],[129,138]],[[36,42],[3,5],[12,14],[63,65],[18,19],[69,80],[81,91],[92,104],[105,110],[444,451],[51,54],[18,27]],[[369,375],[336,338],[335,337],[396,398],[351,352],[402,413],[414,424],[425,437],[438,443],[468,475],[387,393],[351,360]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);i=[];for(var l=0;l<20;l++)i.push(n[r]);this.sprite.animations.add("idle"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle2"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][1][0],a[r][1][1],".png",4),this.sprite.animations.add("lookLeft"+s,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][1][1],a[r][1][0],".png",4),this.sprite.animations.add("lookLeft"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][2][0],a[r][2][1],".png",4),this.sprite.animations.add("lookRight"+s,i,12,!1).onComplete.add(function(){setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][2][1],a[r][2][0],".png",4),this.sprite.animations.add("lookRight"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][3][0],a[r][3][1],".png",4),this.sprite.animations.add("lookAtCam"+s,i,12,!1).onComplete.add(function(){setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][3][1],a[r][3][0],".png",4),this.sprite.animations.add("lookAtCam"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][4][0],a[r][4][1],".png",4),this.sprite.animations.add("lookDown"+s,i,12,!1).onComplete.add(function(){setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookDown"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][4][1],a[r][4][0],".png",4),this.sprite.animations.add("lookDown"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][5][0],a[r][5][1],".png",4),this.sprite.animations.add("walk"+s,i,12,!0),i=Phaser.Animation.generateFrameNames("Cow",a[r][6][0],a[r][6][1],".png",4),this.sprite.animations.add("attack"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][7][0],a[r][7][1],".png",4),this.sprite.animations.add("hurt"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][8][0],a[r][8][1],".png",4),this.sprite.animations.add("die"+s,i,12,!1),i=this.controller.levelView.generateReverseFrames("Cow",a[r][9][0],a[r][9][1],".png",4),this.sprite.animations.add("bump"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),2===r?(i=Phaser.Animation.generateFrameNames("Cow",a[r][10][0],a[r][10][1],".png",4),this.sprite.animations.add("idle2"+s,i,6,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle2"+e.controller.levelView.getDirectionName(e.facing)+"_reverse")}),i=Phaser.Animation.generateFrameNames("Cow",a[r][10][1],a[r][10][0],".png",4),this.sprite.animations.add("idle2"+s+"_reverse",i,6,!1).onComplete.add(function(){e.playRandomIdle(e.facing)})):(i=Phaser.Animation.generateFrameNames("Cow",a[r][10][1],a[r][10][0],".png",4),this.sprite.animations.add("idle2"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle2"+e.controller.levelView.getDirectionName(e.facing)+"_reverse")}),i=Phaser.Animation.generateFrameNames("Cow",a[r][10][0],a[r][10][1],".png",4),this.sprite.animations.add("idle2"+s+"_reverse",i,12,!1).onComplete.add(function(){e.playRandomIdle(e.facing)})),i=Phaser.Animation.generateFrameNames("Cow",a[r][11][0],a[r][11][1],".png",4),this.sprite.animations.add("eat"+s,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"eat"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Cow",a[r][11][1],a[r][11][0],".png",4),this.sprite.animations.add("eat"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t.prototype.playRandomIdle=function(e){var t,o="";switch(t=this.controller.levelView.getDirectionName(e),Math.trunc(5*Math.random())+1){case 1:o+="idle";break;case 2:o+="lookLeft";break;case 3:o+="lookRight";break;case 4:o+="lookAtCam";break;case 5:o+="lookDown"}o+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,o),this.controller.printErrorMsg(this.type+" calls animation : "+o+"\n")},t}(r)},2724:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794);e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-25,-32],p.prepareSprite(),p.sprite.sortOrder=p.controller.levelView.yToIndex(p.position.y),p}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[];this.sprite=o.create(0,0,"chicken","chicken0001.png"),this.sprite.scale.setTo(.75,.75);for(var n=["chicken0222.png","chicken0111.png","chicken0001.png","chicken0333.png"],a=[[[259,275],[225,227],[224,226],[285,287],[276,281],[291,302],[303,313],[314,326],[327,332],[460,467],[240,249]],[[148,164],[114,116],[113,115],[174,176],[165,170],[180,191],[192,202],[203,215],[216,221],[452,459],[129,138]],[[37,53],[3,5],[12,14],[63,65],[54,59],[69,80],[81,91],[92,104],[105,110],[444,451],[18,27]],[[370,386],[336,338],[335,337],[396,398],[387,392],[402,413],[414,424],[425,437],[438,443],[468,475],[351,360]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);i=Phaser.Animation.generateFrameNames("chicken",a[r][0][0],a[r][0][1],".png",4);for(var l=0;l<8;l++)i.push(n[r]);this.sprite.animations.add("idle"+s,i,12,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames("chicken",a[r][1][0],a[r][1][1],".png",4),this.sprite.animations.add("lookLeft"+s,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][1][1],a[r][1][0],".png",4),this.sprite.animations.add("lookLeft"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][2][0],a[r][2][1],".png",4),this.sprite.animations.add("lookRight"+s,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][2][1],a[r][2][0],".png",4),this.sprite.animations.add("lookRight"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][3][0],a[r][3][1],".png",4),this.sprite.animations.add("lookAtCam"+s,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][3][1],a[r][3][0],".png",4),this.sprite.animations.add("lookAtCam"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][4][0],a[r][4][1],".png",4),this.sprite.animations.add("lookDown"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][5][0],a[r][5][1],".png",4),this.sprite.animations.add("walk"+s,i,12,!0),i=Phaser.Animation.generateFrameNames("chicken",a[r][6][0],a[r][6][1],".png",4),this.sprite.animations.add("attack"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][7][0],a[r][7][1],".png",4),this.sprite.animations.add("hurt"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][8][0],a[r][8][1],".png",4),this.sprite.animations.add("die"+s,i,12,!1),i=this.controller.levelView.generateReverseFrames("chicken",a[r][9][0],a[r][9][1],".png",4),this.sprite.animations.add("bump"+s,i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][10][0],a[r][10][1],".png",4),this.sprite.animations.add("eat"+s,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"eat"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("chicken",a[r][10][1],a[r][10][0],".png",4),this.sprite.animations.add("eat"+s+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t}(r)},2725:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(794),s=o(1272).randomInt;e.exports=function(e){function t(o,a,r,s,l,c){i(this,t);var p=n(this,e.call(this,o,a,r,s,l,c));return p.offset=[-50,-84],p.prepareSprite(),p.sprite.sortOrder=p.controller.levelView.yToIndex(Number.MAX_SAFE_INTEGER),p.audioDelay=15,s<5?p.patrolA():p.patrolB(),p}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},o=this.controller.levelView.actionGroup,i=[];this.sprite=o.create(0,0,"ghast","Ghast0000.png"),this.sprite.scale.setTo(1,1);for(var n=[[[72,83],[84,95]],[[48,59],[60,71]],[[24,35],[36,47]],[[0,11],[12,23]]],a=0;a<4;a++){var r=this.controller.levelView.getDirectionName(a);i=Phaser.Animation.generateFrameNames("Ghast",n[a][0][0],n[a][0][1],".png",4);for(var l=s(2,i.length),c=[],p=0;p<l;++p)c.push(i[0]),i.splice(0,1);for(var d=0;d<c.length;++d)i.push(c[d]);for(var u=0;u<0;u++)i.push(i[0]);this.sprite.animations.add("idle"+r,i,12,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),i=Phaser.Animation.generateFrameNames("Ghast",n[a][1][0],n[a][1][1],".png",4),this.sprite.animations.add("shoot"+r,i,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"shoot"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),i=Phaser.Animation.generateFrameNames("Ghast",n[a][1][1],n[a][1][0],".png",4),this.sprite.animations.add("shoot"+r+"_2",i,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t.prototype.canMoveThrough=function(){return!0},t.prototype.playRandomIdle=function(e){var t,o="";if(t=this.controller.levelView.getDirectionName(e),o+="idle",o+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,o),this.audioDelay>0)--this.audioDelay;else{this.audioDelay=5;if(0===Math.floor(5*Math.random())){var i=Math.floor(4*Math.random());this.playMoan(i)}}},t.prototype.playMoan=function(e){switch(e){case 0:this.controller.audioPlayer.play("moan2");break;case 1:this.controller.audioPlayer.play("moan3");break;case 2:this.controller.audioPlayer.play("moan6");break;default:this.controller.audioPlayer.play("moan7")}},t.prototype.patrolA=function(){var e,t,o=[Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0];(e=this.controller.levelView.addResettableTween(this.sprite)).to.apply(e,[{y:this.offset[1]+40*this.position.y+80},s(2500,3500)].concat(o)),(t=this.controller.levelView.addResettableTween(this.sprite)).to.apply(t,[{x:this.offset[0]+40*this.position.x+10},s(1500,2e3)].concat(o))},t.prototype.patrolB=function(){var e,t,o=[Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0];(e=this.controller.levelView.addResettableTween(this.sprite)).to.apply(e,[{y:this.offset[1]+40*this.position.y-80},s(2500,3500)].concat(o)),(t=this.controller.levelView.addResettableTween(this.sprite)).to.apply(t,[{x:this.offset[0]+40*this.position.x-10},s(1500,2e3)].concat(o))},t}(r)},2726:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.exports=function(){function e(t){i(this,e),this.controller=t,this.audioPlayer=t.audioPlayer,this.game=t.game,this.assetRoot=t.assetRoot,this.assets={entityShadow:{type:"image",path:this.assetRoot+"images/Character_Shadow.png"},selectionIndicator:{type:"image",path:this.assetRoot+"images/Selection_Indicator.png"},tallGrass:{type:"image",path:this.assetRoot+"images/TallGrass.png"},finishOverlay:{type:"image",path:this.assetRoot+"images/WhiteRect.png"},bed:{type:"image",path:this.assetRoot+"images/Bed.png"},playerSteve:{type:"atlasJSON",pngPath:this.assetRoot+"images/Steve1013.png",jsonPath:this.assetRoot+"images/Steve1013.json"},playerAlex:{type:"atlasJSON",pngPath:this.assetRoot+"images/Alex1013.png",jsonPath:this.assetRoot+"images/Alex1013.json"},playerSteveEvents:{type:"atlasJSON",pngPath:this.assetRoot+"images/Steve_2016.png",jsonPath:this.assetRoot+"images/Steve_2016.json"},playerAlexEvents:{type:"atlasJSON",pngPath:this.assetRoot+"images/DevAlex.png",jsonPath:this.assetRoot+"images/DevAlex.json"},playerAgent:{type:"atlasJSON",pngPath:this.assetRoot+"images/Agent.png",jsonPath:this.assetRoot+"images/Agent.json"},AO:{type:"atlasJSON",pngPath:this.assetRoot+"images/AO.png",jsonPath:this.assetRoot+"images/AO.json"},LavaGlow:{type:"atlasJSON",pngPath:this.assetRoot+"images/LavaGlow.png",jsonPath:this.assetRoot+"images/LavaGlow.json"},WaterAO:{type:"atlasJSON",pngPath:this.assetRoot+"images/WaterAO.png",jsonPath:this.assetRoot+"images/WaterAO.json"},blockShadows:{type:"atlasJSON",pngPath:this.assetRoot+"images/Block_Shadows.png",jsonPath:this.assetRoot+"images/Block_Shadows.json"},undergroundFow:{type:"atlasJSON",pngPath:this.assetRoot+"images/UndergroundFoW.png",jsonPath:this.assetRoot+"images/UndergroundFoW.json"},blocks:{type:"atlasJSON",pngPath:this.assetRoot+"images/Blocks.png",jsonPath:this.assetRoot+"images/Blocks.json"},leavesAcacia:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Acacia_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Acacia_Decay.json"},leavesBirch:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Birch_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Birch_Decay.json"},leavesJungle:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Jungle_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Jungle_Decay.json"},leavesOak:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Oak_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Oak_Decay.json"},leavesSpruce:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Spruce_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Spruce_Decay.json"},leavesSpruceSnowy:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Spruce_Snowy_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Spruce_Snowy_Decay.json"},sheep:{type:"atlasJSON",pngPath:this.assetRoot+"images/Sheep_2016.png",jsonPath:this.assetRoot+"images/Sheep_2016.json"},crops:{type:"atlasJSON",pngPath:this.assetRoot+"images/Crops.png",jsonPath:this.assetRoot+"images/Crops.json"},torch:{type:"atlasJSON",pngPath:this.assetRoot+"images/Torch.png",jsonPath:this.assetRoot+"images/Torch.json"},destroyOverlay:{type:"atlasJSON",pngPath:this.assetRoot+"images/Destroy_Overlay.png",jsonPath:this.assetRoot+"images/Destroy_Overlay.json"},blockExplode:{type:"atlasJSON",pngPath:this.assetRoot+"images/BlockExplode.png",jsonPath:this.assetRoot+"images/BlockExplode.json"},miningParticles:{type:"atlasJSON",pngPath:this.assetRoot+"images/MiningParticles.png",jsonPath:this.assetRoot+"images/MiningParticles.json"},miniBlocks:{type:"atlasJSON",pngPath:this.assetRoot+"images/Miniblocks.png",jsonPath:this.assetRoot+"images/Miniblocks.json"},lavaPop:{type:"atlasJSON",pngPath:this.assetRoot+"images/LavaPop.png",jsonPath:this.assetRoot+"images/LavaPop.json"},redstoneSparkle:{type:"atlasJSON",pngPath:this.assetRoot+"images/Redstone_Sparkle.png",jsonPath:this.assetRoot+"images/Redstone_Sparkle.json"},fire:{type:"atlasJSON",pngPath:this.assetRoot+"images/Fire.png",jsonPath:this.assetRoot+"images/Fire.json"},bubbles:{type:"atlasJSON",pngPath:this.assetRoot+"images/Bubbles.png",jsonPath:this.assetRoot+"images/Bubbles.json"},explosion:{type:"atlasJSON",pngPath:this.assetRoot+"images/Explosion.png",jsonPath:this.assetRoot+"images/Explosion.json"},door:{type:"atlasJSON",pngPath:this.assetRoot+"images/Door.png",jsonPath:this.assetRoot+"images/Door.json"},doorIron:{type:"atlasJSON",pngPath:this.assetRoot+"images/Door_Iron.png",jsonPath:this.assetRoot+"images/Door_Iron.json"},rails:{type:"atlasJSON",pngPath:this.assetRoot+"images/Rails.png",jsonPath:this.assetRoot+"images/Rails.json"},tnt:{type:"atlasJSON",pngPath:this.assetRoot+"images/TNT.png",jsonPath:this.assetRoot+"images/TNT.json"},burningInSun:{type:"atlasJSON",pngPath:this.assetRoot+"images/BurningInSun.png",jsonPath:this.assetRoot+"images/BurningInSun.json"},zombie:{type:"atlasJSON",pngPath:this.assetRoot+"images/Zombie.png",jsonPath:this.assetRoot+"images/Zombie.json"},ironGolem:{type:"atlasJSON",pngPath:this.assetRoot+"images/Iron_Golem.png",jsonPath:this.assetRoot+"images/Iron_Golem.json"},creeper:{type:"atlasJSON",pngPath:this.assetRoot+"images/Creeper_2016.png",jsonPath:this.assetRoot+"images/Creeper_2016.json"},cow:{type:"atlasJSON",pngPath:this.assetRoot+"images/Cow.png",jsonPath:this.assetRoot+"images/Cow.json"},chicken:{type:"atlasJSON",pngPath:this.assetRoot+"images/Chicken.png",jsonPath:this.assetRoot+"images/Chicken.json"},ghast:{type:"atlasJSON",pngPath:this.assetRoot+"images/Ghast.png",jsonPath:this.assetRoot+"images/Ghast.json"},dig_wood1:{type:"sound",mp3:this.assetRoot+"audio/dig_wood1.mp3",wav:this.assetRoot+"audio/dig_wood1.wav",ogg:this.assetRoot+"audio/dig_wood1.ogg"},stepGrass:{type:"sound",mp3:this.assetRoot+"audio/step_grass1.mp3",wav:this.assetRoot+"audio/step_grass1.wav",ogg:this.assetRoot+"audio/step_grass1.ogg"},stepWood:{type:"sound",mp3:this.assetRoot+"audio/wood2.mp3",ogg:this.assetRoot+"audio/wood2.ogg"},stepStone:{type:"sound",mp3:this.assetRoot+"audio/stone2.mp3",ogg:this.assetRoot+"audio/stone2.ogg"},stepGravel:{type:"sound",mp3:this.assetRoot+"audio/gravel1.mp3",ogg:this.assetRoot+"audio/gravel1.ogg"},stepFarmland:{type:"sound",mp3:this.assetRoot+"audio/cloth4.mp3",ogg:this.assetRoot+"audio/cloth4.ogg"},failure:{type:"sound",mp3:this.assetRoot+"audio/break.mp3",ogg:this.assetRoot+"audio/break.ogg"},success:{type:"sound",mp3:this.assetRoot+"audio/levelup.mp3",ogg:this.assetRoot+"audio/levelup.ogg"},fall:{type:"sound",mp3:this.assetRoot+"audio/fallsmall.mp3",ogg:this.assetRoot+"audio/fallsmall.ogg"},fuse:{type:"sound",mp3:this.assetRoot+"audio/fuse.mp3",ogg:this.assetRoot+"audio/fuse.ogg"},explode:{type:"sound",mp3:this.assetRoot+"audio/explode3.mp3",ogg:this.assetRoot+"audio/explode3.ogg"},placeBlock:{type:"sound",mp3:this.assetRoot+"audio/cloth1.mp3",ogg:this.assetRoot+"audio/cloth1.ogg"},collectedBlock:{type:"sound",mp3:this.assetRoot+"audio/pop.mp3",ogg:this.assetRoot+"audio/pop.ogg"},bump:{type:"sound",mp3:this.assetRoot+"audio/hit3.mp3",ogg:this.assetRoot+"audio/hit3.ogg"},punch:{type:"sound",mp3:this.assetRoot+"audio/cloth1.mp3",ogg:this.assetRoot+"audio/cloth1.ogg"},fizz:{type:"sound",mp3:this.assetRoot+"audio/fizz.mp3",ogg:this.assetRoot+"audio/fizz.ogg"},doorOpen:{type:"sound",mp3:this.assetRoot+"audio/door_open.mp3",ogg:this.assetRoot+"audio/door_open.ogg"},houseSuccess:{type:"sound",mp3:this.assetRoot+"audio/launch1.mp3",ogg:this.assetRoot+"audio/launch1.ogg"},minecart:{type:"sound",mp3:this.assetRoot+"audio/minecartBase.mp3",ogg:this.assetRoot+"audio/minecartBase.ogg"},sheepBaa:{type:"sound",mp3:this.assetRoot+"audio/say3.mp3",ogg:this.assetRoot+"audio/say3.ogg"},chickenHurt:{type:"sound",mp3:this.assetRoot+"audio/chickenhurt2.mp3",ogg:this.assetRoot+"audio/chickenhurt2.ogg"},chickenBawk:{type:"sound",mp3:this.assetRoot+"audio/chickensay3.mp3",ogg:this.assetRoot+"audio/chickensay3.ogg"},cowHuff:{type:"sound",mp3:this.assetRoot+"audio/cowhuff.mp3",ogg:this.assetRoot+"audio/cowhuff.ogg"},cowHurt:{type:"sound",mp3:this.assetRoot+"audio/cowhurt.mp3",ogg:this.assetRoot+"audio/cowhurt.ogg"},cowMoo:{type:"sound",mp3:this.assetRoot+"audio/cowmoo1.mp3",ogg:this.assetRoot+"audio/cowmoo1.ogg"},cowMooLong:{type:"sound",mp3:this.assetRoot+"audio/cowmoolong.mp3",ogg:this.assetRoot+"audio/cowmoolong.ogg"},creeperHiss:{type:"sound",mp3:this.assetRoot+"audio/creeper.mp3",ogg:this.assetRoot+"audio/creeper.ogg"},ironGolemHit:{type:"sound",mp3:this.assetRoot+"audio/irongolemhit.mp3",ogg:this.assetRoot+"audio/irongolemhit.ogg"},metalWhack:{type:"sound",mp3:this.assetRoot+"audio/metalwhack.mp3",ogg:this.assetRoot+"audio/metalwhack.ogg"},zombieBrains:{type:"sound",mp3:this.assetRoot+"audio/zombiebrains.mp3",ogg:this.assetRoot+"audio/zombiebrains.ogg"},zombieGroan:{type:"sound",mp3:this.assetRoot+"audio/zombiegroan.mp3",ogg:this.assetRoot+"audio/zombiegroan.ogg"},zombieHurt:{type:"sound",mp3:this.assetRoot+"audio/zombiehurt1.mp3",ogg:this.assetRoot+"audio/zombiehurt1.ogg"},pistonIn:{type:"sound",mp3:this.assetRoot+"audio/piston_in.mp3",ogg:this.assetRoot+"audio/piston_in.ogg"},zombieHurt2:{type:"sound",mp3:this.assetRoot+"audio/zombiehurt2.mp3",ogg:this.assetRoot+"audio/zombiehurt2.ogg"},pistonOut:{type:"sound",mp3:this.assetRoot+"audio/piston_out.mp3",ogg:this.assetRoot+"audio/piston_out.ogg"},portalAmbient:{type:"sound",mp3:this.assetRoot+"audio/portal.mp3",ogg:this.assetRoot+"audio/portal.ogg"},portalTravel:{type:"sound",mp3:this.assetRoot+"audio/travel_portal.mp3",ogg:this.assetRoot+"audio/travel_portal.ogg"},pressurePlateClick:{type:"sound",mp3:this.assetRoot+"audio/pressurePlateClick.mp3",ogg:this.assetRoot+"audio/pressurePlateClick.ogg"},moan2:{type:"sound",mp3:this.assetRoot+"audio/moan2.mp3",ogg:this.assetRoot+"audio/moan2.ogg"},moan3:{type:"sound",mp3:this.assetRoot+"audio/moan3.mp3",ogg:this.assetRoot+"audio/moan3.ogg"},moan6:{type:"sound",mp3:this.assetRoot+"audio/moan6.mp3",ogg:this.assetRoot+"audio/moan6.ogg"},moan7:{type:"sound",mp3:this.assetRoot+"audio/moan7.mp3",ogg:this.assetRoot+"audio/moan7.ogg"}};var o=["dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","minecart","sheepBaa","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","ironGolemHit","metalWhack","zombieBrains","zombieGroan","zombieHurt","pistonIn","pistonOut","portalAmbient","portalTravel","pressurePlateClick","moan2","moan3","moan6","moan7"],n=["chicken","entityShadow","selectionIndicator","AO","blockShadows","tallGrass","blocks","miniBlocks","stepGrass","failure","success"].concat(o);this.assetPacks={adventurerLevelOneAssets:["entityShadow","selectionIndicator","AO","blockShadows","leavesOak","leavesBirch","tallGrass","blocks","sheep","bump","stepGrass","failure","success"],adventurerLevelTwoAssets:["entityShadow","selectionIndicator","AO","blockShadows","leavesSpruce","tallGrass","blocks","sheep","bump","stepGrass","failure","playerSteve","success","miniBlocks","blockExplode","miningParticles","destroyOverlay","dig_wood1","collectedBlock","punch"],adventurerLevelThreeAssets:["entityShadow","selectionIndicator","AO","blockShadows","leavesOak","tallGrass","blocks","sheep","bump","stepGrass","failure","playerSteve","success","miniBlocks","blockExplode","miningParticles","destroyOverlay","dig_wood1","collectedBlock","sheepBaa","punch"],adventurerAllAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesOak","leavesSpruce","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","fire","bubbles","explosion","door","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa"],levelOneAssets:n,levelTwoAssets:n,levelThreeAssets:n,designerAllAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesJungle","leavesOak","leavesSpruce","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","fire","bubbles","explosion","door","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa","zombie","cow","chicken","ironGolem","burningInSun","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","ironGolemHit","metalWhack","zombieBrains","zombieGroan","zombieHurt","zombieHurt2"],heroAllAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesOak","leavesSpruce","leavesSpruceSnowy","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","redstoneSparkle","fire","bubbles","explosion","door","doorIron","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa","zombie","cow","chicken","burningInSun","ghast","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","metalWhack","zombieBrains","zombieGroan","zombieHurt","zombieHurt2","pistonIn","pistonOut","portalAmbient","portalTravel","pressurePlateClick","moan2","moan3","moan6","moan7"],allAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesJungle","leavesOak","leavesSpruce","leavesSpruceSnowy","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","redstoneSparkle","fire","bubbles","explosion","door","doorIron","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa","zombie","cow","chicken","ghast","ironGolem","burningInSun","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","ironGolemHit","metalWhack","zombieBrains","zombieGroan","zombieHurt","zombieHurt2","pistonIn","pistonOut","portalAmbient","portalTravel","pressurePlateClick","moan2","moan3","moan6","moan7"],playerSteve:["playerSteve"],playerAlex:["playerAlex"],playerSteveEvents:["playerSteveEvents"],playerAlexEvents:["playerAlexEvents"],playerAgent:["playerAgent"],grass:["tallGrass"]}}return e.prototype.loadPacks=function(e){var t=this;e.forEach(function(e){t.loadPack(e)})},e.prototype.loadPack=function(e){var t=this.assetPacks[e];this.loadAssets(t)},e.prototype.loadAssets=function(e){var t=this;e.forEach(function(e){var o=t.assets[e];t.loadAsset(e,o)})},e.prototype.loadAsset=function(e,t){switch(t.type){case"image":this.game.load.image(e,t.path);break;case"sound":this.audioPlayer.register({id:e,mp3:t.mp3,ogg:t.ogg});break;case"atlasJSON":this.game.load.atlasJSONHash(e,t.pngPath,t.jsonPath);break;default:throw"Asset "+e+" needs config.type set in configuration."}},e}()},2727:function(e,t,o){"use strict";var i=o(2728),n=o(2729),a=o(2730),r=o(2731),s=o(2732),l=o(2733),c=o(2734),p=o(2735),d=o(1016),u=o(2736);e.exports.get=function(e){return{startCommandCollection:function(){e.DEBUG&&console.log("Collecting commands.")},startAttempt:function(t){e.OnCompleteCallback=t,e.setPlayerActionDelayByQueueLength(),e.queue.begin(),e.run(),e.attemptRunning=!0,e.resultReported=!1},resetAttempt:function(){e.reset(),e.queue.reset(),e.OnCompleteCallback=null,e.attemptRunning=!1},registerEventCallback:function(t,o){e.events.push(o)},onEventTriggered:function(e,t,o,i){this.registerEventCallback(e,function(e){e.eventType===o&&e.targetType===t&&i(e)})},isEventTriggered:function(e,t){return e.eventType===t},moveDirection:function(t,o,i){e.addCommand(new l(e,t,o,i),o)},moveForward:function(t,o){e.addCommand(new r(e,t,o),o)},moveBackward:function(t,o){e.addCommand(new s(e,t,o),o)},moveAway:function(t,o,i){var n=new d(e,t,function(){e.moveAway(n,i)},o);e.addCommand(n)},moveToward:function(t,o,i){var n=new d(e,t,function(){e.moveToward(n,i)},o);e.addCommand(n)},flashEntity:function(t,o){var i=new d(e,t,function(){e.flashEntity(i)},o);e.addCommand(i)},explodeEntity:function(t,o){var i=new d(e,t,function(){e.explodeEntity(i)},o);e.addCommand(i)},use:function(t,o){var i=new d(e,t,function(){e.use(i,o)},o);e.addCommand(i)},playSound:function(t,o,i){var n=new d(e,t,function(){e.playSound(n,o)},i);e.addCommand(n)},turn:function(t,o,i){var n=new d(e,t,function(){e.turn(n,"right"===o?1:-1)},i);e.addCommand(n)},turnRandom:function(t,o){var i=new d(e,t,function(){e.turnRandom(i)},o);e.addCommand(i)},turnRight:function(e,t){this.turn(e,"right",t)},turnLeft:function(e,t){this.turn(e,"left",t)},destroyBlock:function(t,o){var i=new d(e,t,function(){e.destroyBlock(i)},o);e.addCommand(i)},placeBlock:function(t,o,n){e.addCommand(new i(e,t,o,n),n)},placeDirection:function(t,o,i,n){e.addCommand(new a(e,t,o,i,n),i,n)},placeInFront:function(t,o,i){e.addCommand(new n(e,t,o,i),i)},tillSoil:function(t,o){e.addCommand(new n(e,t,"watering",o))},whilePathAhead:function(t,o,i,n){e.addCommand(new c(e,t,o,i,n),i)},ifBlockAhead:function(t,o,i,n){e.addCommand(new p(e,t,o,i,n),i)},repeat:function(t,o,i,n){e.addCommand(new u(e,t,o,i,n))},repeatRandom:function(t,o,i){var n=Math.floor(10*Math.random())+1;e.addCommand(new u(e,t,o,n,i))},getScreenshot:function(){return e.getScreenshot()},spawnEntity:function(t,o,i){var n=new d(e,t,function(){e.spawnEntity(n,o,i)});e.addCommand(n)},destroyEntity:function(t,o){var i=new d(e,t,function(){e.destroyEntity(i,o)},o);e.addGlobalCommand(i)},drop:function(t,o,i){var n=new d(e,t,function(){e.drop(n,o)},i);e.addCommand(n)},startDay:function(t){var o=new d(e,t,function(){e.startDay(o)});e.addGlobalCommand(o)},startNight:function(t){var o=new d(e,t,function(){e.startNight(o)});e.addGlobalCommand(o)},wait:function(t,o,i){var n=new d(e,t,function(){e.wait(n,o)},i);e.addGlobalCommand(n)},attack:function(t,o){var i=new d(e,t,function(){e.attack(i)},o);e.addCommand(i)},setDayNightCycle:function(t,o,i){e.dayNightCycle||(e.dayNightCycle=!0,e.initiateDayNightCycle(t,o,i))},addScore:function(t,o,i){var n=new d(e,t,function(){e.addScore(n,o)},i);e.addGlobalCommand(n)},arrowDown:function(t){e.arrowDown(t)},arrowUp:function(t){e.arrowUp(t)},clickDown:function(){e.clickDown()},clickUp:function(){e.clickUp()}}}},2728:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r,s){i(this,t);var l=n(this,e.call(this,o,a,s));return l.BlockType=r,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.placeBlock(this,this.BlockType)},t}(r)},2729:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r,s){i(this,t);var l=n(this,e.call(this,o,a,s));return l.BlockType=r,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.placeBlockForward(this,this.BlockType)},t}(r)},2730:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r,s,l){i(this,t);var c=n(this,e.call(this,o,a,s));return c.BlockType=r,c.Direction=l,c}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.placeBlockDirection(this,this.BlockType,this.Direction)},t}(r)},2731:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r){return i(this,t),n(this,e.call(this,o,a,r))}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.moveForward(this)},t}(r)},2732:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r){return i(this,t),n(this,e.call(this,o,a,r))}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.moveBackward(this)},t}(r)},2733:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r,s){i(this,t);var l=n(this,e.call(this,o,a,r,s));return l.Direciton=s,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.moveDirection(this,this.Direciton)},t}(r)},2734:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(1270),s=o(1269),l=o(793);e.exports=function(e){function t(o,a,r,l,c){i(this,t);var p=n(this,e.call(this,o,a,l));return p.iterationsLeft=15,p.BlockType=r,p.WhileCode=c,p.queue=new s(o),p}return a(t,e),t.prototype.tick=function(){this.state===r.WORKING&&this.queue.tick(),this.queue.isFailed()&&(this.state=r.FAILURE),this.queue.isSucceeded()&&this.handleWhileCheck()},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.DEBUG&&console.log("WHILE command: BEGIN"),this.handleWhileCheck()},t.prototype.handleWhileCheck=function(){this.iterationsLeft<=0&&(this.state=r.FAILURE),this.GameController.isPathAhead(this.BlockType)?(this.queue.reset(),this.GameController.queue.setWhileCommandInsertState(this.queue),this.WhileCode(),this.GameController.queue.setWhileCommandInsertState(null),this.queue.begin()):this.state=r.SUCCESS,this.iterationsLeft--,this.GameController.DEBUG&&console.log("While command: Iterationsleft   "+this.iterationsLeft+" ")},t}(l)},2735:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(1270),s=o(1269),l=o(793);e.exports=function(e){function t(o,a,r,l,c){i(this,t);var p=n(this,e.call(this,o,a,l));return p.blockType=r,p.ifCodeCallback=c,p.queue=new s(o),p}return a(t,e),t.prototype.tick=function(){this.state===r.WORKING&&this.queue.tick(),this.queue.isFailed()&&(this.state=r.FAILURE),this.queue.isSucceeded()&&(this.state=r.SUCCESS)},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.DEBUG&&console.log("WHILE command: BEGIN"),this.handleIfCheck()},t.prototype.handleIfCheck=function(){if(this.GameController.isPathAhead(this.blockType)){var e=this.GameController.getEntity(this.target).queue;this.queue.reset(),e.setWhileCommandInsertState(this.queue),this.ifCodeCallback(),e.setWhileCommandInsertState(null),this.queue.begin()}else this.state=r.SUCCESS},t}(l)},2736:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=o(793);e.exports=function(e){function t(o,a,r,s,l){i(this,t);var c=n(this,e.call(this,o,a,l));return c.actionCallback=r,c.iteration=s,c}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.succeeded(),this.addRepeatCommand()},t.prototype.addRepeatCommand=function(){var e=this.GameController.levelEntity.entityMap.get(this.target);void 0===e?this.GameController.queue.addRepeatCommands(this.actionCallback,this.iteration):e.queue.addRepeatCommands(this.actionCallback,this.iteration)},t}(r)},2737:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){return i.load(e,t)}},2739:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){return i.load(e,t)}},2740:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=o(1),a=i(n),r=o(1737),s=i(r),l=o(788),c=i(l),p=o(40),d=o(819).default,u=o(824),h=function(e){return a.default.createElement("span",null,a.default.createElement(c.default,null,a.default.createElement("div",{id:"minecraft-frame"},a.default.createElement("div",{id:"phaser-game"}))),a.default.createElement(d,null,a.default.createElement(s.default,null),e.showFinishButton&&a.default.createElement("div",{id:"right-button-cell"},a.default.createElement("button",{id:"finishButton",className:"share mc-share-button"},a.default.createElement("div",null,p.finish())))),a.default.createElement(u,null))};h.propTypes={showFinishButton:n.PropTypes.bool.isRequired},e.exports=h},2741:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,o,i){var n=t.split("\n"),a=Math.max(i-3,0),r=Math.min(n.length,i+3),s=n.slice(a,r).map(function(e,t){var o=t+a+1;return(o==i?" >> ":"    ")+o+"| "+e}).join("\n");throw e.path=o,e.message=(o||"ejs")+":"+i+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectLetsGetStarted() %></h1>\n\n<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',__filename="src/craft/agent/dialogs/playerSelection.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(1955);__append('\n<h1 class="minecraft-big-yellow-header" id="getting-started-header">'),__line=2,__append(escape(i18n.playerSelectLetsGetStarted())),__append('</h1>\n\n<h2 id="select-character-text">'),__line=4,__append(escape(i18n.playerSelectChooseCharacter())),__append('</h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select">'),__line=10,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select">'),__line=15,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n'),__line=20}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectLetsGetStarted() %></h1>\n\n<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',"src/craft/agent/dialogs/playerSelection.html.ejs",__line)}}},2742:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=o(744),a=i(n),r=o(2131),s=i(r);t.load=function(e,t){var o=a.default.load(e,t);return o.replaceInstructions=function(e){return e?e.replace(/{currentPlayerName}/g,s.default.getCurrentCharacter()):e},o.instructions2ImageSubstitutions={agent:"/blockly/media/craft/instructions/agent.png",NetherPortal:"/blockly/media/craft/instructions/NetherPortal.png",PressurePlate_Up:"/blockly/media/craft/instructions/PressurePlate_Up.png",Rails_Vertical:"/blockly/media/craft/instructions/Rails_Vertical.png",cactus:"/blockly/media/craft/instructions/cactus.png",door_iron:"/blockly/media/craft/instructions/door_iron.png",book_enchanted:"/blockly/media/craft/instructions/book_enchanted.png",compass:"/blockly/media/craft/instructions/compass.png",diamond_axe:"/blockly/media/craft/instructions/diamond_axe.png",diamond_pickaxe:"/blockly/media/craft/instructions/diamond_pickaxe.png",diamond_shovel:"/blockly/media/craft/instructions/diamond_shovel.png",flint_and_steel:"/blockly/media/craft/instructions/flint_and_steel.png",flint:"/blockly/media/craft/instructions/flint.png",map_empty:"/blockly/media/craft/instructions/map_empty.png",chest:"/blockly/media/craft/instructions/chest.png",bucket_empty:"/blockly/media/craft/instructions/bucket_empty.png",redstone_torch:"/blockly/media/craft/instructions/redstone_torch.png",minecart_normal:"/blockly/media/craft/instructions/minecart_normal.png"},o}},2744:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){return i.load(e,t)}},2747:function(e,t,o){"use strict";var i=o(744),n={flappy:{}};t.load=function(e,t){var o=i.load(e,t),a=n[o.id];return o.scifi={background:o.assetUrl("background_scifi.png"),avatar:o.assetUrl("avatar_scifi.png"),obstacle_bottom:o.assetUrl("obstacle_bottom_scifi.png"),obstacle_bottom_thumb:o.assetUrl("obstacle_bottom_scifi_thumb.png"),obstacle_top:o.assetUrl("obstacle_top_scifi.png"),ground:o.assetUrl("ground_scifi.png"),ground_thumb:o.assetUrl("ground_scifi_thumb.png")},o.underwater={background:o.assetUrl("background_underwater.png"),avatar:o.assetUrl("avatar_underwater.png"),obstacle_bottom:o.assetUrl("obstacle_bottom_underwater.png"),obstacle_bottom_thumb:o.assetUrl("obstacle_bottom_underwater_thumb.png"),obstacle_top:o.assetUrl("obstacle_top_underwater.png"),ground:o.assetUrl("ground_underwater.png"),ground_thumb:o.assetUrl("ground_underwater_thumb.png")},o.cave={background:o.assetUrl("background_cave.png"),avatar:o.assetUrl("avatar_cave.png"),obstacle_bottom:o.assetUrl("obstacle_bottom_cave.png"),obstacle_bottom_thumb:o.assetUrl("obstacle_bottom_cave_thumb.png"),obstacle_top:o.assetUrl("obstacle_top_cave.png"),ground:o.assetUrl("ground_cave.png"),ground_thumb:o.assetUrl("ground_cave_thumb.png")},o.santa={background:o.assetUrl("background_santa.png"),avatar:o.assetUrl("santa.png"),obstacle_bottom:o.assetUrl("obstacle_bottom_santa.png"),obstacle_bottom_thumb:o.assetUrl("obstacle_bottom_santa_thumb.png"),obstacle_top:o.assetUrl("obstacle_top_santa.png"),ground:o.assetUrl("ground_santa.png"),ground_thumb:o.assetUrl("ground_santa_thumb.png")},o.night={background:o.assetUrl("background_night.png")},o.redbird={avatar:o.assetUrl("avatar_redbird.png")},o.laser={obstacle_bottom:o.assetUrl("obstacle_bottom_laser.png"),obstacle_bottom_thumb:o.assetUrl("obstacle_bottom_laser_thumb.png"),obstacle_top:o.assetUrl("obstacle_top_laser.png")},o.lava={ground:o.assetUrl("ground_lava.png"),ground_thumb:o.assetUrl("ground_lava_thumb.png")},o.shark={avatar:o.assetUrl("shark.png")},o.easter={avatar:o.assetUrl("easterbunny.png")},o.batman={avatar:o.assetUrl("batman.png")},o.submarine={avatar:o.assetUrl("submarine.png")},o.unicorn={avatar:o.assetUrl("unicorn.png")},o.fairy={avatar:o.assetUrl("fairy.png")},o.superman={avatar:o.assetUrl("superman.png")},o.turkey={avatar:o.assetUrl("turkey.png")},o.ground=o.assetUrl("ground.png"),o.ground_thumb=o.assetUrl("ground_thumb.png"),o.obstacle_top=o.assetUrl("obstacle_top.png"),o.obstacle_bottom=o.assetUrl("obstacle_bottom.png"),o.obstacle_bottom_thumb=o.assetUrl("obstacle_bottom_thumb.png"),o.instructions=o.assetUrl("instructions.png"),o.clickrun=o.assetUrl("clickrun.png"),o.getready=o.assetUrl("getready.png"),o.gameover=o.assetUrl("gameover.png"),o.flapIcon=o.assetUrl("flap-bird.png"),o.crashIcon=o.assetUrl("when-crash.png"),o.collideObstacleIcon=o.assetUrl("when-obstacle.png"),o.collideGroundIcon=o.assetUrl("when-crash.png"),o.enterObstacleIcon=o.assetUrl("when-pass.png"),o.tiles=o.assetUrl("tiles.png"),o.goal=o.assetUrl("goal.png"),o.goalSuccess=o.assetUrl("goal_success.png"),o.obstacle=o.assetUrl("obstacle.png"),o.obstacleScale=a.obstacleScale||1,o.largerObstacleAnimationTiles=o.assetUrl(a.largerObstacleAnimationTiles),o.hittingWallAnimation=o.assetUrl(a.hittingWallAnimation),o.approachingGoalAnimation=o.assetUrl(a.approachingGoalAnimation),o.obstacleSound=[o.assetUrl("obstacle.mp3"),o.assetUrl("obstacle.ogg")],o.wallSound=[o.assetUrl("wall.mp3"),o.assetUrl("wall.ogg")],o.winGoalSound=[o.assetUrl("win_goal.mp3"),o.assetUrl("win_goal.ogg")],o.wall0Sound=[o.assetUrl("wall0.mp3"),o.assetUrl("wall0.ogg")],o.dieSound=[o.assetUrl("sfx_die.mp3"),o.assetUrl("sfx_die.ogg")],o.hitSound=[o.assetUrl("sfx_hit.mp3"),o.assetUrl("sfx_hit.ogg")],o.pointSound=[o.assetUrl("sfx_point.mp3"),o.assetUrl("sfx_point.ogg")],o.swooshingSound=[o.assetUrl("sfx_swooshing.mp3"),o.assetUrl("sfx_swooshing.ogg")],o.wingSound=[o.assetUrl("sfx_wing.mp3"),o.assetUrl("sfx_wing.ogg")],o.jetSound=[o.assetUrl("jet.mp3"),o.assetUrl("jet.ogg")],o.crashSound=[o.assetUrl("crash.mp3"),o.assetUrl("crash.ogg")],o.jingleSound=[o.assetUrl("jingle.mp3"),o.assetUrl("jingle.ogg")],o.laserSound=[o.assetUrl("laser.mp3"),o.assetUrl("laser.ogg")],o.splashSound=[o.assetUrl("splash.mp3"),o.assetUrl("splash.ogg")],o.graph=a.graph,o.background=o.assetUrl("background.png"),o}},2750:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){return i.load(e,t)}},2751:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){var o=i.load(e,t);return o.artist=o.assetUrl("artist.png"),o.blocks=o.assetUrl("blocks.png"),o.apple=o.assetUrl("apple.png"),o.smiley=o.assetUrl("smiley.png"),o.snail=o.assetUrl("snail.png"),o.elephant=o.assetUrl("elephant.png"),o.fish=o.assetUrl("fish.png"),o.doggie=o.assetUrl("doggie.png"),o.tree=o.assetUrl("tree.png"),o.flower=o.assetUrl("flower.png"),o.house=o.assetUrl("house.png"),o.computer=o.assetUrl("computer.png"),o.blank=o.assetUrl("blank.png"),o.smallStaticAvatar=o.blank,o.background=o.assetUrl("background.png"),o}},2793:function(e,t,o){"use strict";var i=o(744);t.load=function(e,t){return i.load(e,t)}},2800:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){e.twitterOptions=g,e.defaultBackground="dots",e.projectileFrames=10,e.itemFrames=10,e.spriteHeight=110,e.spriteWidth=110,e.spriteCollisionRectWidth=60,e.spriteCollisionRectHeight=60,e.ProjectileClassNames=["projectile_banana","projectile_dodgeball","projectile_donkey","projectile_handbag","projectile_hotdog","projectile_pompom","projectile_toaster","projectile_waterball"],e.ItemClassNames=["item_projectile_banana","item_projectile_dodgeball","item_projectile_donkey","item_projectile_handbag","item_projectile_hotdog","item_projectile_pompom","item_projectile_toaster","item_projectile_waterball"],e.projectile_banana=e.assetUrl("projectile_banana.png"),e.projectile_dodgeball=e.assetUrl("projectile_dodgeball.png"),e.projectile_donkey=e.assetUrl("projectile_donkey.png"),e.projectile_handbag=e.assetUrl("projectile_handbag.png"),e.projectile_hotdog=e.assetUrl("projectile_hotdog.png"),e.projectile_pompom=e.assetUrl("projectile_pompom.png"),e.projectile_toaster=e.assetUrl("projectile_toaster.png"),e.projectile_waterball=e.assetUrl("projectile_waterball.png"),e.item_projectile_banana=e.assetUrl("projectile_banana.png"),e.item_projectile_dodgeball=e.assetUrl("projectile_dodgeball.png"),e.item_projectile_donkey=e.assetUrl("projectile_donkey.png"),e.item_projectile_handbag=e.assetUrl("projectile_handbag.png"),e.item_projectile_hotdog=e.assetUrl("projectile_hotdog.png"),e.item_projectile_pompom=e.assetUrl("projectile_pompom.png"),e.item_projectile_toaster=e.assetUrl("projectile_toaster.png"),e.item_projectile_waterball=e.assetUrl("projectile_waterball.png"),e.explosion=e.assetUrl("explosion.png"),e.explosionThumbnail=e.assetUrl("explosion_thumb.png"),e.explosionFrames=40,e.fadeExplosion=!1,e.timePerExplosionFrame=20,e.characters={background:e.assetUrl("background_characters.png")},e.checkers={background:e.assetUrl("background_checkers.png")},e.clouds={background:e.assetUrl("background_clouds.png")},e.cornered={background:e.assetUrl("background_cornered.png")},e.dots={background:e.assetUrl("background_dots.png")},e.graffiti={background:e.assetUrl("background_graffiti.png")},e.space={background:e.assetUrl("background_space.png")},e.squares={background:e.assetUrl("background_squares.png")},e.stripes={background:e.assetUrl("background_stripes.png")},e.wood={background:e.assetUrl("background_wood.png")},e.avatarList=["anais","anton","bananajoe","darwin","gumball","nicole","penny","richard"],e.walkValues=[8,8,8,12,12,8,10,12],e.avatarList.forEach(function(t,o){e[t]={sprite:e.assetUrl("idle_"+t+".png"),walk:e.assetUrl("walk_"+t+".png"),dropdownThumbnail:e.assetUrl("avatar_"+t+"_thumb.png"),frameCounts:{normal:19,turns:8,emotions:0,walk:e.walkValues[o],extraEmotions:3,walkingEmotions:3},animations:{turns:8,walkingEmotions:3},animationFrameDuration:3}}),e.backgroundChoices=[[p.default.setBackgroundRandom(),l.RANDOM_VALUE],[p.default.setBackgroundCharacters(),'"characters"'],[p.default.setBackgroundCheckers(),'"checkers"'],[p.default.setBackgroundClouds(),'"clouds"'],[p.default.setBackgroundCornered(),'"cornered"'],[p.default.setBackgroundDots(),'"dots"'],[p.default.setBackgroundGraffiti(),'"graffiti"'],[p.default.setBackgroundSpace(),'"space"'],[p.default.setBackgroundSquares(),'"squares"'],[p.default.setBackgroundStripes(),'"stripes"'],[p.default.setBackgroundWood(),'"wood"']],e.backgroundChoicesK1=[[e.characters.background,'"characters"'],[e.checkers.background,'"checkers"'],[e.clouds.background,'"clouds"'],[e.cornered.background,'"cornered"'],[e.dots.background,'"dots"'],[e.graffiti.background,'"graffiti"'],[e.space.background,'"space"'],[e.squares.background,'"squares"'],[e.stripes.background,'"stripes"'],[e.wood.background,'"wood"'],[e.randomPurpleIcon,l.RANDOM_VALUE]],e.spriteChoices=[[p.default.setSpriteHidden(),l.HIDDEN_VALUE],[p.default.setSpriteRandom(),l.RANDOM_VALUE],[p.default.setSpriteAnais(),'"anais"'],[p.default.setSpriteAnton(),'"anton"'],[p.default.setSpriteBananajoe(),'"bananajoe"'],[p.default.setSpriteDarwin(),'"darwin"'],[p.default.setSpriteGumball(),'"gumball"'],[p.default.setSpriteNicole(),'"nicole"'],[p.default.setSpritePenny(),'"penny"'],[p.default.setSpriteRichard(),'"richard"']],e.projectileChoices=[[p.default.projectileBanana(),'"projectile_banana"'],[p.default.projectileDodgeball(),'"projectile_dodgeball"'],[p.default.projectileDonkey(),'"projectile_donkey"'],[p.default.projectileHandbag(),'"projectile_handbag"'],[p.default.projectileHotdog(),'"projectile_hotdog"'],[p.default.projectilePompom(),'"projectile_pompom"'],[p.default.projectileToaster(),'"projectile_toaster"'],[p.default.projectileWaterball(),'"projectile_waterball"'],[p.default.projectileRandom(),l.RANDOM_VALUE]],e.makeProjectileChoices=[[p.default.makeProjectileBanana(),'"projectile_banana"'],[p.default.makeProjectileDodgeball(),'"projectile_dodgeball"'],[p.default.makeProjectileDonkey(),'"projectile_donkey"'],[p.default.makeProjectileHandbag(),'"projectile_handbag"'],[p.default.makeProjectileHotdog(),'"projectile_hotdog"'],[p.default.makeProjectilePompom(),'"projectile_pompom"'],[p.default.makeProjectileToaster(),'"projectile_toaster"'],[p.default.makeProjectileWaterball(),'"projectile_waterball"']],e.whenProjectileCollidedChoices=[[p.default.whenSpriteCollidedWithProjectileBanana(),"projectile_banana"],[p.default.whenSpriteCollidedWithProjectileDodgeball(),"projectile_dodgeball"],[p.default.whenSpriteCollidedWithProjectileDonkey(),"projectile_donkey"],[p.default.whenSpriteCollidedWithProjectileHandbag(),"projectile_handbag"],[p.default.whenSpriteCollidedWithProjectileHotdog(),"projectile_hotdog"],[p.default.whenSpriteCollidedWithProjectilePompom(),"projectile_pompom"],[p.default.whenSpriteCollidedWithProjectileToaster(),"projectile_toaster"],[p.default.whenSpriteCollidedWithProjectileWaterball(),"projectile_waterball"]],e.itemChoices=[[p.default.itemProjectileBanana(),'"item_projectile_banana"'],[p.default.itemProjectileDodgeball(),'"item_projectile_dodgeball"'],[p.default.itemProjectileDonkey(),'"item_projectile_donkey"'],[p.default.itemProjectileHandbag(),'"item_projectile_handbag"'],[p.default.itemProjectileHotdog(),'"item_projectile_hotdog"'],[p.default.itemProjectilePompom(),'"item_projectile_pompom"'],[p.default.itemProjectileToaster(),'"item_projectile_toaster"'],[p.default.itemProjectileWaterball(),'"item_projectile_waterball"'],[p.default.itemRandom(),l.RANDOM_VALUE]]}function a(e){e.twitterOptions=g,e.defaultBackground="icy1",e.projectileFrames=10,e.itemFrames=10,e.spriteHeight=130,e.spriteWidth=130,e.spriteCollisionRectWidth=60,e.spriteCollisionRectHeight=60,e.ProjectileClassNames=["ia_projectile_1","ia_projectile_2","ia_projectile_3","ia_projectile_4","ia_projectile_5"],e.ItemClassNames=["item_ia_projectile_1","item_ia_projectile_2","item_ia_projectile_3","item_ia_projectile_4","item_ia_projectile_5"],e.ia_projectile_1=e.assetUrl("ia_projectile_1.png"),e.ia_projectile_2=e.assetUrl("ia_projectile_2.png"),e.ia_projectile_3=e.assetUrl("ia_projectile_3.png"),e.ia_projectile_4=e.assetUrl("ia_projectile_4.png"),e.ia_projectile_5=e.assetUrl("ia_projectile_5.png"),e.item_ia_projectile_1=e.assetUrl("ia_projectile_1.png"),e.item_ia_projectile_2=e.assetUrl("ia_projectile_2.png"),e.item_ia_projectile_3=e.assetUrl("ia_projectile_3.png"),e.item_ia_projectile_4=e.assetUrl("ia_projectile_4.png"),e.item_ia_projectile_5=e.assetUrl("ia_projectile_5.png"),e.explosion=e.assetUrl("explosion.png"),e.explosionThumbnail=e.assetUrl("explosion_thumb.png"),e.explosionFrames=17,e.fadeExplosion=!1,e.timePerExplosionFrame=40,e.icy1={background:e.assetUrl("background_icy1.jpg")},e.icy2={background:e.assetUrl("background_icy2.jpg")},e.icy3={background:e.assetUrl("background_icy3.jpg")},e.icy4={background:e.assetUrl("background_icy4.jpg")},e.icy5={background:e.assetUrl("background_icy5.jpg")},e.ground={background:e.assetUrl("background_ground.jpg")},e.avatarList=["manny","sid","scrat","diego","granny"],e.avatarList.forEach(function(t){e[t]={sprite:e.assetUrl("avatar_"+t+".png"),walk:e.assetUrl("walk_"+t+".png"),dropdownThumbnail:e.assetUrl("avatar_"+t+"_thumb.png"),frameCounts:{normal:19,turns:8,emotions:0,walk:12,extraEmotions:3,walkingEmotions:3},animations:{turns:8,walkingEmotions:3},animationFrameDuration:3}}),e.backgroundChoices=[[p.default.setBackgroundRandom(),l.RANDOM_VALUE],[p.default.setBackgroundIcy1(),'"icy1"'],[p.default.setBackgroundIcy2(),'"icy2"'],[p.default.setBackgroundIcy3(),'"icy3"'],[p.default.setBackgroundIcy4(),'"icy4"'],[p.default.setBackgroundIcy5(),'"icy5"'],[p.default.setBackgroundGround(),'"ground"']],e.backgroundChoicesK1=[[e.icy1.background,'"icy1"'],[e.icy2.background,'"icy2"'],[e.icy3.background,'"icy3"'],[e.icy4.background,'"icy4"'],[e.icy5.background,'"icy5"'],[e.ground.background,'"ground"'],[e.randomPurpleIcon,l.RANDOM_VALUE]],e.spriteChoices=[[p.default.setSpriteHidden(),l.HIDDEN_VALUE],[p.default.setSpriteRandom(),l.RANDOM_VALUE],[p.default.setSpriteManny(),'"manny"'],[p.default.setSpriteSid(),'"sid"'],[p.default.setSpriteScrat(),'"scrat"'],[p.default.setSpriteDiego(),'"diego"'],[p.default.setSpriteGranny(),'"granny"']],e.projectileChoices=[[p.default.projectileIAProjectile1(),'"ia_projectile_1"'],[p.default.projectileIAProjectile2(),'"ia_projectile_2"'],[p.default.projectileIAProjectile3(),'"ia_projectile_3"'],[p.default.projectileIAProjectile4(),'"ia_projectile_4"'],[p.default.projectileIAProjectile5(),'"ia_projectile_5"'],[p.default.projectileRandom(),l.RANDOM_VALUE]],e.makeProjectileChoices=[[p.default.makeProjectileIAProjectile1(),'"ia_projectile_1"'],[p.default.makeProjectileIAProjectile2(),'"ia_projectile_2"'],[p.default.makeProjectileIAProjectile3(),'"ia_projectile_3"'],[p.default.makeProjectileIAProjectile4(),'"ia_projectile_4"'],[p.default.makeProjectileIAProjectile5(),'"ia_projectile_5"']],e.whenProjectileCollidedChoices=[[p.default.whenSpriteCollidedWithIAProjectile1(),"ia_projectile_1"],[p.default.whenSpriteCollidedWithIAProjectile2(),"ia_projectile_2"],[p.default.whenSpriteCollidedWithIAProjectile3(),"ia_projectile_3"],[p.default.whenSpriteCollidedWithIAProjectile4(),"ia_projectile_4"],[p.default.whenSpriteCollidedWithIAProjectile5(),"ia_projectile_5"]],e.itemChoices=[[p.default.itemIAProjectile1(),'"item_ia_projectile_1"'],[p.default.itemIAProjectile2(),'"item_ia_projectile_2"'],[p.default.itemIAProjectile3(),'"item_ia_projectile_3"'],[p.default.itemIAProjectile4(),'"item_ia_projectile_4"'],[p.default.itemIAProjectile5(),'"item_ia_projectile_5"'],[p.default.itemRandom(),l.RANDOM_VALUE]]}function r(e){e.preloadAssets=!0,e.defaultBackground="leafy",e.projectileFrames=10,e.itemFrames=10,e.ProjectileClassNames=["projectile_hiro","projectile_anna","projectile_elsa","projectile_baymax","projectile_rapunzel","projectile_cherry","projectile_ice","projectile_duck"],e.specialProjectileProperties={projectile_cherry:{frames:13},projectile_ice:{frames:12},projectile_duck:{frames:12}},e.ItemClassNames=["item_hiro","item_anna","item_elsa","item_baymax","item_rapunzel","item_cherry","item_ice","item_duck"],e.specialItemProperties={item_cherry:{frames:13},item_ice:{frames:12},item_duck:{frames:12}},e.explosion=e.assetUrl("vanish.png"),e.explosionFrames=17,e.fadeExplosion=!0,e.timePerExplosionFrame=100,e.projectileSpriteWidth=70,e.projectileSpriteHeight=70,e.avatarList=["anna","elsa","hiro","baymax","rapunzel"],e.avatarList.forEach(function(t){e[t]={sprite:e.assetUrl("avatar_"+t+".png"),walk:e.assetUrl("walk_"+t+".png"),dropdownThumbnail:e.assetUrl("avatar_"+t+"_thumb.png"),frameCounts:{normal:19,turns:8,emotions:0,walk:12},animations:{turns:8},animationFrameDuration:3}}),e.preventProjectileLoop=function(e){return"projectile_hiro"===e},e.preventItemLoop=function(e){return"item_hiro"===e},e.projectile_hiro=e.assetUrl("projectile_hiro.png"),e.projectile_anna=e.assetUrl("projectile_anna.png"),e.projectile_elsa=e.assetUrl("projectile_elsa.png"),e.projectile_baymax=e.assetUrl("projectile_baymax.png"),e.projectile_rapunzel=e.assetUrl("projectile_rapunzel.png"),e.projectile_cherry=e.assetUrl("projectile_cherry.png"),e.projectile_ice=e.assetUrl("projectile_ice.png"),e.projectile_duck=e.assetUrl("projectile_duck.png"),e.item_hiro=e.assetUrl("projectile_hiro.png"),e.item_anna=e.assetUrl("projectile_anna.png"),e.item_elsa=e.assetUrl("projectile_elsa.png"),e.item_baymax=e.assetUrl("projectile_baymax.png"),e.item_rapunzel=e.assetUrl("projectile_rapunzel.png"),e.item_cherry=e.assetUrl("projectile_cherry.png"),e.item_ice=e.assetUrl("projectile_ice.png"),e.item_duck=e.assetUrl("projectile_duck.png"),e.leafy={background:e.assetUrl("background_leafy.jpg")},e.grassy={background:e.assetUrl("background_grassy.jpg")},e.flower={background:e.assetUrl("background_flower.jpg")},e.tile={background:e.assetUrl("background_tile.jpg")},e.icy={background:e.assetUrl("background_icy.jpg")},e.snowy={background:e.assetUrl("background_snowy.jpg")},e.backgroundChoices=[[p.default.setBackgroundRandom(),l.RANDOM_VALUE],[p.default.setBackgroundLeafy(),'"leafy"'],[p.default.setBackgroundGrassy(),'"grassy"'],[p.default.setBackgroundFlower(),'"flower"'],[p.default.setBackgroundTile(),'"tile"'],[p.default.setBackgroundIcy(),'"icy"'],[p.default.setBackgroundSnowy(),'"snowy"']],e.backgroundChoicesK1=[[e.leafy.background,'"leafy"'],[e.grassy.background,'"grassy"'],[e.flower.background,'"flower"'],[e.tile.background,'"tile"'],[e.icy.background,'"icy"'],[e.snowy.background,'"snowy"'],[e.randomPurpleIcon,l.RANDOM_VALUE]],e.spriteChoices=[[p.default.setSpriteHidden(),l.HIDDEN_VALUE],[p.default.setSpriteRandom(),l.RANDOM_VALUE],[p.default.setSpriteAnna(),'"anna"'],[p.default.setSpriteElsa(),'"elsa"'],[p.default.setSpriteHiro(),'"hiro"'],[p.default.setSpriteBaymax(),'"baymax"'],[p.default.setSpriteRapunzel(),'"rapunzel"']],e.projectileChoices=[[p.default.projectileHiro(),'"projectile_hiro"'],[p.default.projectileAnna(),'"projectile_anna"'],[p.default.projectileElsa(),'"projectile_elsa"'],[p.default.projectileBaymax(),'"projectile_baymax"'],[p.default.projectileRapunzel(),'"projectile_rapunzel"'],[p.default.projectileCherry(),'"projectile_cherry"'],[p.default.projectileIce(),'"projectile_ice"'],[p.default.projectileDuck(),'"projectile_duck"'],[p.default.projectileRandom(),l.RANDOM_VALUE]],e.itemChoices=[[p.default.itemHiro(),'"item_hiro"'],[p.default.itemAnna(),'"item_anna"'],[p.default.itemElsa(),'"item_elsa"'],[p.default.itemBaymax(),'"item_baymax"'],[p.default.itemRapunzel(),'"item_rapunzel"'],[p.default.itemCherry(),'"item_cherry"'],[p.default.itemIce(),'"item_ice"'],[p.default.itemDuck(),'"item_duck"'],[p.default.itemRandom(),l.RANDOM_VALUE]]}function s(e){e.defaultBackground="cave",e.projectileFrames=8,e.itemFrames=8,e.explosion=e.assetUrl("explosion.png"),e.explosionThumbnail=e.assetUrl("explosion_thumb.png"),e.explosionFrames=20,e.fadeExplosion=!1,e.timePerExplosionFrame=40,e.hardcourt={background:e.assetUrl("background.png")},e.black={background:e.assetUrl("retro_background.png")},e.cave={background:e.assetUrl("background_cave.png")},e.night={background:e.assetUrl("background_santa.png")},e.cloudy={background:e.assetUrl("background_scifi.png")},e.underwater={background:e.assetUrl("background_underwater.png")},e.city={background:e.assetUrl("background_city.png")},e.desert={background:e.assetUrl("background_desert.png")},e.rainbow={background:e.assetUrl("background_rainbow.png")},e.soccer={background:e.assetUrl("background_soccer.png")},e.space={background:e.assetUrl("background_space.png")},e.tennis={background:e.assetUrl("background_tennis.png")},e.winter={background:e.assetUrl("background_winter.png")},e.grid={background:e.assetUrl("background_grid.png")},e.mapChoices=[[p.default.setMapRandom(),l.RANDOM_VALUE],[p.default.setMapBlank(),"blank"],[p.default.setMapCircle(),"circle"],[p.default.setMapHorizontal(),"horizontal"],[p.default.setMapGrid(),"grid"],[p.default.setMapBlobs(),"blobs"]],e.wallMaps={blank:{srcUrl:e.assetUrl("obstacle_blank.png")},circle:{srcUrl:e.assetUrl("obstacle_circle.png")},horizontal:{srcUrl:e.assetUrl("obstacle_horizontal.png")},grid:{srcUrl:e.assetUrl("obstacle_grid.png")},blobs:{srcUrl:e.assetUrl("obstacle_blobs.png")}},e.avatarList=["dog","cat","penguin","dinosaur","octopus","witch","bat","bird","dragon","squirrel","wizard","alien","ghost","monster","robot","unicorn","zombie","knight","ninja","pirate","caveboy","cavegirl","princess","spacebot","soccergirl","soccerboy","tennisgirl","tennisboy"],e.avatarList.forEach(function(t){e[t]={sprite:e.assetUrl(t+"_spritesheet_200px.png"),dropdownThumbnail:e.assetUrl(t+"_thumb.png"),frameCounts:{normal:2,holdIdleFrame0Count:8,turns:7,emotions:3},animationFrameDuration:6}}),e.backgroundChoices=[[p.default.setBackgroundRandom(),l.RANDOM_VALUE],[p.default.setBackgroundCave(),'"cave"'],[p.default.setBackgroundNight(),'"night"'],[p.default.setBackgroundCloudy(),'"cloudy"'],[p.default.setBackgroundUnderwater(),'"underwater"'],[p.default.setBackgroundHardcourt(),'"hardcourt"'],[p.default.setBackgroundBlack(),'"black"'],[p.default.setBackgroundCity(),'"city"'],[p.default.setBackgroundDesert(),'"desert"'],[p.default.setBackgroundRainbow(),'"rainbow"'],[p.default.setBackgroundSoccer(),'"soccer"'],[p.default.setBackgroundSpace(),'"space"'],[p.default.setBackgroundTennis(),'"tennis"'],[p.default.setBackgroundWinter(),'"winter"']],e.backgroundChoicesK1=[[e.cave.background,'"cave"'],[e.night.background,'"night"'],[e.cloudy.background,'"cloudy"'],[e.underwater.background,'"underwater"'],[e.hardcourt.background,'"hardcourt"'],[e.black.background,'"black"'],[e.city.background,'"city"'],[e.desert.background,'"desert"'],[e.rainbow.background,'"rainbow"'],[e.soccer.background,'"soccer"'],[e.space.background,'"space"'],[e.tennis.background,'"tennis"'],[e.winter.background,'"winter"'],[e.randomPurpleIcon,l.RANDOM_VALUE]],e.spriteChoices=[[p.default.setSpriteHidden(),l.HIDDEN_VALUE],[p.default.setSpriteRandom(),l.RANDOM_VALUE],[p.default.setSpriteWitch(),'"witch"'],[p.default.setSpriteCat(),'"cat"'],[p.default.setSpriteDinosaur(),'"dinosaur"'],[p.default.setSpriteDog(),'"dog"'],[p.default.setSpriteOctopus(),'"octopus"'],[p.default.setSpritePenguin(),'"penguin"'],[p.default.setSpriteBat(),'"bat"'],[p.default.setSpriteBird(),'"bird"'],[p.default.setSpriteDragon(),'"dragon"'],[p.default.setSpriteSquirrel(),'"squirrel"'],[p.default.setSpriteWizard(),'"wizard"'],[p.default.setSpriteAlien(),'"alien"'],[p.default.setSpriteGhost(),'"ghost"'],[p.default.setSpriteMonster(),'"monster"'],[p.default.setSpriteRobot(),'"robot"'],[p.default.setSpriteUnicorn(),'"unicorn"'],[p.default.setSpriteZombie(),'"zombie"'],[p.default.setSpriteKnight(),'"knight"'],[p.default.setSpriteNinja(),'"ninja"'],[p.default.setSpritePirate(),'"pirate"'],[p.default.setSpriteCaveBoy(),'"caveboy"'],[p.default.setSpriteCaveGirl(),'"cavegirl"'],[p.default.setSpritePrincess(),'"princess"'],[p.default.setSpriteSpacebot(),'"spacebot"'],[p.default.setSpriteSoccerGirl(),'"soccergirl"'],[p.default.setSpriteSoccerBoy(),'"soccerboy"'],[p.default.setSpriteTennisGirl(),'"tennisgirl"'],[p.default.setSpriteTennisBoy(),'"tennisboy"']],e.projectileChoices=[[p.default.projectileAirplane(),'"airplane"'],[p.default.projectileBasketball(),'"basketball"'],[p.default.projectileDisc(),'"disc"'],[p.default.projectilePie(),'"pie"'],[p.default.projectilePumpkin(),'"pumpkin"'],[p.default.projectileStar(),'"star"'],[p.default.projectileSandwich(),'"sandwich"'],[p.default.projectileSnowball(),'"snowball"'],[p.default.projectileBlueFireball(),'"blue_fireball"'],[p.default.projectilePurpleFireball(),'"purple_fireball"'],[p.default.projectileRedFireball(),'"red_fireball"'],[p.default.projectileYellowHearts(),'"yellow_hearts"'],[p.default.projectilePurpleHearts(),'"purple_hearts"'],[p.default.projectileRedHearts(),'"red_hearts"'],[p.default.projectileRandom(),l.RANDOM_VALUE]],e.makeProjectileChoices=[[p.default.makeProjectileAirplane(),'"airplane"'],[p.default.makeProjectileBasketball(),'"basketball"'],[p.default.makeProjectileDisc(),'"disc"'],[p.default.makeProjectilePie(),'"pie"'],[p.default.makeProjectilePumpkin(),'"pumpkin"'],[p.default.makeProjectileStar(),'"star"'],[p.default.makeProjectileSandwich(),'"sandwich"'],[p.default.makeProjectileSnowball(),'"snowball"'],[p.default.makeProjectileBlueFireball(),'"blue_fireball"'],[p.default.makeProjectilePurpleFireball(),'"purple_fireball"'],[p.default.makeProjectileRedFireball(),'"red_fireball"'],[p.default.makeProjectileYellowHearts(),'"yellow_hearts"'],[p.default.makeProjectilePurpleHearts(),'"purple_hearts"'],[p.default.makeProjectileRedHearts(),'"red_hearts"']],e.whenProjectileCollidedChoices=[[p.default.whenSpriteCollidedWithAirplane(),"airplane"],[p.default.whenSpriteCollidedWithBasketball(),"basketball"],[p.default.whenSpriteCollidedWithDisc(),"disc"],[p.default.whenSpriteCollidedWithPie(),"pie"],[p.default.whenSpriteCollidedWithPumpkin(),"pumpkin"],[p.default.whenSpriteCollidedWithStar(),"star"],[p.default.whenSpriteCollidedWithSandwich(),"sandwich"],[p.default.whenSpriteCollidedWithSnowball(),"snowball"],[p.default.whenSpriteCollidedWithBlueFireball(),"blue_fireball"],[p.default.whenSpriteCollidedWithPurpleFireball(),"purple_fireball"],[p.default.whenSpriteCollidedWithRedFireball(),"red_fireball"],[p.default.whenSpriteCollidedWithYellowHearts(),"yellow_hearts"],[p.default.whenSpriteCollidedWithPurpleHearts(),"purple_hearts"],[p.default.whenSpriteCollidedWithRedHearts(),"red_hearts"]],e.itemChoices=[[p.default.itemAirplane(),'"item_airplane"'],[p.default.itemBasketball(),'"item_basketball"'],[p.default.itemDisc(),'"item_disc"'],[p.default.itemPie(),'"item_pie"'],[p.default.itemPumpkin(),'"item_pumpkin"'],[p.default.itemStar(),'"item_star"'],[p.default.itemSandwich(),'"item_sandwich"'],[p.default.itemSnowball(),'"item_snowball"'],[p.default.itemBlueFireball(),'"item_blue_fireball"'],[p.default.itemPurpleFireball(),'"item_purple_fireball"'],[p.default.itemRedFireball(),'"item_red_fireball"'],[p.default.itemYellowHearts(),'"item_yellow_hearts"'],[p.default.itemPurpleHearts(),'"item_purple_hearts"'],[p.default.itemRedHearts(),'"item_red_hearts"'],[p.default.itemRandom(),l.RANDOM_VALUE]]}var l=o(789),c=o(1706),p=i(c),d=o(40),u=i(d),h=o(744),f=i(h),m=o(2151),g={text:u.default.defaultTwitterText()+" @codeorg",hashtag:"HourOfCode"};t.load=function(e,t){var o=f.default.load(e,t);switch(o.ProjectileClassNames=["airplane","basketball","disc","pie","pumpkin","star","sandwich","snowball","blue_fireball","purple_fireball","red_fireball","purple_hearts","red_hearts","yellow_hearts"],o.specialProjectileProperties={airplane:{frames:10},basketball:{frames:10},disc:{frames:10},pie:{frames:10},pumpkin:{frames:10},star:{frames:10},sandwich:{frames:10},snowball:{frames:10}},o.ItemClassNames=["item_airplane","item_basketball","item_disc","item_pie","item_pumpkin","item_star","item_sandwich","item_snowball","item_blue_fireball","item_purple_fireball","item_red_fireball","item_purple_hearts","item_red_hearts","item_yellow_hearts"],o.airplane=o.assetUrl("projectile_airplane.png"),o.basketball=o.assetUrl("projectile_basketball.png"),o.disc=o.assetUrl("projectile_disc.png"),o.pie=o.assetUrl("projectile_pie.png"),o.pumpkin=o.assetUrl("projectile_pumpkin.png"),o.star=o.assetUrl("projectile_star.png"),o.sandwich=o.assetUrl("projectile_sandwich.png"),o.snowball=o.assetUrl("projectile_snowball.png"),o.yellow_hearts=o.assetUrl("yellow_hearts.gif"),o.purple_hearts=o.assetUrl("purple_hearts.gif"),o.red_hearts=o.assetUrl("red_hearts.gif"),o.blue_fireball=o.assetUrl("blue_fireball.png"),o.purple_fireball=o.assetUrl("purple_fireball.png"),o.red_fireball=o.assetUrl("red_fireball.png"),o.item_airplane=o.assetUrl("projectile_airplane.png"),o.item_basketball=o.assetUrl("projectile_basketball.png"),o.item_disc=o.assetUrl("projectile_disc.png"),o.item_pie=o.assetUrl("projectile_pie.png"),o.item_pumpkin=o.assetUrl("projectile_pumpkin.png"),o.item_star=o.assetUrl("projectile_star.png"),o.item_sandwich=o.assetUrl("projectile_sandwich.png"),o.item_snowball=o.assetUrl("projectile_snowball.png"),o.item_yellow_hearts=o.assetUrl("yellow_hearts.gif"),o.item_purple_hearts=o.assetUrl("purple_hearts.gif"),o.item_red_hearts=o.assetUrl("red_hearts.gif"),o.item_blue_fireball=o.assetUrl("blue_fireball.png"),o.item_purple_fireball=o.assetUrl("purple_fireball.png"),o.item_red_fireball=o.assetUrl("red_fireball.png"),o.whenUp=o.assetUrl("when-up.png"),o.whenDown=o.assetUrl("when-down.png"),o.whenLeft=o.assetUrl("when-left.png"),o.whenRight=o.assetUrl("when-right.png"),o.collide=o.assetUrl("when-sprite-collide.png"),o.emotionAngry=o.assetUrl("emotion-angry.png"),o.emotionNormal=o.assetUrl("emotion-nothing.png"),o.emotionSad=o.assetUrl("emotion-sad.png"),o.emotionHappy=o.assetUrl("emotion-happy.png"),o.speechBubble=o.assetUrl("say-sprite.png"),o.goal=o.assetUrl("goal.png"),o.goalSuccess=o.assetUrl("goal_success.png"),o.builtinSounds=["start","win","failure","flag"],o.sounds=["rubber","crunch","goal1","goal2","wood","retro","slap","hit","winpoint","winpoint2","losepoint","losepoint2"],o.soundChoices=[[p.default.playSoundRandom(),l.RANDOM_VALUE],[p.default.playSoundHit(),"hit"],[p.default.playSoundWood(),"wood"],[p.default.playSoundRetro(),"retro"],[p.default.playSoundSlap(),"slap"],[p.default.playSoundRubber(),"rubber"],[p.default.playSoundCrunch(),"crunch"],[p.default.playSoundWinPoint(),"winpoint"],[p.default.playSoundWinPoint2(),"winpoint2"],[p.default.playSoundLosePoint(),"losepoint"],[p.default.playSoundLosePoint2(),"losepoint2"],[p.default.playSoundGoal1(),"goal1"],[p.default.playSoundGoal2(),"goal2"]],o.soundChoicesK1=[[p.default.soundRandom(),l.RANDOM_VALUE],[p.default.soundHit(),"hit"],[p.default.soundWood(),"wood"],[p.default.soundRetro(),"retro"],[p.default.soundSlap(),"slap"],[p.default.soundRubber(),"rubber"],[p.default.soundCrunch(),"crunch"],[p.default.soundWinPoint(),"winpoint"],[p.default.soundWinPoint2(),"winpoint2"],[p.default.soundLosePoint(),"losepoint"],[p.default.soundLosePoint2(),"losepoint2"],[p.default.soundGoal1(),"goal1"],[p.default.soundGoal2(),"goal2"]],o.background=o.assetUrl("background.png"),o.spriteHeight=100,o.spriteWidth=100,o.dropdownThumbnailWidth=50,o.dropdownThumbnailHeight=50,o.preloadAssets=!0,o.wallCollisionRectOffsetX=0,o.wallCollisionRectOffsetY=0,o.setSpritePrefix=p.default.setSprite(),o.activityChoices=[[p.default.setActivityRandom(),l.RANDOM_VALUE],[p.default.setActivityRoam(),'"roam"'],[p.default.setActivityChase(),'"chase"'],[p.default.setActivityFlee(),'"flee"'],[p.default.setActivityNone(),'"none"']],o.id){case"gumball":n(o);break;case"iceage":a(o);break;case"infinity":r(o);break;case"hoc2015":(0,m.loadStarWarsEvents)(o),o.twitterOptions=g;break;case"hoc2015x":(0,m.loadStarWarsGrid)(o);break;case"studio":s(o)}return o}},3433:function(e,t,o){o(151),o(152),e.exports=o(3434)},3434:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=o(35),a=i(n),r=o(1),s=i(r),l=o(32),c=i(l),p=o(596),d=i(p),u=o(2087),h=i(u),f=o(2968),m=i(f),g=o(1813),y=i(g),v=o(3435),b=i(v),k=(0,d.default)("pageOptions");if(window.Blockly&&!k.uses_droplet){window.Blockly.Css.styleSheet_=window.goog.cssom.addCssText(Blockly.Css.CONTENT.join("\n")).sheet,window.Blockly.assetUrl=function(e){return"/assets/"+e};var _=o(2969)("./"+k.app+"/blocks"),w=o(3436)("./"+k.app+"/skins"),P={skin:w.load(function(){},k.skin_id),isK1:k.isK1};y.default.install(window.Blockly,P),_.install(window.Blockly,P)}var S={startEditor:{codemirror:"level_start_blocks",blockPreview:"start-preview"},requiredEditor:{codemirror:"level_required_blocks",blockPreview:"required-preview"},recommendedEditor:{codemirror:"level_recommended_blocks",blockPreview:"recommended-preview"},toolboxEditor:{hideWhen:k.uses_droplet,codemirror:"level_toolbox_blocks",blockPreview:"toolbox-preview"},initializationEditor:{hideWhen:k.uses_droplet,codemirror:"level_initialization_blocks",blockPreview:"initialization-preview"},solutionEditor:{hideWhen:!k.solution_blocks,codemirror:"level_solution_blocks",blockPreview:"solution-preview"},codeFunctions:{hideWhen:!k.uses_droplet,codemirror:"level_code_functions",codemirrorMode:"javascript"},inputOutputTable:{hideWhen:!k.input_output_table,codemirror:"level_input_output_table",codemirrorMode:"javascript"}};Object.keys(S).forEach(function(e){var t=S[e];if(!t.hideWhen){var o=t.codemirrorMode||(k.uses_droplet?"javascript":"xml");t.editor=(0,h.default)(t.codemirror,o),t.blockPreview&&!k.uses_droplet&&(0,m.default)(t.editor,document.getElementById(t.blockPreview))}}),(0,a.default)("#plusAnswerContainedLevel").on("click",function(){(0,a.default)("#plusAnswerContainedLevel").prev().clone().insertBefore("#plusAnswerContainedLevel")}),k.original_palette&&!S.codeFunctions.hideWhen&&c.default.render(s.default.createElement(b.default,{palette:k.original_palette,editor:S.codeFunctions.editor}),(0,a.default)("<div></div>").insertAfter('label[for="'+S.codeFunctions.codemirror+'"]').get(0))},3435:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(852),l=i(s),c=o(1),p=i(c),d=function(e){function t(o){n(this,t);var i=a(this,e.call(this,o));return i.selectBlock=function(e){var t=e.target.value;if(t){var o=void 0;try{o=i.getCurrentPaletteBlocks()}catch(e){return}o[t]=i.props.palette[t],i.props.editor.setValue(JSON.stringify(o,null,2))}},i.state={currentPalette:o.editor.getValue()},i}return r(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.editor.on("change",function(){e.setState({currentPalette:e.props.editor.getValue()})})},t.prototype.getCurrentPaletteBlocks=function(){return this.state.currentPalette.trim()?JSON.parse(this.state.currentPalette):{}},t.prototype.render=function(){var e=this,t=[],o=null;try{!function(){var o=e.getCurrentPaletteBlocks();t=Object.keys(e.props.palette).filter(function(e){return void 0===o[e]})}()}catch(e){o=!0}var i=o?"Fix JSON syntax to see available blocks":0===t.length?"All blocks have been added":"Add block";return p.default.createElement("select",{disabled:o||0===t.length,onChange:this.selectBlock},p.default.createElement("option",null,i),t.map(function(e){return p.default.createElement("option",{key:e,value:e},e)}))},t}(p.default.Component);d.propTypes={editor:c.PropTypes.instanceOf(l.default).isRequired,palette:c.PropTypes.object.isRequired},t.default=d,e.exports=t.default},3436:function(e,t,o){function i(e){return o(n(e))}function n(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./applab/skins":1951,"./bounce/skins":2709,"./craft/agent/skins":2742,"./craft/code-connection/skins":2744,"./craft/designer/skins":2739,"./craft/simple/skins":2737,"./flappy/skins":2747,"./gamelab/skins":2750,"./jigsaw/skins":2751,"./maze/skins":2760,"./netsim/skins":2793,"./studio/skins":2800,"./studio/starwars/skins":2151,"./turtle/skins":2152};i.keys=function(){return Object.keys(a)},i.resolve=n,e.exports=i,i.id=3436},793:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(1270);e.exports=function(){function e(t,o,a){i(this,e),this.GameController=t,this.Game=t.game,this.HighlightCallback=o,this.state=n.NOT_STARTED,this.target=a,this.repeat=!1}return e.prototype.tick=function(){},e.prototype.begin=function(){this.HighlightCallback&&this.HighlightCallback(),this.state=n.WORKING},e.prototype.isStarted=function(){return this.state!==n.NOT_STARTED},e.prototype.isFinished=function(){return this.isSucceeded()||this.isFailed()},e.prototype.isSucceeded=function(){return this.state===n.SUCCESS},e.prototype.isFailed=function(){return this.state===n.FAILURE},e.prototype.succeeded=function(){this.state=n.SUCCESS},e.prototype.failed=function(){this.state=n.FAILURE},e}()},794:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(1269),a=o(799),r=o(838),s=o(1159),l=o(1016),c=o(1271);e.exports=function(){function e(t,o,a,s,l,c){i(this,e),this.queue=new n(t),this.controller=t,this.game=t.game,this.position=new r(s,l),this.type=o,this.facing=c,this.offset=[-22,-12],this.identifier=a,this.healthPoint=3,this.underTree={state:!1,treeIndex:-1}}return e.prototype.tick=function(){this.queue.tick()},e.prototype.reset=function(){},e.prototype.canMoveThrough=function(){return!1},e.prototype.canPlaceBlock=function(){return!1},e.prototype.canTriggerPressurePlates=function(){return!1},e.prototype.shouldUpdateSelectionIndicator=function(){return!1},e.prototype.setMovePosition=function(e){this.position=e},e.prototype.getSortOrderOffset=function(){return 5},e.prototype.addCommand=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.queue.addCommand(e,t),this.queue.begin()},e.prototype.getWalkAnimation=function(){return"walk"+this.controller.levelView.getDirectionName(this.facing)},e.prototype.getIdleAnimation=function(){return"idle"+this.controller.levelView.getDirectionName(this.facing)},e.prototype.playMoveForwardAnimation=function(e,t,o,i){var n,r=this,s=this.controller.levelView,l=e[1]+(t===a.North?1:0);this.sprite.sortOrder=this.controller.levelView.yToIndex(l)+1,s.playBlockSound(i),s.playScaledSpeed(this.sprite.animations,this.getWalkAnimation()),setTimeout(function(){n=r.controller.levelView.addResettableTween(r.sprite).to({x:r.offset[0]+40*e[0],y:r.offset[1]+40*e[1]},300,Phaser.Easing.Linear.None),n.onComplete.add(function(){s.playScaledSpeed(r.sprite.animations,r.getIdleAnimation()),o.succeeded()}),n.start()},50/this.controller.tweenTimeScale)},e.prototype.walkableCheck=function(){},e.prototype.updateHidingTree=function(){var e=this.controller.levelView;if(this.underTree.state){var t=this.underTree.treeIndex,o=this.controller.levelEntity.entityMap;e.isUnderTree(t,this.position)||(function(e,t,o){var i=!0,n=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value,c=l[1];if(!(c===e)&&c.underTree.treeIndex===o)return!0}}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return!1}(this,o,t)||e.changeTreeAlpha(t,1),this.underTree={state:!1,treeIndex:-1})}else for(var i=e.trees,n=0;n<i.length;n++)if(e.isUnderTree(n,this.position)){e.changeTreeAlpha(n,.8),this.underTree={state:!0,treeIndex:n};break}},e.prototype.updateHidingBlock=function(e){var t=this.controller.levelView,o=this.controller.levelModel.actionPlane;this.isOnBlock||function(e,i){var n=r.south(i),a=o.getBlockAt(n);if(a&&!a.isTransparent){var s=t.actionPlaneBlocks[t.coordinatesToIndex(n)];if(null!==s){e.controller.levelView.addResettableTween(s).to({alpha:.8},300,Phaser.Easing.Linear.None).start()}}}(this,this.position),void 0!==e&&function(e,o){var i=r.south(o);if(i.y<10){var n=t.actionPlaneBlocks[t.coordinatesToIndex(i)];if(null!==n){e.controller.levelView.addResettableTween(n).to({alpha:1},300,Phaser.Easing.Linear.None).start()}}}(this,e)},e.prototype.doMoveForward=function(e,t){var o=this.controller.levelModel,i=this.position;this.position=t;var n=o.groundPlane.getBlockAt(this.position).blockType;this.playMoveForwardAnimation(t,this.facing,e,n,function(){}),this.updateHidingTree(),this.updateHidingBlock(i)},e.prototype.bump=function(e){var t=this,o=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"bump"+o);var i=this.controller.levelModel.getMoveForwardPosition(this),n=this.controller.levelEntity.getEntityAt(i);null!==n&&(this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenTouched,targetType:t.type,targetIdentifier:t.identifier,eventSenderIdentifier:n.identifier})}),this.queue.endPushHighPriorityCommands()),this.controller.delayPlayerMoveBy(400,800,function(){e.succeeded()})},e.prototype.callBumpEvents=function(e){for(var t=this,o=1;o<e.length;o++)"frontEntity"===e[o]&&(this.controller.events.forEach(function(i){return i({eventType:s.WhenTouched,targetType:e[o+1].type,eventSenderIdentifier:t.identifier,targetIdentifier:e[o+1].identifier})}),o++)},e.prototype.moveDirection=function(e,t){this.controller.levelModel.turnToDirection(this,t),this.moveForward(e,!1)},e.prototype.moveForward=function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.controller.addCommandRecord("moveForward",this.type,e.repeat);var t=this.controller.levelModel.getMoveForwardPosition(this),o=this.controller.levelModel.canMoveForward(this);if(o[0]){var i=r.directionToOffsetPosition(this.facing),n=r.directionToOffsetPosition(a.opposite(this.facing)),s=this.handleMoveOnPressurePlate(i);this.doMoveForward(e,t),s||this.handleMoveOffPressurePlate(n),this.handleMoveOffIronDoor(n),this.handleMoveAwayFromPiston(n)}else this.bump(e),this.callBumpEvents(o)},e.prototype.moveBackward=function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.controller.addCommandRecord("moveBackward",this.type,e.repeat);var t=this.controller.levelModel.getMoveDirectionPosition(this,2),o=this.controller.levelModel.canMoveBackward(this);if(o[0]){var i=r.directionToOffsetPosition(a.opposite(this.facing)),n=r.directionToOffsetPosition(this.facing),s=this.handleMoveOnPressurePlate(i);this.doMoveBackward(e,t),s||this.handleMoveOffPressurePlate(n),this.handleMoveOffIronDoor(n),this.handleMoveAwayFromPiston(n)}else this.bump(e),this.callBumpEvents(o)},e.prototype.canPlaceBlockOver=function(){return{canPlace:!1,plane:""}},e.prototype.moveAway=function(e,t){this.controller.addCommandRecord("moveAway",this.type,e.repeat);var o=t.position,i=[],n=function(e,t,o){return r.absoluteDistanceSquare(t[1],e)<r.absoluteDistanceSquare(o[1],e)?o:t},s=r.absoluteDistanceSquare(o,this.position);o.x<=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.East)[0]&&(i=[a.East,r.east(this.position)]),o.x>=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.West)[0]&&(i=i.length>0?n(o,i,[a.West,r.west(this.position)]):[a.West,r.west(this.position)]),o.y>=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.North)[0]&&(i=i.length>0?n(o,i,[a.North,r.north(this.position)]):[a.North,r.north(this.position)]),o.y<=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.South)[0]&&(i=i.length>0?n(o,i,[a.South,r.south(this.position)]):[a.South,r.south(this.position)]),0===i.length||s>=r.absoluteDistanceSquare(o,i[1])?e.succeeded():this.moveDirection(e,i[0])},e.prototype.moveToward=function(e,t){this.controller.addCommandRecord("moveToward",this.type,e.repeat);var o=t.position,i=[],n=function(e,t,o){return r.absoluteDistanceSquare(t[1],e)>r.absoluteDistanceSquare(o[1],e)?o:t};return o.x>=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.East)[0]&&(i=[a.East,r.east(this.position)]),o.x<=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.West)[0]&&(i=i.length>0?n(o,i,[a.West,r.west(this.position)]):[a.West,r.west(this.position)]),o.y<=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.North)[0]&&(i=i.length>0?n(o,i,[a.North,r.north(this.position)]):[a.North,r.north(this.position)]),o.y>=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.South)[0]&&(i=i.length>0?n(o,i,[a.South,r.south(this.position)]):[a.South,r.south(this.position)]),1===r.absoluteDistanceSquare(this.position,o)?(this.position.x<o.x?this.facing=a.East:this.position.x>o.x?this.facing=a.West:this.position.y<o.y?this.facing=a.South:this.position.y>o.y&&(this.facing=a.North),this.updateAnimationDirection(),this.bump(e),!1):0===i.length?(e.succeeded(),!1):(this.moveDirection(e,i[0]),!0)},e.prototype.moveTo=function(e,t){var o=this;if(1===r.absoluteDistanceSquare(t.position,this.position))t.position.y-this.position.y==-1?this.moveDirection(e,a.North):t.position.y-this.position.y==1?this.moveDirection(e,a.South):t.position.x-this.position.x==1?this.moveDirection(e,a.East):this.moveDirection(e,a.West);else if(this.moveToward(e,t)){var i=new l(this.controller,function(){},function(){o.moveTo(i,t)},this.identifier);this.addCommand(i)}else this.bump(e)},e.prototype.turn=function(e,t){(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&this.controller.addCommandRecord("turn",this.type,e.repeat),-1===t&&this.controller.levelModel.turnLeft(this),1===t&&this.controller.levelModel.turnRight(this),this.updateAnimationDirection(),this.controller.delayPlayerMoveBy(200,800,function(){e.succeeded()})},e.prototype.turnRandom=function(e){this.controller.addCommandRecord("turnRandom",this.type,e.repeat);var t=0===function(e,t){return Math.floor(Math.random()*(t-e+1))+e}(0,1)?1:-1;this.turn(e,t,!1)},e.prototype.use=function(e,t){var o=this,i="lookAtCam"+this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,i),this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenUsed,targetType:o.type,eventSenderIdentifier:t.identifier,targetIdentifier:o.identifier})}),this.queue.endPushHighPriorityCommands(),e.succeeded()},e.prototype.drop=function(e,t){var o=this;this.controller.addCommandRecord("drop",this.type,e.repeat),this.controller.levelView.playItemDropAnimation(this.position,t,function(){if(e.succeeded(),o.controller.levelModel.usePlayer){var t=o.controller.levelModel.player.queue.currentCommand;t&&t.waitForOtherQueue&&t.succeeded()}})},e.prototype.attack=function(e){var t=this;this.controller.addCommandRecord("attack",this.type,e.repeat);var o=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"attack"+o),setTimeout(function(o){var i=o.controller.levelEntity.getEntityAt(o.controller.levelModel.getMoveForwardPosition(o));if(i){var n=new l(o.controller,function(){},function(){i.takeDamage(n)},i);i.addCommand(n)}setTimeout(function(t,o,n){null!==o&&(i.queue.startPushHighPriorityCommands(),t.events.forEach(function(e){return e({eventType:s.WhenAttacked,targetType:o.type,eventSenderIdentifier:n.identifier,targetIdentifier:o.identifier})}),i.queue.endPushHighPriorityCommands()),e.succeeded()},300/t.controller.tweenTimeScale,o.controller,i,o)},200/this.controller.tweenTimeScale,this)},e.prototype.pushBack=function(e,t,o,i){var n=this,a=this.controller.levelModel,s=r.forward(this.position,t);if(a.isPositionEmpty(s)[0]){this.updateHidingBlock(this.position),this.position=s,this.updateHidingTree();var l=this.controller.levelView.addResettableTween(this.sprite).to({x:this.offset[0]+40*this.position[0],y:this.offset[1]+40*this.position[1]},o,Phaser.Easing.Linear.None);l.onComplete.add(function(){setTimeout(function(){e.succeeded(),void 0!==i&&i(n)},o/n.controller.tweenTimeScale)}),l.start()}else e.succeeded(),void 0!==i&&i(this)},e.prototype.takeDamage=function(e){var t=this,o=this.controller.levelView,i=o.getDirectionName(this.facing);this.healthPoint>1?(o.playScaledSpeed(this.sprite.animations,"hurt"+i),setTimeout(function(){t.healthPoint--,e.succeeded()},1500/this.controller.tweenTimeScale)):(this.healthPoint--,this.sprite.animations.stop(null,!0),this.controller.levelView.playScaledSpeed(this.sprite.animations,"die"+i),setTimeout(function(){var e=t.controller.levelView.addResettableTween(t.sprite).to({alpha:0},300,Phaser.Easing.Linear.None);e.onComplete.add(function(){t.controller.levelEntity.destroyEntity(t.identifier)}),e.start()},1500/this.controller.tweenTimeScale))},e.prototype.playRandomIdle=function(e){var t,o="";switch(t=this.controller.levelView.getDirectionName(e),Math.trunc(5*Math.random())+1){case 1:o+="idle";break;case 2:o+="lookLeft";break;case 3:o+="lookRight";break;case 4:o+="lookAtCam";break;case 5:o+="lookDown"}o+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,o)},e.prototype.updateAnimationDirection=function(){var e=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+e)},e.prototype.getDistance=function(e){return r.absoluteDistanceSquare(this.position,e.position)},e.prototype.blowUp=function(e,t){var o=a.South;t[0]>this.position[0]?(o=a.West,this.facing=a.East,this.updateAnimationDirection()):t[0]<this.position[0]?(o=a.East,this.facing=a.West,this.updateAnimationDirection()):t[1]>this.position[1]?(o=a.North,this.facing=a.South,this.updateAnimationDirection()):t[1]<this.position[1]&&(o=a.South,this.facing=a.North,this.updateAnimationDirection()),this.pushBack(e,o,150,function(t){var o=new l(t.controller,function(){},function(){t.controller.destroyEntity(o,t.identifier)},t.identifier);t.queue.startPushHighPriorityCommands(),t.addCommand(o,e.repeat),t.queue.endPushHighPriorityCommands()})},e.prototype.hasPermissionToWalk=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(e.isWalkable||void 0!==t&&t.isOnBlock&&!e.isEmpty)&&(void 0===t||t.canMoveThrough())&&"water"!==o.blockType&&"lava"!==o.blockType},e.prototype.handleMoveOffPressurePlate=function(e){var t=this,o=r.add(this.position,e),i="pressurePlateDown"===this.controller.levelModel.actionPlane.getBlockAt(o).blockType,n=this.controller.levelModel.actionPlane.getBlockAt(this.position),a=!1;if(void 0!==n&&n.isWalkable||(a=!0),this.controller.levelEntity.entityMap.forEach(function(e){e.identifier!==t.identifier&&e.canTriggerPressurePlates()&&t.controller.positionEquivalence(e.position,o)&&(a=!0)}),i&&!a){this.controller.audioPlayer.play("pressurePlateClick");var s=new c("pressurePlateUp");this.controller.levelModel.actionPlane.setBlockAt(o,s,e[0],e[1])}},e.prototype.handleMoveOnPressurePlate=function(e){var t=r.add(this.position,e);if("pressurePlateUp"===this.controller.levelModel.actionPlane.getBlockAt(t).blockType){this.controller.audioPlayer.play("pressurePlateClick");var o=new c("pressurePlateDown");return this.controller.levelModel.actionPlane.setBlockAt(t,o),!0}return!1},e.prototype.handleMoveOffIronDoor=function(e){var t=r.add(this.position,e);if(this.controller.levelModel.inBounds(t)){var o="doorIron"===this.controller.levelModel.actionPlane.getBlockAt(t).blockType,i="doorIron"===this.controller.levelModel.actionPlane.getBlockAt(this.position).blockType;o&&!i&&this.controller.levelModel.actionPlane.findDoorToAnimate(new r(-1,-1))}},e.prototype.handleMoveAwayFromPiston=function(e){var t=this,o=r.add(this.position,e);r.getOrthogonalPositions(o).forEach(function(e){if(t.controller.levelModel.actionPlane.inBounds(e)){var o=t.controller.levelModel.actionPlane.getBlockAt(e);o.blockType.startsWith("piston")&&o.isPowered&&t.controller.levelModel.actionPlane.activatePiston(e)}})},e.prototype.handleGetOnRails=function(e){this.getOffTrack=!1,this.handleMoveOffPressurePlate(new r(0,0)),this.controller.levelView.playTrack(this.position,e,!0,this,null)},e}()},799:function(e,t,o){"use strict";var i=Object.freeze({North:0,East:1,South:2,West:3,opposite:function(e){switch(e){case i.North:return i.South;case i.South:return i.North;case i.East:return i.West;case i.West:return i.East}},left:function(e){return this.turn(e,"left")},right:function(e){return this.turn(e,"right")},turnDirection:function(e,t){switch(e){case i.North:return t===i.East?"right":"left";case i.South:return t===i.West?"right":"left";case i.East:return t===i.South?"right":"left";case i.West:return t===i.North?"right":"left"}},turn:function(e,t){return(e+4+("right"===t?1:-1))%4},directionToOffset:function(e){switch(e){case i.North:return[0,-1];case i.South:return[0,1];case i.East:return[1,0];case i.West:return[-1,0]}},directionToRelative:function(e){switch(e){case i.North:return"Up";case i.South:return"Down";case i.East:return"Right";case i.West:return"Left"}}});e.exports=i},838:function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=o(799),a=[n.North,n.East,n.South,n.West];e.exports=function(){function e(t,o){i(this,e),this.x=t,this.y=o,this[0]=t,this[1]=o}return e.add=function(t,o){return new e(t[0]+o[0],t[1]+o[1])},e.subtract=function(t,o){return new e(t[0]-o[0],t[1]-o[1])},e.equals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.directionToOffsetPosition=function(t){var o=n.directionToOffset(t);if(o)return e.fromArray(o)},e.isAdjacent=function(t,o){return a.map(e.directionToOffsetPosition).some(function(i){return e.equals(e.add(t,i),o)})},e.forward=function(t,o){return e.add(t,e.directionToOffsetPosition(o))},e.north=function(t){return e.forward(t,n.North)},e.east=function(t){return e.forward(t,n.East)},e.south=function(t){return e.forward(t,n.South)},e.west=function(t){return e.forward(t,n.West)},e.getOrthogonalPositions=function(t){return a.map(function(o){return e.forward(t,o)})},e.manhattanDistance=function(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},e.absoluteDistanceSquare=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},e.getSurroundingPositions=function(t){return e.getOrthogonalPositions(t).concat([e.north(e.east(t)),e.north(e.west(t)),e.south(e.east(t)),e.south(e.west(t))])},e.fromArray=function(t){return new e(t[0],t[1])},e}()}},[3433]);