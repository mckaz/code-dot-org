webpackJsonp([41],{3470:function(e,o,t){t(151),t(152),e.exports=t(3471)},3471:function(e,o,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function n(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o}function l(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}function s(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var u=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i=t(35),c=r(i),d=t(1),f=r(d),p=t(32),h=r(p),_=t(1707),m=r(_),v=t(2158),g=r(v),y=t(1749),b=t(2159),w=r(b),E=t(40),T=r(E),S=t(925),O=r(S),I=["charter","private","public"],k=["charter","private","public","afterschool","organization"];window.SignupManager=function(e){function o(){return JSON.stringify({country:z.country,nces:z.nces})}function t(e){O.default.putRecord({study:"school-info-optional",study_group:x,event:e,data_json:o()})}function r(e){var o;o=""!==k.options.returnToUrl?k.options.returnToUrl:S()?k.options.teacherDashboardUrl:"/",S()&&t("signup-success"),window.location.href=o}function a(e){(0,c.default)("#signup-button").prop("disabled",!1);var o=["user_type","name","email","password","password_confirmation","age","gender","terms_of_service_version","school_info.zip"],r=0;if(e.responseJSON&&e.responseJSON.errors)for(var a=0;a<o.length;a++){var n=o[a];if(e.responseJSON.errors[n]){var l=(0,c.default)("#"+n+"-block .error_in_field");"terms_of_service_version"===n?l.text(k.options.acceptTermsString):"school_info.zip"===n?(l=(0,c.default)("#school-zip").find(".error_in_field"),l.text(e.responseJSON.errors[n][0])):"user_type"!==n&&l.text(e.responseJSON.errors[n][0]),l.fadeTo("normal",1),r++}}0===r&&(0,c.default)("#signup-error").show(),S()&&t("signup-error")}function n(e){e?(0,c.default)("#schooldropdown-block").fadeIn():(0,c.default)("#schooldropdown-block").hide()}function l(){(0,c.default)("#age-block").fadeIn(),(0,c.default)("#gender-block").fadeIn(),(0,c.default)("#name-student").fadeIn(),(0,c.default)("#name-teacher").hide(),n(!1),(0,c.default)("#student-terms").fadeIn(),(0,c.default)("#teacher-terms").hide(),(0,c.default)("#user_terms_of_service_version").prop("checked",!0)}function i(e,o){z.country=o?o.value:"",b(z)}function d(e){return y.COUNTRIES.find(function(o){return o.value===e}).label}function p(e){z.schoolType=e?e.target.value:"",b(z)}function _(e,o){z.nces=o?o.value:"",b(z)}function v(e,o){o&&(z=u({},z,s({},e,o.target.value))),b(z)}function b(e){var o="United States"===e.country;h.default.render(f.default.createElement("div",null,f.default.createElement("h5",{style:{fontWeight:"bold"}},j?T.default.schoolInformationOptionalHeader():T.default.schoolInformationHeader()),f.default.createElement("hr",null),f.default.createElement(g.default,{onChange:i,value:e.country,showErrorMsg:!1,singleLineLayout:!0}),f.default.createElement("div",{className:"itemblock",style:{minHeight:42}},f.default.createElement("div",{className:"school-info-labelblock"},T.default.signupFormSchoolType()),f.default.createElement("select",{className:"form-control fieldblock",id:"school-type-auto",name:"user[school_info_attributes][school_type]",type:"select",defaultValue:"",onChange:p},f.default.createElement("option",{disabled:"",value:""}),f.default.createElement("option",{value:"charter"},"Charter"),f.default.createElement("option",{value:"private"},"Private"),f.default.createElement("option",{value:"public"},"Public"),f.default.createElement("option",{value:"homeschool"},"Homeschool"),f.default.createElement("option",{value:"afterschool"},"After School"),f.default.createElement("option",{value:"organization"},"Organization"),f.default.createElement("option",{value:"other"},"Other"))),o&&I.includes(e.schoolType)&&f.default.createElement(m.default,{setField:_,value:e.nces,showErrorMsg:!1,singleLineLayout:!0,showRequiredIndicator:!1}),f.default.createElement(N,{isUS:o,data:e,schoolDataErrors:{},onSchoolNotFoundChange:v})),(0,c.default)("#schooldropdown-block")[0])}function w(){(0,c.default)("#age-block").hide(),(0,c.default)("#gender-block").hide(),(0,c.default)("#name-student").hide(),(0,c.default)("#name-teacher").fadeIn(),n(!0),(0,c.default)("#student-terms").hide(),(0,c.default)("#teacher-terms").fadeIn(),(0,c.default)("#user_terms_of_service_version").prop("checked",!1),b(z),t("signup-loaded")}function E(){var e=(0,c.default)("#new_user").serializeArray(),o=c.default.grep(e,function(e){return"user[user_type]"===e.name});return 1===o.length?o[0].value:"no_user_type"}function S(){return"teacher"===E()}this.options=e;var k=this,x=Math.random()<.5?"control":"optional-removed",j="control"===x,z={country:e.usIP?"United States":"",nces:"",schoolName:"",schoolCity:"",schoolState:"",schoolZip:"",schoolType:"",showErrorMsg:!1};"true"===k.options.isTeacher&&((0,c.default)("#user_user_type").val("teacher"),w()),(0,c.default)("#user_user_type").change(function(){var e=(0,c.default)(this).val();"student"===e?l():"teacher"===e&&w()}),(0,c.default)(".signupform").submit(function(){(0,c.default)("#user_hashed_email").val(""),(0,c.default)("#signup-error").hide(),(0,c.default)("#signup-button").prop("disabled",!0),window.dashboard.hashEmail({email_selector:"#user_email",hashed_email_selector:"#user_hashed_email",age_selector:"#user_user_age",skip_clear_email:!0});var e=(0,c.default)("#new_user").serializeArray(),o=[{from:"nces_school_s",to:"school_id"},{from:"country_s",to:"country",transform:d},{from:"school_name_s",to:"school_name"},{from:"school_state_s",to:"school_state"},{from:"school_zip_s",to:"school_zip"},{from:"registration_location",to:"full_address"}];return(0,c.default)(".signupform").serializeArray().forEach(function(t){var r=o.find(function(e){return e.from===t.name});if(r){var a=r.transform?r.transform(t.value):t.value;"school_id"===r.to&&"-1"===a||e.push({name:"user[school_info_attributes]["+r.to+"]",value:a})}}),S()?e.push({name:"user[age]",value:"21+"}):(c.default.grep(e,function(e){return"user[email]"===e.name})[0].value="",c.default.grep(e,function(e){return e.name.startsWith("user[school_info_attributes]")}).forEach(function(e){return e.value=""})),(0,c.default)(".error_in_field").css("opacity",0),(0,c.default)("#password_message").text(""),(0,c.default)("#password_message_confirmation").text(""),S()&&(b(z),t("signup-submitted")),c.default.ajax({url:"/users.json",type:"post",dataType:"json",data:e}).done(r).fail(a),!1}),(0,c.default)("#user_password").on("input",function(e){var o=(0,c.default)(this).val(),t=(0,c.default)("#password-block .error_in_field"),r=(0,c.default)("#password_confirmation-block .error_in_field");!o||o.length<6?(t.text(k.options.invalidPasswordString),t.fadeTo("normal",1)):t.text(""),r.text("")}),(0,c.default)("#user_password_confirmation").on("input",function(e){var o=(0,c.default)(this).val(),t=(0,c.default)("#user_password").val(),r=(0,c.default)("#password-block .error_in_field"),a=(0,c.default)("#password_confirmation-block .error_in_field");o!==t?(a.text(k.options.passwordMismatchString),a.fadeTo("normal",1)):a.text(""),r.text("")}),(0,c.default)("#user_name").placeholder(),(0,c.default)("#user_email").placeholder(),(0,c.default)("#user_school").placeholder()};var N=function(e){function o(){return a(this,o),n(this,e.apply(this,arguments))}return l(o,e),o.prototype.render=function(){var e=this.props,o=e.isUS,t=e.data,r=e.schoolDataErrors,a=e.onSchoolNotFoundChange,n=!o,l="-1"===t.nces,s=!I.includes(t.schoolType)&&""!==t.schoolType;if(n||l||s){var u=k.includes(t.schoolType),i=["afterschool","organization"].includes(t.schoolType)?T.default.signupFormSchoolOrOrganization():T.default.schoolName();return f.default.createElement(w.default,{onChange:a,schoolName:u?t.schoolName:w.default.OMIT_FIELD,schoolType:w.default.OMIT_FIELD,schoolCity:t.schoolCity,schoolState:o?t.schoolState:w.default.OMIT_FIELD,schoolZip:o?t.schoolZip:w.default.OMIT_FIELD,showErrorMsg:r.school,singleLineLayout:!0,showRequiredIndicators:!1,schoolNameLabel:i,useGoogleLocationSearch:!0})}return null},o}(f.default.Component);N.propTypes={isUS:d.PropTypes.bool.isRequired,data:d.PropTypes.object.isRequired,schoolDataErrors:d.PropTypes.object.isRequired,onSchoolNotFoundChange:d.PropTypes.func.isRequired}}},[3470]);