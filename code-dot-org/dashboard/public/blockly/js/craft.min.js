webpackJsonp([6],{1016:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r,s){n(this,t);var l=o(this,e.call(this,i,a,s));return l.actionCallback=r,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.actionCallback()},t}(r)},1269:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(1270);e.exports=function(){function e(t){n(this,e),this.gameController=t,this.game=t.game,this.reset(),this.repeatCommands=[],this.setUnshiftState=!1,this.highPriorityCommands=[]}return e.prototype.addCommand=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.repeat=t,this.whileCommandQueue?this.whileCommandQueue.addCommand(e):this.setUnshiftState?this.highPriorityCommands.push(e):this.commandList_.push(e)},e.prototype.setWhileCommandInsertState=function(e){this.whileCommandQueue=e},e.prototype.begin=function(){this.state=o.WORKING},e.prototype.reset=function(){this.state=o.NOT_STARTED,this.currentCommand=null,this.commandList_=[],this.highPriorityCommands=[],this.whileCommandQueue&&this.whileCommandQueue.reset(),this.repeatCommands=[],this.whileCommandQueue=null},e.prototype.startPushHighPriorityCommands=function(){this.setUnshiftState=!0,this.highPriorityCommands=[]},e.prototype.endPushHighPriorityCommands=function(){for(var e=this.highPriorityCommands.length-1;e>=0;e--)this.commandList_.unshift(this.highPriorityCommands[e]);this.setUnshiftState=!1},e.prototype.tick=function(){if(this.state===o.WORKING){if(!this.currentCommand){if(0===this.commandList_.length){0===this.repeatCommands.length&&(this.state=o.SUCCESS),this.gameController.startPushRepeatCommand();for(var e=0;e<this.repeatCommands.length;e++)this.repeatCommands[e][1]>0?(this.repeatCommands[e][0](),this.repeatCommands[e][1]--):-1===this.repeatCommands[e][1]?this.repeatCommands[e][0]():this.repeatCommands.splice(e,1);return void this.gameController.endPushRepeatCommand()}this.currentCommand=this.commandList_.shift()}this.currentCommand.isStarted()?this.currentCommand.tick():this.currentCommand.begin(),this.currentCommand.isSucceeded()?this.currentCommand=null:this.currentCommand.isFailed()&&(this.state=o.FAILURE)}},e.prototype.getLength=function(){return this.commandList_?this.commandList_.length:0},e.prototype.isStarted=function(){return this.state!==o.NOT_STARTED},e.prototype.isFinished=function(){return this.isSucceeded()||this.isFailed()},e.prototype.isSucceeded=function(){return this.state===o.SUCCESS},e.prototype.isFailed=function(){return this.state===o.FAILURE},e.prototype.addRepeatCommands=function(e,t){if(-1===t)for(var i=0;i<this.repeatCommands.length;i++)if(-1===this.repeatCommands[i][1]){this.repeatCommands.splice(i,1);break}this.repeatCommands.push([e,t]),this.begin()},e}()},1270:function(e,t,i){"use strict";e.exports=Object.freeze({NOT_STARTED:0,WORKING:1,SUCCESS:2,FAILURE:3})},1271:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(799),a=o.North,r=o.South,s=o.East,l=o.West;e.exports=function(){function e(t){n(this,e),this.blockType=t,this.isEntity=!1,this.isWalkable=!1,this.isPlacable=!1,this.isDestroyable=!0,this.isUsable=!0,this.isEmpty=!1,this.isEmissive=!1,this.isTransparent=!1,this.isRedstone=!1,this.isPowered=!1,this.isConnectedToRedstone=!1,this.isRedstoneBattery=!1,this.isOpen=!1,this.isRail=!1,this.isSolid=!0,this.isWeaklyPowerable=!0,this.isStickable=!0,""===t&&(this.isWalkable=!0,this.isDestroyable=!1,this.isEmpty=!0,this.isPlacable=!0,this.isUsable=!1,this.isWeaklyPowerable=!1),this.getIsMiniblock()&&(this.isEntity=!0,this.isWalkable=!0,this.isDestroyable=!1,this.isPlacable=!0,this.isUsable=!1,this.isTransparent=!0),t.match("torch")&&(this.isWalkable=!0,this.isPlacable=!0,this.isStickable=!1),"rails"===t.substring(0,5)&&(this.isWeaklyPowerable="railsRedstoneTorch"===t,this.isStickable="railsRedstoneTorch"!==t,this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!0,this.isTransparent=!0,this.isRail="railsRedstoneTorch"!==t,this.isConnectedToRedstone=/^rails(RedstoneTorch|Unpowered|Powered)/.test(t),this.isRedstoneBattery="railsRedstoneTorch"===t,this.connectionA=void 0,this.connectionB=void 0),"sheep"===t&&(this.isEntity=!0,this.isDestroyable=!1,this.isUsable=!0),"invisible"===t&&(this.isDestroyable=!1,this.isUsable=!1,this.isWeaklyPowerable=!1,this.isEmissive=!0),t.startsWith("glass")&&(this.isSolid=!1),t.startsWith("ice")&&(this.isSolid=!1),"creeper"===t&&(this.isEntity=!0),"bedrock"===t&&(this.isDestroyable=!1),"lava"===t&&(this.isEmissive=!0,this.isWalkable=!0,this.isPlacable=!0),"water"===t&&(this.isPlacable=!0),"torch"===t&&(this.isEmissive=!0,this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!1,this.isTransparent=!0),"cropWheat"===t&&(this.isEmissive=!1,this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!1,this.isTransparent=!0),"tnt"===t&&(this.isUsable=!0,this.isDestroyable=!0),"door"===t&&(this.isWeaklyPowerable=!1,this.isSolid=!1,this.isEntity=!0,this.isWalkable=!1,this.isUsable=!0,this.isDestroyable=!1,this.isTransparent=!0,this.isStickable=!1),"doorIron"===t&&(this.isWeaklyPowerable=!1,this.isSolid=!1,this.isEntity=!0,this.isWalkable=!1,this.isDestroyable=!1,this.isTransparent=!0,this.isConnectedToRedstone=!0,this.isStickable=!1),t.startsWith("redstoneWire")&&(this.isEntity=!0,this.isWalkable=!0,this.isUsable=!0,this.isDestroyable=!0,this.isTransparent=!0,this.isRedstone=!0,this.isStickable=!1),t.startsWith("pressurePlate")&&(this.isWeaklyPowerable="pressurePlateUp"!==t,this.isEntity=!0,this.isWalkable=!0,this.isDestroyable=!1,this.isTransparent=!0,this.isConnectedToRedstone=!0,this.isRedstoneBattery="pressurePlateUp"!==t,this.isStickable=!1),"glowstone"===t&&(this.isEntity=!0),"bedFoot"!==t&&"bedHead"!==t||(this.isEntity=!0),t.startsWith("piston")&&(this.isWeaklyPowerable=!1,this.isSolid=!1,this.isDestroyable=!1,this.isConnectedToRedstone=!t.startsWith("pistonArm"),("On"===t.substring(t.length-2,t.length)||t.startsWith("pistonArm")||"OnSticky"===t.substring(t.length-8,t.length))&&(this.isEntity=!0)),t.startsWith("flower")&&(this.isWalkable=!0)}return e.prototype.isFlat=function(){return this.isRail||this.isRedstone||this.blockType.startsWith("pressurePlate")},e.prototype.notValidOnGroundPlane=function(){return this.blockType.startsWith("rails")||this.blockType.startsWith("redstone")},e.prototype.skipsDestructionOverlay=function(){return this.isRedstone||"torch"===this.blockType||"railsRedstoneTorch"===this.blockType},e.prototype.shouldRenderOnGroundPlane=function(){return this.isFlat()},e.prototype.getIsPowerableRail=function(){return this.isRail&&this.isConnectedToRedstone},e.prototype.getIsHorizontal=function(){return this.blockType.match("East|West")},e.prototype.getIsVertical=function(){return this.blockType.match("North|South")},e.prototype.getIsStickyPiston=function(){return"Sticky"===this.blockType.substring(this.blockType.length-6,this.blockType.length)},e.prototype.canHoldCharge=function(){return this.isSolid},e.prototype.getIsMiniblock=function(){return e.isMiniblock(this.blockType)},e.prototype.getIsTree=function(){return!!this.blockType.match(/^tree/)},e.prototype.getIsDoor=function(){return this.blockType.startsWith("door")},e.prototype.getIsLiquid=function(){return"water"===this.blockType||"lava"===this.blockType},e.prototype.getCanFall=function(){return"sand"===this.blockType||"gravel"===this.blockType},e.prototype.getIsPlaceableInLiquid=function(){return!(this.isRedstone||this.getIsPiston()||this.isRail||"torch"===this.blockType||"railsRedstoneTorch"===this.blockType||"pressurePlateUp"===this.blockType)},e.prototype.getIsPiston=function(){return this.blockType.startsWith("piston")},e.prototype.getIsPistonArm=function(){return this.blockType.startsWith("pistonArm")},e.prototype.getIsPushable=function(){return""!==this.blockType&&!this.isDestroyableUponPush()},e.prototype.isDestroyableUponPush=function(){return this.blockType.startsWith("redstone")||this.blockType.startsWith("door")||this.blockType.startsWith("railsRedstone")||this.blockType.startsWith("pressure")},e.prototype.needToRefreshRedstone=function(){return!!(this.isRedstone||""===this.blockType||this.isConnectedToRedstone&&!this.blockType.startsWith("piston"))},e.prototype.getPistonDirection=function(){if(this.blockType.startsWith("piston")){switch(this.blockType.substring(6,7)){case"D":return r;case"U":return a;case"L":return l;case"R":return s}}},e.prototype.getIsEmptyOrEntity=function(){return this.isEmpty||this.isEntity},e.getCanFall=function(t){return new e(t).getCanFall()},e.getIsPlaceableInLiquid=function(t){return new e(t).getIsPlaceableInLiquid()},e.isWalkable=function(t){return new e(t).isWalkable},e.isMiniblock=function(e){return e.endsWith("Miniblock")},e.isFlat=function(t){return new e(t).isFlat()},e.skipsDestructionOverlay=function(t){return new e(t).skipsDestructionOverlay()},e.notValidOnGroundPlane=function(t){return new e(t).notValidOnGroundPlane()},e.getMiniblockFrame=function(t){if("railsRedstoneTorch"===t)return"redstoneTorch";if(t.startsWith("rails"))return"railNormal";if(!t.startsWith("glass")&&!t.startsWith("ice")){if("redstoneWire"===t.substring(0,12))return"redstoneDust";if(e.isMiniblock(t))return t.replace("Miniblock","");var i=t;switch(i){case"treeAcacia":case"treeBirch":case"treeJungle":case"treeOak":case"treeSpruce":case"treeSpruceSnowy":i="log"+i.substring(4);break;case"stone":i="cobblestone";break;case"oreCoal":i="coal";break;case"oreDiamond":i="diamond";break;case"oreIron":i="ingotIron";break;case"oreLapis":i="lapisLazuli";break;case"oreGold":i="ingotGold";break;case"oreEmerald":i="emerald";break;case"oreRedstone":i="redstoneDust";break;case"grass":i="dirt";break;case"wool_orange":i="wool";break;case"tnt":i="gunPowder"}return i}},e}()},1272:function(e,t,i){"use strict";var n=function(){function e(e,t){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=i(799);e.exports.convertActionPlaneEntitiesToConfig=function(e){var t=e.gridWidth&&e.gridHeight?[e.gridWidth,e.gridHeight]:[10,10],i=n(t,2),a=i[0],r=i[1];[e.actionPlane].forEach(function(t){for(var i=0;i<t.length;i++){var n=t[i];if(n.match(/sheep|zombie|ironGolem|creeper|cow|chicken|ghast/)){var s={Up:o.North,Down:o.South,Left:o.West,Right:o.East};e.entities=e.entities||[];var l=i%a,c=Math.floor(i/r),u=n.match(/(.*)(Right|Left|Up|Down)/),p=u?s[u[2]]:o.East,d=u?u[1]:n;e.entities.push([d,l,c,p]),t[i]=""}}})},e.exports.randomInt=function(e,t){return Math.floor(Math.random()*(t-e))+e}},1952:function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=i(1269),s=i(1016),l=i(1159),c=i(799),u=i(838),p=i(2711),d=i(2716),h=i(2718),f=i(2726),g=i(2727),m=400,v=400,y=function(){function e(t){var i=this;o(this,e),this.DEBUG=t.debug,window.PhaserGlobal={disableAudio:!0,disableWebAudio:!0,hideBanner:!this.DEBUG},this.codeOrgAPI=g.get(this);var n=t.Phaser;this.game=new n.Game({forceSetTimeOut:t.forceSetTimeOut,width:m,height:v,renderer:n.CANVAS,parent:t.containerId,state:"earlyLoad",preserveDrawingBuffer:!0}),this.specialLevelType=null,this.queue=new r(this),this.OnCompleteCallback=null,this.assetRoot=t.assetRoot,this.audioPlayer=t.audioPlayer,this.afterAssetsLoaded=t.afterAssetsLoaded,this.assetLoader=new f(this),this.earlyLoadAssetPacks=t.earlyLoadAssetPacks||[],this.earlyLoadNiceToHaveAssetPacks=t.earlyLoadNiceToHaveAssetPacks||[],this.resettableTimers=[],this.timeouts=[],this.timeout=0,this.initializeCommandRecord(),this.score=0,this.useScore=!1,this.scoreText=null,this.onScoreUpdate=t.onScoreUpdate,this.events=[],this.assumedSlowMotion=1.5,this.initialSlowMotion=t.customSlowMotion||this.assumedSlowMotion,this.tweenTimeScale=1.5/this.initialSlowMotion,this.playerDelayFactor=1,this.dayNightCycle=!1,this.player=null,this.agent=null,this.timerSprite=null,this.game.state.add("earlyLoad",{preload:function(){i.game.load.resetLocked=!0,i.assetLoader.loadPacks(i.earlyLoadAssetPacks)},create:function(){i.assetLoader.loadPacks(i.earlyLoadNiceToHaveAssetPacks),i.game.load.start()}}),this.game.state.add("levelRunner",{preload:this.preload.bind(this),create:this.create.bind(this),update:this.update.bind(this),render:this.render.bind(this)})}return e.prototype.getIsDirectPlayerControl=function(){return this.levelData.isEventLevel||this.levelData.isAgentLevel},e.prototype.loadLevel=function(e){this.levelData=Object.freeze(e),this.levelEntity=new h(this),this.levelModel=new p(this.levelData,this),this.levelView=new d(this),this.specialLevelType=e.specialLevelType,this.timeout=e.levelVerificationTimeout,void 0!==e.useScore&&(this.useScore=e.useScore),this.timeoutResult=e.timeoutResult,this.onDayCallback=e.onDayCallback,this.onNightCallback=e.onNightCallback,this.game.state.start("levelRunner")},e.prototype.reset=function(){var e=this;this.dayNightCycle=!1,this.queue.reset(),this.levelEntity.reset(),this.levelModel.reset(),this.levelView.reset(this.levelModel),this.levelEntity.loadData(this.levelData),this.player=this.levelModel.player,this.agent=this.levelModel.agent,this.resettableTimers.forEach(function(e){e.stop(!0)}),this.timeouts.forEach(function(e){clearTimeout(e)}),this.timerSprite&&this.timerSprite.kill(),this.timerSprite=null,this.timeouts=[],this.resettableTimers.length=0,this.events.length=0,this.score=0,this.useScore&&this.updateScore(),this.getIsDirectPlayerControl()||this.events.push(function(t){t.eventType===l.WhenUsed&&"sheep"===t.targetType&&e.codeOrgAPI.drop(null,"wool",t.targetIdentifier),t.eventType===l.WhenTouched&&"creeper"===t.targetType&&(e.codeOrgAPI.flashEntity(null,t.targetIdentifier),e.codeOrgAPI.explodeEntity(null,t.targetIdentifier))}),this.initializeCommandRecord()},e.prototype.preload=function(){this.game.load.resetLocked=!0,this.game.time.advancedTiming=this.DEBUG,this.game.stage.disableVisibilityChange=!0,this.assetLoader.loadPacks(this.levelData.assetPacks.beforeLoad)},e.prototype.create=function(){var e=this;this.levelView.create(this.levelModel),this.game.time.slowMotion=this.initialSlowMotion,this.addCheatKeys(),this.assetLoader.loadPacks(this.levelData.assetPacks.afterLoad),this.game.load.image("timer",this.assetRoot+"images/placeholderTimer.png"),this.game.load.onLoadComplete.addOnce(function(){e.afterAssetsLoaded&&e.afterAssetsLoaded()}),this.levelEntity.loadData(this.levelData),this.game.load.start()},e.prototype.run=function(){var e=this;this.events.forEach(function(e){return e({eventType:l.WhenRun,targetIdentifier:void 0})});var t=!0,i=!1,n=void 0;try{for(var o,a=this.levelEntity.entityMap[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value,s=r[1];this.events.forEach(function(e){return e({eventType:l.WhenSpawned,targetType:s.type,targetIdentifier:s.identifier})}),s.queue.begin()}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}if(!isNaN(this.timeout)&&this.timeout>0){this.timerSprite=this.game.add.sprite(-50,390,"timer");var c=this.levelView.addResettableTween(this.timerSprite).to({x:-450,alpha:.5},this.timeout,Phaser.Easing.Linear.None);c.onComplete.add(function(){e.endLevel(e.timeoutResult(e.levelModel))}),c.start()}},e.prototype.followingPlayer=function(){return!!this.levelData.gridDimensions&&!this.checkMinecartLevelEndAnimation()},e.prototype.update=function(){this.queue.tick(),this.levelEntity.tick(),this.levelModel.usePlayer&&this.player.updateMovement(),this.levelModel.usingAgent&&this.agent.updateMovement(),this.levelView.update(),(this.getIsDirectPlayerControl()||this.player.queue.state>1)&&this.checkSolution()},e.prototype.addCheatKeys=function(){var e,t=this;if(this.levelModel.usePlayer){var i=(e={},n(e,Phaser.Keyboard.UP,c.North),n(e,Phaser.Keyboard.W,c.North),n(e,Phaser.Keyboard.RIGHT,c.East),n(e,Phaser.Keyboard.D,c.East),n(e,Phaser.Keyboard.DOWN,c.South),n(e,Phaser.Keyboard.S,c.South),n(e,Phaser.Keyboard.LEFT,c.West),n(e,Phaser.Keyboard.A,c.West),n(e,Phaser.Keyboard.SPACEBAR,-2),e);Object.keys(i).forEach(function(e){var n=i[e];t.game.input.keyboard.addKey(e).onDown.add(function(){t.player.movementState=n,t.player.updateMovement()}),t.game.input.keyboard.addKey(e).onUp.add(function(){t.player.movementState===n&&(t.player.movementState=-1),t.player.updateMovement()})})}},e.prototype.handleEndState=function(e){this.OnCompleteCallback&&(this.OnCompleteCallback(e,this.levelModel),this.OnCompleteCallback=null)},e.prototype.render=function(){this.DEBUG&&this.game.debug.text(this.game.time.fps||"--",2,14,"#00ff00"),this.levelView.render()},e.prototype.scaleFromOriginal=function(){var e=this.levelData.gridDimensions||[10,10],t=a(e,2);return[t[0]/10,t[1]/10]},e.prototype.getScreenshot=function(){return this.game.canvas.toDataURL("image/png")},e.prototype.initializeCommandRecord=function(){var e=["moveAway","moveToward","moveForward","turn","turnRandom","explode","wait","flash","drop","spawn","destroy","playSound","attack","addScore"];this.commandRecord=new Map,this.repeatCommandRecord=new Map,this.isRepeat=!1;for(var t=0;t<e.length;t++)this.commandRecord.set(e[t],new Map),this.commandRecord.get(e[t]).set("count",0),this.repeatCommandRecord.set(e[t],new Map),this.repeatCommandRecord.get(e[t]).set("count",0)},e.prototype.startPushRepeatCommand=function(){this.isRepeat=!0},e.prototype.endPushRepeatCommand=function(){this.isRepeat=!1},e.prototype.addCommandRecord=function(e,t,i){var n=i?this.repeatCommandRecord:this.commandRecord;if(n.has(e)){var o=n.get(e);if(o.set("count",o.get("count")+1),o.has(t)?o.set(t,o.get(t)+1):o.set(t,1),this.DEBUG){var a=i?"Repeat ":"Command :";console.log(a+e+" executed in mob type : "+t+" updated count : "+o.get(t))}}},e.prototype.getCommandCount=function(e,t,i){var n=i?this.repeatCommandRecord:this.commandRecord;if(n.has(e)){var o=n.get(e);return void 0===t?o.get("count"):o.has(t)?o.get(t):0}return 0},e.prototype.getEntity=function(e){void 0===e&&(e="Player");var t=this.levelEntity.entityMap.get(e);return void 0===t&&console.log("Debug GetEntity: there is no entity : "+e+"\n"),t},e.prototype.getEntities=function(e){return this.levelEntity.getEntitiesOfType(e)},e.prototype.isType=function(e){return"string"==typeof e&&"Player"!==e&&"PlayerAgent"!==e},e.prototype.printErrorMsg=function(e){this.DEBUG&&this.game.debug.text(e)},e.prototype.moveAway=function(e,t){var i=this,n=e.target;if(void 0===n){var o=this.levelEntity.entityMap,a=!0,r=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var p;!function(){p=c.value;var n=p[1],o=new s(i,function(){},function(){i.moveAway(o,t)},n.identifier);n.addCommand(o,e.repeat)}()}}catch(e){r=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(r)throw l}}e.succeeded()}else{var d=this.isType(n),h=this.isType(t);if(n===t)return this.printErrorMsg("Debug MoveAway: Can't move away entity from itself\n"),void e.succeeded();if(d||h)if(d&&!h){var f=this.getEntities(n),g=this.getEntity(t);if(void 0!==g)for(var m=0;m<f.length;m++){(function(){if(f[m].identifier===g.identifier)return"continue";var n=new s(i,function(){},function(){i.moveAway(n,t)},f[m].identifier);f[m].addCommand(n,e.repeat)})()}e.succeeded()}else if(!d&&h){var v=this.getEntity(n),y=this.getEntities(t);if(y.length>0){for(var _=[Number.MAX_VALUE,-1],k=0;k<y.length;k++)if(v.identifier!==y[k].identifier){var w=v.getDistance(y[k]);w<_[0]&&(_=[w,k])}-1!==_[1]&&v.moveAway(e,y[_[1]])}else e.succeeded()}else!function(){var o=i.getEntities(n),a=i.getEntities(t);if(a.length>0&&o.length>0){for(var r=0;r<o.length;r++)!function(t){for(var n=o[t],r=[Number.MAX_VALUE,-1],l=0;l<a.length;l++)if(a[t].identifier!==n.identifier){var c=n.getDistance(a[l]);c<r[0]&&(r=[c,l])}-1!==r?function(){var t=new s(i,function(){},function(){i.moveAway(t,a[r[1]].identifier)},n.identifier);n.addCommand(t,e.repeat)}():e.succeeded()}(r);e.succeeded()}}();else{var b=this.getEntity(n),C=this.getEntity(t);if(b===C)return void e.succeeded();b.moveAway(e,C)}}},e.prototype.moveToward=function(e,t){var i=this,n=e.target;if(void 0===n){var o=this.levelEntity.entityMap,a=!0,r=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var p;!function(){p=c.value;var n=p[1],o=new s(i,function(){},function(){i.moveToward(o,t)},n.identifier);n.addCommand(o,e.repeat)}()}}catch(e){r=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(r)throw l}}e.succeeded()}else{var d=this.isType(n),h=this.isType(t);if(n===t)return void e.succeeded();if(d||h)if(d&&!h){var f=this.getEntities(n),g=this.getEntity(t);if(void 0!==g){for(var m=0;m<f.length;m++){(function(n){if(f[n].identifier===g.identifier)return"continue";var o=new s(i,function(){},function(){i.moveToward(o,t)},f[n].identifier);f[n].addCommand(o,e.repeat)})(m)}e.succeeded()}}else if(!d&&h){var v=this.getEntity(n),y=this.getEntities(t);if(y.length>0){for(var _=[Number.MAX_VALUE,-1],k=0;k<y.length;k++)if(y[k].identifier!==v.identifier){var w=v.getDistance(y[k]);w<_[0]&&(_=[w,k])}-1!==_[1]?v.moveToward(e,y[_[1]]):e.succeeded()}else e.succeeded()}else!function(){var o=i.getEntities(n),a=i.getEntities(t);if(a.length>0&&o.length>0){for(var r=0;r<o.length;r++)!function(t){for(var n=o[t],r=[Number.MAX_VALUE,-1],l=0;l<a.length;l++)if(a[t].identifier!==n.identifier){var c=n.getDistance(a[l]);c<r[0]&&(r=[c,l])}-1!==r[1]&&function(){var t=new s(i,function(){},function(){i.moveToward(t,a[r[1]].identifier)},n.identifier);n.addCommand(t,e.repeat)}()}(r);e.succeeded()}}();else{var b=this.getEntity(n),C=this.getEntity(t);b.moveToward(e,C)}}},e.prototype.positionEquivalence=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.prototype.execute=function(e,t){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];var a=this,r=e.target;if(this.isType(r)){for(var l=this.getEntities(r),c=0;c<l.length;c++)!function(i){var o=new s(a,function(){},function(){a.execute.apply(a,[o,t].concat(n))},l[i].identifier);l[i].addCommand(o,e.repeat)}(c);e.succeeded()}else if(void 0===r){var u=this.levelEntity.entityMap,p=!0,d=!1,h=void 0;try{for(var f,g=u[Symbol.iterator]();!(p=(f=g.next()).done);p=!0)!function(){var i=f.value,o=i[1],r=new s(a,function(){},function(){a.execute.apply(a,[r,t].concat(n))},o.identifier);o.addCommand(r,e.repeat)}()}catch(e){d=!0,h=e}finally{try{!p&&g.return&&g.return()}finally{if(d)throw h}}e.succeeded()}else{var m=this.getEntity(r);m[t].apply(m,[e].concat(n))}},e.prototype.moveForward=function(e){this.execute(e,"moveForward")},e.prototype.moveBackward=function(e){this.execute(e,"moveBackward")},e.prototype.moveDirection=function(e,t){var i=this.levelModel.player;this.levelModel.shouldRide(t)?(i.handleGetOnRails(t),e.succeeded()):this.execute(e,"moveDirection",t)},e.prototype.turn=function(e,t){this.execute(e,"turn",t)},e.prototype.turnRandom=function(e){this.execute(e,"turnRandom")},e.prototype.flashEntity=function(e){var t=this,i=e.target;if(this.isType(i)){for(var n=this.getEntities(i),o=0;o<n.length;o++)!function(i){var o=new s(t,function(){},function(){t.flashEntity(o)},n[i].identifier);n[i].addCommand(o,e.repeat)}(o);e.succeeded()}else if(void 0===i){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var u,p=a[Symbol.iterator]();!(r=(u=p.next()).done);r=!0)!function(){var i=u.value,n=i[1],o=new s(t,function(){},function(){t.flashEntity(o)},n.identifier);n.addCommand(o,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&p.return&&p.return()}finally{if(l)throw c}}e.succeeded()}else{var d=this.getEntity(i),h=this.levelView.flashSpriteToWhite(d.sprite);this.addCommandRecord("flash",d.type,e.repeat),this.delayBy(h,function(){e.succeeded()})}},e.prototype.explodeEntity=function(e){var t=this,i=e.target;if(this.isType(i)){for(var n=this.getEntities(i),o=0;o<n.length;o++)!function(i){var o=new s(t,function(){},function(){t.explodeEntity(o)},n[i].identifier);n[i].addCommand(o,e.repeat)}(o);e.succeeded()}else{if(void 0===i){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var u,p=a[Symbol.iterator]();!(r=(u=p.next()).done);r=!0)!function(){var i=u.value,n=i[1],o=new s(t,function(){},function(){t.explodeEntity(o)},n.identifier);n.addCommand(o,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&p.return&&p.return()}finally{if(l)throw c}}e.succeeded()}else!function(){var n=t.getEntity(i);t.levelView.playExplosionCloudAnimation(n.position),t.addCommandRecord("explode",n.type,e.repeat),t.levelView.audioPlayer.play("explode");var o=t.levelEntity.entityMap,a=!0,r=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)for(var p=c.value,d=p[1],h=-1;h<=1;h++)for(var f=-1;f<=1;f++)if(0!==h||0!==f){var g=[n.position[0]+h,n.position[1]+f];t.destroyBlockWithoutPlayerInteraction(g),d.position[0]===n.position[0]+h&&d.position[1]===n.position[1]+f&&d.blowUp(e,n.position)}}catch(e){r=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(r)throw l}}var m=new s(t,function(){},function(){t.destroyEntity(m,n.identifier)},n.identifier);n.queue.startPushHighPriorityCommands(),n.addCommand(m,e.repeat),n.queue.endPushHighPriorityCommands()}();e.succeeded(),this.updateFowPlane(),this.updateShadingPlane()}},e.prototype.wait=function(e,t){var i=this,n=e.target;if(this.isType(n)){for(var o=this.getEntities(n),a=0;a<o.length;a++)!function(n){var a=new s(i,function(){},function(){i.wait(a,t)},o[n].identifier);o[n].addCommand(a,e.repeat)}(a);e.succeeded()}else{var r=this.getEntity(n);this.addCommandRecord("wait",r.type,e.repeat),setTimeout(function(){e.succeeded()},1e3*t/this.tweenTimeScale)}},e.prototype.spawnEntity=function(e,t,i){this.addCommandRecord("spawn",t,e.repeat);var n=this.levelEntity.spawnEntity(t,i);null!==n&&this.events.forEach(function(e){return e({eventType:l.WhenSpawned,targetType:t,targetIdentifier:n.identifier})}),e.succeeded()},e.prototype.spawnEntityAt=function(e,t,i,n,o){var a=this.levelEntity.spawnEntityAt(t,i,n,o);null!==a&&this.events.forEach(function(e){return e({eventType:l.WhenSpawned,targetType:t,targetIdentifier:a.identifier})}),e.succeeded()},e.prototype.destroyEntity=function(e,t){var i=this;if(this.isType(t)){for(var n=this.getEntities(t),o=0;o<n.length;o++)!function(t){var o=n[t],a=new s(i,function(){},function(){i.destroyEntity(a,o.identifier)},o.identifier);o.addCommand(a,e.repeat)}(o);e.succeeded()}else if(void 0===t){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var u,p=a[Symbol.iterator]();!(r=(u=p.next()).done);r=!0)!function(){var t=u.value,n=t[1],o=new s(i,function(){},function(){i.destroyEntity(o,n.identifier)},n.identifier);n.addCommand(o,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&p.return&&p.return()}finally{if(l)throw c}}e.succeeded()}else{this.addCommandRecord("destroy",this.type,e.repeat);var d=this.getEntity(t);void 0!==d?(d.healthPoint=1,d.takeDamage(e)):e.succeeded()}},e.prototype.drop=function(e,t){var i=this,n=e.target;if(this.isType(n)){for(var o=this.getEntities(n),a=0;a<o.length;a++)!function(n){var a=new s(i,function(){},function(){i.drop(a,t)},o[n].identifier);o[n].addCommand(a,e.repeat)}(a);e.succeeded()}else if(void 0===n){var r=this.levelEntity.entityMap,l=!0,c=!1,u=void 0;try{for(var p,d=r[Symbol.iterator]();!(l=(p=d.next()).done);l=!0)!function(){var n=p.value,o=n[1],a=new s(i,function(){},function(){i.drop(a,t)},o.identifier);o.addCommand(a,e.repeat)}()}catch(e){c=!0,u=e}finally{try{!l&&d.return&&d.return()}finally{if(c)throw u}}e.succeeded()}else{var h=this.getEntity(n);h.drop(e,t)}},e.prototype.attack=function(e){var t=this,i=e.target;if(this.isType(i)){for(var n=this.getEntities(i),o=0;o<n.length;o++)!function(i){var o=new s(t,function(){},function(){t.attack(o)},n[i].identifier);n[i].addCommand(o,e.repeat)}(o);e.succeeded()}else if(void 0===i){var a=this.levelEntity.entityMap,r=!0,l=!1,c=void 0;try{for(var u,p=a[Symbol.iterator]();!(r=(u=p.next()).done);r=!0)!function(){var i=u.value,n=i[1],o=new s(t,function(){},function(){t.attack(o)},n.identifier);n.addCommand(o,e.repeat)}()}catch(e){l=!0,c=e}finally{try{!r&&p.return&&p.return()}finally{if(l)throw c}}e.succeeded()}else{var d=this.getEntity(i);"Player"===d.identifier?(this.codeOrgAPI.destroyBlock(function(){},d.identifier),e.succeeded()):d.attack(e)}},e.prototype.playSound=function(e,t){this.addCommandRecord("playSound",void 0,e.repeat),this.levelView.audioPlayer.play(t),e.succeeded()},e.prototype.use=function(e){var t=this,i=this.levelModel.player,n=this.levelModel.getMoveForwardPosition(i),o=this.levelEntity.getEntityAt(n),a=this.levelModel.actionPlane.getBlockAt(n),r=void 0!==a&&"door"===a.blockType;null!==o&&o!==this.agent?(this.levelView.setSelectionIndicatorPosition(n[0],n[1]),this.levelView.onAnimationEnd(this.levelView.playPlayerAnimation("punch",i.position,i.facing,!1),function(){o.queue.startPushHighPriorityCommands();var n=new s(t,function(){},function(){o.use(n,i)},o.identifier);t.levelEntity.isFriendlyEntity(o.type)||function(){var e=i.facing,n=new s(t,function(){},function(){o.pushBack(n,e,150)},o.identifier);o.addCommand(n)}(),o.addCommand(n),o.queue.endPushHighPriorityCommands(),t.levelView.playPlayerAnimation("idle",i.position,i.facing,!1),t.getIsDirectPlayerControl()?t.delayPlayerMoveBy(0,0,function(){e.succeeded()}):e.waitForOtherQueue=!0,setTimeout(function(){t.levelView.setSelectionIndicatorPosition(i.position[0],i.position[1])},0)})):r?(this.levelView.setSelectionIndicatorPosition(n[0],n[1]),this.levelView.onAnimationEnd(this.levelView.playPlayerAnimation("punch",i.position,i.facing,!1),function(){t.audioPlayer.play("doorOpen");var o=!a.isWalkable;t.levelView.playDoorAnimation(n,o,function(){a.isWalkable=!a.isWalkable,t.levelView.playIdleAnimation(i.position,i.facing,i.isOnBlock),t.levelView.setSelectionIndicatorPosition(i.position[0],i.position[1]),e.succeeded()})})):a&&a.isRail?(this.levelView.playTrack(n,i.facing,!0,i,null),e.succeeded()):this.levelView.playPunchDestroyAirAnimation(i.position,i.facing,this.levelModel.getMoveForwardPosition(),function(){t.levelView.setSelectionIndicatorPosition(i.position[0],i.position[1]),t.levelView.playIdleAnimation(i.position,i.facing,i.isOnBlock),t.delayPlayerMoveBy(0,0,function(){e.succeeded()})})},e.prototype.destroyBlock=function(e){var t=this,i=this.getEntity(e.target);if(this.levelModel.canDestroyBlockForward(i)){var n=this.levelModel.actionPlane.getBlockAt(this.levelModel.getMoveForwardPosition(i));if(null!==n){var o=this.levelModel.getMoveForwardPosition(i),a=n.blockType;if(n.isDestroyable){switch(a){case"logAcacia":case"treeAcacia":a="planksAcacia";break;case"logBirch":case"treeBirch":a="planksBirch";break;case"logJungle":case"treeJungle":a="planksJungle";break;case"logOak":case"treeOak":a="planksOak";break;case"logSpruce":case"treeSpruce":a="planksSpruce"}this.levelView.playDestroyBlockAnimation(i.position,i.facing,o,a,i,function(){e.succeeded()})}else if(n.isUsable)switch(a){case"sheep":this.levelView.playShearSheepAnimation(i.position,i.facing,o,a,function(){e.succeeded()});break;default:e.succeeded()}else e.succeeded()}}else this.levelView.playPunchDestroyAirAnimation(i.position,i.facing,this.levelModel.getMoveForwardPosition(i),function(){t.levelView.setSelectionIndicatorPosition(i.position[0],i.position[1]),t.levelView.playIdleAnimation(i.position,i.facing,i.isOnBlock,i),t.delayPlayerMoveBy(0,0,function(){e.succeeded()})},i)},e.prototype.destroyBlockWithoutPlayerInteraction=function(e){if(this.levelModel.inBounds(e)){var t=this.levelModel.actionPlane.getBlockAt(e);if(null!==t&&void 0!==t){var i=e,n=t.blockType;if(t.isDestroyable){switch(n){case"logAcacia":case"treeAcacia":n="planksAcacia";break;case"logBirch":case"treeBirch":n="planksBirch";break;case"logJungle":case"treeJungle":n="planksJungle";break;case"logOak":case"treeOak":n="planksOak";break;case"logSpruce":case"treeSpruce":case"logSpruceSnowy":case"treeSpruceSnowy":n="planksSpruce"}this.levelView.destroyBlockWithoutPlayerInteraction(i),this.levelView.playExplosionAnimation(this.levelModel.player.position,this.levelModel.player.facing,e,n,function(){},!1),this.levelView.createMiniBlock(i[0],i[1],n),this.updateFowPlane(),this.updateShadingPlane()}else if(t.isUsable)switch(n){case"sheep":this.levelView.playShearAnimation(this.levelModel.player.position,this.levelModel.player.facing,e,n,function(){})}}this.levelModel.destroyBlock(e)}},e.prototype.checkTntAnimation=function(){return"freeplay"===this.specialLevelType},e.prototype.checkMinecartLevelEndAnimation=function(){return"minecart"===this.specialLevelType},e.prototype.checkHouseBuiltEndAnimation=function(){return"houseBuild"===this.specialLevelType},e.prototype.checkAgentSpawn=function(){return"agentSpawn"===this.specialLevelType},e.prototype.placeBlock=function(e,t){var i=this,n=this.getEntity(e.target),o=n.position,a=this.levelModel.actionPlane.getBlockAt(o),r=a.blockType;this.levelModel.canPlaceBlock(n,a)?(""!==r&&this.levelModel.destroyBlock(o),"cropWheat"!==t||"farmlandWet"===this.levelModel.groundPlane.getBlockAt(n.position).blockType?(this.levelModel.player.updateHidingBlock(n.position),this.checkMinecartLevelEndAnimation()&&"rail"===t&&(t=n.position[1]<7?"railsUnpoweredVertical":"rails"),this.levelView.playPlaceBlockAnimation(n.position,n.facing,t,r,n,function(){i.levelModel.placeBlock(t,n),i.updateFowPlane(),i.updateShadingPlane(),i.delayBy(200,function(){i.levelView.playIdleAnimation(n.position,n.facing,!1,n)}),i.delayPlayerMoveBy(200,400,function(){e.succeeded()})})):function(){var t=i.levelView.playPlayerAnimation("jumpUp",n.position,n.facing,!1,n).onLoop.add(function(){i.levelView.playIdleAnimation(n.position,n.facing,!1,n),t.detach(),i.delayBy(800,function(){return e.succeeded()})},i)}()):e.succeeded()},e.prototype.setPlayerActionDelayByQueueLength=function(){if(this.levelModel.usePlayer){var e=this.levelModel.player.queue.getLength(),t=Math.min(Math.max(e-10,0),10);this.playerDelayFactor=1-t/10}},e.prototype.delayBy=function(e,t){var i=this.game.time.create(!0);i.add(this.originalMsToScaled(e),t,this),i.start(),this.resettableTimers.push(i)},e.prototype.delayPlayerMoveBy=function(e,t,i){this.delayBy(Math.max(e,t*this.playerDelayFactor),i)},e.prototype.originalMsToScaled=function(e){return e/this.assumedSlowMotion*this.game.time.slowMotion},e.prototype.originalFpsToScaled=function(e){return e*this.assumedSlowMotion/this.game.time.slowMotion},e.prototype.placeBlockForward=function(e,t){this.placeBlockDirection(e,t,0)},e.prototype.placeBlockDirection=function(e,t,i){var n=this,o=this.getEntity(e.target),a=void 0,r=void 0,s=function(){};if(!this.levelModel.canPlaceBlockDirection(t,o,i))return void this.levelView.playPunchAirAnimation(o.position,o.facing,o.position,function(){n.levelView.playIdleAnimation(o.position,o.facing,!1,o),e.succeeded()},o);a=this.levelModel.getMoveDirectionPosition(o,i),r=this.levelModel.getPlaneToPlaceOn(a,o,t),this.levelModel.isBlockOfTypeOnPlane(a,"lava",r)&&(s=function(){return n.levelView.audioPlayer.play("fizz")}),this.levelView.playPlaceBlockInFrontAnimation(o,o.position,o.facing,a,function(){n.levelModel.placeBlockDirection(t,r,o,i),n.levelView.refreshGroundGroup(),n.updateFowPlane(),n.updateShadingPlane(),s(),n.delayBy(200,function(){n.levelView.playIdleAnimation(o.position,o.facing,!1,o)}),n.delayPlayerMoveBy(200,400,function(){e.succeeded()})})},e.prototype.checkSolution=function(){var e=this;if(this.attemptRunning&&!this.resultReported)if(this.levelModel.isSolved()){var t,i,n,o,a,r;!function(){var s=e.levelModel.player;if(e.checkHouseBuiltEndAnimation())e.resultReported=!0,t=e.levelModel.getHouseBottomRight(),i=new u(t.x-1,t.y+2),n=new u(t.x,t.y),o=new u(t.x-1,t.y+1),e.levelModel.moveTo(i),e.levelView.playSuccessHouseBuiltAnimation(s.position,s.facing,s.isOnBlock,e.levelModel.houseGroundToFloorBlocks(t),[n,o],function(){e.endLevel(!0)},function(){e.levelModel.destroyBlock(n),e.levelModel.destroyBlock(o),e.updateFowPlane(),e.updateShadingPlane()});else if(e.checkMinecartLevelEndAnimation())e.resultReported=!0,e.levelView.playMinecartAnimation(s.isOnBlock,function(){e.handleEndState(!0)});else if(e.checkAgentSpawn()){e.resultReported=!0;var l=e.levelView.playLevelEndAnimation(s.position,s.facing,s.isOnBlock);l.onComplete.add(function(){e.levelModel.spawnAgent(null,new u(3,4),2),e.levelView.agent=e.agent,e.levelView.resetEntity(e.agent),e.updateFowPlane(),e.updateShadingPlane(),e.delayBy(200,function(){e.endLevel(!0)})})}else e.checkTntAnimation()?(e.resultReported=!0,e.levelView.scaleShowWholeWorld(function(){}),a=e.levelModel.getTnt(),r=s.isOnBlock,e.levelView.playDestroyTntAnimation(s.position,s.facing,s.isOnBlock,e.levelModel.getTnt(),e.levelModel.shadingPlane,function(){for(var t in a){a[t].x===e.levelModel.player.position.x&&a[t].y===e.levelModel.player.position.y&&(e.levelModel.player.isOnBlock=!1);var i=e.levelModel.getAllBorderingPositionNotOfType(a[t],"tnt");e.levelModel.destroyBlock(a[t]);for(var n=1;n<i.length;++n)i[n][0]&&e.destroyBlockWithoutPlayerInteraction(i[n][1])}!s.isOnBlock&&r&&e.levelView.playPlayerJumpDownVerticalAnimation(s.facing,s.position),e.updateFowPlane(),e.updateShadingPlane(),e.delayBy(200,function(){e.levelView.playSuccessAnimation(s.position,s.facing,s.isOnBlock,function(){e.endLevel(!0)})})})):e.endLevel(!0)}()}else!this.levelModel.isFailed()&&this.getIsDirectPlayerControl()||this.endLevel(!1)},e.prototype.endLevel=function(e){var t=this;if(!this.levelModel.usePlayer)return e?this.levelView.audioPlayer.play("success"):this.levelView.audioPlayer.play("failure"),this.resultReported=!0,void this.handleEndState(e);e?function(){var e=t.levelModel.player,i=new s(t,function(){},function(){t.levelView.playSuccessAnimation(e.position,e.facing,e.isOnBlock,function(){t.handleEndState(!0)})},e.identifier);e.queue.startPushHighPriorityCommands(),e.addCommand(i,t.isRepeat),e.queue.endPushHighPriorityCommands()}():function(){var e=t.levelModel.player,i=new s(t,function(){},function(){t.destroyEntity(i,e.identifier)},e.identifier);e.queue.startPushHighPriorityCommands(),e.addCommand(i,t.isRepeat),e.queue.endPushHighPriorityCommands()}()},e.prototype.addScore=function(e,t){this.addCommandRecord("addScore",void 0,e.repeat),this.useScore&&(this.score+=t,this.updateScore()),e.succeeded()},e.prototype.updateScore=function(){this.onScoreUpdate&&this.onScoreUpdate(this.score)},e.prototype.isPathAhead=function(e){return this.levelModel.isForwardBlockOfType(e)},e.prototype.addCommand=function(e){if(void 0!==e.target){this.getEntity(e.target).addCommand(e,this.isRepeat)}else this.queue.addCommand(e,this.isRepeat),this.queue.begin()},e.prototype.addGlobalCommand=function(e){var t=this.levelEntity.entityMap.get(e.target);void 0!==t?t.addCommand(e,this.isRepeat):(this.queue.addCommand(e,this.isRepeat),this.queue.begin())},e.prototype.startDay=function(e){var t=this;if(this.levelModel.isDaytime)void 0!==e&&null!==e&&e.succeeded(),this.DEBUG&&this.game.debug.text("Impossible to start day since it's already day time\n");else{void 0!==this.onDayCallback&&this.onDayCallback(),this.levelModel.isDaytime=!0,this.levelModel.clearFow(),this.levelView.updateFowGroup(this.levelModel.fowPlane),this.events.forEach(function(e){return e({eventType:l.WhenDayGlobal})});var i=this.levelEntity.entityMap,n=!0,o=!1,a=void 0;try{for(var r,s=i[Symbol.iterator]();!(n=(r=s.next()).done);n=!0)!function(){var e=r.value,i=e[1];t.events.forEach(function(e){return e({eventType:l.WhenDay,targetIdentifier:i.identifier,targetType:i.type})})}()}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}for(var c=this.levelEntity.getEntitiesOfType("zombie"),u=0;u<c.length;u++)c[u].setBurn(!0);void 0!==e&&null!==e&&e.succeeded()}},e.prototype.startNight=function(e){var t=this;if(this.levelModel.isDaytime){void 0!==this.onNightCallback&&this.onNightCallback(),this.levelModel.isDaytime=!1,this.levelModel.computeFowPlane(),this.levelView.updateFowGroup(this.levelModel.fowPlane),this.events.forEach(function(e){return e({eventType:l.WhenNightGlobal})});var i=this.levelEntity.entityMap,n=!0,o=!1,a=void 0;try{for(var r,s=i[Symbol.iterator]();!(n=(r=s.next()).done);n=!0)!function(){var e=r.value,i=e[1];t.events.forEach(function(e){return e({eventType:l.WhenNight,targetIdentifier:i.identifier,targetType:i.type})})}()}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}for(var c=this.levelEntity.getEntitiesOfType("zombie"),u=0;u<c.length;u++)c[u].setBurn(!1);void 0!==e&&null!==e&&e.succeeded()}else void 0!==e&&null!==e&&e.succeeded(),this.DEBUG&&this.game.debug.text("Impossible to start night since it's already night time\n")},e.prototype.initiateDayNightCycle=function(e,t,i){var n=this;"day"===i||"Day"===i?this.timeouts.push(setTimeout(function(){n.startDay(null),n.setDayNightCycle(t,"night")},1e3*e)):"night"!==i&&"Night"!==i||this.timeouts.push(setTimeout(function(){n.startNight(null),n.setDayNightCycle(t,"day")},1e3*e))},e.prototype.setDayNightCycle=function(e,t){var i=this;this.dayNightCycle&&("day"===t||"Day"===t?this.timeouts.push(setTimeout(function(){i.dayNightCycle&&(i.startDay(null),i.setDayNightCycle(e,"night"))},1e3*e)):"night"!==t&&"Night"!==t||this.timeouts.push(setTimeout(function(){i.dayNightCycle&&(i.startNight(null),i.setDayNightCycle(e,"day"))},1e3*e)))},e.prototype.arrowDown=function(e){this.levelModel.usePlayer&&(this.player.movementState=e,this.player.updateMovement())},e.prototype.arrowUp=function(e){this.levelModel.usePlayer&&(this.player.movementState===e&&(this.player.movementState=-1),this.player.updateMovement())},e.prototype.clickDown=function(){this.levelModel.usePlayer&&(this.player.movementState=-2,this.player.updateMovement())},e.prototype.clickUp=function(){this.levelModel.usePlayer&&(-2===this.player.movementState&&(this.player.movementState=-1),this.player.updateMovement())},e.prototype.updateFowPlane=function(){this.levelModel.computeFowPlane(),this.levelView.updateFowGroup(this.levelModel.fowPlane)},e.prototype.updateShadingPlane=function(){this.levelModel.computeShadingPlane(),this.levelView.updateShadingGroup(this.levelModel.shadingPlane)},e}();window.GameController=y,e.exports=y},2129:function(e,t,i){var n;/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(o,a,r,s){"use strict";function l(e,t,i){return setTimeout(h(e,i),t)}function c(e,t,i){return!!Array.isArray(e)&&(u(e,i[t],i),!0)}function u(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==s)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function p(e,t,i){var n="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=o.console&&(o.console.warn||o.console.log);return a&&a.call(o.console,n,i),e.apply(this,arguments)}}function d(e,t,i){var n,o=t.prototype;n=e.prototype=Object.create(o),n.constructor=e,n._super=o,i&&fe(n,i)}function h(e,t){return function(){return e.apply(t,arguments)}}function f(e,t){return typeof e==ve?e.apply(t?t[0]||s:s,t):e}function g(e,t){return e===s?t:e}function m(e,t,i){u(k(t),function(t){e.addEventListener(t,i,!1)})}function v(e,t,i){u(k(t),function(t){e.removeEventListener(t,i,!1)})}function y(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function _(e,t){return e.indexOf(t)>-1}function k(e){return e.trim().split(/\s+/g)}function w(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function b(e){return Array.prototype.slice.call(e,0)}function C(e,t,i){for(var n=[],o=[],a=0;a<e.length;){var r=t?e[a][t]:e[a];w(o,r)<0&&n.push(e[a]),o[a]=r,a++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function P(e,t){for(var i,n,o=t[0].toUpperCase()+t.slice(1),a=0;a<ge.length;){if(i=ge[a],(n=i?i+o:t)in e)return n;a++}return s}function S(){return Ce++}function A(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||o}function T(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){f(e.options.enable,[e])&&i.handler(t)},this.init()}function E(e){var t=e.options.inputClass;return new(t||(Ae?q:Te?H:Se?J:U))(e,M)}function M(e,t,i){var n=i.pointers.length,o=i.changedPointers.length,a=t&Me&&n-o==0,r=t&(Re|De)&&n-o==0;i.isFirst=!!a,i.isFinal=!!r,a&&(e.session={}),i.eventType=t,B(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function B(e,t){var i=e.session,n=t.pointers,o=n.length;i.firstInput||(i.firstInput=O(t)),o>1&&!i.firstMultiple?i.firstMultiple=O(t):1===o&&(i.firstMultiple=!1);var a=i.firstInput,r=i.firstMultiple,s=r?r.center:a.center,l=t.center=I(n);t.timeStamp=ke(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=N(s,l),t.distance=x(s,l),R(i,t),t.offsetDirection=F(t.deltaX,t.deltaY);var c=L(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=_e(c.x)>_e(c.y)?c.x:c.y,t.scale=r?W(r.pointers,n):1,t.rotation=r?V(r.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,D(i,t);var u=e.element;y(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function R(e,t){var i=t.center,n=e.offsetDelta||{},o=e.prevDelta||{},a=e.prevInput||{};t.eventType!==Me&&a.eventType!==Re||(o=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=o.x+(i.x-n.x),t.deltaY=o.y+(i.y-n.y)}function D(e,t){var i,n,o,a,r=e.lastInterval||t,l=t.timeStamp-r.timeStamp;if(t.eventType!=De&&(l>Ee||r.velocity===s)){var c=t.deltaX-r.deltaX,u=t.deltaY-r.deltaY,p=L(l,c,u);n=p.x,o=p.y,i=_e(p.x)>_e(p.y)?p.x:p.y,a=F(c,u),e.lastInterval=t}else i=r.velocity,n=r.velocityX,o=r.velocityY,a=r.direction;t.velocity=i,t.velocityX=n,t.velocityY=o,t.direction=a}function O(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:ye(e.pointers[i].clientX),clientY:ye(e.pointers[i].clientY)},i++;return{timeStamp:ke(),pointers:t,center:I(t),deltaX:e.deltaX,deltaY:e.deltaY}}function I(e){var t=e.length;if(1===t)return{x:ye(e[0].clientX),y:ye(e[0].clientY)};for(var i=0,n=0,o=0;o<t;)i+=e[o].clientX,n+=e[o].clientY,o++;return{x:ye(i/t),y:ye(n/t)}}function L(e,t,i){return{x:t/e||0,y:i/e||0}}function F(e,t){return e===t?Oe:_e(e)>=_e(t)?e<0?Ie:Le:t<0?Fe:xe}function x(e,t,i){i||(i=Ue);var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]];return Math.sqrt(n*n+o*o)}function N(e,t,i){i||(i=Ue);var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]];return 180*Math.atan2(o,n)/Math.PI}function V(e,t){return N(t[1],t[0],qe)+N(e[1],e[0],qe)}function W(e,t){return x(t[0],t[1],qe)/x(e[0],e[1],qe)}function U(){this.evEl=Ge,this.evWin=He,this.pressed=!1,T.apply(this,arguments)}function q(){this.evEl=Ye,this.evWin=Xe,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function j(){this.evTarget=Ze,this.evWin=Qe,this.started=!1,T.apply(this,arguments)}function G(e,t){var i=b(e.touches),n=b(e.changedTouches);return t&(Re|De)&&(i=C(i.concat(n),"identifier",!0)),[i,n]}function H(){this.evTarget=et,this.targetIds={},T.apply(this,arguments)}function z(e,t){var i=b(e.touches),n=this.targetIds;if(t&(Me|Be)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var o,a,r=b(e.changedTouches),s=[],l=this.target;if(a=i.filter(function(e){return y(e.target,l)}),t===Me)for(o=0;o<a.length;)n[a[o].identifier]=!0,o++;for(o=0;o<r.length;)n[r[o].identifier]&&s.push(r[o]),t&(Re|De)&&delete n[r[o].identifier],o++;return s.length?[C(a.concat(s),"identifier",!0),s]:void 0}function J(){T.apply(this,arguments);var e=h(this.handler,this);this.touch=new H(this.manager,e),this.mouse=new U(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Y(e,t){e&Me?(this.primaryTouch=t.changedPointers[0].identifier,X.call(this,t)):e&(Re|De)&&X.call(this,t)}function X(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches,o=function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)};setTimeout(o,tt)}}function K(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],a=Math.abs(t-o.x),r=Math.abs(i-o.y);if(a<=it&&r<=it)return!0}return!1}function Z(e,t){this.manager=e,this.set(t)}function Q(e){if(_(e,st))return st;var t=_(e,lt),i=_(e,ct);return t&&i?st:t||i?t?lt:ct:_(e,rt)?rt:at}function $(e){this.options=fe({},this.defaults,e||{}),this.id=S(),this.manager=null,this.options.enable=g(this.options.enable,!0),this.state=pt,this.simultaneous={},this.requireFail=[]}function ee(e){return e&mt?"cancel":e&ft?"end":e&ht?"move":e&dt?"start":""}function te(e){return e==xe?"down":e==Fe?"up":e==Ie?"left":e==Le?"right":""}function ie(e,t){var i=t.manager;return i?i.get(e):e}function ne(){$.apply(this,arguments)}function oe(){ne.apply(this,arguments),this.pX=null,this.pY=null}function ae(){ne.apply(this,arguments)}function re(){$.apply(this,arguments),this._timer=null,this._input=null}function se(){ne.apply(this,arguments)}function le(){ne.apply(this,arguments)}function ce(){$.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ue(e,t){return t=t||{},t.recognizers=g(t.recognizers,ue.defaults.preset),new pe(e,t)}function pe(e,t){this.options=fe({},ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=E(this),this.touchAction=new Z(this,this.options.touchAction),de(this,!0),u(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function de(e,t){var i=e.element;if(i.style){var n;u(e.options.cssProps,function(o,a){n=P(i.style,a),t?(e.oldCssProps[n]=i.style[n],i.style[n]=o):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={})}}function he(e,t){var i=a.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}var fe,ge=["","webkit","Moz","MS","ms","o"],me=a.createElement("div"),ve="function",ye=Math.round,_e=Math.abs,ke=Date.now;fe="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==s&&null!==n)for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])}return t}:Object.assign;var we=p(function(e,t,i){for(var n=Object.keys(t),o=0;o<n.length;)(!i||i&&e[n[o]]===s)&&(e[n[o]]=t[n[o]]),o++;return e},"extend","Use `assign`."),be=p(function(e,t){return we(e,t,!0)},"merge","Use `assign`."),Ce=1,Pe=/mobile|tablet|ip(ad|hone|od)|android/i,Se="ontouchstart"in o,Ae=P(o,"PointerEvent")!==s,Te=Se&&Pe.test(navigator.userAgent),Ee=25,Me=1,Be=2,Re=4,De=8,Oe=1,Ie=2,Le=4,Fe=8,xe=16,Ne=Ie|Le,Ve=Fe|xe,We=Ne|Ve,Ue=["x","y"],qe=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(A(this.element),this.evWin,this.domHandler)}};var je={mousedown:Me,mousemove:Be,mouseup:Re},Ge="mousedown",He="mousemove mouseup";d(U,T,{handler:function(e){var t=je[e.type];t&Me&&0===e.button&&(this.pressed=!0),t&Be&&1!==e.which&&(t=Re),this.pressed&&(t&Re&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var ze={pointerdown:Me,pointermove:Be,pointerup:Re,pointercancel:De,pointerout:De},Je={2:"touch",3:"pen",4:"mouse",5:"kinect"},Ye="pointerdown",Xe="pointermove pointerup pointercancel";o.MSPointerEvent&&!o.PointerEvent&&(Ye="MSPointerDown",Xe="MSPointerMove MSPointerUp MSPointerCancel"),d(q,T,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),o=ze[n],a=Je[e.pointerType]||e.pointerType,r="touch"==a,s=w(t,e.pointerId,"pointerId");o&Me&&(0===e.button||r)?s<0&&(t.push(e),s=t.length-1):o&(Re|De)&&(i=!0),s<0||(t[s]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),i&&t.splice(s,1))}});var Ke={touchstart:Me,touchmove:Be,touchend:Re,touchcancel:De},Ze="touchstart",Qe="touchstart touchmove touchend touchcancel";d(j,T,{handler:function(e){var t=Ke[e.type];if(t===Me&&(this.started=!0),this.started){var i=G.call(this,e,t);t&(Re|De)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}});var $e={touchstart:Me,touchmove:Be,touchend:Re,touchcancel:De},et="touchstart touchmove touchend touchcancel";d(H,T,{handler:function(e){var t=$e[e.type],i=z.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}});var tt=2500,it=25;d(J,T,{handler:function(e,t,i){var n="touch"==i.pointerType,o="mouse"==i.pointerType;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)Y.call(this,t,i);else if(o&&K.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var nt=P(me.style,"touchAction"),ot=nt!==s,at="auto",rt="manipulation",st="none",lt="pan-x",ct="pan-y",ut=function(){if(!ot)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){e[i]=!t||o.CSS.supports("touch-action",i)}),e}();Z.prototype={set:function(e){"compute"==e&&(e=this.compute()),ot&&this.manager.element.style&&ut[e]&&(this.manager.element.style[nt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return u(this.manager.recognizers,function(t){f(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Q(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,o=_(n,st)&&!ut[st],a=_(n,ct)&&!ut[ct],r=_(n,lt)&&!ut[lt];if(o){var s=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(s&&l&&c)return}return r&&a?void 0:o||a&&i&Ne||r&&i&Ve?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var pt=1,dt=2,ht=4,ft=8,gt=ft,mt=16;$.prototype={defaults:{},set:function(e){return fe(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(c(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=ie(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return c(e,"dropRecognizeWith",this)?this:(e=ie(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(c(e,"requireFailure",this))return this;var t=this.requireFail;return e=ie(e,this),-1===w(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(c(e,"dropRequireFailure",this))return this;e=ie(e,this);var t=w(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(t,e)}var i=this,n=this.state;n<ft&&t(i.options.event+ee(n)),t(i.options.event),e.additionalEvent&&t(e.additionalEvent),n>=ft&&t(i.options.event+ee(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|pt)))return!1;e++}return!0},recognize:function(e){var t=fe({},e);if(!f(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(gt|mt|32)&&(this.state=pt),this.state=this.process(t),this.state&(dt|ht|ft|mt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},d(ne,$,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(dt|ht),o=this.attrTest(e);return n&&(i&De||!o)?t|mt:n||o?i&Re?t|ft:t&dt?t|ht:dt:32}}),d(oe,ne,{defaults:{event:"pan",threshold:10,pointers:1,direction:We},getTouchAction:function(){var e=this.options.direction,t=[];return e&Ne&&t.push(ct),e&Ve&&t.push(lt),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,o=e.direction,a=e.deltaX,r=e.deltaY;return o&t.direction||(t.direction&Ne?(o=0===a?Oe:a<0?Ie:Le,i=a!=this.pX,n=Math.abs(e.deltaX)):(o=0===r?Oe:r<0?Fe:xe,i=r!=this.pY,n=Math.abs(e.deltaY))),e.direction=o,i&&n>t.threshold&&o&t.direction},attrTest:function(e){return ne.prototype.attrTest.call(this,e)&&(this.state&dt||!(this.state&dt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=te(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),d(ae,ne,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&dt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),d(re,$,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[at]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(Re|De)&&!o)this.reset();else if(e.eventType&Me)this.reset(),this._timer=l(function(){this.state=gt,this.tryEmit()},t.time,this);else if(e.eventType&Re)return gt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===gt&&(e&&e.eventType&Re?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ke(),this.manager.emit(this.options.event,this._input)))}}),d(se,ne,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&dt)}}),d(le,ne,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ne|Ve,pointers:1},getTouchAction:function(){return oe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(Ne|Ve)?t=e.overallVelocity:i&Ne?t=e.overallVelocityX:i&Ve&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&_e(t)>this.options.velocity&&e.eventType&Re},emit:function(e){var t=te(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),d(ce,$,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rt]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&Me&&0===this.count)return this.failTimeout();if(n&&o&&i){if(e.eventType!=Re)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||x(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,r&&a?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=l(function(){this.state=gt,this.tryEmit()},t.interval,this),dt):gt}return 32},failTimeout:function(){return this._timer=l(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ue.VERSION="2.0.7",ue.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[se,{enable:!1}],[ae,{enable:!1},["rotate"]],[le,{direction:Ne}],[oe,{direction:Ne},["swipe"]],[ce],[ce,{event:"doubletap",taps:2},["tap"]],[re]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};pe.prototype={set:function(e){return fe(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,n=this.recognizers,o=t.curRecognizer;(!o||o&&o.state&gt)&&(o=t.curRecognizer=null);for(var a=0;a<n.length;)i=n[a],2===t.stopped||o&&i!=o&&!i.canRecognizeWith(o)?i.reset():i.recognize(e),!o&&i.state&(dt|ht|ft)&&(o=t.curRecognizer=i),a++}},get:function(e){if(e instanceof $)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(c(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(c(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=w(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var i=this.handlers;return u(k(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==s){var i=this.handlers;return u(k(e),function(e){t?i[e]&&i[e].splice(w(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&he(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&de(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},fe(ue,{INPUT_START:Me,INPUT_MOVE:Be,INPUT_END:Re,INPUT_CANCEL:De,STATE_POSSIBLE:pt,STATE_BEGAN:dt,STATE_CHANGED:ht,STATE_ENDED:ft,STATE_RECOGNIZED:gt,STATE_CANCELLED:mt,STATE_FAILED:32,DIRECTION_NONE:Oe,DIRECTION_LEFT:Ie,DIRECTION_RIGHT:Le,DIRECTION_UP:Fe,DIRECTION_DOWN:xe,DIRECTION_HORIZONTAL:Ne,DIRECTION_VERTICAL:Ve,DIRECTION_ALL:We,Manager:pe,Input:T,TouchAction:Z,TouchInput:H,MouseInput:U,PointerEventInput:q,TouchMouseInput:J,SingleTouchInput:j,Recognizer:$,AttrRecognizer:ne,Tap:ce,Pan:oe,Swipe:le,Pinch:ae,Rotate:se,Press:re,on:m,off:v,each:u,merge:be,extend:we,assign:fe,inherit:d,bindFn:h,prefixed:P}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=ue,(n=function(){return ue}.call(t,i,t,e))!==s&&(e.exports=n)}(window,document)},2131:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__(35),_jquery2=_interopRequireDefault(_jquery),_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(32),_reactDom2=_interopRequireDefault(_reactDom),_hammerjs=__webpack_require__(2129),_hammerjs2=_interopRequireDefault(_hammerjs),_trackEvent=__webpack_require__(601),_trackEvent2=_interopRequireDefault(_trackEvent),_utils=__webpack_require__(71),_StudioApp=__webpack_require__(597),_locale=__webpack_require__(1955),_locale2=_interopRequireDefault(_locale),_CustomMarshalingInterpreter=__webpack_require__(850),_CustomMarshalingInterpreter2=_interopRequireDefault(_CustomMarshalingInterpreter),_GameController=__webpack_require__(1952),_GameController2=_interopRequireDefault(_GameController),_FacingDirection=__webpack_require__(799),_FacingDirection2=_interopRequireDefault(_FacingDirection),_EventType=__webpack_require__(1159),_EventType2=_interopRequireDefault(_EventType),_Utils=__webpack_require__(1272),_dom=__webpack_require__(594),_dom2=_interopRequireDefault(_dom),_MusicController=__webpack_require__(1954),_MusicController2=_interopRequireDefault(_MusicController),_reactRedux=__webpack_require__(53),_AppView=__webpack_require__(944),_AppView2=_interopRequireDefault(_AppView),_CraftVisualizationColumn=__webpack_require__(2740),_CraftVisualizationColumn2=_interopRequireDefault(_CraftVisualizationColumn),_redux=__webpack_require__(237),_Sounds=__webpack_require__(764),_Sounds2=_interopRequireDefault(_Sounds),_constants=__webpack_require__(216),_thumbnail=__webpack_require__(1158),_progressRedux=__webpack_require__(498),MEDIA_URL="/blockly/media/craft/",ArrowIds={LEFT:"leftButton",UP:"upButton",RIGHT:"rightButton",DOWN:"downButton"},interfaceImages={DEFAULT:[MEDIA_URL+"Sliced_Parts/MC_Loading_Spinner.gif",MEDIA_URL+"Sliced_Parts/Frame_Large_Plus_Logo.png",MEDIA_URL+"Sliced_Parts/Pop_Up_Slice.png",MEDIA_URL+"Sliced_Parts/X_Button.png",MEDIA_URL+"Sliced_Parts/Button_Grey_Slice.png",MEDIA_URL+"Sliced_Parts/Run_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Run_Arrow_Icon_Smaller.png",MEDIA_URL+"Sliced_Parts/Run_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Reset_Arrow_Icon.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Callout_Tail.png"],1:[MEDIA_URL+"Sliced_Parts/Steve_Character_Select.png",MEDIA_URL+"Sliced_Parts/Alex_Character_Select.png",MEDIA_URL+"Sliced_Parts/Agent_Fail.png",MEDIA_URL+"Sliced_Parts/Agent_Neutral.png",MEDIA_URL+"Sliced_Parts/Agent_Success.png"]},MUSIC_METADATA=[{volume:1,hasOgg:!0,name:"vignette1"},{volume:1,hasOgg:!0,name:"vignette2-quiet"},{volume:1,hasOgg:!0,name:"vignette3"},{volume:1,hasOgg:!0,name:"vignette4-intro"},{volume:1,hasOgg:!0,name:"vignette5-shortpiano"},{volume:1,hasOgg:!0,name:"vignette7-funky-chirps-short"},{volume:1,hasOgg:!0,name:"vignette8-free-play"},{volume:1,hasOgg:!0,name:"nether2"}],CHARACTER_STEVE="Steve",CHARACTER_ALEX="Alex",DEFAULT_CHARACTER=CHARACTER_STEVE,directionToFacing={upButton:_FacingDirection2.default.North,downButton:_FacingDirection2.default.South,leftButton:_FacingDirection2.default.West,rightButton:_FacingDirection2.default.East},Craft=function(){function Craft(){_classCallCheck(this,Craft)}return Craft.init=function(e){1===e.level.puzzle_number&&1===e.level.stage_total&&(e.level.puzzle_number=999),e.level.isTestLevel&&(e.level.customSlowMotion=.1),e.level.disableFinalStageMessage=!0,e.showInstructionsInTopPane=!0;var t=function(){return document.documentMode}();t&&(0,_jquery2.default)("body").addClass("ieVersion"+t),e.level.isAgentLevel&&(0,_jquery2.default)("body").addClass("minecraft-agent");var i=document.body;i.className=i.className+" minecraft",e.level.afterVideoBeforeInstructionsFn=function(t){Craft.beginBackgroundMusic(),e.level.showPopupOnLoad?"playerSelection"===e.level.showPopupOnLoad&&Craft.showPlayerSelectionPopup(function(i){(0,_trackEvent2.default)("Minecraft","ChoseCharacter",i),Craft.clearPlayerState(),(0,_utils.trySetLocalStorage)("craftSelectedPlayer",i),Craft.initializeAppLevel(e.level),t()}):t()},Craft.initialConfig=e,(0,_StudioApp.singleton)().reset=Craft.reset.bind(Craft),(0,_StudioApp.singleton)().runButtonClick=Craft.runButtonClick.bind(Craft),(0,_StudioApp.singleton)().setCheckForEmptyBlocks(!0),Craft.level=e.level,Craft.skin=e.skin;var n=[];Craft.level.songs&&MUSIC_METADATA&&(n=MUSIC_METADATA.filter(function(e){return-1!==Craft.level.songs.indexOf(e.name)})),Craft.musicController=new _MusicController2.default(_Sounds2.default.getSingleton(),function(t){return e.skin.assetUrl("music/"+t)},n,n.length>1?7500:null),e.skin.staticAvatar=MEDIA_URL+"Sliced_Parts/Agent_Neutral.png",e.skin.smallStaticAvatar=MEDIA_URL+"Sliced_Parts/Agent_Neutral.png",e.skin.failureAvatar=MEDIA_URL+"Sliced_Parts/Agent_Fail.png",e.skin.winAvatar=MEDIA_URL+"Sliced_Parts/Agent_Success.png";var o=function(){(0,_StudioApp.singleton)().init(Object.assign({},e,{forceInsertTopBlock:"when_run",appStrings:{generatedCodeDescription:_locale2.default.generatedCodeDescription()},loadAudio:function(){},afterInject:function(){var t;e.level.showMovementBanner&&(0,_StudioApp.singleton)().displayWorkspaceAlert("warning",_react2.default.createElement("div",null,_locale2.default.useArrowKeys()));var i=parseFloat((location.search.split("customSlowMotion=")[1]||"").split("&")[0]);if(Craft.gameController=new _GameController2.default({Phaser:window.Phaser,containerId:"phaser-game",assetRoot:Craft.skin.assetUrl(""),audioPlayer:{register:(0,_StudioApp.singleton)().registerAudio.bind((0,_StudioApp.singleton)()),play:(0,_StudioApp.singleton)().playAudio.bind((0,_StudioApp.singleton)())},debug:!1,customSlowMotion:e.level.isTestLevel?.5:i,earlyLoadAssetPacks:Craft.earlyLoadAssetsForLevel(e.level.puzzle_number),afterAssetsLoaded:function(){window.addEventListener("displayHintPath",function(e){Craft.gameController.levelView.drawHintPath(e.detail)}),window.addEventListener("craftCollectibleCollected",function(e){"diamondMiniblock"===e.blockType&&Craft.setSessionDiamondCollected()}),Craft.musicController.preload()},earlyLoadNiceToHaveAssetPacks:Craft.niceToHaveAssetsForLevel(e.level.puzzle_number)}),e.level.showPopupOnLoad||Craft.initializeAppLevel(e.level),(0,_StudioApp.singleton)().hideSource){document.getElementById("visualizationColumn").style.width=this.nativeVizWidth+"px"}for(var n in ArrowIds)_dom2.default.addMouseUpTouchEvent(document.getElementById(ArrowIds[n]),function(e){return function(){Craft.onArrowButtonUp(ArrowIds[e])}}(n)),_dom2.default.addMouseDownTouchEvent(document.getElementById(ArrowIds[n]),function(e){return function(t){Craft.onArrowButtonDown(t,ArrowIds[e])}}(n));_dom2.default.addMouseUpTouchEvent(document,Craft.onDocumentMouseUp,!1),(0,_jquery2.default)("#soft-buttons").removeClass("soft-buttons-none").addClass("soft-buttons-4"),(0,_jquery2.default)(".arrow").prop("disabled",!1);var o=document.getElementById("resetButton");_dom2.default.addClickTouchEvent(o,Craft.resetButtonClick);var a=document.getElementById("phaser-game"),r=(t={},_defineProperty(t,_hammerjs2.default.DIRECTION_LEFT,"leftButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_RIGHT,"rightButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_UP,"upButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_DOWN,"downButton"),t),s=function(e){r[e.direction]&&Craft.gameController.codeOrgAPI.arrowDown(directionToFacing[r[e.direction]]),e.preventDefault()},l=function(e){r[e.direction]&&Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[r[e.direction]]),e.preventDefault()},c=new _hammerjs2.default.Manager(a);c.add(new _hammerjs2.default.Pan({direction:_hammerjs2.default.DIRECTION_ALL})),c.add(new _hammerjs2.default.Press({time:150})),c.add(new _hammerjs2.default.Tap),c.on("pan",s),c.on("panend pancancel",l),c.on("press",function(){return Craft.gameController.codeOrgAPI.clickDown(function(){})}),c.on("tap",function(){Craft.gameController.codeOrgAPI.clickDown(function(){}),Craft.gameController.codeOrgAPI.clickUp(function(){})}),c.on("pressup",function(){return Craft.gameController.codeOrgAPI.clickUp(function(){})})},twitter:{text:"Share on Twitter",hashtag:"Craft"}}));var t=[];t=t.concat(interfaceImages.DEFAULT),e.level.puzzle_number&&interfaceImages[e.level.puzzle_number]&&(t=t.concat(interfaceImages[e.level.puzzle_number])),t.forEach(function(e){(new Image).src=e});var i=(0,_jquery2.default)(".mc-share-button");i.length&&_dom2.default.addClickTouchEvent(i[0],function(){Craft.reportResult(!0)})};(0,_StudioApp.singleton)().setPageConstants(e,{isMinecraft:!0,hideRunButton:"agentSpawn"===e.level.specialLevelType}),_reactDom2.default.render(_react2.default.createElement(_reactRedux.Provider,{store:(0,_redux.getStore)()},_react2.default.createElement(_AppView2.default,{visualizationColumn:_react2.default.createElement(_CraftVisualizationColumn2.default,{showFinishButton:!e.level.isProjectLevel}),onMount:o})),document.getElementById(e.containerId))},Craft.beginBackgroundMusic=function(){_Sounds2.default.getSingleton().whenAudioUnlocked(function(){var e=Craft.level.songs&&Craft.level.songs.length>1,t=e?Craft.level.songs[0]:null;Craft.musicController.play(t)})},Craft.onArrowButtonDown=function(e,t){Craft.gameController.codeOrgAPI.arrowDown(directionToFacing[t]),e.preventDefault()},Craft.onArrowButtonUp=function(e){Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[e])},Craft.onDocumentMouseUp=function(){if(Craft.phaserLoaded()&&Craft.levelInitialized())for(var e in directionToFacing)Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[e])},Craft.characterAssetPackName=function(e){return"player"+e},Craft.getCurrentCharacter=function(){return window.localStorage.getItem("craftSelectedPlayer")||DEFAULT_CHARACTER},Craft.getSessionDiamondCollectedLevels=function(){return JSON.parse((0,_utils.tryGetLocalStorage)("craftSessionDiamondCollectedLevels","[]"))||[]},Craft.setSessionDiamondCollected=function(){var e=Craft.getSessionDiamondCollectedLevels();return!e.includes(Craft.initialConfig.serverLevelId)&&(e.push(Craft.initialConfig.serverLevelId),(0,_utils.trySetLocalStorage)("craftSessionDiamondCollectedLevels",JSON.stringify(e)),!0)},Craft.showPlayerSelectionPopup=function(e){var t=DEFAULT_CHARACTER,i=document.createElement("div");i.innerHTML=__webpack_require__(2741)({image:(0,_StudioApp.singleton)().assetUrl()});var n=(0,_StudioApp.singleton)().createModalDialog({contentDiv:i,defaultBtnSelector:"#choose-steve",onHidden:function(){e(t)},id:"craft-popup-player-selection"});_dom2.default.addClickTouchEvent((0,_jquery2.default)("#close-character-select")[0],function(){n.hide()}),_dom2.default.addClickTouchEvent((0,_jquery2.default)("#choose-steve")[0],function(){t=CHARACTER_STEVE,(0,_trackEvent2.default)("MinecraftAgent","ClickedCharacter",t),n.hide()}),_dom2.default.addClickTouchEvent((0,_jquery2.default)("#choose-alex")[0],function(){t=CHARACTER_ALEX,(0,_trackEvent2.default)("MinecraftAgent","ClickedCharacter",t),n.hide()}),n.show()},Craft.clearPlayerState=function(){window.localStorage.removeItem("craftSelectedPlayer")},Craft.initializeAppLevel=function initializeAppLevel(levelConfig){(0,_Utils.convertActionPlaneEntitiesToConfig)(levelConfig);for(var fluffPlane=[],i=0;i<(levelConfig.gridWidth||10)*(levelConfig.gridHeight||10);i++)fluffPlane.push("");var levelAssetPacks={beforeLoad:Craft.minAssetsForLevelWithCharacter(levelConfig.puzzle_number),afterLoad:Craft.afterLoadAssetsForLevel(levelConfig.puzzle_number)};Craft.gameController.loadLevel({isDaytime:levelConfig.isDaytime,groundPlane:levelConfig.groundPlane,groundDecorationPlane:levelConfig.groundDecorationPlane,actionPlane:levelConfig.actionPlane,fluffPlane:fluffPlane,entities:levelConfig.entities,useAgent:!!levelConfig.agentStartPosition,usePlayer:!!levelConfig.playerStartPosition,playerStartPosition:levelConfig.playerStartPosition,playerStartDirection:levelConfig.playerStartDirection,agentStartPosition:levelConfig.agentStartPosition,agentStartDirection:levelConfig.agentStartDirection,playerName:Craft.getCurrentCharacter(),assetPacks:levelAssetPacks,specialLevelType:levelConfig.specialLevelType,isAgentLevel:levelConfig.isAgentLevel,gridDimensions:levelConfig.gridWidth&&levelConfig.gridHeight?[levelConfig.gridWidth,levelConfig.gridHeight]:null,levelVerificationTimeout:levelConfig.levelVerificationTimeout,verificationFunction:eval("["+levelConfig.verificationFunction+"]")[0],failureCheckFunction:eval("["+levelConfig.failureCheckFunction+"]")[0],timeoutResult:eval("["+(levelConfig.timeoutVerificationFunction||"function() { return false; }")+"]")[0]})},Craft.minAssetsForLevelWithCharacter=function(e){return Craft.minAssetsForLevelNumber(e).concat([Craft.characterAssetPackName(Craft.getCurrentCharacter())])},Craft.minAssetsForLevelNumber=function(e){return["heroAllAssetsMinusPlayer","playerAgent"]},Craft.afterLoadAssetsForLevel=function(e){return["heroAllAssetsMinusPlayer","playerAgent"]},Craft.earlyLoadAssetsForLevel=function(e){return Craft.minAssetsForLevelWithCharacter(e)},Craft.niceToHaveAssetsForLevel=function(e){switch(e){case 1:return["playerSteve","playerAlex"];default:return["heroAllAssetsMinusPlayer"]}},Craft.reset=function(e){e||((0,_thumbnail.captureThumbnailFromCanvas)((0,_jquery2.default)("#minecraft-frame canvas")[0]),Craft.gameController.codeOrgAPI.resetAttempt())},Craft.phaserLoaded=function(){return Craft.gameController&&Craft.gameController.game&&Craft.gameController.game.load&&!Craft.gameController.game.load.isLoading},Craft.levelInitialized=function(){return Craft.gameController&&Craft.gameController.levelModel},Craft.resetButtonClick=function(){(0,_jquery2.default)(".arrow").prop("disabled",!1)},Craft.isPreAnimationFailure=function(e){switch(e){case _constants.TestResults.QUESTION_MARKS_IN_NUMBER_FIELD:case _constants.TestResults.EMPTY_FUNCTIONAL_BLOCK:case _constants.TestResults.EXTRA_TOP_BLOCKS_FAIL:case _constants.TestResults.EXAMPLE_FAILED:case _constants.TestResults.EMPTY_BLOCK_FAIL:case _constants.TestResults.EMPTY_FUNCTION_NAME:return!0;default:return!1}},Craft.runButtonClick=function(){if(Craft.phaserLoaded()&&((0,_StudioApp.singleton)().toggleRunReset("reset"),Blockly.mainBlockSpace.traceOn(!0),(0,_StudioApp.singleton)().attempts++,Craft.executeUserCode(),Craft.level.freePlay&&!(0,_StudioApp.singleton)().hideSource)){var e=(0,_jquery2.default)("#right-button-cell");if(e.length&&!e.hasClass("right-button-cell-enabled")){e.addClass("right-button-cell-enabled"),(0,_StudioApp.singleton)().onResize();var t=document.createEvent("Event");t.initEvent("finishButtonShown",!0,!0),document.dispatchEvent(t)}}},Craft.executeUserCode=function(){if(Craft.initialConfig.level.edit_blocks)return void Craft.reportResult(!0);var e=(0,_StudioApp.singleton)().getTestResults(!1);if(Craft.isPreAnimationFailure(e))return void Craft.reportResult(!1);(0,_StudioApp.singleton)().playAudio("start"),Blockly.mainBlockSpace.traceOn(!0);var t=Craft.gameController.codeOrgAPI;t.startCommandCollection(),t.registerEventCallback(null,function(e){e.eventType===_EventType2.default.WhenUsed&&"sheep"===e.targetType&&t.drop(null,"wool",e.targetIdentifier),e.eventType===_EventType2.default.WhenTouched&&"creeper"===e.targetType&&(t.flashEntity(null,e.targetIdentifier),t.explodeEntity(null,e.targetIdentifier))});var i="",n=Blockly.mainBlockSpace.getTopBlocks(!0);(0,_StudioApp.singleton)().initializationBlocks&&(n=(0,_StudioApp.singleton)().initializationBlocks.concat(n)),i=Blockly.Generator.blocksToCode("JavaScript",n),_CustomMarshalingInterpreter2.default.evalWith(i,{moveForward:function(e){t.moveForward((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},moveBackward:function(e){t.moveBackward((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},turnLeft:function(e){t.turnLeft((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},turnRight:function(e){t.turnRight((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},destroyBlock:function(e){t.destroyBlock((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"PlayerAgent")},whilePathAhead:function(e,i){t.whilePathAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),"","PlayerAgent",i)},whileBlockAhead:function(e,i,n){t.whilePathAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),e),i,"PlayerAgent",n)},ifLavaAhead:function(e,i){t.ifBlockAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),"lava","PlayerAgent",e)},ifBlockAhead:function(e,i,n){t.ifBlockAhead((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),e,"PlayerAgent",i)},placeBlock:function(e,i){t.placeBlock((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),e,"PlayerAgent")},placeDirection:function(e,i,n){t.placeDirection((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),e,"PlayerAgent",i)},moveDirection:function(e,i,n){var o={up:_FacingDirection2.default.North,down:_FacingDirection2.default.South,left:_FacingDirection2.default.West,right:_FacingDirection2.default.East};t.moveDirection((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),o[e],i)}}),Craft.gameController.codeOrgAPI.startAttempt(function(e){Craft.level.freePlay||Craft.reportResult(e)})},Craft.getTestResultFrom=function(e,t){return t===_constants.TestResults.LEVEL_INCOMPLETE_FAIL?_constants.TestResults.APP_SPECIFIC_FAIL:Craft.initialConfig.level.freePlay?_constants.TestResults.FREE_PLAY:t},Craft.reportResult=function(e){var t=(0,_StudioApp.singleton)().getTestResults(e),i=Craft.getTestResultFrom(e,t),n=Craft.initialConfig.level.freePlay?Craft.gameController.getScreenshot():null,o=n?encodeURIComponent(n.split(",")[1]):null,a=void 0;if(i===_constants.TestResults.APP_SPECIFIC_FAIL)a=_locale2.default.agentGenericFailureMessage();else if(i===_constants.TestResults.TOO_FEW_BLOCKS_FAIL)a=_locale2.default.agentTooFewBlocksFailureMessage();else if(i===_constants.TestResults.ALL_PASS){var r=Craft.getSessionDiamondCollectedLevels();r.includes(Craft.initialConfig.serverLevelId)&&(a=_locale2.default.agentDiamondPathCongrats({count:r.length}))}(0,_StudioApp.singleton)().report({app:"craft",level:Craft.initialConfig.level.id,result:!!Craft.initialConfig.level.freePlay||e,testResult:i,image:o,program:encodeURIComponent(Blockly.Xml.domToText(Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace))),onComplete:function(e){var t=Craft.initialConfig.level.freePlay;t&&e.level_source&&(0,_utils.trySetLocalStorage)("craftHeroShareLink",e.level_source);var o=(0,_redux.getStore)().getState().progress.signInState===_progressRedux.SignInState.SignedIn;(0,_StudioApp.singleton)().displayFeedback({feedbackType:i,response:e,level:Craft.initialConfig.level,defaultToContinue:Craft.shouldDefaultToContinue(i),message:a,appStrings:{reinfFeedbackMsg:_locale2.default.reinfFeedbackMsg(),nextLevelMsg:_locale2.default.nextLevelMsg({puzzleNumber:Craft.initialConfig.level.puzzle_number}),tooManyBlocksFailMsgFunction:_locale2.default.tooManyBlocksFail,generatedCodeDescription:_locale2.default.generatedCodeDescription()},feedbackImage:n,showingSharing:t,saveToProjectGallery:!0,disableSaveToGallery:!o})}})},Craft.shouldDefaultToContinue=function(e){var t=e===_constants.TestResults.FREE_PLAY;return e>_constants.TestResults.APP_SPECIFIC_ACCEPTABLE_FAIL&&!t},Craft}();exports.default=Craft,module.exports=exports.default},2711:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(2712),a=i(1271),r=i(799),s=i(838),l=i(2714),c=i(2715);e.exports=function(){function e(t,i){n(this,e),this.planeWidth=t.gridDimensions?t.gridDimensions[0]:10,this.planeHeight=t.gridDimensions?t.gridDimensions[1]:10,this.controller=i,this.player={},this.agent={},this.usingAgent=!1,this.initialLevelData=Object.create(t),this.reset(),this.initialPlayerState=Object.create(this.player),this.initialAgentState=Object.create(this.agent)}return e.prototype.planeArea=function(){return this.planeWidth*this.planeHeight},e.prototype.inBounds=function(e){var t=e[0],i=e[1];return t>=0&&t<this.planeWidth&&i>=0&&i<this.planeHeight},e.prototype.reset=function(){var e=this;this.groundPlane=new o(this.initialLevelData.groundPlane,this.planeWidth,this.planeHeight,this,"groundPlane"),this.groundDecorationPlane=new o(this.initialLevelData.groundDecorationPlane,this.planeWidth,this.planeHeight,this,"decorationPlane"),this.shadingPlane=[],this.actionPlane=new o(this.initialLevelData.actionPlane,this.planeWidth,this.planeHeight,this,"actionPlane"),this.actionPlane.powerRedstone(),this.actionPlane.getAllPositions().forEach(function(t){e.actionPlane.getBlockAt(t).isRedstone&&e.actionPlane.determineRedstoneSprite(t),e.actionPlane.getBlockAt(t).isRail&&e.actionPlane.determineRailType(t)}),this.fluffPlane=new o(this.initialLevelData.fluffPlane,this.planeWidth,this.planeHeight),this.fowPlane=[],this.isDaytime=void 0===this.initialLevelData.isDaytime||this.initialLevelData.isDaytime;var t=Object.create(this.initialLevelData);if(void 0!==this.initialLevelData.usePlayer?this.usePlayer=this.initialLevelData.usePlayer:this.usePlayer=!0,this.usePlayer){var i=s.fromArray(t.playerStartPosition);this.player=new l(this.controller,"Player",i.x,i.y,this.initialLevelData.playerName||"Steve",!this.actionPlane.getBlockAt(i).getIsEmptyOrEntity(),t.playerStartDirection),this.controller.levelEntity.pushEntity(this.player),this.controller.player=this.player,t.useAgent&&this.spawnAgent(t)}!t.useAgent&&this.usingAgent&&this.destroyAgent(),this.computeShadingPlane(),this.computeFowPlane()},e.prototype.spawnAgent=function(e,t,i){this.usingAgent=!0;var n=void 0!==t?t:s.fromArray(e.agentStartPosition),o=void 0!==i?i:e.agentStartDirection,a=this.actionPlane.getBlockAt(n);this.agent=new c(this.controller,"PlayerAgent",n.x,n.y,"Agent",!a.getIsEmptyOrEntity(),o),this.controller.levelEntity.pushEntity(this.agent),this.controller.agent=this.agent},e.prototype.destroyAgent=function(){this.controller.agent=void 0,this.controller.levelEntity.destroyEntity(this.agent.identifier),this.agent=void 0,this.usingAgent=!1},e.prototype.yToIndex=function(e){return e*this.planeWidth},e.prototype.isSolved=function(){return this.initialLevelData.verificationFunction(this)},e.prototype.isFailed=function(){return void 0!==this.initialLevelData.failureCheckFunction&&this.initialLevelData.failureCheckFunction(this)},e.prototype.getHouseBottomRight=function(){return s.fromArray(this.initialLevelData.houseBottomRight)},e.prototype.isPlayerNextTo=function(e){var t=this;return!!this.usePlayer&&s.getOrthogonalPositions(this.player.position).some(function(i){return t.inBounds(i)&&(t.isBlockOfType(i,e)||t.isEntityOfType(i,e)||t.groundPlane.getBlockAt(i).blockType===e)})},e.prototype.isEntityNextTo=function(e,t){var i=this;return this.controller.levelEntity.getEntitiesOfType(e).some(function(e){return s.getOrthogonalPositions(e.position).some(function(e){return i.inBounds(e)&&(i.isBlockOfType(e,t)||i.isEntityOfType(e,t)||i.groundPlane.getBlockAt(e).blockType===t)})})},e.prototype.isEntityOnBlocktype=function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.controller.levelEntity.getEntitiesOfType(e),o=0,a=0;a<n.length;a++){var r=n[a];(this.isBlockOfType(r.position,t)||this.groundPlane.getBlockAt(r.position).blockType===t)&&o++}return o>=i},e.prototype.isEntityAt=function(e,t){Array.isArray(t)&&(t=s.fromArray(t));for(var i=this.controller.levelEntity.getEntitiesOfType(e),n=0;n<i.length;n++){var o=i[n];if(s.equals(o.position,t))return!0}return!1},e.prototype.isEntityTypeRunning=function(e){for(var t=this.controller.levelEntity.getEntitiesOfType(e),i=0;i<t.length;i++){var n=t[i],o=!n.queue.isStarted(),a=!n.queue.isFinished();if(o&&n.queue.commandList_.length>0||a)return!0}return!1},e.prototype.isEntityDied=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.controller.levelEntity.entityDeathCount;return!!(i.has(e)&&i.get(e)>=t)},e.prototype.getScore=function(){return this.controller.score},e.prototype.shouldRide=function(e){var t=this.player,i=this.getNextRailPosition(t,e),n=this.actionPlane.getBlockAt(i);return this.isNextRailValid(n,e)},e.prototype.isNextRailValid=function(e,t){if(e)return r.opposite(e.connectionA)===t||r.opposite(e.connectionB)===t||e.connectionA===t||e.connectionB===t},e.prototype.getNextRailPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1],i=s.directionToOffsetPosition(t)||new s(0,0);return s.add(e.position,i)},e.prototype.getEntityCount=function(e){return this.controller.levelEntity.getEntitiesOfType(e).length},e.prototype.getCommandExecutedCount=function(e,t){return this.controller.getCommandCount(e,t,!1)},e.prototype.getRepeatCommandExecutedCount=function(e,t){return this.controller.getCommandCount(e,t,!0)},e.prototype.getTurnRandomCount=function(){return this.controller.turnRandomCount},e.prototype.getInventoryAmount=function(e){if(!this.usePlayer)return 0;if("all"===e||"All"===e){var t=this.player.inventory,i=0;for(var n in t)i+=t[n];return i}return this.player.inventory[e]},e.prototype.getInventoryTypes=function(){return this.usePlayer?Object.keys(this.player.inventory):[]},e.prototype.countOfTypeOnMap=function(e){var t=this;return this.actionPlane.getAllPositions().filter(function(i){return t.actionPlane.getBlockAt(i).blockType===e}).length},e.prototype.isPlayerAt=function(e){return!!this.usePlayer&&(Array.isArray(e)&&(e=s.fromArray(e)),s.equals(this.player.position,e))},e.prototype.spritePositionToIndex=function(e,t){var i=s.subtract(t,e);return new s(i.x/40,i.y/40)},e.prototype.solutionMapMatchesResultMap=function(e){for(var t=0;t<this.planeArea();t++){var i=e[t],n=this.actionPlane.indexToCoordinates(t);if(""!==i)if("empty"===i){if(!this.actionPlane.getBlockAt(n).isEmpty)return!1}else if("any"===i){if(this.actionPlane.getBlockAt(n).isEmpty)return!1}else if(this.actionPlane.getBlockAt(n).blockType!==i)return!1}return!0},e.prototype.getTnt=function(){var e=this;return this.actionPlane.getAllPositions().filter(function(t){var i=e.actionPlane.getBlockAt(t);return i&&"tnt"===i.blockType})},e.prototype.getMoveForwardPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;return s.forward(e.position,e.facing)},e.prototype.getMoveDirectionPosition=function(e,t){for(var i=e.facing,n=0;n<t;++n)i=r.turn(i,"right");return s.forward(e.position,i)},e.prototype.isForwardBlockOfType=function(e){var t=this.getMoveForwardPosition(),i=this.isBlockOfTypeOnPlane(t,"empty",this.actionPlane);return!(""!==e||!i)||(i?this.isBlockOfTypeOnPlane(t,e,this.groundPlane):this.isBlockOfTypeOnPlane(t,e,this.actionPlane))},e.prototype.getForwardBlockType=function(){return this.getForwardBlock().blockType},e.prototype.getForwardBlock=function(){var e=this.getMoveForwardPosition();return this.actionPlane.getBlockAt(e)},e.prototype.isBlockOfType=function(e,t){return this.isBlockOfTypeOnPlane(e,t,this.actionPlane)},e.prototype.isEntityOfType=function(e,t){return this.controller.levelEntity.getEntitiesOfType(t).some(function(t){return s.equals(e,t.position)})},e.prototype.isBlockOfTypeOnPlane=function(e,t,i){var n=!1;return this.inBounds(e)&&(n="empty"===t?i.getBlockAt(e).isEmpty:"tree"===t?i.getBlockAt(e).getIsTree():t===i.getBlockAt(e).blockType),n},e.prototype.isPlayerStandingInWater=function(){return"water"===this.groundPlane.getBlockAt(this.player.position).blockType},e.prototype.isPlayerStandingInLava=function(){return"lava"===this.groundPlane.getBlockAt(this.player.position).blockType},e.prototype.coordinatesToIndex=function(e){return this.yToIndex(e[1])+e[0]},e.prototype.checkPositionForTypeAndPush=function(e,t,i){return!e&&""!==this.actionPlane.getBlockAt(t).blockType||this.isBlockOfType(t,e)?(i.push([!0,t]),!0):(i.push([!1,null]),!1)},e.prototype.houseGroundToFloorHelper=function(e,t,i){var n,o,a,r,s,l=0,c=i,u=this.yToIndex(e[2])+e[1];44===u&&(u=44),o=[0,e[1],e[2]+1],o[0]=this.yToIndex(o[2])+o[1],a=[0,e[1],e[2]-1],a[0]=this.yToIndex(a[2])+a[1],r=[0,e[1]+1,e[2]],r[0]=this.yToIndex(r[2])+r[1],s=[0,e[1]-1,e[2]],r[0]=this.yToIndex(r[2])+r[1],n=this.actionPlane.getBlockAt(this.actionPlane.indexToCoordinates(u));for(var p=0;p<c.length;++p)if(c[p][0]===u){l=-1;break}return""!==n.blockType?{}:c.length>0&&-1===l?{}:(c.push(e),c.concat(this.houseGroundToFloorHelper(o,t,c)),c.concat(this.houseGroundToFloorHelper(a,t,c)),c.concat(this.houseGroundToFloorHelper(r,t,c)),c.concat(this.houseGroundToFloorHelper(s,t,c)),c)},e.prototype.houseGroundToFloorBlocks=function(e){var t=[0,e[0],e[1]];return this.houseGroundToFloorHelper(t,"wool_orange",[])},e.prototype.getEntityAt=function(e){var t=!0,i=!1,n=void 0;try{for(var o,a=this.controller.levelEntity.entityMap[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if(s.equals(r[1].position,e))return r[1]}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}},e.prototype.getAllBorderingPositionNotOfType=function(e,t){for(var i=this.getAllBorderingPosition(e,null),n=1;n<i.length;++n)i[n][0]&&this.actionPlane.getBlockAt(i[n][1]).blockType===t&&(i[n][0]=!1);return i},e.prototype.getAllBorderingPosition=function(e,t){var i=this,n=[!1];return s.getSurroundingPositions(e).forEach(function(e){i.checkPositionForTypeAndPush(t,e,n)&&(n[0]=!0)}),n},e.prototype.canMoveForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveForwardPosition(e);return!(!this.controller.followingPlayer()&&(t.x>9||t.y>9))&&this.isPositionEmpty(t,e)},e.prototype.canMoveBackward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveDirectionPosition(e,2);return this.isPositionEmpty(t,e)},e.prototype.isPositionEmpty=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player,i=[!1];if(this.inBounds(e)){if(this.actionPlane.getBlockAt(e).isWalkable||i.push("notWalkable"),!this.actionPlane.getBlockAt(e).isEmpty){if(this.player.isOnBlock)return[!0];i.push("notEmpty")}if("water"===this.groundPlane.getBlockAt(e).blockType){if(!this.controller.getIsDirectPlayerControl())return[!0];i.push("water")}else if("lava"===this.groundPlane.getBlockAt(e).blockType){if(!this.controller.getIsDirectPlayerControl())return[!0];i.push("lava")}var n=this.getEntityAt(e);void 0!==n&&(i.push("frontEntity"),i.push(n));var o=this.groundPlane.getBlockAt(e),a=this.actionPlane.getBlockAt(e);i[0]=t.hasPermissionToWalk(a,n,o)}else i.push("outBound");return i},e.prototype.canMoveDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1],i=e.facing;this.turnToDirection(e,t);var n=this.canMoveForward(e);return this.turnToDirection(e,i),n},e.prototype.canPlaceBlock=function(e,t){return e.canPlaceBlock(t)},e.prototype.canPlaceBlockDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2];return!t.isOnBlock&&!(this.getPlaneToPlaceOn(this.getMoveDirectionPosition(t,i),t,e)===this.groundPlane&&a.notValidOnGroundPlane(e)&&this.groundPlane.getBlockAt(this.getMoveDirectionPosition(t,i))||this.checkEntityConflict(this.getMoveDirectionPosition(t,i))||null===this.getPlaneToPlaceOn(this.getMoveDirectionPosition(t,i),t,e))},e.prototype.checkEntityConflict=function(e){var t=!1;return this.controller.levelEntity.entityMap.forEach(function(i){s.equals(i.position,e)&&(t=!0)}),t},e.prototype.canPlaceBlockForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;return this.canPlaceBlockDirection(e,t,0)},e.prototype.getPlaneToPlaceOn=function(e,t,i){if(this.inBounds(e)){var n=this.actionPlane.getBlockAt(e);if(t===this.agent&&n.isEmpty){if(this.groundPlane.getBlockAt(e).getIsLiquid()){if(a.getCanFall(i))return this.groundPlane;if(!a.getIsPlaceableInLiquid(i))return null}return this.actionPlane}if(n.isPlacable){return this.groundPlane.getBlockAt(e).isPlacable?this.groundPlane:this.actionPlane}}return null},e.prototype.canDestroyBlockForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=!1;if(!e.isOnBlock){var i=this.getMoveForwardPosition(e);if(this.inBounds(i)){var n=this.actionPlane.getBlockAt(i);t=!n.isEmpty&&(n.isDestroyable||n.isUsable)}}return t},e.prototype.moveForward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveForwardPosition(e);this.moveTo(t,e)},e.prototype.moveBackward=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=this.getMoveDirectionPosition(e,2);this.moveTo(t,e)},e.prototype.moveTo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;t.setMovePosition(e),this.actionPlane.getBlockAt(e).isEmpty&&(t.isOnBlock=!1)},e.prototype.turnLeft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;e.facing=r.turn(e.facing,"left")},e.prototype.turnRight=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;e.facing=r.turn(e.facing,"right")},e.prototype.turnToDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1];e.facing=t},e.prototype.moveDirection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1];this.turnToDirection(e,t),this.moveForward()},e.prototype.placeBlock=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player,i=t.position,n=null,o=this.groundPlane.getBlockAt(i),r=this.actionPlane.getBlockAt(i),s=new a(e),l=t.canPlaceBlockOver(s,o);if(l.canPlace&&!r.getIsMiniblock())switch(l.plane){case"actionPlane":n=this.actionPlane.setBlockAt(i,s),t.walkableCheck(s);break;case"groundPlane":this.groundPlane.setBlockAt(i,s)}return n},e.prototype.placeBlockForward=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player;return this.placeBlockDirection(e,t,i,0)},e.prototype.placeBlockDirection=function(e,t,i,n){var o=this.getMoveDirectionPosition(i,n);return"watering"===e&&(e="farmlandWet",t=this.groundPlane),t.setBlockAt(o,new a(e))},e.prototype.destroyBlock=function(e){var t=null;return this.inBounds(e)&&null!==(t=this.actionPlane.getBlockAt(e))&&(t.position=e,t.isDestroyable&&this.actionPlane.setBlockAt(e,new a(""))),t},e.prototype.destroyBlockForward=function(e){var t=null,i=this.getMoveForwardPosition(e);return this.inBounds(i)&&null!==(t=this.actionPlane.getBlockAt(i))&&t.isDestroyable&&this.actionPlane.setBlockAt(i,new a("")),t},e.prototype.solveFOWTypeForMap=function(){var e,t;e=this.getAllEmissives(),t=this.findBlocksAffectedByEmissives(e);for(var i in t)t.hasOwnProperty(i)&&this.solveFOWTypeFor(t[i],e)},e.prototype.solveFOWTypeFor=function(e,t){var i,n,o,a=!1,r=!1,s=!1,l=!1,c=!1,u=!1,p=!1,d=!1,h=0,f=this.coordinatesToIndex(e);i=this.findEmissivesThatTouch(e,t);for(var g in i){var m=i[g];o=e[1],n=e[0],h=Math.atan2(m[1]-e[1],m[0]-e[0]),h=-h,h<0&&(h+=2*Math.PI),h*=360/(2*Math.PI),!u&&h>32.5&&h<=57.5&&(l=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_InCorner_TopRight",precedence:0})),!s&&h>122.5&&h<=147.5&&(a=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_InCorner_TopLeft",precedence:0})),!s&&h>212.5&&h<=237.5&&(r=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_InCorner_BottomLeft",precedence:0})),!u&&h>302.5&&h<=317.5&&(c=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_InCorner_BottomRight",precedence:0})),(h>=327.5||h<=32.5)&&(u=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Right",precedence:1})),h>237.5&&h<=302.5&&(d=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Bottom",precedence:1})),h>147.5&&h<=212.5&&(s=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Left",precedence:1})),h>57.5&&h<=122.5&&(p=!0,this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Top",precedence:1}))}a&&r&&this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Left",precedence:1}),l&&c&&this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Right",precedence:1}),a&&l&&this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Top",precedence:1}),c&&r&&this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Bottom",precedence:1}),c&&a||r&&l||s&&u||p&&d||u&&d&&a||d&&l&&a||p&&c&&r||s&&l&&c||s&&d&&l?this.fowPlane[f]="":d&&s||d&&a||s&&c?this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Bottom_Left",precedence:2}):d&&u||d&&l||u&&r?this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Bottom_Right",precedence:2}):p&&u||p&&c||u&&a?this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Top_Right",precedence:2}):(p&&s||p&&r||s&&l)&&this.pushIfHigherPrecedence(f,{x:n,y:o,type:"FogOfWar_Top_Left",precedence:2})},e.prototype.pushIfHigherPrecedence=function(e,t){if(""===t)return void(this.fowPlane[e]="");var i=this.fowPlane[e];i&&i.precedence>t.precedence||(this.fowPlane[e]=t)},e.prototype.getAllEmissives=function(){for(var e=[],t=0;t<this.planeHeight;++t)for(var i=0;i<this.planeWidth;++i){var n=new s(i,t);(!this.actionPlane.getBlockAt(n).isEmpty&&this.actionPlane.getBlockAt(n).isEmissive||this.groundPlane.getBlockAt(n).isEmissive&&this.actionPlane.getBlockAt(n).isEmpty)&&e.push(n)}return e},e.prototype.findBlocksAffectedByEmissives=function(e){var t={};for(var i in e)for(var n=e[i],o=n.x,a=n.y,r=n.y-2;r<=a+2;++r)for(var l=n.x-2;l<=o+2;++l){var c=new s(l,r);this.inBounds(c)&&(r>=a-1&&r<=a+1&&l>=o-1&&l<=o+1||(t[r.toString()+l.toString()]=c))}return t},e.prototype.findEmissivesThatTouch=function(e,t){for(var i=[],n=e.y,o=e.x,a=n-2;a<=n+2;++a)for(var r=o-2;r<=o+2;++r){var l=new s(r,a);if(this.inBounds(l)&&!(a>=n-1&&a<=n+1&&r>=o-1&&r<=o+1))for(var c in t)s.equals(t[c],l)&&i.push(t[c])}return i},e.prototype.computeFowPlane=function(){var e,t;if(this.fowPlane=[],!this.isDaytime){for(t=0;t<this.planeHeight;++t)for(e=0;e<this.planeWidth;++e)this.fowPlane.push({x:e,y:t,type:"FogOfWar_Center"});for(this.solveFOWTypeForMap(),t=0;t<this.planeHeight;++t)for(e=0;e<this.planeWidth;++e){var i=new s(e,t),n=this.groundPlane.getBlockAt(i),o=this.actionPlane.getBlockAt(i);(n.isEmissive&&o.isEmpty||!o.isEmpty&&o.isEmissive)&&this.clearFowAround(e,t)}}},e.prototype.clearFowAround=function(e,t){var i,n;for(n=-1;n<=1;++n)for(i=-1;i<=1;++i)this.clearFowAt(e+i,t+n)},e.prototype.clearFowAt=function(e,t){if(e>=0&&e<this.planeWidth&&t>=0&&t<this.planeHeight){var i=this.yToIndex(t)+e;this.fowPlane[i]=""}},e.prototype.clearFow=function(){for(var e=0;e<this.planeWidth;e++)for(var t=0;t<this.planeHeight;t++){var i=this.yToIndex(t)+e;this.fowPlane[i]=""}},e.prototype.computeShadingPlane=function(){this.shadingPlane=[],this.computeShading(this.actionPlane),this.computeShading(this.groundPlane)},e.prototype.occludedBy=function(e){return e&&!e.getIsEmptyOrEntity()&&!e.getIsLiquid()},e.prototype.computeShading=function(e){var t,i,n,o;for(n=0;n<this.planeArea();++n){t=n%this.planeWidth,i=Math.floor(n/this.planeWidth);var a=new s(t,i);o=!1;var r=e.getBlockAt(a),l=this.groundPlane.getBlockAt(a);if(r.isEmpty||r.isTransparent||r.getIsLiquid()){var c="AO";"lava"===r.blockType?c="LavaGlow":"water"===r.blockType&&(c="WaterAO"),r!==l&&l.getIsLiquid()||(0===i&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Bottom"}),i===this.planeHeight-1&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Top"}),0===t&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Right"}),t===this.planeWidth-1&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Left"}));var u=e.getSurroundingBlocks(a);t<this.planeWidth-1&&this.occludedBy(u.east)&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Left"}),t>0&&this.occludedBy(u.west)&&(this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Right"}),r.getIsLiquid()||(this.shadingPlane.push({x:t,y:i,atlas:"blockShadows",type:"Shadow_Parts_Fade_base.png"}),i>0&&t>0&&e.getBlockAt(s.north(s.west(a))).getIsEmptyOrEntity()&&this.shadingPlane.push({x:t,y:i,atlas:"blockShadows",type:"Shadow_Parts_Fade_top.png"})),o=!0),i>0&&this.occludedBy(u.north)?this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Bottom"}):i>0&&(t<this.planeWidth-1&&this.occludedBy(u.northEast)&&!this.occludedBy(u.east)&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_BottomLeft"}),!o&&t>0&&this.occludedBy(u.northWest)&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_BottomRight"})),i<this.planeHeight-1&&this.occludedBy(u.south)?this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_Top"}):i<this.planeHeight-1&&(t<this.planeWidth-1&&this.occludedBy(u.southEast)&&!this.occludedBy(u.east)&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_TopLeft"}),!o&&t>0&&this.occludedBy(u.southWest)&&this.shadingPlane.push({x:t,y:i,atlas:c,type:"AOeffect_TopRight"}))}}},e}()},2712:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=i(1271),r=i(799),s=r.North,l=r.South,c=r.East,u=r.West,p=r.opposite,d=r.turnDirection,h=r.turn,f=r.directionToRelative,g=i(838),m=i(2713),v=function(e){switch(e){case s:return"North";case l:return"South";case c:return"East";case u:return"West";default:return""}},y=["","Vertical","Vertical","Vertical","Horizontal","UpRight","DownRight","TRight","Horizontal","UpLeft","DownLeft","TLeft","Horizontal","TUp","TDown","Cross"],_=[[],[s],[l],[s,l],[c],[s,c],[l,c],[l,c],[u],[s,u],[l,u],[l,u],[c,u],[s,c],[l,c],[s,c]],k=[[],[s],[l],[s,l],[c],[c,u],[c,u],[c,u],[u],[c,u],[c,u],[c,u],[c,u],[c,u],[c,u],[c,u]];e.exports=function(){function e(t,i,o,r,s){n(this,e),this._data=[],this.width=i,this.height=o,this.levelModel=r,this.planeType=s,this.playPistonOn=!1,this.playPistonOff=!1;for(var l=0;l<t.length;++l){var c=new a(t[l]);this._data.push(c)}this.isActionPlane()&&(this.redstoneAdjacencySet=this.createRedstoneAdjacencySet())}return e.prototype.inBounds=function(e){return e.x>=0&&e.x<this.width&&e.y>=0&&e.y<this.height},e.prototype.coordinatesToIndex=function(e){return e.y*this.width+e.x},e.prototype.indexToCoordinates=function(e){var t=Math.floor(e/this.width),i=e-t*this.width;return new g(i,t)},e.prototype.getAllPositions=function(){var e=this;return this._data.map(function(t,i){return e.indexToCoordinates(i)})},e.prototype.getBlockAt=function(e){if(e=g.fromArray(e),this.inBounds(e))return this._data[this.coordinatesToIndex(e)]},e.prototype.isActionPlane=function(){return"actionPlane"===this.planeType},e.prototype.isDecorationPlane=function(){return"decorationPlane"===this.planeType},e.prototype.isGroundPlane=function(){return"groundPlane"===this.planeType},e.prototype.setBlockAt=function(e,t){var i=this;if(e=g.fromArray(e),this.inBounds(e)){if(this._data[this.coordinatesToIndex(e)]=t,this.isActionPlane()){t.isRedstone||t.isRedstoneBattery?this.redstoneAdjacencySet.add(e):this.redstoneAdjacencySet.remove(e);var n=[];if(t.needToRefreshRedstone()&&(n=this.refreshRedstone()),this.updateWeakCharge(e,t),t.isEmpty&&[s,l,c,u].forEach(function(t){var n=g.directionToOffsetPosition(t),o=i.getBlockAt(g.add(e,n));o&&o.isRail&&(o.connectionA===p(t)&&(o.connectionA=void 0),o.connectionB===p(t)&&(o.connectionB=void 0))}),this.determineRailType(e,!0),this.levelModel&&this.levelModel.controller.levelView){var o=g.north(g.east(e)),a=g.south(g.west(e)),r=g.getOrthogonalPositions(e).concat([e,o,a]);this.levelModel.controller.levelView.refreshActionGroup(r),this.levelModel.controller.levelView.refreshActionGroup(n)}}else this.isGroundPlane()&&this.levelModel.controller.levelView.refreshGroundGroup();return t}},e.prototype.getOrthogonalBlocks=function(e){return{north:{block:this.getBlockAt(g.north(e)),relative:l},south:{block:this.getBlockAt(g.south(e)),relative:s},east:{block:this.getBlockAt(g.east(e)),relative:u},west:{block:this.getBlockAt(g.west(e)),relative:c}}},e.prototype.getSurroundingBlocks=function(e){return{north:this.getBlockAt(g.north(e)),northEast:this.getBlockAt(g.north(g.east(e))),east:this.getBlockAt(g.east(e)),southEast:this.getBlockAt(g.south(g.east(e))),south:this.getBlockAt(g.south(e)),southWest:this.getBlockAt(g.south(g.west(e))),west:this.getBlockAt(g.west(e)),northWest:this.getBlockAt(g.north(g.west(e)))}},e.prototype.getOrthogonalMask=function(e,t){var i=this.getOrthogonalBlocks(e);return(t(i.north)<<0)+(t(i.south)<<1)+(t(i.east)<<2)+(t(i.west)<<3)},e.prototype.getMinecartTrack=function(e,t){var i=this.getBlockAt(e);if(i.isRail){if(i.connectionA===t||i.connectionB===t)return["",g.forward(e,t),t,300];var n=p(t);if(i.connectionA===n&&void 0!==i.connectionB){var o=d(t,i.connectionB);return["turn_"+o,e,h(t,o),300]}if(i.connectionB===n&&void 0!==i.connectionA){var a=d(t,i.connectionA);return["turn_"+a,e,h(t,a),300]}}},e.prototype.getPoweredRailsConnected=function(e,t){if(!g.isAdjacent(e,t))return!1;var i=this.getBlockAt(e),n=this.getBlockAt(t);return!(!i.getIsPowerableRail()||!n.getIsPowerableRail())&&(i.getIsHorizontal()&&n.getIsHorizontal()?g.equals(g.forward(e,c),t)||g.equals(g.forward(e,u),t):!(!i.getIsVertical()||!n.getIsVertical())&&(g.equals(g.forward(e,s),t)||g.equals(g.forward(e,l),t)))},e.prototype.powerRedstone=function(){var e=this;return this.redstoneAdjacencySet.sets.forEach(function(t){var i=t.some(function(t){return e.getBlockAt(t).isRedstoneBattery});t.forEach(function(t){e.getBlockAt(t).isPowered=i,e.determineRedstoneSprite(t)})}),this.redstoneAdjacencySet.flattenSets()},e.prototype.createRedstoneAdjacencySet=function(){var e=this,t=this.getAllPositions().filter(function(t){var i=e.getBlockAt(t);return i.isRedstone||i.isRedstoneBattery});return new m(t)},e.prototype.powerRails=function(){var e=this,t=this.getAllPositions().filter(function(t){return e.getBlockAt(t).getIsPowerableRail()});return t.forEach(function(t){e.determineRailType(t)}),new m(t,this.getPoweredRailsConnected.bind(this)).sets.forEach(function(t){t.some(function(t){return e.getBlockAt(t).isPowered})&&t.forEach(function(t){e.getBlockAt(t).isPowered=!0})}),t.forEach(function(t){e.determineRailType(t)}),t},e.prototype.determineRailType=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getBlockAt(e);if(n&&n.isRail){var a="",r=_;if(n.getIsPowerableRail()&&(a=n.isPowered?"Powered":"Unpowered",r=k),void 0===n.connectionA||void 0===n.connectionB){var s=this.getOrthogonalMask(e,function(e){var t=e.block,i=e.relative;if(!t||!t.isRail)return!1;var n=void 0===t.connectionA||t.connectionA===i,o=void 0===t.connectionB||t.connectionB===i;return n||o}),l=o(r[s],2);n.connectionA=l[0],n.connectionB=l[1]}var c=v(n.connectionA)+v(n.connectionB);n.blockType="rails"+a+c,i&&g.getOrthogonalPositions(e).forEach(function(e){t.determineRailType(e)})}},e.prototype.determineRedstoneSprite=function(e){var t=this.getBlockAt(e);if(t&&t.isRedstone){var i=this.getOrthogonalMask(e,function(e){var t=e.block;return t&&(t.isRedstone||t.isConnectedToRedstone)}),n=y[i],o=t.isPowered?"On":"";return t.blockType="redstoneWire"+n+o,"redstoneWire"+n}},e.prototype.refreshRedstone=function(){var e=this,t=this.powerRedstone();this.powerAllBlocks();var i=this.powerRails(),n=t.concat(i);return this.getAllPositions().forEach(function(t){e.getIronDoors(t),e.getPistonState(t)}),this.playPistonSound(),n},e.prototype.playPistonSound=function(){this.levelModel&&(this.playPistonOn?this.levelModel.controller.audioPlayer.play("pistonOut"):this.playPistonOff&&this.levelModel.controller.audioPlayer.play("pistonIn"),this.playPistonOn=!1,this.playPistonOff=!1)},e.prototype.checkEntityConflict=function(e){var t=this;if(this.levelModel){var i=!1;return this.levelModel.controller.levelEntity.entityMap.forEach(function(n){t.levelModel.controller.positionEquivalence(e,n.position)&&(i=!0)}),i}},e.prototype.getIronDoors=function(e){e=g.fromArray(e);var t=this.getBlockAt(e),i=this.coordinatesToIndex(e);"doorIron"===t.blockType&&(t.isPowered=this.powerCheck(e,!0),t.isPowered&&!t.isOpen?(t.isOpen=!0,this.levelModel&&this.levelModel.controller.levelView.animateDoor(i,!0)):!t.isPowered&&t.isOpen&&this.levelModel&&(this.checkEntityConflict(e)||(t.isOpen=!1,this.levelModel.controller.levelView.animateDoor(i,!1))))},e.prototype.getPistonState=function(e){var t=this.getBlockAt(e);t.getIsPiston()&&!t.getIsPistonArm()&&(t.isPowered=this.powerCheck(e,!0),t.isPowered?this.activatePiston(e):t.isPowered||this.deactivatePiston(e),this.levelModel&&(this.levelModel.controller.updateFowPlane(),this.levelModel.controller.updateShadingPlane()))},e.prototype.findDoorToAnimate=function(e){var t=this;this.getAllPositions().forEach(function(i){var n=t.getBlockAt(i),o=t.coordinatesToIndex(i);"doorIron"===n.blockType&&i!==e&&(n.isPowered=t.powerCheck(i,!0),n.isPowered&&!n.isOpen?(n.isOpen=!0,t.levelModel&&t.levelModel.controller.levelView.animateDoor(o,!0)):n.isPowered||!n.isOpen||t.checkEntityConflict(i)||(n.isOpen=!1,t.levelModel&&t.levelModel.controller.levelView.animateDoor(o,!1)))})},e.prototype.activatePiston=function(e){var t=this.getBlockAt(e),i=t.blockType;t.getIsStickyPiston()&&(i=i.substring(0,i.length-6)),"On"===i.substring(i.length-2,i.length)&&(i=i.substring(0,i.length-2));var n=t.getPistonDirection(),o="pistonArm"+f(n),r=g.directionToOffsetPosition(n),s=g.forward(e,n),l=this.getBlockAt(s);if(!this.pistonArmBlocked(e,r))if(l.isDestroyableUponPush())this.setBlockAt(s,new a("")),this.playPistonOn=!0,this.levelModel&&this.levelModel.controller.levelView.playExplosionAnimation(s,2,s,l.blockType,null,null,this.player);else if(""===l.blockType||l.getIsPistonArm()){if(""===l.blockType){var c="On";t.getIsStickyPiston()&&(c+="Sticky",o+="Sticky");var u=new a(o),p=new a(i+=c);this.setBlockAt(s,u),this.setBlockAt(e,p),this.playPistonOn=!0}}else{var d=this.getBlocksToPush(s,r),h="On";t.getIsStickyPiston()&&(h+="Sticky");var m=new a(i+=h);this.setBlockAt(e,m),this.pushBlocks(d,r),this.playPistonOn=!0}},e.prototype.pistonArmBlocked=function(e,t){var i=g.add(e,t);return this.checkEntityConflict(i)},e.prototype.deactivatePiston=function(e){var t=this.getBlockAt(e);if(t.getIsPiston()&&t.blockType.match("On")){var i=t.getPistonDirection();void 0!==i&&this.retractArm(g.forward(e,i),e)}},e.prototype.retractArm=function(e,t){var i=new a(""),n=this.getBlockAt(t),o="",r="";this.getBlockAt(t).getIsStickyPiston()?(o="Sticky",r=n.blockType.substring(0,n.blockType.length-8)):r=n.blockType.substring(0,n.blockType.length-2);var s=r+o,l=new a(s);if(this.getBlockAt(e).getIsPistonArm())if(this.getBlockAt(t).getIsStickyPiston()){var c=g.directionToOffsetPosition(n.getPistonDirection()),u=g.add(e,c);this.inBounds(u)&&this.getBlockAt(u).isStickable?(this.setBlockAt(e,this.getBlockAt(u)),this.setBlockAt(u,i)):(this.setBlockAt(e,i),this.playPistonOff=!0)}else this.setBlockAt(e,i),this.playPistonOff=!0;this.setBlockAt(t,l)},e.prototype.pushBlocks=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i="",n=!1;1===t[0]?i="pistonArmRight":-1===t[0]?i="pistonArmLeft":1===t[1]?i="pistonArmDown":-1===t[1]&&(i="pistonArmUp");for(var o=new a(i),r=e.length-1;r>=0;--r){var s=g.add(e[r],g.fromArray(t)),l=this.getBlockAt(e[r]);this.inBounds(s)&&this.getBlockAt(s).isDestroyableUponPush()&&(this.levelModel&&this.levelModel.controller.levelView.playExplosionAnimation(s,2,s,l.blockType,null,null,this.player),n=!0),this.setBlockAt(s,this.getBlockAt(e[r])),0===r&&this.setBlockAt(e[r],o)}n&&this.refreshRedstone()},e.prototype.getBlocksToPush=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i=[],n=e;this.inBounds(n)&&this.getBlockAt(n).getIsPushable();)i.push(n),n=g.add(n,g.fromArray(t));return i},e.prototype.powerCheck=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g.getOrthogonalPositions(e).some(function(n){var o=t.getBlockAt(n);if(o){if(!o.isWeaklyPowerable)return!1;if(t.getBlockAt(e).getIsPiston()){var a=t.getBlockAt(e),r=g.directionToOffsetPosition(a.getPistonDirection())||new g(0,0),s=g.add(e,r);if(g.equals(n,s))return!1}return i?o.isPowered||o.isRedstoneBattery:o.isRedstone&&o.isPowered||o.isRedstoneBattery}})},e.prototype.powerAllBlocks=function(){var e=this;this.getAllPositions().forEach(function(t){var i=e.getBlockAt(t);""!==i.blockType&&i.canHoldCharge()&&(i.isPowered=e.powerCheck(t))})},e.prototype.updateWeakCharge=function(e,t){var i=this;t.isWeaklyPowerable&&(t.isPowered=this.powerCheck(e)),t.isPowered&&g.getOrthogonalPositions(e).forEach(function(e){i.inBounds(e)&&(i.getIronDoors(e),i.getPistonState(e))})},e}()},2713:function(e,t,i){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=i(838);e.exports=function(){function e(t,i){var n=this;o(this,e),this.comparisonFunction=i||a.isAdjacent,this.sets=[],t&&t.forEach(function(e){n.add(e)})}return e.prototype.flattenSets=function(){return this.sets.reduce(function(e,t){return e.concat(t)},[])},e.prototype.add=function(e){var t=this;if(this.find(e))return!1;var i=this.sets.filter(function(i){return i.some(function(i){return t.comparisonFunction(e,i)})});return 1===i.length?i[0].push(e):i.length>1?function(){var o=[];i.forEach(function(e){t.sets.splice(t.sets.indexOf(e),1),o.push.apply(o,n(e))}),o.push(e),t.sets.push(o)}():this.sets.push([e]),!0},e.prototype.find=function(e){return this.sets.find(function(t){return t.some(function(t){return a.equals(e,t)})})},e.prototype.remove=function(t){var i=this.find(t);if(!i)return!1;this.sets.splice(this.sets.indexOf(i),1);var o=i.filter(function(e){return!a.equals(t,e)});if(o.length){var r,s=new e(o,this.comparisonFunction).sets;(r=this.sets).push.apply(r,n(s))}return!0},e}()},2714:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=i(794),l=i(1016),c=i(838);e.exports=function(e){function t(i,a,r,s,l,c,u){n(this,t);var p=o(this,e.call(this,i,a,"Player",r,s,u));return p.offset=[-18,-32],p.name=l,p.isOnBlock=c,p.inventory={},p.movementState=-1,p.onTracks=!1,p.getOffTrack=!1,i.getIsDirectPlayerControl()?(p.moveDelayMin=0,p.moveDelayMax=0):(p.moveDelayMin=30,p.moveDelayMax=200),p}return a(t,e),t.prototype.canPlaceBlockOver=function(e,t){var i={canPlace:!1,plane:""};return t.getIsLiquid()?(i.canPlace=!0,i.plane="groundPlane"):(i.canPlace=!0,i.plane="actionPlane"),"cropWheat"===e.blockType&&(i.canPlace="farmlandWet"===t.blockType),i},t.prototype.canPlaceBlock=function(e){return e.isEmpty},t.prototype.shouldUpdateSelectionIndicator=function(){return!0},t.prototype.setMovePosition=function(t){e.prototype.setMovePosition.call(this,t),this.collectItems(this.position)},t.prototype.walkableCheck=function(e){this.isOnBlock=!e.isWalkable},t.prototype.updateMovement=function(){var e=this;this.controller.attemptRunning&&this.controller.getIsDirectPlayerControl()&&(this.onTracks&&this.collectItems(this.position),this.canUpdateMovement()&&(this.movementState>=0?function(){var t=e.movementState,i=new l(e,function(){},function(){e.lastMovement=+new Date,e.controller.moveDirection(i,t)},e.identifier);e.addCommand(i)}():function(){var t=new l(e,function(){},function(){e.lastMovement=+new Date,e.controller.use(t)},e.identifier);e.addCommand(t)}()))},t.prototype.canUpdateMovement=function(){var e=this.queue.isFinished()||!this.queue.isStarted(),t=-1!==this.movementState,i=this.queue.currentCommand&&0===this.queue.getLength(),n=+new Date-this.lastMovement,o=n>300;return t&&n>800&&(this.getOffTrack=!0),!this.onTracks&&(e||i&&o)&&t},t.prototype.doMoveForward=function(e){var t,i,n=this,o=this,a=this.controller.levelModel,r=this.controller.levelView,s=o.isOnBlock,l=this.position;a.moveForward(),i=s&&s!==o.isOnBlock,t=o.isOnBlock||i?a.actionPlane.getBlockAt(o.position).blockType:a.groundPlane.getBlockAt(o.position).blockType,r.playMoveForwardAnimation(o,l,o.facing,i,o.isOnBlock,t,function(){r.playIdleAnimation(o.position,o.facing,o.isOnBlock),a.isPlayerStandingInWater()?r.playDrownFailureAnimation(o.position,o.facing,o.isOnBlock,function(){n.controller.handleEndState(!1)}):a.isPlayerStandingInLava()?r.playBurnInLavaAnimation(o.position,o.facing,o.isOnBlock,function(){n.controller.handleEndState(!1)}):n.controller.delayPlayerMoveBy(n.moveDelayMin,n.moveDelayMax,function(){e.succeeded()})}),this.updateHidingTree(),this.updateHidingBlock(l)},t.prototype.doMoveBackward=function(e){var t,i,n=this,o=this,a=this.controller.levelModel,r=this.controller.levelView,s=o.isOnBlock,l=this.position;a.moveBackward(this),i=s&&s!==o.isOnBlock,t=(o.isOnBlock,a.actionPlane.getBlockAt(o.position).blockType),r.playMoveBackwardAnimation(o,l,o.facing,i,o.isOnBlock,t,function(){r.playIdleAnimation(o.position,o.facing,o.isOnBlock,o),a.isPlayerStandingInWater()?r.playDrownFailureAnimation(o.position,o.facing,o.isOnBlock,function(){n.controller.handleEndState(!1)}):a.isPlayerStandingInLava()?r.playBurnInLavaAnimation(o.position,o.facing,o.isOnBlock,function(){n.controller.handleEndState(!1)}):n.controller.delayPlayerMoveBy(n.moveDelayMin,n.moveDelayMax,function(){e.succeeded()})}),this.updateHidingTree(),this.updateHidingBlock(l)},t.prototype.bump=function(e){var t=this,i=this.controller.levelView,n=this.controller.levelModel;i.playBumpAnimation(this.position,this.facing,!1);var o=this.controller.levelEntity.getEntityAt(n.getMoveForwardPosition(this));if(null!==o){if(this.controller.levelEntity.isFriendlyEntity(o.type)){var a;!function(){var e=t.facing;a=new l(t,function(){},function(){o.pushBack(a,e,250)},o.identifier),o.queue.startPushHighPriorityCommands(),o.addCommand(a),o.queue.endPushHighPriorityCommands()}()}}this.controller.delayPlayerMoveBy(200,400,function(){e.succeeded()})},t.prototype.collectItems=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.position,t=this.controller.levelView.collectibleItems,i=0;i<t.length;i++){var n=r(t[i],4),o=n[0],a=n[1],s=n[2],l=n[3];if(null===o)t.splice(i,1);else{var u=this.controller.levelModel.spritePositionToIndex(a,new c(o.x,o.y));c.absoluteDistanceSquare(e,u)<l&&(this.controller.levelView.playItemAcquireAnimation(this.position,this.facing,o,function(){},s),t.splice(i,1))}}},t.prototype.takeDamage=function(e){var t=this,i=this.controller.levelView.getDirectionName(this.facing);this.healthPoint--,this.healthPoint>0?(this.controller.levelView.playScaledSpeed(this.sprite.animations,"hurt"+i),e.succeeded()):(this.sprite.animations.stop(null,!0),this.controller.levelView.playFailureAnimation(this.position,this.facing,this.isOnBlock,function(){e.failed(),t.controller.handleEndState(!1)}))},t.prototype.canTriggerPressurePlates=function(){return!0},t}(s)},2715:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794),s=i(1016);e.exports=function(e){function t(i,a,r,s,l,c,u){n(this,t);var p=o(this,e.call(this,i,a,"PlayerAgent",r,s,u));return p.offset=[-16,-15],p.name=l,p.isOnBlock=c,p.inventory={},p.movementState=-1,p.moveDelayMin=20,p.moveDelayMax=150,p}return a(t,e),t.prototype.canPlaceBlockOver=function(e,t){var i={canPlace:!1,plane:""};return t.getIsLiquid()?e.getIsPlaceableInLiquid()&&(i.canPlace=!0,i.plane="groundPlane"):e.isWalkable&&(i.canPlace=!0,i.plane="actionPlane"),i},t.prototype.canPlaceBlock=function(e){return e.isEmpty},t.prototype.canMoveThrough=function(){return!0},t.prototype.getSortOrderOffset=function(){return e.prototype.getSortOrderOffset.call(this)-1},t.prototype.updateMovement=function(){var e=this;if(this.controller.attemptRunning&&this.controller.getIsDirectPlayerControl()){var t=this.queue.isFinished()||!this.queue.isStarted(),i=-1!==this.movementState,n=this.queue.currentCommand&&0===this.queue.getLength(),o=+new Date-this.lastMovement,a=o>300;(t||n&&a)&&i&&(this.movementState>=0?function(){var t=e.movementState,i=new s(e,function(){},function(){e.lastMovement=+new Date,e.controller.moveDirection(i,t)},e.identifier);e.addCommand(i)}():function(){var t=new s(e,function(){},function(){e.lastMovement=+new Date,e.controller.use(t)},e.identifier);e.addCommand(t)}())}},t.prototype.doMove=function(e,t){var i=this,n=void 0,o=this.controller.levelModel,a=this.controller.levelView,r=this.isOnBlock,s=this.position;o["move"+t](this);var l=r&&r!==this.isOnBlock;n=this.isOnBlock||l?o.actionPlane.getBlockAt(this.position).blockType:o.groundPlane.getBlockAt(this.position).blockType,a["playMove"+t+"Animation"](this,s,this.facing,l,this.isOnBlock,n,function(){a.playIdleAnimation(i.position,i.facing,i.isOnBlock,i),i.controller.delayPlayerMoveBy(i.moveDelayMin,i.moveDelayMax,function(){e.succeeded()})}),this.updateHidingTree(),this.updateHidingBlock(s)},t.prototype.doMoveForward=function(e){this.doMove(e,"Forward")},t.prototype.doMoveBackward=function(e){this.doMove(e,"Backward")},t.prototype.bump=function(e){var t=this,i=this.controller.levelView,n=this.controller.levelModel;i.playBumpAnimation(this.position,this.facing,!1,this);var o=this.controller.levelEntity.getEntityAt(n.getMoveForwardPosition(this));if(null!==o){if(this.controller.levelEntity.isFriendlyEntity(o.type)){var a;!function(){var e=t.facing;a=new s(t,function(){},function(){o.pushBack(a,e,250)},o.identifier),o.queue.startPushHighPriorityCommands(),o.addCommand(a),o.queue.endPushHighPriorityCommands()}()}}this.controller.delayPlayerMoveBy(200,400,function(){e.succeeded()})},t.prototype.takeDamage=function(e){var t=this,i=this.controller.levelView.getDirectionName(this.facing);this.healthPoint--,this.healthPoint>0?(this.controller.levelView.playScaledSpeed(this.sprite.animations,"hurt"+i),e.succeeded()):(this.sprite.animations.stop(null,!0),this.controller.levelView.playFailureAnimation(this.position,this.facing,this.isOnBlock,function(){e.failed(),t.controller.handleEndState(!1)}))},t.prototype.hasPermissionToWalk=function(e){return e.isWalkable},t.prototype.canTriggerPressurePlates=function(){return!0},t}(r)},2716:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=i(1271),r=i(799),s=i(838),l=i(2717).createEvent,c=i(1272).randomInt;e.exports=function(){function e(t){n(this,e),this.controller=t,this.audioPlayer=t.audioPlayer,this.game=t.game,this.baseShading=null,this.player=null,this.agent=null,this.selectionIndicator=null,this.groundGroup=null,this.shadingGroup=null,this.actionGroup=null,this.fluffGroup=null,this.fowGroup=null,this.collectibleItems=[],this.trees=[],this.miniBlocks={dirt:["Miniblocks",0,5],dirtCoarse:["Miniblocks",6,11],sand:["Miniblocks",12,17],gravel:["Miniblocks",18,23],bricks:["Miniblocks",24,29],logAcacia:["Miniblocks",30,35],logBirch:["Miniblocks",36,41],logJungle:["Miniblocks",42,47],logOak:["Miniblocks",48,53],logSpruce:["Miniblocks",54,59],logSpruceSnowy:["Miniblocks",54,59],planksAcacia:["Miniblocks",60,65],planksBirch:["Miniblocks",66,71],planksJungle:["Miniblocks",72,77],planksOak:["Miniblocks",78,83],planksSpruce:["Miniblocks",84,89],cobblestone:["Miniblocks",90,95],sandstone:["Miniblocks",96,101],wool:["Miniblocks",102,107],redstoneDust:["Miniblocks",108,113],lapisLazuli:["Miniblocks",114,119],ingotIron:["Miniblocks",120,125],ingotGold:["Miniblocks",126,131],emerald:["Miniblocks",132,137],diamond:["Miniblocks",138,143],coal:["Miniblocks",144,149],bucketWater:["Miniblocks",150,155],bucketLava:["Miniblocks",156,161],gunPowder:["Miniblocks",162,167],wheat:["Miniblocks",168,173],potato:["Miniblocks",174,179],carrots:["Miniblocks",180,185],milk:["Miniblocks",186,191],egg:["Miniblocks",192,197],poppy:["Miniblocks",198,203],daisy:["Miniblocks",204,209],dandelion:["Miniblocks",210,215],bed:["Miniblocks",216,221],cactus:["Miniblocks",222,227],clay:["Miniblocks",228,233],deadbush:["Miniblocks",234,239],doorIron:["Miniblocks",240,245],doorOak:["Miniblocks",246,251],glowstoneDust:["Miniblocks",252,257],hardenedClay:["Miniblocks",258,263],hardenedClayBlack:["Miniblocks",264,269],hardenedClayBlue:["Miniblocks",270,275],hardenedClayBrown:["Miniblocks",276,281],hardenedClayCyan:["Miniblocks",282,287],hardenedClayGray:["Miniblocks",288,293],hardenedClayGreen:["Miniblocks",294,299],hardenedClayLightBlue:["Miniblocks",300,305],hardenedClayLime:["Miniblocks",306,311],hardenedClayMagenta:["Miniblocks",312,317],hardenedClayOrange:["Miniblocks",318,323],hardenedClayPink:["Miniblocks",324,329],hardenedClayPurple:["Miniblocks",330,335],hardenedClayRed:["Miniblocks",336,341],hardenedClaySilver:["Miniblocks",342,347],hardenedClayWhite:["Miniblocks",348,353],hardenedClayYellow:["Miniblocks",354,359],netherbrick:["Miniblocks",360,365],netherrack:["Miniblocks",366,371],obsidian:["Miniblocks",372,377],piston:["Miniblocks",378,383],pressurePlateOak:["Miniblocks",384,389],netherQuartz:["Miniblocks",390,395],railGolden:["Miniblocks",396,401],railNormal:["Miniblocks",402,407],redstoneTorch:["Miniblocks",408,413],reeds:["Miniblocks",414,419],seedsWheat:["Miniblocks",420,425],snow:["Miniblocks",426,431],snowBall:["Miniblocks",432,437],woolBlack:["Miniblocks",438,443],woolBlue:["Miniblocks",444,449],woolBrown:["Miniblocks",450,455],woolCyan:["Miniblocks",456,461],woolGray:["Miniblocks",462,467],woolGreen:["Miniblocks",468,473],woolLightBlue:["Miniblocks",474,479],woolLime:["Miniblocks",480,485],woolMagenta:["Miniblocks",486,491],woolOrange:["Miniblocks",492,497],woolPink:["Miniblocks",498,503],woolLPurple:["Miniblocks",504,509],woolRed:["Miniblocks",510,515],woolSilver:["Miniblocks",516,521],woolYellow:["Miniblocks",522,527],bookEnchanted:["Miniblocks",528,533],bucketEmpty:["Miniblocks",534,539],chest:["Miniblocks",540,545],compass:["Miniblocks",546,551],axeDiamond:["Miniblocks",552,557],pickaxeDiamond:["Miniblocks",558,563],shovelDiamond:["Miniblocks",564,569],flintAndSteel:["Miniblocks",570,575],flint:["Miniblocks",576,581],mapEmpty:["Miniblocks",582,587],minecart:["Miniblocks",588,593],potionBottleDrinkable:["Miniblocks",594,599]},this.blocks={bedrock:["blocks","Bedrock",-13,0],bricks:["blocks","Bricks",-13,0],oreCoal:["blocks","Coal_Ore",-13,0],dirtCoarse:["blocks","Coarse_Dirt",-13,0],cobblestone:["blocks","Cobblestone",-13,0],oreDiamond:["blocks","Diamond_Ore",-13,0],dirt:["blocks","Dirt",-13,0],oreEmerald:["blocks","Emerald_Ore",-13,0],farmlandWet:["blocks","Farmland_Wet",-13,0],flowerDandelion:["blocks","Flower_Dandelion",-13,0],flowerOxeeye:["blocks","Flower_Oxeeye",-13,0],flowerRose:["blocks","Flower_Rose",-13,0],glass:["blocks","Glass",-13,0],oreGold:["blocks","Gold_Ore",-13,0],grass:["blocks","Grass",-13,0],gravel:["blocks","Gravel",-13,0],oreIron:["blocks","Iron_Ore",-13,0],oreLapis:["blocks","Lapis_Ore",-13,0],lava:["blocks","Lava_0",-13,0],logAcacia:["blocks","Log_Acacia",-13,0],logBirch:["blocks","Log_Birch",-13,0],logJungle:["blocks","Log_Jungle",-13,0],logOak:["blocks","Log_Oak",-13,0],logSpruce:["blocks","Log_Spruce",-13,0],logSpruceSnowy:["blocks","Log_Spruce",-13,0],obsidian:["blocks","Obsidian",-13,0],planksAcacia:["blocks","Planks_Acacia",-13,0],planksBirch:["blocks","Planks_Birch",-13,0],planksJungle:["blocks","Planks_Jungle",-13,0],planksOak:["blocks","Planks_Oak",-13,0],planksSpruce:["blocks","Planks_Spruce",-13,0],oreRedstone:["blocks","Redstone_Ore",-13,0],sand:["blocks","Sand",-13,0],sandstone:["blocks","Sandstone",-13,0],stone:["blocks","Stone",-13,0],tnt:["tnt","TNTexplosion0",-80,-58],water:["blocks","Water_0",-13,0],wool:["blocks","Wool_White",-13,0],wool_orange:["blocks","Wool_Orange",-13,0],wool_black:["blocks","Wool_Black",-13,0],wool_blue:["blocks","Wool_Blue",-13,0],wool_brown:["blocks","Wool_Brown",-13,0],wool_cyan:["blocks","Wool_Cyan",-13,0],wool_gray:["blocks","Wool_Gray",-13,0],wool_green:["blocks","Wool_Green",-13,0],wool_light_blue:["blocks","Wool_LightBlue",-13,0],wool_lime:["blocks","Wool_Lime",-13,0],wool_magenta:["blocks","Wool_Magenta",-13,0],wool_pink:["blocks","Wool_Pink",-13,0],wool_purple:["blocks","Wool_Purple",-13,0],wool_red:["blocks","Wool_Red",-13,0],wool_silver:["blocks","Wool_Silver",-13,0],wool_yellow:["blocks","Wool_Yellow",-13,0],leavesAcacia:["leavesAcacia","Leaves_Acacia0.png",-100,0],leavesBirch:["leavesBirch","Leaves_Birch0.png",-100,0],leavesJungle:["leavesJungle","Leaves_Jungle0.png",-100,0],leavesOak:["leavesOak","Leaves_Oak0.png",-100,0],leavesSpruce:["leavesSpruce","Leaves_Spruce0.png",-100,0],leavesSpruceSnowy:["leavesSpruceSnowy","Leaves_SpruceSnowy0.png",-100,36],watering:["blocks","Water_0",-13,0],cropWheat:["blocks","Wheat0",-13,0],torch:["torch","Torch0",-13,0],tallGrass:["tallGrass","",-13,0],lavaPop:["lavaPop","LavaPop01",-13,0],redstoneSparkle:["redstoneSparkle","redstone_sparkle1.png",7,23],fire:["fire","",-11,135],bubbles:["bubbles","",-11,135],explosion:["explosion","",-70,60],door:["door","",-12,-15],doorIron:["doorIron","",-12,-15],rails:["blocks","Rails_Vertical",-13,-0],railsNorthEast:["blocks","Rails_BottomLeft",-13,0],railsNorthWest:["blocks","Rails_BottomRight",-13,0],railsEast:["blocks","Rails_Horizontal",-13,0],railsWest:["blocks","Rails_Horizontal",-13,0],railsEastWest:["blocks","Rails_Horizontal",-13,0],railsSouthEast:["blocks","Rails_TopLeft",-13,0],railsSouthWest:["blocks","Rails_TopRight",-13,0],railsNorth:["blocks","Rails_Vertical",-13,-0],railsSouth:["blocks","Rails_Vertical",-13,-0],railsNorthSouth:["blocks","Rails_Vertical",-13,-0],railsUnpowered:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredNorth:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredSouth:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredNorthSouth:["blocks","Rails_UnpoweredVertical",-13,0],railsUnpoweredEast:["blocks","Rails_UnpoweredHorizontal",-13,0],railsUnpoweredWest:["blocks","Rails_UnpoweredHorizontal",-13,0],railsUnpoweredEastWest:["blocks","Rails_UnpoweredHorizontal",-13,0],railsPowered:["blocks","Rails_PoweredVertical",-13,0],railsPoweredNorth:["blocks","Rails_PoweredVertical",-13,0],railsPoweredSouth:["blocks","Rails_PoweredVertical",-13,0],railsPoweredNorthSouth:["blocks","Rails_PoweredVertical",-13,0],railsPoweredEast:["blocks","Rails_PoweredHorizontal",-13,0],railsPoweredWest:["blocks","Rails_PoweredHorizontal",-13,0],railsPoweredEastWest:["blocks","Rails_PoweredHorizontal",-13,0],railsRedstoneTorch:["blocks","Rails_RedstoneTorch",-12,9],redstoneWire:["blocks","redstone_dust_dot_off",-13,0],redstoneWireHorizontal:["blocks","redstone_dust_line_h_off",-13,0],redstoneWireVertical:["blocks","redstone_dust_line_v_off",-13,0],redstoneWireUpRight:["blocks","redstone_dust_corner_BottomLeft_off",-13,0],redstoneWireUpLeft:["blocks","redstone_dust_corner_BottomRight_off",-13,0],redstoneWireDownRight:["blocks","redstone_dust_corner_TopLeft_off",-13,0],redstoneWireDownLeft:["blocks","redstone_dust_corner_TopRight_off",-13,0],redstoneWireTUp:["blocks","redstone_dust_cross_up_off",-13,0],redstoneWireTDown:["blocks","redstone_dust_cross_down_off",-13,0],redstoneWireTLeft:["blocks","redstone_dust_cross_left_off",-13,0],redstoneWireTRight:["blocks","redstone_dust_cross_right_off",-13,0],redstoneWireCross:["blocks","redstone_dust_cross_off",-13,0],redstoneWireOn:["blocks","redstone_dust_dot",-13,0],redstoneWireHorizontalOn:["blocks","redstone_dust_line_h",-13,0],redstoneWireVerticalOn:["blocks","redstone_dust_line_v",-13,0],redstoneWireUpRightOn:["blocks","redstone_dust_corner_BottomLeft",-13,0],redstoneWireUpLeftOn:["blocks","redstone_dust_corner_BottomRight",-13,0],redstoneWireDownRightOn:["blocks","redstone_dust_corner_TopLeft",-13,0],redstoneWireDownLeftOn:["blocks","redstone_dust_corner_TopRight",-13,0],redstoneWireTUpOn:["blocks","redstone_dust_cross_up",-13,0],redstoneWireTDownOn:["blocks","redstone_dust_cross_down",-13,0],redstoneWireTLeftOn:["blocks","redstone_dust_cross_left",-13,0],redstoneWireTRightOn:["blocks","redstone_dust_cross_right",-13,0],redstoneWireCrossOn:["blocks","redstone_dust_cross",-13,0],pressurePlateUp:["blocks","PressurePlate_Up",-13,0],pressurePlateDown:["blocks","PressurePlate_Down",-13,0],pistonUp:["blocks","piston_up",-13,0],pistonDown:["blocks","piston_down",-13,0],pistonLeft:["blocks","piston_left",-13,0],pistonRight:["blocks","piston_right",-13,0],pistonUpOn:["blocks","piston_base_up",-26,-13],pistonDownOn:["blocks","piston_base_down",-26,-13],pistonLeftOn:["blocks","piston_base_left",-26,-13],pistonRightOn:["blocks","piston_base_right",-26,-13],pistonArmLeft:["blocks","piston_arm_left",-26,-13],pistonArmRight:["blocks","piston_arm_right",-26,-13],pistonArmUp:["blocks","piston_arm_up",-26,-13],pistonArmDown:["blocks","piston_arm_down",-26,-13],pistonUpSticky:["blocks","piston_up",-13,0],pistonDownSticky:["blocks","piston_down_sticky",-13,0],pistonLeftSticky:["blocks","piston_left",-13,0],pistonRightSticky:["blocks","piston_right",-13,0],pistonUpOnSticky:["blocks","piston_base_up",-26,-13],pistonDownOnSticky:["blocks","piston_base_down_sticky",-26,-13],pistonLeftOnSticky:["blocks","piston_base_left",-26,-13],pistonRightOnSticky:["blocks","piston_base_right",-26,-13],pistonArmLeftSticky:["blocks","piston_arm_left",-26,-13],pistonArmRightSticky:["blocks","piston_arm_right",-26,-13],pistonArmUpSticky:["blocks","piston_arm_up",-26,-13],pistonArmDownSticky:["blocks","piston_arm_down_sticky",-26,-13],cactus:["blocks","cactus",-13,0],deadBush:["blocks","dead_bush",-13,0],glowstone:["blocks","glowstone",-13,0],grassPath:["blocks","grass_path",-13,0],ice:["blocks","ice",-13,0],netherrack:["blocks","netherrack",-13,0],netherBrick:["blocks","nether_brick",-13,0],quartzOre:["blocks","quartz_ore",-13,0],snow:["blocks","snow",-13,0],snowyGrass:["blocks","snowy_grass",-13,0],topSnow:["blocks","top_snow",-13,0],Nether_Portal:["blocks","Nether_Portal0",0,-58],bedFoot:["blocks","Bed_Foot",-13,0],bedHead:["blocks","Bed_Head",-13,10],clay:["blocks","Clay",-13,0],glassBlack:["blocks","Glass_Black",-13,0],glassBlue:["blocks","Glass_Blue",-13,0],glassBrown:["blocks","Glass_Brown",-13,0],glassCyan:["blocks","Glass_Cyan",-13,0],glassGray:["blocks","Glass_Gray",-13,0],glassGreen:["blocks","Glass_Green",-13,0],glassLightBlue:["blocks","Glass_LightBlue",-13,0],glassLime:["blocks","Glass_Lime",-13,0],glassMagenta:["blocks","Glass_Magenta",-13,0],glassOrange:["blocks","Glass_Orange",-13,0],glassPink:["blocks","Glass_Pink",-13,0],glassPurple:["blocks","Glass_Purple",-13,0],glassRed:["blocks","Glass_Red",-13,0],glassSilver:["blocks","Glass_Silver",-13,0],glassWhite:["blocks","Glass_White",-13,0],glassYellow:["blocks","Glass_Yellow",-13,0],terracotta:["blocks","Terracotta",-13,0],terracottaBlack:["blocks","Terracotta_Black",-13,0],terracottaBlue:["blocks","Terracotta_Blue",-13,0],terracottaBrown:["blocks","Terracotta_Brown",-13,0],terracottaCyan:["blocks","Terracotta_Cyan",-13,0],terracottaGray:["blocks","Terracotta_Gray",-13,0],terracottaGreen:["blocks","Terracotta_Green",-13,0],terracottaLightBlue:["blocks","Terracotta_LightBlue",-13,0],terracottaLime:["blocks","Terracotta_Lime",-13,0],terracottaMagenta:["blocks","Terracotta_Magenta",-13,0],terracottaOrange:["blocks","Terracotta_Orange",-13,0],terracottaPink:["blocks","Terracotta_Pink",-13,0],terracottaPurple:["blocks","Terracotta_Purple",-13,0],terracottaRed:["blocks","Terracotta_Red",-13,0],terracottaSilver:["blocks","Terracotta_Silver",-13,0],terracottaWhite:["blocks","Terracotta_White",-13,0],terracottaYellow:["blocks","Terracotta_Yellow",-13,0],invisible:["blocks","Invisible",0,0]},this.actionPlaneBlocks=[],this.toDestroy=[],this.resettableTweens=[],this.treeFluffTypes={treeAcacia:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2]],treeBirch:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3]],treeJungle:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3],[1,-3]],treeOak:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[0,-3]],treeSpruce:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3]],treeSpruceSnowy:[[0,0],[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,-2],[0,-2],[1,-2],[0,-3]]}}return e.prototype.yToIndex=function(e){return this.controller.levelModel.yToIndex(e)},e.prototype.create=function(e){this.createGroups(),this.reset(e)},e.prototype.resetEntity=function(e){this.preparePlayerSprite(e.name,e),e.sprite.animations.stop(),this.setPlayerPosition(e.position,e.isOnBlock,e),e.shouldUpdateSelectionIndicator()&&(this.setSelectionIndicatorPosition(e.position[0],e.position[1]),this.selectionIndicator.visible=!0),this.playIdleAnimation(e.position,e.facing,e.isOnBlock,e)},e.prototype.reset=function(e){this.player=e.player,this.agent=e.agent,this.resettableTweens.forEach(function(e){e.stop(!1)}),this.resettableTweens.length=0,this.collectibleItems=[],this.trees=[],this.resetGroups(e),e.usePlayer&&(this.resetEntity(this.player),e.usingAgent&&this.resetEntity(this.agent)),this.updateShadingGroup(e.shadingPlane),this.updateFowGroup(e.fowPlane),this.controller.followingPlayer()?(this.game.world.setBounds(0,0,40*e.planeWidth,40*e.planeHeight),this.game.camera.follow(this.player.sprite),this.game.world.scale.x=1,this.game.world.scale.y=1):this.game.world.setBounds(0,0,400,400)},e.prototype.update=function(){var e;for(e=0;e<this.toDestroy.length;++e)this.toDestroy[e].destroy();this.toDestroy=[]},e.prototype.render=function(){this.actionGroup.sort("sortOrder"),this.fluffGroup.sort("z")},e.prototype.scaleShowWholeWorld=function(e){var t=this.controller.scaleFromOriginal(),i=o(t,2),n=i[0],a=i[1],r=this.addResettableTween(this.game.world.scale).to({x:1/n,y:1/a},1e3,Phaser.Easing.Exponential.Out);this.game.camera.unfollow();var s=this.addResettableTween(this.game.camera).to({x:0,y:0},1e3,Phaser.Easing.Exponential.Out);r.onComplete.addOnce(function(){e()}),s.start(),r.start()},e.prototype.getDirectionName=function(e){return"_"+r.directionToRelative(e).toLowerCase()},e.prototype.updatePlayerDirection=function(e,t){var i=this.getDirectionName(t);this.setSelectionIndicatorPosition(e[0],e[1]),this.playScaledSpeed(this.player.sprite.animations,"idle"+i)},e.prototype.playDoorAnimation=function(e,t,i){var n=this.yToIndex(e[1])+e[0],o=this.actionPlaneBlocks[n],a=t?"open":"close",r=this.playScaledSpeed(o.animations,a);this.onAnimationEnd(r,function(){r.updateCurrentFrame(),i()})},e.prototype.playPlayerAnimation=function(e,t,i){var n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player),o=this.getDirectionName(i);n.sprite.sortOrder=this.yToIndex(t[1])+n.getSortOrderOffset();var a=e+o;return this.playScaledSpeed(n.sprite.animations,a)},e.prototype.playIdleAnimation=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.player;this.playPlayerAnimation("idle",e,t,i,n)},e.prototype.playSuccessAnimation=function(e,t,i,n){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.controller.delayBy(250,function(){o.audioPlayer.play("success"),o.onAnimationEnd(o.playPlayerAnimation("celebrate",e,t,i,a),function(){n()})})},e.prototype.playFailureAnimation=function(e,t,i,n){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.controller.delayBy(500,function(){o.audioPlayer.play("failure"),o.onAnimationEnd(o.playPlayerAnimation("fail",e,t,i,a),function(){o.controller.delayBy(800,n)})})},e.prototype.playBumpAnimation=function(e,t,i){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.player,a=this.playPlayerAnimation("bump",e,t,i,o);return a.onComplete.add(function(){n.playIdleAnimation(e,t,i,o)}),a},e.prototype.playDrownFailureAnimation=function(e,t,i,n){var a,r;this.playPlayerAnimation("fail",e,t,i),this.createBlock(this.fluffGroup,e[0],e[1],"bubbles"),a=this.fluffGroup.create(0,0,"finishOverlay");var s=this.controller.scaleFromOriginal(),l=o(s,2),c=l[0],u=l[1];a.scale.x=c,a.scale.y=u,a.alpha=0,a.tint=3296255,r=this.addResettableTween(a).to({alpha:.5},200,Phaser.Easing.Linear.None),r.onComplete.add(function(){n()}),r.start()},e.prototype.playBurnInLavaAnimation=function(e,t,i,n){var a,r;this.playPlayerAnimation("jumpUp",e,t,i),this.createBlock(this.fluffGroup,e[0],e[1],"fire"),a=this.fluffGroup.create(0,0,"finishOverlay");var s=this.controller.scaleFromOriginal(),l=o(s,2),c=l[0],u=l[1];a.scale.x=c,a.scale.y=u,a.alpha=0,a.tint=13719565,r=this.addResettableTween(a).to({alpha:.5},200,Phaser.Easing.Linear.None),r.onComplete.add(function(){n()}),r.start()},e.prototype.playDestroyTntAnimation=function(e,t,i,n,o,a){var r,s,l=this;if(0===n.length)return void a();this.audioPlayer.play("fuse");for(var c in n)r=this.actionPlaneBlocks[this.coordinatesToIndex(n[c])],s=this.playScaledSpeed(r.animations,"explode");this.onAnimationEnd(s,function(){l.audioPlayer.play("explode"),a()})},e.prototype.playCreeperExplodeAnimation=function(e,t,i,n,o){var a=this;this.controller.delayBy(180,function(){a.playPlayerAnimation("bump",e,t,!1).onComplete.add(function(){a.audioPlayer.play("fuse"),a.playExplodingCreeperAnimation(e,t,i,n,o,a),a.controller.delayBy(200,function(){a.onAnimationLoopOnce(a.playPlayerAnimation("jumpUp",e,t,!1),function(){a.playIdleAnimation(e,t,n)})})})})},e.prototype.flashEntity=function(e){return this.flashSpriteToWhite(e.sprite)},e.prototype.flashBlock=function(e){var t=this.yToIndex(e[1])+e[0],i=this.actionPlaneBlocks[t];return this.flashSpriteToWhite(i)},e.prototype.flashSpriteToWhite=function(e){var t=this.game.add.bitmapData(e.width,e.height);t.fill(255,255,255,255);var i=this.game.add.bitmapData(e.width,e.height),n={x:0,y:0,width:e.width,height:e.height},o={x:0,y:0,width:e.texture.crop.width,height:e.texture.crop.height};i.alphaMask(t,e,n,o);var a=e.addChild(this.game.make.sprite(0,0,i.texture));a.alpha=0;var r=0,s={alpha:1},l={alpha:0},c=this.game.add.tween(a).to(s,60,Phaser.Easing.Linear.None),u=this.game.add.tween(a).to(l,60,Phaser.Easing.Linear.None);r=120,c.chain(u);for(var p=u,d=0;d<2;d++){var h=this.game.add.tween(a).to(l,240,Phaser.Easing.Linear.None),f=this.game.add.tween(a).to(s,60,Phaser.Easing.Linear.None),g=this.game.add.tween(a).to(l,60,Phaser.Easing.Linear.None);r+=360,p.chain(h),h.chain(f),f.chain(g),p=g}return p.onComplete.add(function(){a.destroy()}),c.start(),2*r},e.prototype.playExplodingCreeperAnimation=function(e,t,i,n,o){var a=this,r=this.yToIndex(i[1])+i[0],s=this.actionPlaneBlocks[r],l=s.animations.getAnimation("explode");l.onComplete.add(function(){s.kill(),a.playExplosionAnimation(e,t,i,n,function(){a.controller.delayBy(100,function(){a.playFailureAnimation(e,t,!1,o)})},!1),a.audioPlayer.play("explode"),a.playExplosionCloudAnimation(i)}),l.play()},e.prototype.playExplosionCloudAnimation=function(e){this.createBlock(this.fluffGroup,e[0],e[1],"explosion")},e.prototype.coordinatesToIndex=function(e){return this.yToIndex(e[1])+e[0]},e.prototype.playMinecartTurnAnimation=function(e,t,i,n,o){var a=t?r.North:r.South;return this.playPlayerAnimation("mineCart_turn"+o,e,a,!1)},e.prototype.playMinecartMoveForwardAnimation=function(e,t,i,n,o,a){var r;return this.audioPlayer.play("minecart"),this.playPlayerAnimation("mineCart",e,t,!1),r=this.addResettableTween(this.player.sprite).to(this.positionToScreen(o),a,Phaser.Easing.Linear.None),r.start(),this.player.sprite.sortOrder=this.yToIndex(o[1])+10,r},e.prototype.playMinecartAnimation=function(e,t){var i=this,n=new s(3,2);this.setPlayerPosition(n,e),this.player.facing=2;var o=this.playLevelEndAnimation(n,this.player.facing,e,t,!1);this.game.world.setBounds(0,0,440,400),this.game.camera.follow(this.player.sprite),o.onComplete.add(function(){i.playTrack(n,i.player.facing,e,i.player,t)})},e.prototype.playTrack=function(e,t,i){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.player,l=arguments[4];a.onTracks=!0;var c=this.controller.levelModel.actionPlane.getMinecartTrack(e,t),u=s.forward(a.position,t);if(a.getOffTrack||!c&&!this.isFirstTimeOnRails(e,u))return a.getOffTrack=!1,a.onTracks=!1,void(l&&l());if(void 0===c&&void 0===(c=this.controller.levelModel.actionPlane.getMinecartTrack(u,t)))return a.getOffTrack=!1,a.onTracks=!1,void(l&&l());var p=void 0,d=c,h=o(d,4),f=h[0],g=h[1],m=h[2],v=h[3];if(this.player.position=g,"turn"===f.substring(0,4)){p=f.substring(5);var y=t===r.North||m===r.North;this.onAnimationEnd(this.playMinecartTurnAnimation(e,y,i,l,p),function(){n.playTrack(g,m,i,a,l)})}else this.onAnimationEnd(this.playMinecartMoveForwardAnimation(e,t,i,l,g,v),function(){n.playTrack(g,m,i,a,l)})},e.prototype.isFirstTimeOnRails=function(e,t){var i=this.controller.levelModel.actionPlane.getBlockAt(t),n=this.controller.levelModel.actionPlane.getBlockAt(e);return!(!i||!n||n.isRail||!i.isRail)},e.prototype.addHouseBed=function(e){var t=e[1]-1;this.actionGroup.create(38*e[0],35*t,"bed").sortOrder=this.yToIndex(e[1])},e.prototype.addDoor=function(e){var t,i=this.actionPlaneBlocks[this.coordinatesToIndex(e)];this.createActionPlaneBlock(e,"door"),t=this.createBlock(this.groundGroup,e[0],e[1],"wool_orange"),i.kill(),t.sortOrder=this.yToIndex(6)},e.prototype.playSuccessHouseBuiltAnimation=function(e,t,i,n,o,a,r){var s=this;this.playLevelEndAnimation(e,t,i,function(){s.controller.delayBy(4e3,a)},!0).onComplete.add(function(){s.audioPlayer.play("houseSuccess");for(var e,t,i,a=0;a<n.length;++a)e=n[a][1],t=n[a][2],i=s.createBlock(s.groundGroup,e,t,"wool_orange"),i.sortOrder=s.yToIndex(t);s.addHouseBed(o[0]),s.addDoor(o[1]),s.groundGroup.sort("sortOrder"),r()})},e.prototype.playLevelEndAnimation=function(e,t,i,n,a){var r,s,l,c=this;r=this.fluffGroup.create(0,0,"finishOverlay");var u=this.controller.scaleFromOriginal(),p=o(u,2),d=p[0],h=p[1];return r.scale.x=d,r.scale.y=h,r.alpha=0,s=this.tweenToWhite(r),l=this.tweenFromWhiteToClear(r),s.onComplete.add(function(){c.selectionIndicator.visible=!1,c.setPlayerPosition(e,i),l.start()}),a&&l.onComplete.add(function(){c.playSuccessAnimation(e,t,i,n)}),s.start(),s},e.prototype.tweenFromWhiteToClear=function(e){return this.addResettableTween(e).to({alpha:0},700,Phaser.Easing.Linear.None)},e.prototype.tweenToWhite=function(e){var t;return t=this.addResettableTween(e).to({alpha:1},300,Phaser.Easing.Linear.None),t},e.prototype.playBlockSound=function(e){var t=e.substring(0,3);"water"!==e&&"lava"!==e&&("stone"===e||"cobblestone"===e||"bedrock"===e||"ore"===t||"bricks"===e?this.audioPlayer.play("stepStone"):"grass"===e||"dirt"===e||"dirtCoarse"===e||"wool_orange"===e||"wool"===e?this.audioPlayer.play("stepGrass"):"gravel"===e?this.audioPlayer.play("stepGravel"):"farmlandWet"===e?this.audioPlayer.play("stepFarmland"):this.audioPlayer.play("stepWood"))},e.prototype.playMoveForwardAnimation=function(e,t,i,n,o,a,s){var l=e.position[1]+(i===r.North?1:0);this.playWalkAnimation(e,t,i,n,o,a,l,s)},e.prototype.playMoveBackwardAnimation=function(e,t,i,n,o,a,s){var l=e.position[1]+(i===r.South?1:0);this.playWalkAnimation(e,t,i,n,o,a,l,s)},e.prototype.playWalkAnimation=function(e,t,i,n,o,a,r,s){var l=this,c=void 0,u=e.position;if(this.playBlockSound(a),e.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(u[0],u[1]),n)c=this.playPlayerJumpDownVerticalAnimation(i,u,t);else{var p="walk"+this.getDirectionName(i);this.playScaledSpeed(e.sprite.animations,p),c=this.addResettableTween(e.sprite).to(this.positionToScreen(u,o,e),180,Phaser.Easing.Linear.None)}c.onUpdateCallback(function(t,i){i>=.75&&(e.sprite.sortOrder=l.yToIndex(r)+e.getSortOrderOffset(),t.onUpdateCallback(null))}),c.onComplete.add(function(){s()}),c.start()},e.prototype.playPlayerJumpDownVerticalAnimation=function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o="jumpDown"+this.getDirectionName(e);this.playScaledSpeed(this.player.sprite.animations,o);var a=this.positionToScreen(n),r=this.positionToScreen(t),s=this.addResettableTween(this.player.sprite).to({x:[a.x,r.x,r.x],y:[a.y,r.y-50,r.y]},300,Phaser.Easing.Linear.None).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});return s.onComplete.addOnce(function(){i.audioPlayer.play("fall")}),s.start(),s},e.prototype.playPlaceBlockAnimation=function(e,t,i,n,o,r){var s,l=this,c=this.yToIndex(e[1])+e[0];if(o.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(e[0],e[1]),o===this.agent||a.isWalkable(i))var u=this.playPlayerAnimation("punch",e,t,!1,o).onComplete.add(function(){u.detach(),r()});else{this.audioPlayer.play("placeBlock");s="jumpUp"+this.getDirectionName(t),""!==n&&this.playExplosionAnimation(e,t,e,n,function(){},!1),this.playScaledSpeed(this.player.sprite.animations,s);var p=this.addResettableTween(this.player.sprite).to({y:40*e[1]-55},125,Phaser.Easing.Cubic.EaseOut);p.onComplete.addOnce(function(){p=null,""!==n&&l.actionPlaneBlocks[c].kill(),r()}),p.start()}},e.prototype.playPlaceBlockInFrontAnimation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player,t=arguments[1],i=arguments[2],n=arguments[3],o=arguments[4];this.setSelectionIndicatorPosition(n[0],n[1]),this.playPlayerAnimation("punch",t,i,!1,e).onComplete.addOnce(function(){o()})},e.prototype.correctForShadowOverlay=function(e,t){e.startsWith("piston")&&(t.sortOrder-=.1)},e.prototype.createActionPlaneBlock=function(e,t){var i=new a(t),n=this.yToIndex(e[1])+e[0];if(this.actionGroup.remove(this.actionPlaneBlocks[n]),this.groundGroup.remove(this.actionPlaneBlocks[n]),i.isEmpty)return void(this.actionPlaneBlocks[n]=null);var o=void 0;if(i.getIsMiniblock())o=this.createMiniBlock(e[0],e[1],t,{collectibleDistance:1,xOffsetRange:10,yOffsetRange:10});else{var r=i.shouldRenderOnGroundPlane()?this.groundGroup:this.actionGroup,s=i.shouldRenderOnGroundPlane()?-.5:0;o=this.createBlock(r,e[0],e[1]+s,t)}o&&(o.sortOrder=this.yToIndex(e[1]),this.correctForShadowOverlay(t,o)),this.actionPlaneBlocks[n]=o},e.prototype.playShearAnimation=function(e,t,i,n,o){var a=this,r=this.yToIndex(i[1])+i[0],s=this.actionPlaneBlocks[r];s.animations.stop(null,!0),this.onAnimationLoopOnce(this.playScaledSpeed(s.animations,"used"),function(){a.playScaledSpeed(s.animations,"face")}),this.playExplosionAnimation(e,t,i,n,o,!0)},e.prototype.playShearSheepAnimation=function(e,t,i,n,o){var a=this;this.setSelectionIndicatorPosition(i[0],i[1]),this.onAnimationEnd(this.playPlayerAnimation("punch",e,t,!1),function(){var r=a.yToIndex(i[1])+i[0],s=a.actionPlaneBlocks[r];s.animations.stop(null,!0),a.onAnimationLoopOnce(a.playScaledSpeed(s.animations,"used"),function(){a.playScaledSpeed(s.animations,"face")}),a.playExplosionAnimation(e,t,i,n,o,!0)})},e.prototype.destroyBlockWithoutPlayerInteraction=function(e){var t=this,i=this.yToIndex(e[1])+e[0],n=this.actionPlaneBlocks[i],o=this.actionGroup.create(40*e[0]-12,40*e[1]-22,"destroyOverlay","destroy1");o.sortOrder=this.yToIndex(e[1])+2,this.onAnimationEnd(o.animations.add("destroy",Phaser.Animation.generateFrameNames("destroy",1,12,"",0),30,!1),function(){t.actionPlaneBlocks[i]=null,n.hasOwnProperty("onBlockDestroy")&&n.onBlockDestroy(n),n.kill(),o.kill(),t.toDestroy.push(n),t.toDestroy.push(o),t.audioPlayer.play("dig_wood1")}),this.playScaledSpeed(o.animations,"destroy")},e.prototype.playDestroyBlockAnimation=function(e,t,i,n,o,a){o.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(i[0],i[1]);var r=void 0;r=o===this.agent?"punchDestroy":n.match(/(ore|stone|clay|bricks|bedrock)/)?"mine":"punchDestroy",this.playPlayerAnimation(r,e,t,!1,o),this.playMiningParticlesAnimation(t,i),this.playBlockDestroyOverlayAnimation(e,t,i,n,o,a)},e.prototype.playPunchDestroyAirAnimation=function(e,t,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.playPunchAnimation(e,t,i,"punchDestroy",n,o)},e.prototype.playPunchAirAnimation=function(e,t,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.player;this.playPunchAnimation(e,t,i,"punch",n,o)},e.prototype.playPunchAnimation=function(e,t,i,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.player;a.shouldUpdateSelectionIndicator()&&this.setSelectionIndicatorPosition(i[0],i[1]),this.onAnimationEnd(this.playPlayerAnimation(n,e,t,!1,a),function(){o()})},e.prototype.playBlockDestroyOverlayAnimation=function(e,t,i,n,o,r){var s=this,l=this.yToIndex(i[1])+i[0],c=this.actionPlaneBlocks[l],u=function(){c.hasOwnProperty("onBlockDestroy")&&c.onBlockDestroy(c),s.controller.levelModel.destroyBlockForward(o),s.controller.updateShadingPlane(),s.controller.updateFowPlane(),o.shouldUpdateSelectionIndicator()&&s.setSelectionIndicatorPosition(e[0],e[1]),s.audioPlayer.play("dig_wood1"),s.playExplosionAnimation(e,t,i,n,r,!0,o)};a.skipsDestructionOverlay(n)?u():function(){var e=s.actionGroup.create(40*i[0]-12,40*i[1]-22,"destroyOverlay","destroy1");if(a.isFlat(n)){var t=new Phaser.Rectangle(0,0,60,40);e.position.y+=20,e.crop(t)}e.sortOrder=s.yToIndex(i[1])+2,s.onAnimationEnd(e.animations.add("destroy",Phaser.Animation.generateFrameNames("destroy",1,12,"",0),30,!1),function(){e.kill(),s.toDestroy.push(e),u()}),s.playScaledSpeed(e.animations,"destroy")}()},e.prototype.playMiningParticlesAnimation=function(e,t){var i=this,n=[[24,-100,-80],[12,-120,-80],[0,-60,-80],[36,-80,-60]],o=this.getDirectionName(e),a="_left"===o?0:"_bottom"===o?1:"_right"===o?2:3,r=n[a][0],s=n[a][1],l=n[a][2],c=this.actionGroup.create(s+40*t[0],l+40*t[1],"miningParticles","MiningParticles"+r);c.sortOrder=this.yToIndex(t[1])+2,this.onAnimationEnd(c.animations.add("miningParticles",Phaser.Animation.generateFrameNames("MiningParticles",r,r+11,"",0),30,!1),function(){c.kill(),i.toDestroy.push(c)}),this.playScaledSpeed(c.animations,"miningParticles")},e.prototype.playExplosionAnimation=function(e,t,i,n,o,a){var r=this,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.player,l=this.actionGroup.create(40*i[0]-36,40*i[1]-30,"blockExplode","BlockBreakParticle0");switch(n){case"treeAcacia":case"logAcacia":l.tint=7103834;break;case"treeBirch":case"logBirch":l.tint=14341836;break;case"treeJungle":case"logJungle":l.tint=6967089;break;case"treeOak":case"logOak":l.tint=6771249;break;case"treeSpruce":case"logSpruce":l.tint=4929827;break;case"planksAcacia":l.tint=12215095;break;case"planksBirch":l.tint=14142349;break;case"planksJungle":l.tint=12093284;break;case"planksOak":l.tint=11833434;break;case"planksSpruce":l.tint=8412726;break;case"stone":case"oreCoal":case"oreDiamond":case"oreIron":case"oreGold":case"oreEmerald":case"oreRedstone":l.tint=13027014;break;case"grass":case"cropWheat":l.tint=6131491;break;case"dirt":l.tint=9068083;break;case"redstoneWireOn":case"redstoneWireHorizontalOn":case"redstoneWireVerticalOn":case"redstoneWireUpRightOn":case"redstoneWireUpLeftOn":case"redstoneWireDownRightOn":case"redstoneWireDownLeftOn":case"redstoneWireTUpOn":case"redstoneWireTDownOn":case"redstoneWireTLeftOn":case"redstoneWireTRightOn":case"redstoneWireCrossOn":l.tint=10028807;break;case"redstoneWire":case"redstoneWireHorizontal":case"redstoneWireVertical":case"redstoneWireUpRight":case"redstoneWireUpLeft":case"redstoneWireDownRight":case"redstoneWireDownLeft":case"redstoneWireTUp":case"redstoneWireTDown":case"redstoneWireTLeft":case"redstoneWireTRight":case"redstoneWireCross":l.tint=2687490}l.sortOrder=this.yToIndex(i[1])+2,this.onAnimationEnd(l.animations.add("explode",Phaser.Animation.generateFrameNames("BlockBreakParticle",0,7,"",0),30,!1),function(){l.kill(),r.toDestroy.push(l),a&&(r.controller.getIsDirectPlayerControl()||r.playPlayerAnimation("idle",e,t,!1,s),null!==o&&r.playItemDropAnimation(i,n,o))}),this.playScaledSpeed(l.animations,"explode"),this.controller.getIsDirectPlayerControl()^!a&&o&&o()},e.prototype.playItemDropAnimation=function(e,t,i){var n=this,o=this.createMiniBlock(e[0],e[1],t);o&&(o.sortOrder=this.yToIndex(e[1])+2),this.controller.getIsDirectPlayerControl()?i&&i():this.onAnimationEnd(this.playScaledSpeed(o.animations,"animate"),function(){var e=n.controller.levelModel.player;n.playItemAcquireAnimation(e.position,e.facing,o,i,t)})},e.prototype.playScaledSpeed=function(e,t){var i=e.getAnimation(t);if(null!==i){i.originalFps||(i.originalFps=1e3/i.delay);var n=this.controller.originalFpsToScaled(i.originalFps);return e.play(t,n)}console.log("can't find animation name : "+t)},e.prototype.playItemAcquireAnimation=function(e,t,i,n,o){var a,r=this;a=this.addResettableTween(i).to(this.positionToScreen(e),200,Phaser.Easing.Linear.None),a.onComplete.add(function(){var t=s.equals(r.player.position,e);if(i.alive&&t){r.audioPlayer.play("collectedBlock"),r.player.inventory[o]=(r.player.inventory[o]||0)+1,i.kill(),r.toDestroy.push(i);var a=l("craftCollectibleCollected");a.blockType=o,window.dispatchEvent(a),n&&n()}else r.playItemAcquireAnimation(r.player.position,r.player.facing,i,n,o)}),a.start()},e.prototype.positionToScreen=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player,n=e[0],o=e[1];return{x:i.offset[0]+40*n,y:i.offset[1]+(t?-23:0)+40*o}},e.prototype.setPlayerPosition=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player,n=this.positionToScreen(e,t,i);i.sprite.x=n.x,i.sprite.y=n.y,i.sprite.sortOrder=this.yToIndex(n.y)+i.getSortOrderOffset()},e.prototype.setSelectionIndicatorPosition=function(e,t){this.selectionIndicator.x=40*e-12,this.selectionIndicator.y=40*t-12},e.prototype.drawHintPath=function(e){this.hintGroup.removeAll(!0);var t=this.game.world.bounds,i=this.game.add.bitmapData(t.width,t.height),n=i.context;n.setLineDash([10,10]),n.lineDashOffset=5,n.lineWidth=2,n.strokeStyle="#fff",n.shadowColor="#000",n.shadowOffsetY=7,n.shadowBlur=4,n.beginPath(),e.forEach(function(e){var t=o(e,2),i=t[0],a=t[1];n.lineTo(40*i+19,40*a+19)}),n.stroke();var a=this.hintGroup.create(0,0,i);a.alpha=0,this.addResettableTween(a).to({alpha:1},830,Phaser.Easing.Quadratic.Out).to({alpha:.4},500,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)},e.prototype.createGroups=function(){this.groundGroup=this.game.add.group(),this.groundGroup.yOffset=-2,this.shadingGroup=this.game.add.group(),this.shadingGroup.yOffset=-2,this.hintGroup=this.game.add.group(),this.actionGroup=this.game.add.group(),this.actionGroup.yOffset=-22,this.fluffGroup=this.game.add.group(),this.fluffGroup.yOffset=-160,this.fowGroup=this.game.add.group(),this.fowGroup.yOffset=0},e.prototype.resetGroups=function(e){var t,i,n;for(this.groundGroup.removeAll(!0),this.actionGroup.removeAll(!0),this.hintGroup.removeAll(!0),this.fluffGroup.removeAll(!0),this.shadingGroup.removeAll(!0),this.fowGroup.removeAll(!0),this.baseShading=this.game.add.group(),this.actionPlaneBlocks=[],this.refreshGroundGroup(),n=0;n<this.controller.levelModel.planeHeight;++n)for(i=0;i<this.controller.levelModel.planeWidth;++i){var o=new s(i,n);t=null;var a=e.groundDecorationPlane.getBlockAt(o);a.isEmpty||(t=this.createBlock(this.actionGroup,i,n,a.blockType))&&(t.sortOrder=this.yToIndex(n));var r=e.actionPlane.getBlockAt(o);r.shouldRenderOnGroundPlane()||this.createActionPlaneBlock(o,r.blockType)}for(n=0;n<this.controller.levelModel.planeHeight;++n)for(i=0;i<this.controller.levelModel.planeWidth;++i){var l=new s(i,n);e.fluffPlane.getBlockAt(l).isEmpty||(t=this.createBlock(this.fluffGroup,i,n,e.fluffPlane.getBlockAt(l).blockType))}},e.prototype.refreshGroundGroup=function(){this.groundGroup.removeAll(!0);for(var e=0;e<this.controller.levelModel.planeHeight;++e)for(var t=0;t<this.controller.levelModel.planeWidth;++t){var i=new s(t,e),n=this.controller.levelModel.groundPlane.getBlockAt(i),o=this.createBlock(this.groundGroup,t,e,n.blockType);o&&(o.sortOrder=this.yToIndex(e));var a=this.controller.levelModel.actionPlane.getBlockAt(i);a&&a.shouldRenderOnGroundPlane()&&this.createActionPlaneBlock(i,a.blockType)}},e.prototype.refreshActionGroup=function(e){for(var t=this,i=0;i<e.length;++i){var n=s.south(e[i]);if(this.controller.levelModel.actionPlane.inBounds(n)){""===this.controller.levelModel.actionPlane.getBlockAt(n).blockType||e.push(n)}}e.forEach(function(e){if(e){var i=t.controller.levelModel.actionPlane.getBlockAt(e);if(i&&i.getIsDoor())return;if(i&&i.getIsMiniblock()||i&&i.getIsTree())return;if(i&&i.blockType)t.createActionPlaneBlock(e,i.blockType);else if(i){var n=t.coordinatesToIndex(e);t.actionGroup.remove(t.actionPlaneBlocks[n]),t.groundGroup.remove(t.actionPlaneBlocks[n])}}})},e.prototype.updateShadingGroup=function(e){var t,i,n,o,a;for(this.shadingGroup.removeAll(),this.shadingGroup.add(this.baseShading),this.selectionIndicator&&this.shadingGroup.add(this.selectionIndicator),t=0;t<e.length;++t){i=e[t],a=i.atlas,n=40*i.x,o=40*i.y;var r=this.shadingGroup.create(n,o,a,i.type);"WaterAO"===a&&(r.tint=5592405)}},e.prototype.updateFowGroup=function(e){var t,i,n,o;for(this.fowGroup.removeAll(),t=0;t<e.length;++t){var a=e[t];if(""!==a){o="undergroundFow",i=40*a.x-40,n=40*a.y-40,a.type;this.fowGroup.create(i,n,o,a.type).alpha=.8}}},e.prototype.playRandomPlayerIdle=function(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;switch(t=this.getDirectionName(e),Math.trunc(4*Math.random())+1){case 1:i="idle";break;case 2:i="lookLeft";break;case 3:i="lookRight";break;case 4:i="lookAtCam"}i+=t,this.playScaledSpeed(n.sprite.animations,i)},e.prototype.generatePlayerCelebrateFrames=function(){for(var e=[],t=0;t<6;++t)e.push("Player_001");return e=e.concat("Player_259"),e=e.concat("Player_260"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e.push("Player_001"),e.push("Player_001"),e.push("Player_001"),e.push("Player_001"),e.push("Player_001"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e.push("Player_261"),e.push("Player_297"),e.push("Player_298"),e.push("Player_297"),e.push("Player_261"),e},e.prototype.generateFramesWithEndDelay=function(e,t,i,n,o,a){for(var r=Phaser.Animation.generateFrameNames(e,t,i,"",o),s=0;s<a;++s)r.push(n);return r},e.prototype.generateReverseFrames=function(e,t,i,n,o){return Phaser.Animation.generateFrameNames(e,t,i,n,o).concat(Phaser.Animation.generateFrameNames(e,i-1,t,n,o))},e.prototype.preparePlayerSprite=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.player;i.sprite=this.actionGroup.create(0,0,"player"+e,"Player_121"),this.controller.followingPlayer()&&i===this.player&&this.game.camera.follow(i.sprite),i.shouldUpdateSelectionIndicator()&&(this.selectionIndicator=this.shadingGroup.create(24,44,"selectionIndicator")),this.generateAnimations(r.South,0,i),this.generateAnimations(r.East,60,i),this.generateAnimations(r.North,120,i),this.generateAnimations(r.West,180,i);var n=void 0;n=this.generateFramesWithEndDelay("Player_",263,262,"Player_262",3,5),n.push("Player_263"),i.sprite.animations.add("lookAtCam_down",n,10,!1).onComplete.add(function(){t.playScaledSpeed(i.sprite.animations,"idlePause_down")}),n=this.generateFramesWithEndDelay("Player_",270,269,"Player_269",3,5),n.push("Player_270"),i.sprite.animations.add("lookAtCam_right",n,10,!1).onComplete.add(function(){t.playScaledSpeed(i.sprite.animations,"idlePause_right")}),n=this.generateFramesWithEndDelay("Player_",277,276,"Player_276",3,5),n.push("Player_277"),i.sprite.animations.add("lookAtCam_up",n,10,!1).onComplete.add(function(){t.playScaledSpeed(i.sprite.animations,"idlePause_up")}),n=this.generateFramesWithEndDelay("Player_",284,283,"Player_283",3,5),n.push("Player_284"),i.sprite.animations.add("lookAtCam_left",n,10,!1).onComplete.add(function(){t.playScaledSpeed(i.sprite.animations,"idlePause_left")}),i.sprite.animations.add("mine_down",Phaser.Animation.generateFrameNames("Player_",241,244,"",3),20,!0),i.sprite.animations.add("mine_right",Phaser.Animation.generateFrameNames("Player_",245,248,"",3),20,!0),i.sprite.animations.add("mine_up",Phaser.Animation.generateFrameNames("Player_",249,252,"",3),20,!0),i.sprite.animations.add("mine_left",Phaser.Animation.generateFrameNames("Player_",253,256,"",3),20,!0),i.sprite.animations.add("mineCart_down",Phaser.Animation.generateFrameNames("Minecart_",5,5,"",2),20,!1),i.sprite.animations.add("mineCart_turnleft_down",Phaser.Animation.generateFrameNames("Minecart_",6,6,"",2),20,!1),i.sprite.animations.add("mineCart_turnright_down",Phaser.Animation.generateFrameNames("Minecart_",12,12,"",2),20,!1),i.sprite.animations.add("mineCart_right",Phaser.Animation.generateFrameNames("Minecart_",7,7,"",2),20,!1),i.sprite.animations.add("mineCart_left",Phaser.Animation.generateFrameNames("Minecart_",11,11,"",2),20,!1),i.sprite.animations.add("mineCart_up",Phaser.Animation.generateFrameNames("Minecart_",9,9,"",2),20,!1),i.sprite.animations.add("mineCart_turnleft_up",Phaser.Animation.generateFrameNames("Minecart_",10,10,"",2),20,!1),i.sprite.animations.add("mineCart_turnright_up",Phaser.Animation.generateFrameNames("Minecart_",8,8,"",2),20,!1)},e.prototype.playerFrameName=function(e){return Phaser.Animation.generateFrameNames("Player_",e,e,"",3)},e.prototype.generateAnimations=function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player,o=this.getDirectionName(e),a=[];a.push(this.playerFrameName(t+1)),a.push(this.playerFrameName(t+3)),a.push(this.playerFrameName(t+1)),a.push(this.playerFrameName(t+7)),a.push(this.playerFrameName(t+9)),a.push(this.playerFrameName(t+7));for(var r=0;r<5;++r)a.push(this.playerFrameName(t+1));n.sprite.animations.add("idle"+o,a,20/3,!1).onComplete.add(function(){i.playRandomPlayerIdle(e,n)}),a=this.generateFramesWithEndDelay("Player_",t+6,t+5,this.playerFrameName(t+5),3,5),a.push(this.playerFrameName(t+6)),n.sprite.animations.add("lookLeft"+o,a,10,!1).onComplete.add(function(){i.playScaledSpeed(n.sprite.animations,"idlePause"+o)}),a=this.generateFramesWithEndDelay("Player_",t+12,t+11,this.playerFrameName(t+11),3,5),a.push(this.playerFrameName(t+12)),n.sprite.animations.add("lookRight"+o,a,10,!1).onComplete.add(function(){i.playScaledSpeed(n.sprite.animations,"idlePause"+o)}),a=[];for(var s=0;s<13;++s)a.push(this.playerFrameName(t+1));n.sprite.animations.add("idlePause"+o,a,20/3,!1).onComplete.add(function(){i.playRandomPlayerIdle(e,n)}),n.sprite.animations.add("walk"+o,Phaser.Animation.generateFrameNames("Player_",t+13,t+20,"",3),20,!0);var l=Phaser.Animation.generateFrameNames("Player_",t+21,t+24,"",3);n.sprite.animations.add("punch"+o,l,20,!1).onComplete.add(function(){i.audioPlayer.play("punch")}),n.sprite.animations.add("punchDestroy"+o,l.concat(l).concat(l),20,!1),n.sprite.animations.add("hurt"+o,Phaser.Animation.generateFrameNames("Player_",t+25,t+28,"",3),20,!1).onComplete.add(function(){i.playScaledSpeed(n.sprite.animations,"idlePause"+o)}),n.sprite.animations.add("crouch"+o,Phaser.Animation.generateFrameNames("Player_",t+29,t+32,"",3),20,!0),n.sprite.animations.add("jumpUp"+o,Phaser.Animation.generateFrameNames("Player_",t+33,t+36,"",3),10,!0),n.sprite.animations.add("fail"+o,Phaser.Animation.generateFrameNames("Player_",t+45,t+48,"",3),20,!1),n.sprite.animations.add("celebrate"+o,this.generatePlayerCelebrateFrames(),10,!1),n.sprite.animations.add("bump"+o,Phaser.Animation.generateFrameNames("Player_",t+49,t+54,"",3),20,!1).onStart.add(function(){i.audioPlayer.play("bump")}),n.sprite.animations.add("jumpDown"+o,Phaser.Animation.generateFrameNames("Player_",t+55,t+60,"",3),20,!0)},e.prototype.createMiniBlock=function(e,t,i){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=null,l=void 0,c=o.collectibleDistance||2,u=o.xOffsetRange||40,p=o.yOffsetRange||40,d=a.getMiniblockFrame(i);if(!d||!this.miniBlocks[d])return r;var h=this.miniBlocks[d][0],f=this.miniBlocks[d][1],g=this.miniBlocks[d][2],m=-10-u/2+Math.random()*u,v=0-p/2+Math.random()*p+this.actionGroup.yOffset,y=new s(m,v);l=Phaser.Animation.generateFrameNames(h,f,g,".png",3),r=this.actionGroup.create(m+40*e,v+40*t,"miniBlocks","");var _=r.animations.add("animate",l,10,!1);return this.controller.getIsDirectPlayerControl()&&function(){var o=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},a=n.controller.levelModel.spritePositionToIndex(y,new s(r.x,r.y));n.collectibleItems.push([r,y,i,c]),_.onComplete.add(function(){n.controller.levelModel.usePlayer&&o(n.player.position,a)<c&&n.player.collectItems(new s(e,t))})}(),this.playScaledSpeed(r.animations,"animate"),r},e.prototype.playAnimationWithOffset=function(e,t,i,n){var o=Math.trunc(Math.random()*i)+n;this.playScaledSpeed(e.animations,t).setFrame(o,!0)},e.prototype.psuedoRandomTint=function(e,t,i,n){var o=Math.pow(10*i+n,5)%251,a=o/12;e===this.groundGroup?a+=24:a*=.75;var r=Math.floor(255-a).toString(16);t.tint="0x"+r+r+r},e.prototype.createBlock=function(e,t,i,n){var o,r,l,c,u,p,d=this,h=new s(t,i),f=null,g=function(o,a){var r=n.substring(4);f=o.createBlock(e,t,i,"log"+r),f.fluff=o.createBlock(o.fluffGroup,t,i,"leaves"+r),f.onBlockDestroy=function(e){e.fluff.animations.add("despawn",Phaser.Animation.generateFrameNames("Leaves_"+r,a[0],a[1],".png",0),10,!1).onComplete.add(function(){o.toDestroy.push(e.fluff),e.fluff.kill()}),o.playScaledSpeed(e.fluff.animations,"despawn")},o.trees.push({sprite:f,type:n,position:h})},m=function(o,a){l=d.blocks[n][0],c=d.blocks[n][1],u=d.blocks[n][2],p=d.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=[];for(var s=Phaser.Animation.generateFrameNames(a,0,3,"",1),h=0;h<5;++h)r.push(a+"0");r=r.concat(s),f.animations.add("open",r),r=[],s=Phaser.Animation.generateFrameNames(a,3,0,"",1);for(var g=0;g<5;++g)r.push(a+"3");return r=r.concat(s),f.animations.add("close",r),f};switch(n){case"treeAcacia":g(this,[0,7]);break;case"treeBirch":g(this,[0,8]);break;case"treeJungle":g(this,[0,9]);break;case"treeOak":g(this,[0,6]);break;case"treeSpruce":case"treeSpruceSnowy":g(this,[0,8]);break;case"cropWheat":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Wheat",0,2,"",0),f.animations.add("idle",r,.4,!1),this.playScaledSpeed(f.animations,"idle");break;case"torch":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Torch",0,23,"",0),f.animations.add("idle",r,15,!0),this.playScaledSpeed(f.animations,"idle");break;case"water":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Water_",0,5,"",0),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"watering":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),f.kill(),this.toDestroy.push(f),this.createBlock(this.groundGroup,t,i,"farmlandWet"),this.refreshGroundGroup();break;case"lava":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Lava_",0,5,"",0),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"Nether_Portal":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Nether_Portal",0,5,"",0),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"lavaPop":for(l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("LavaPop",1,7,"",2),o=0;o<4;++o)r.push("LavaPop07");for(r=r.concat(Phaser.Animation.generateFrameNames("LavaPop",8,13,"",2)),o=0;o<3;++o)r.push("LavaPop13");for(r=r.concat(Phaser.Animation.generateFrameNames("LavaPop",14,30,"",2)),o=0;o<8;++o)r.push("LavaPop01");f.animations.add("idle",r,5,!0),this.playAnimationWithOffset(f,"idle",29,1);break;case"fire":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Fire",0,14,"",2),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"bubbles":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Bubbles",0,14,"",2),f.animations.add("idle",r,5,!0),this.playScaledSpeed(f.animations,"idle");break;case"explosion":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("Explosion",0,16,"",1),f.animations.add("idle",r,15,!1).onComplete.add(function(){d.toDestroy.push(f),f.kill()}),this.playScaledSpeed(f.animations,"idle");break;case"door":f=m(0,"Door");break;case"doorIron":f=m(0,"DoorIron"),this.blockReceivesCornerShadow(t,i)&&f.addChild(this.game.make.sprite(-40,55,"blockShadows","Shadow_Parts_Fade_overlap.png"));break;case"tnt":l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),r=Phaser.Animation.generateFrameNames("TNTexplosion",0,8,"",0),f.animations.add("explode",r,7,!1).onComplete.add(function(){d.playExplosionCloudAnimation(h),f.kill(),d.toDestroy.push(f),d.actionPlaneBlocks[d.coordinatesToIndex(h)]=null});break;default:if(l=this.blocks[n][0],c=this.blocks[n][1],u=this.blocks[n][2],p=this.blocks[n][3],f=e.create(u+40*t,p+e.yOffset+40*i,l,c),e!==this.actionGroup&&e!==this.groundGroup||a.isWalkable(n)||this.psuedoRandomTint(e,f,t,i),e===this.actionGroup&&!a.isWalkable(n)&&this.blockReceivesCornerShadow(t,i)){var v=-39,y=40;n.startsWith("pistonArm")&&(v=-26,y=53),f.addChild(this.game.make.sprite(v,y,"blockShadows","Shadow_Parts_Fade_overlap.png"))}n.startsWith("redstoneWire")&&n.endsWith("On")&&f.addChild(this.addRedstoneSparkle())}return f},e.prototype.addRedstoneSparkle=function(){for(var e=this,t="redstone_sparkle99.png",i=this.game.make.sprite(20,25,"redstoneSparkle",t),n=0;n<3;n++){var o=8*n,a=[t].concat(Phaser.Animation.generateFrameNames("redstone_sparkle",o,o+7,".png"),t);i.animations.add("fizz_"+n,a,7)}return function t(){setTimeout(function(){if(i.alive){var n=Math.floor(3*Math.random());e.onAnimationEnd(e.playScaledSpeed(i.animations,"fizz_"+n),t),i.position.x=Math.random()>.5?20:40,i.position.y=Math.random()>.5?25:45}},c(500,7e3)/e.controller.tweenTimeScale)}(),i},e.prototype.blockReceivesCornerShadow=function(e,t){var i=this.controller.levelModel.actionPlane.getBlockAt([e,t+1]);if(!i||i.blockType&&!i.isWalkable)return!1;var n=this.controller.levelModel.actionPlane.getBlockAt([e-1,t+1]);return n&&n.blockType&&!n.isWalkable},e.prototype.isUnderTree=function(e,t){if(e>=this.trees.length||e<0)return!1;for(var i=this.treeFluffTypes[this.trees[e].type],n=0;n<i.length;n++)if(this.trees[e].position[0]+i[n][0]===t[0]&&this.trees[e].position[1]+i[n][1]===t[1])return!0;return!1},e.prototype.changeTreeAlpha=function(e,t){this.controller.levelView.addResettableTween(this.trees[e].sprite.fluff).to({alpha:t},300,Phaser.Easing.Linear.None).start()},e.prototype.onAnimationEnd=function(e,t){var i=e.onComplete.add(function(){i.detach(),t()})},e.prototype.onAnimationStart=function(e,t){var i=e.onStart.add(function(){i.detach(),t()})},e.prototype.onAnimationLoopOnce=function(e,t){var i=e.onLoop.add(function(){i.detach(),t()})},e.prototype.addResettableTween=function(e){var t=this.game.add.tween(e);return t.timeScale=this.controller.tweenTimeScale,this.resettableTweens.push(t),t},e.prototype.animateDoor=function(e,t){var i=this,n=this.controller.levelModel.player;this.setSelectionIndicatorPosition(this.controller.levelModel.actionPlane.indexToCoordinates(e)[0],this.controller.levelModel.actionPlane.indexToCoordinates(e)[1]),this.controller.audioPlayer.play("doorOpen");var o=this.controller.levelModel.actionPlane.indexToCoordinates(e);this.playDoorAnimation(o,t,function(){var e=i.controller.levelModel.actionPlane.getBlockAt(o);e.isWalkable=e.isOpen,"doorIron"!==e.blockType&&i.playIdleAnimation(n.position,n.facing,n.isOnBlock,n),i.setSelectionIndicatorPosition(n.position[0],n.position[1])})},e}()},2717:function(e,t,i){"use strict";e.exports={},e.exports.createEvent=function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{t=new Event(e,{bubbles:i,cancelable:n})}catch(o){t=document.createEvent("Event"),t.initEvent(e,i,n)}return t},e.exports.bisect=function(e,t){return[e.filter(function(e){return t(e)}),e.filter(function(e){return!t(e)})]}},2718:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(794),a=i(2719),r=i(2720),s=i(2721),l=i(2722),c=i(2723),u=i(2724),p=i(2725),d=i(838);e.exports=function(){function e(t){n(this,e),this.controller=t,this.game=t.game,this.entityMap=new Map,this.entityDeathCount=new Map,this.sprite=null,this.id=0}return e.prototype.loadData=function(e){if(void 0!==e.entities)for(var t=0;t<e.entities.length;t++){var i=e.entities[t],n=this.createEntity(i[0],this.id++,i[1],i[2],i[3],i[4]);n.updateHidingTree(),n.updateHidingBlock()}},e.prototype.tick=function(){var e=function(e){e.tick()};this.entityMap.forEach(e)},e.prototype.pushEntity=function(e){this.entityMap.has(e.identifier)?this.controller.DEBUG&&this.game.debug.text("Duplicate entity name : "+e.identifier+"\n"):this.entityMap.set(e.identifier,e)},e.prototype.isFriendlyEntity=function(e){for(var t=["sheep","ironGolem","cow","chicken"],i=0;i<t.length;i++)if(e===t[i])return!0;return!1},e.prototype.createEntity=function(e,t,i,n,d,h){var f=null;if(this.entityMap.has(t))this.controller.DEBUG&&this.game.debug.text("Duplicate entity name : "+t+"\n");else{switch(e){case"sheep":f=new a(this.controller,e,t,i,n,d);break;case"zombie":f=new r(this.controller,e,t,i,n,d);break;case"ironGolem":f=new s(this.controller,e,t,i,n,d);break;case"creeper":f=new l(this.controller,e,t,i,n,d);break;case"cow":f=new c(this.controller,e,t,i,n,d);break;case"chicken":f=new u(this.controller,e,t,i,n,d);break;case"ghast":f=new p(this.controller,e,t,i,n,d,h);break;default:f=new o(this.controller,e,t,i,n,d)}this.controller.DEBUG&&console.log("Create Entity type : "+e+" "+i+","+n),this.entityMap.set(t,f)}return f},e.prototype.isSpawnableInBetween=function(e,t,i,n){for(var o=e;o<=i;o++)for(var a=t;a<=n;a++)if(this.controller.levelModel.isPositionEmpty(new d(o,a))[0])return!0;return!1},e.prototype.spawnEntity=function(e,t){var i=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},n=this.controller.levelModel,o=n.planeWidth,a=n.planeHeight;if("middle"===t){if(this.isSpawnableInBetween(Math.floor(.25*o),Math.floor(.25*a),Math.floor(.75*o),Math.floor(.75*a))){for(var r=new d(i(Math.floor(.25*o),Math.floor(.75*o)),i(Math.floor(.25*a),Math.floor(.75*a)));!n.isPositionEmpty(r)[0];)r=new d(i(Math.floor(.25*o),Math.floor(.75*o)),i(Math.floor(.25*a),Math.floor(.75*a)));return this.createEntity(e,this.id++,r.x,r.y,i(0,3))}if(!this.isSpawnableInBetween(1,1,o-2,a-2))return null;for(var s=new d(i(1,o-2),i(1,a-2));!n.isPositionEmpty(s)[0];)s=new d(i(1,o-2),i(1,a-2));return this.createEntity(e,this.id++,s.x,s.y,i(0,3))}if("left"===t){for(var l=0,c=!0;l<o&&c;){c=!0;for(var u=0;u<a;u++)if(n.isPositionEmpty(new d(l,u))[0]){c=!1;break}c&&l++}if(l<o){for(var p=new d(l,i(0,a-1));!n.isPositionEmpty(p)[0];)p=new d(l,i(0,a-1));return this.createEntity(e,this.id++,p.x,p.y,i(0,3))}}else if("right"===t){for(var h=o-1,f=!0;h>-1&&f;){f=!0;for(var g=0;g<a;g++)if(n.isPositionEmpty(new d(h,g))[0]){f=!1;break}f&&h--}if(h>-1){for(var m=new d(h,i(0,a-1));!n.isPositionEmpty(m)[0];)m=new d(h,i(0,a-1));return this.createEntity(e,this.id++,m.x,m.y,i(0,3))}}else if("up"===t){for(var v=0,y=!0;v<a&&y;){y=!0;for(var _=0;_<o;_++)if(n.isPositionEmpty(new d(_,v))[0]){y=!1;break}y&&v++}if(v<a){for(var k=new d(i(0,a-1),v);!n.isPositionEmpty(k)[0];)k=new d(i(0,a-1),v);return this.createEntity(e,this.id++,k.x,k.y,i(0,3))}}else if("down"===t){for(var w=a-1,b=!0;w>-1&&b;){b=!0;for(var C=0;C<o;C++)if(n.isPositionEmpty(new d(C,w))[0]){b=!1;break}b&&w--}if(w>-1){for(var P=new d(i(0,a-1),w);!n.isPositionEmpty(P)[0];)P=new d(i(0,a-1),w);return this.createEntity(e,this.id++,P.x,P.y,i(0,3))}}return null},e.prototype.spawnEntityAt=function(e,t,i,n){return this.createEntity(e,this.id++,t,i,n)},e.prototype.destroyEntity=function(e){if(this.entityMap.has(e)){var t=this.entityMap.get(e);this.entityDeathCount.has(t.type)?this.entityDeathCount.set(t.type,this.entityDeathCount.get(t.type)+1):this.entityDeathCount.set(t.type,1),t.reset(),t.sprite.animations.stop(null,!0),t.sprite.destroy(),this.entityMap.delete(e)}else this.controller.DEBUG&&this.game.debug.text("It's impossible to delete since entity name : "+e+" is not existing\n")},e.prototype.getEntityAt=function(e){var t=!0,i=!1,n=void 0;try{for(var o,a=this.entityMap[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value,s=r[1];if(d.equals(e,s.position))return s}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}return null},e.prototype.getEntitiesOfType=function(e){if("all"===e){var t=[],i=!0,n=!1,o=void 0;try{for(var a,r=this.entityMap[Symbol.iterator]();!(i=(a=r.next()).done);i=!0){var s=a.value,l=s[1];"Player"!==l.type&&t.push(l)}}catch(e){n=!0,o=e}finally{try{!i&&r.return&&r.return()}finally{if(n)throw o}}return t}var c=[],u=!0,p=!1,d=void 0;try{for(var h,f=this.entityMap[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var g=h.value,m=g[1];m.type===e&&c.push(m)}}catch(e){p=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(p)throw d}}return c},e.prototype.reset=function(){this.entityMap.clear(),this.entityDeathCount=new Map},e}()},2719:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794),s=i(1159);e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-43,-55],u.controller.levelView&&(u.prepareSprite(),u.sprite.sortOrder=u.controller.levelView.yToIndex(u.position.y)),u.naked=!1,u}return a(t,e),t.prototype.use=function(e,t){var i=this,n=this.getNakedSuffix()+"lookAtCam"+this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,n),this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenUsed,targetType:i.type,eventSenderIdentifier:t.identifier,targetIdentifier:i.identifier})}),this.queue.endPushHighPriorityCommands(),e.succeeded()},t.prototype.getWalkAnimation=function(){return this.getNakedSuffix()+e.prototype.getWalkAnimation.call(this)},t.prototype.getIdleAnimation=function(){return this.getNakedSuffix()+e.prototype.getIdleAnimation.call(this)},t.prototype.bump=function(e){var t=this,i=this.getNakedSuffix()+"bump",n=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,i+n);var o=this.controller.levelModel.getMoveForwardPosition(this),a=this.controller.levelEntity.getEntityAt(o);null!==a&&(this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenTouched,targetType:t.type,targetIdentifier:t.identifier,eventSenderIdentifier:a.identifier})}),this.queue.endPushHighPriorityCommands()),this.controller.delayPlayerMoveBy(400,800,function(){e.succeeded()})},t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[],o="ShadowSheep_2016";this.sprite=i.create(0,0,"sheep","ShadowSheep_2016001.png");for(var a=["ShadowSheep_2016217.png","ShadowSheep_2016109.png","ShadowSheep_2016001.png","ShadowSheep_2016325.png"],r=[[[252,261],[220,222],[228,231],[276,279],[270,275],[282,293],[294,305],[306,317],[318,323],[234,243],[880,887]],[[144,153],[112,114],[120,123],[168,171],[162,167],[174,185],[186,197],[198,209],[210,215],[126,135],[872,879]],[[36,45],[3,6],[12,15],[60,63],[54,59],[66,77],[78,89],[90,101],[102,108],[18,26],[864,871]],[[360,369],[328,330],[336,339],[384,387],[378,383],[390,401],[402,413],[414,425],[426,431],[342,351],[888,895]]],s=0;s<4;s++){var l=this.controller.levelView.getDirectionName(s);n=Phaser.Animation.generateFrameNames(o,r[s][0][0],r[s][0][1],".png",3);for(var c=0;c<8;c++)n.push(a[s]);this.sprite.animations.add("idle"+l,n,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames(o,r[s][1][0],r[s][1][1],".png",3),this.sprite.animations.add("lookLeft"+l,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.naked?e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2"):e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,r[s][1][1],r[s][1][0],".png",3),this.sprite.animations.add("lookLeft"+l+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][2][0],r[s][2][1],".png",3),this.sprite.animations.add("lookRight"+l,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.naked?e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2"):e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,r[s][2][1],r[s][2][0],".png",3),this.sprite.animations.add("lookRight"+l+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][3][0],r[s][3][1],".png",3),this.sprite.animations.add("lookAtCam"+l,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.naked?e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2"):e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,r[s][3][1],r[s][3][0],".png",3),this.sprite.animations.add("lookAtCam"+l+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][4][0],r[s][4][1],".png",3),this.sprite.animations.add("lookDown"+l,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][5][0],r[s][5][1],".png",3),this.sprite.animations.add("walk"+l,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][6][0],r[s][6][1],".png",3),this.sprite.animations.add("attack"+l,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][7][0],r[s][7][1],".png",3),this.sprite.animations.add("hurt"+l,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[s][8][0],r[s][8][1],".png",3),this.sprite.animations.add("die"+l,n,10,!1),n=this.controller.levelView.generateReverseFrames(o,r[s][9][0],r[s][9][1],".png",3),this.sprite.animations.add("eat"+l,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=this.controller.levelView.generateReverseFrames(o,r[s][10][0],r[s][10][1],".png",3),this.sprite.animations.add("bump"+l,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}r=[[[684,693],[652,654],[660,663],[708,711],[702,707],[714,725],[726,737],[738,749],[750,755],[666,675],[912,919]],[[576,585],[544,546],[552,555],[600,603],[594,599],[606,617],[618,629],[630,641],[642,647],[558,567],[904,911]],[[468,477],[436,438],[444,447],[492,495],[486,491],[498,509],[510,521],[522,533],[534,539],[450,459],[896,903]],[[792,801],[760,762],[768,771],[816,819],[810,815],[822,833],[834,845],[846,857],[858,863],[774,783],[920,927]]],a=["ShadowSheep_2016649.png","ShadowSheep_2016541.png","ShadowSheep_2016433.png","ShadowSheep_2016757.png"];for(var u=0;u<4;u++){var p=this.controller.levelView.getDirectionName(u);n=Phaser.Animation.generateFrameNames(o,r[u][0][0],r[u][0][1],".png",3);for(var d=0;d<8;d++)n.push(a[u]);this.sprite.animations.add("naked_idle"+p,n,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames(o,r[u][1][0],r[u][1][1],".png",3),this.sprite.animations.add("naked_lookLeft"+p,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,r[u][1][1],r[u][1][0],".png",3),this.sprite.animations.add("naked_lookLeft"+p+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[u][2][0],r[u][2][1],".png",3),this.sprite.animations.add("naked_lookRight"+p,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,r[u][2][1],r[u][2][0],".png",3),this.sprite.animations.add("naked_lookRight"+p+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[u][3][0],r[u][3][1],".png",3),this.sprite.animations.add("naked_lookAtCam"+p,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,r[u][3][1],r[u][3][0],".png",3),this.sprite.animations.add("naked_lookAtCam"+p+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[u][4][0],r[u][4][1],".png",3),this.sprite.animations.add("naked_lookDown"+p,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[u][5][0],r[u][5][1],".png",3),this.sprite.animations.add("naked_walk"+p,n,10,!0),n=Phaser.Animation.generateFrameNames(o,r[u][6][0],r[u][6][1],".png",3),this.sprite.animations.add("naked_attack"+p,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[u][7][0],r[u][7][1],".png",3),this.sprite.animations.add("naked_hurt_"+p,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,r[u][8][0],r[u][8][1],".png",3),this.sprite.animations.add("naked_die"+p,n,10,!1),n=this.controller.levelView.generateReverseFrames(o,r[u][9][0],r[u][9][1],".png",3),this.sprite.animations.add("naked_eat"+p,n,10,!1).onComplete.add(function(){e.naked=!1,e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=this.controller.levelView.generateReverseFrames(o,r[u][10][0],r[u][10][1],".png",3),this.sprite.animations.add("naked_bump"+p,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"naked_idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t.prototype.playRandomIdle=function(e){var t,i=this.getNakedSuffix();switch(t=this.controller.levelView.getDirectionName(e),Math.trunc(6*Math.random())+1){case 1:i+="idle";break;case 2:i+="lookLeft";break;case 3:i+="lookRight";break;case 4:i+="lookAtCam";break;case 5:i+="lookDown";break;case 6:i+="eat"}i+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,i),this.controller.printErrorMsg(this.type+" calls animation : "+i+"\n")},t.prototype.attack=function(e){var t=this,i=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.onAnimationEnd(this.controller.levelView.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"attack"+i),function(){var n=t.controller.levelEntity.getEntityAt(t.controller.levelModel.getMoveForwardPosition(t));null!==n&&t.controller.levelView.onAnimationEnd(t.controller.levelView.playScaledSpeed(n.sprite.animations,t.getNakedSuffix()+"hurt"+i),function(){t.controller.events.forEach(function(e){return e({eventType:s.WhenAttacked,targetType:t.type,eventSenderIdentifier:t.identifier,targetIdentifier:n.identifier})})}),e.succeeded()})},t.prototype.updateAnimationDirection=function(){var e=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"idle"+e)},t.prototype.drop=function(t,i){if(this.naked)return!1;if(t&&e.prototype.drop.call(this,t,i),"wool"===i&&(this.naked=!0,this.controller.levelView)){var n=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"naked_idle"+n,function(){})}return!0},t.prototype.takeDamage=function(e){var t=this,i=this.controller.levelView,n=i.getDirectionName(this.facing);this.healthPoint>1?(i.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"hurt"+n),setTimeout(function(){t.healthPoint--,e.succeeded()},1500)):(this.healthPoint--,this.sprite.animations.stop(null,!0),this.controller.levelView.playScaledSpeed(this.sprite.animations,this.getNakedSuffix()+"die"+n),setTimeout(function(){var e=t.controller.levelView.addResettableTween(t.sprite).to({alpha:0},500,Phaser.Easing.Linear.None);e.onComplete.add(function(){t.controller.levelEntity.destroyEntity(t.identifier)}),e.start()},1500))},t.prototype.getNakedSuffix=function(){return this.naked?"naked_":""},t}(r)},2720:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794);e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-43,-45],u.burningSprite=[null,null],u.burningSpriteGhost=[null,null],u.burningSpriteOffset=[47,40],u.prepareSprite(),u}return a(t,e),t.prototype.tick=function(){e.prototype.tick.call(this)},t.prototype.reset=function(){for(var e=0;e<2;e++)this.burningSprite[e]&&this.burningSprite[e].destroy()},t.prototype.playMoveForwardAnimation=function(t,i,n,o){var a=this;e.prototype.playMoveForwardAnimation.call(this,t,i,n,o),this.burningSprite[0].sortOrder=this.sprite.sortOrder+1,this.burningSprite[1].sortOrder=this.sprite.sortOrder-1,setTimeout(function(){for(var e=0;e<2;e++){var i=a.controller.levelView.addResettableTween(a.burningSprite[e]).to({x:a.offset[0]+a.burningSpriteOffset[0]+40*t[0],y:a.offset[1]+a.burningSpriteOffset[1]+40*t[1]},300,Phaser.Easing.Linear.None);i.onComplete.add(function(){}),i.start()}},50/this.controller.tweenTimeScale)},t.prototype.setBurn=function(e){if(e)for(var t=0;t<2;t++)this.burningSprite[t].alpha=1;else for(var i=0;i<2;i++)this.burningSprite[i].alpha=0},t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[];this.sprite=i.create(0,0,"zombie","Zombie_001.png"),this.sprite.sortOrder=this.controller.levelView.yToIndex(this.position.y),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y,this.burningSprite=[i.create(this.sprite.x+this.burningSpriteOffset[0],this.sprite.y+this.burningSpriteOffset[1],"burningInSun","BurningFront_001.png"),i.create(this.sprite.x+this.burningSpriteOffset[0],this.sprite.y+this.burningSpriteOffset[1],"burningInSun","BurningBehind_001.png")],n=Phaser.Animation.generateFrameNames("BurningFront_",1,15,".png",3),this.burningSprite[0].animations.add("burn",n,10,!0),n=Phaser.Animation.generateFrameNames("BurningBehind_",1,15,".png",3),this.burningSprite[1].animations.add("burn",n,10,!0),this.controller.levelView.playScaledSpeed(this.burningSprite[0].animations,"burn"),this.controller.levelView.playScaledSpeed(this.burningSprite[1].animations,"burn"),this.burningSprite[0].sortOrder=this.sprite.sortOrder+1,this.burningSprite[1].sortOrder=this.sprite.sortOrder-1;for(var o=["Zombie_056.png","Zombie_166.png","Zombie_001.png","Zombie_111.png"],a=[[[73,79],[57,59],[61,63],[69,71],[65,67],[80,88],[89,91],[93,101],[102,110],[229,236]],[[183,189],[167,169],[171,173],[179,181],[175,177],[190,198],[199,201],[203,211],[212,220],[245,252]],[[18,24],[2,4],[6,8],[14,16],[10,12],[25,33],[34,36],[38,46],[47,55],[221,228]],[[128,134],[112,114],[116,118],[124,126],[120,122],[135,143],[144,146],[148,156],[158,165],[237,244]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);n=Phaser.Animation.generateFrameNames("Zombie_",a[r][0][0],a[r][0][1],".png",3);for(var l=0;l<8;l++)n.push(o[r]);this.sprite.animations.add("idle"+s,n,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][1][0],a[r][1][1],".png",3),this.sprite.animations.add("lookLeft"+s,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][1][1],a[r][1][0],".png",3),this.sprite.animations.add("lookLeft"+s+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][2][0],a[r][2][1],".png",3),this.sprite.animations.add("lookRight"+s,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][2][1],a[r][2][0],".png",3),this.sprite.animations.add("lookRight"+s+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][3][0],a[r][3][1],".png",3),this.sprite.animations.add("lookAtCam"+s,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][3][1],a[r][3][0],".png",3),this.sprite.animations.add("lookAtCam"+s+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][4][0],a[r][4][1],".png",3),this.sprite.animations.add("lookDown"+s,n,10/3,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][5][0],a[r][5][1],".png",3),this.sprite.animations.add("walk"+s,n,10,!0),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][6][0],a[r][6][1],".png",3),this.sprite.animations.add("attack"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][7][0],a[r][7][1],".png",3),this.sprite.animations.add("hurt"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Zombie_",a[r][8][0],a[r][8][1],".png",3),this.sprite.animations.add("die"+s,n,10,!1),n=this.controller.levelView.generateReverseFrames("Zombie_",a[r][9][0],a[r][9][1],".png",3),this.sprite.animations.add("bump"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.setBurn(this.controller.levelModel.isDaytime)},t.prototype.takeDamage=function(e){var t=this,i=this.controller.levelView,n=i.getDirectionName(this.facing);this.healthPoint>1?(i.playScaledSpeed(this.sprite.animations,"hurt"+n),setTimeout(function(){t.healthPoint--,e.succeeded()},1500/this.controller.tweenTimeScale)):(this.healthPoint--,this.controller.levelView.playScaledSpeed(this.sprite.animations,"die"+n),setTimeout(function(){var e=t.controller.levelView.addResettableTween(t.sprite).to({alpha:0},500,Phaser.Easing.Linear.None);e.onComplete.add(function(){t.controller.levelEntity.destroyEntity(t.identifier)}),e.start();for(var i=0;i<2;i++)e=t.controller.levelView.addResettableTween(t.burningSprite[i]).to({alpha:0},500,Phaser.Easing.Linear.None),e.start()},1500/this.controller.tweenTimeScale))},t}(r)},2721:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794);e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-43,-55],u.prepareSprite(),u.sprite.sortOrder=u.controller.levelView.yToIndex(u.position.y),u}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[],o="Iron_Golem_Anims";this.sprite=i.create(0,0,"ironGolem","Iron_Golem_Anims001.png");for(var a=[[[45,45],[46,48],[50,52],[58,60],[54,56],[62,70],[71,74],[77,81],[82,88],[185,192]],[[133,133],[134,136],[138,140],[146,148],[142,144],[150,158],[159,162],[165,169],[170,176],[201,208]],[[1,1],[2,4],[6,8],[14,16],[10,12],[18,26],[27,30],[33,37],[38,44],[177,184]],[[89,89],[90,92],[94,96],[102,104],[98,100],[106,114],[115,118],[121,125],[126,132],[193,200]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);n=Phaser.Animation.generateFrameNames(o,a[r][0][0],a[r][0][1],".png",3);for(var l=0;l<12;l++)n.push(n[0]);this.sprite.animations.add("idle"+s,n,8,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames(o,a[r][1][0],a[r][1][1],".png",3),this.sprite.animations.add("lookLeft"+s,n,8,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,a[r][1][1],a[r][1][0],".png",3),this.sprite.animations.add("lookLeft"+s+"_2",n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][2][0],a[r][2][1],".png",3),this.sprite.animations.add("lookRight"+s,n,8,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,a[r][2][1],a[r][2][0],".png",3),this.sprite.animations.add("lookRight"+s+"_2",n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][3][0],a[r][3][1],".png",3),this.sprite.animations.add("lookAtCam"+s,n,8,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,a[r][3][1],a[r][3][0],".png",3),this.sprite.animations.add("lookAtCam"+s+"_2",n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][4][0],a[r][4][1],".png",3),this.sprite.animations.add("lookDown"+s,n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookDown_2"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][4][1],a[r][4][0],".png",3),this.sprite.animations.add("lookDown_2"+s,n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][5][0],a[r][5][1],".png",3),this.sprite.animations.add("walk"+s,n,8,!0),n=Phaser.Animation.generateFrameNames(o,a[r][6][0],a[r][6][1],".png",3),this.sprite.animations.add("attack"+s,n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][7][0],a[r][7][1],".png",3),this.sprite.animations.add("hurt"+s,n,16/3,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][8][0],a[r][8][1],".png",3),this.sprite.animations.add("die"+s,n,16/3,!1),n=this.controller.levelView.generateReverseFrames(o,a[r][9][0],a[r][9][1],".png",3),this.sprite.animations.add("bump"+s,n,8,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position[0],this.sprite.y=this.offset[1]+40*this.position[1]},t}(r)},2722:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794);e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-43,-55],u.prepareSprite(),u.sprite.sortOrder=u.controller.levelView.yToIndex(u.position.y),u}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[],o="ShadowCreeper_2016_";this.sprite=i.create(0,0,"creeper","ShadowCreeper_2016_000.png");for(var a=[[[128,128],[128,131],[134,137],[140,143],[146,149],[152,163],[164,167],[164,178],[179,184],[185,191],[272,279]],[[64,64],[64,67],[70,73],[76,89],[82,85],[88,99],[100,103],[100,114],[115,120],[121,127],[264,271]],[[0,0],[0,3],[6,10],[12,16],[18,21],[24,35],[36,39],[36,50],[51,56],[57,63],[256,263]],[[192,192],[192,195],[198,201],[204,207],[210,213],[216,227],[228,231],[228,242],[243,248],[249,255],[280,287]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);n=Phaser.Animation.generateFrameNames(o,a[r][0][0],a[r][0][1],".png",3);for(var l=0;l<12;l++)n.push(n[0]);this.sprite.animations.add("idle"+s,n,10,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames(o,a[r][1][0],a[r][1][1],".png",3),this.sprite.animations.add("lookLeft"+s,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,a[r][1][1],a[r][1][0],".png",3),this.sprite.animations.add("lookLeft"+s+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][2][0],a[r][2][1],".png",3),this.sprite.animations.add("lookRight"+s,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,a[r][2][1],a[r][2][0],".png",3),this.sprite.animations.add("lookRight"+s+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][3][0],a[r][3][1],".png",3),this.sprite.animations.add("lookAtCam"+s,n,10,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames(o,a[r][3][1],a[r][3][0],".png",3),this.sprite.animations.add("lookAtCam"+s+"_2",n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][4][0],a[r][4][1],".png",3),this.sprite.animations.add("lookDown"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookDown_2"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][4][1],a[r][4][0],".png",3),this.sprite.animations.add("lookDown_2"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][5][0],a[r][5][1],".png",3),this.sprite.animations.add("walk"+s,n,10,!0),n=Phaser.Animation.generateFrameNames(o,a[r][6][0],a[r][6][1],".png",3),this.sprite.animations.add("attack"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][7][0],a[r][7][1],".png",3),this.sprite.animations.add("explode"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][8][0],a[r][8][1],".png",3),this.sprite.animations.add("hurt"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames(o,a[r][9][0],a[r][9][1],".png",3),this.sprite.animations.add("die"+s,n,10,!1),n=this.controller.levelView.generateReverseFrames(o,a[r][10][0],a[r][10][1],".png",3),this.sprite.animations.add("bump"+s,n,10,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t}(r)},2723:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794);e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-43,-55],u.prepareSprite(),u.sprite.sortOrder=u.controller.levelView.yToIndex(u.position.y),u}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[];this.sprite=i.create(0,0,"cow","Cow0001.png");for(var o=["Cow0222.png","Cow0111.png","Cow0001.png","Cow0333.png"],a=[[[258,264],[225,227],[224,226],[285,287],[240,241],[291,302],[303,313],[314,326],[327,332],[460,467],[276,282],[240,249]],[[147,153],[114,116],[129,130],[174,176],[129,130],[180,191],[192,202],[203,215],[216,221],[452,459],[165,171],[129,138]],[[36,42],[3,5],[12,14],[63,65],[18,19],[69,80],[81,91],[92,104],[105,110],[444,451],[51,54],[18,27]],[[369,375],[336,338],[335,337],[396,398],[351,352],[402,413],[414,424],[425,437],[438,443],[468,475],[387,393],[351,360]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);n=[];for(var l=0;l<20;l++)n.push(o[r]);this.sprite.animations.add("idle"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle2"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][1][0],a[r][1][1],".png",4),this.sprite.animations.add("lookLeft"+s,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][1][1],a[r][1][0],".png",4),this.sprite.animations.add("lookLeft"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][2][0],a[r][2][1],".png",4),this.sprite.animations.add("lookRight"+s,n,12,!1).onComplete.add(function(){setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][2][1],a[r][2][0],".png",4),this.sprite.animations.add("lookRight"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][3][0],a[r][3][1],".png",4),this.sprite.animations.add("lookAtCam"+s,n,12,!1).onComplete.add(function(){setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][3][1],a[r][3][0],".png",4),this.sprite.animations.add("lookAtCam"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][4][0],a[r][4][1],".png",4),this.sprite.animations.add("lookDown"+s,n,12,!1).onComplete.add(function(){setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookDown"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][4][1],a[r][4][0],".png",4),this.sprite.animations.add("lookDown"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][5][0],a[r][5][1],".png",4),this.sprite.animations.add("walk"+s,n,12,!0),n=Phaser.Animation.generateFrameNames("Cow",a[r][6][0],a[r][6][1],".png",4),this.sprite.animations.add("attack"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][7][0],a[r][7][1],".png",4),this.sprite.animations.add("hurt"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][8][0],a[r][8][1],".png",4),this.sprite.animations.add("die"+s,n,12,!1),n=this.controller.levelView.generateReverseFrames("Cow",a[r][9][0],a[r][9][1],".png",4),this.sprite.animations.add("bump"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),2===r?(n=Phaser.Animation.generateFrameNames("Cow",a[r][10][0],a[r][10][1],".png",4),this.sprite.animations.add("idle2"+s,n,6,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle2"+e.controller.levelView.getDirectionName(e.facing)+"_reverse")}),n=Phaser.Animation.generateFrameNames("Cow",a[r][10][1],a[r][10][0],".png",4),this.sprite.animations.add("idle2"+s+"_reverse",n,6,!1).onComplete.add(function(){e.playRandomIdle(e.facing)})):(n=Phaser.Animation.generateFrameNames("Cow",a[r][10][1],a[r][10][0],".png",4),this.sprite.animations.add("idle2"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle2"+e.controller.levelView.getDirectionName(e.facing)+"_reverse")}),n=Phaser.Animation.generateFrameNames("Cow",a[r][10][0],a[r][10][1],".png",4),this.sprite.animations.add("idle2"+s+"_reverse",n,12,!1).onComplete.add(function(){e.playRandomIdle(e.facing)})),n=Phaser.Animation.generateFrameNames("Cow",a[r][11][0],a[r][11][1],".png",4),this.sprite.animations.add("eat"+s,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"eat"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Cow",a[r][11][1],a[r][11][0],".png",4),this.sprite.animations.add("eat"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t.prototype.playRandomIdle=function(e){var t,i="";switch(t=this.controller.levelView.getDirectionName(e),Math.trunc(5*Math.random())+1){case 1:i+="idle";break;case 2:i+="lookLeft";break;case 3:i+="lookRight";break;case 4:i+="lookAtCam";break;case 5:i+="lookDown"}i+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,i),this.controller.printErrorMsg(this.type+" calls animation : "+i+"\n")},t}(r)},2724:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794);e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-25,-32],u.prepareSprite(),u.sprite.sortOrder=u.controller.levelView.yToIndex(u.position.y),u}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[];this.sprite=i.create(0,0,"chicken","chicken0001.png"),this.sprite.scale.setTo(.75,.75);for(var o=["chicken0222.png","chicken0111.png","chicken0001.png","chicken0333.png"],a=[[[259,275],[225,227],[224,226],[285,287],[276,281],[291,302],[303,313],[314,326],[327,332],[460,467],[240,249]],[[148,164],[114,116],[113,115],[174,176],[165,170],[180,191],[192,202],[203,215],[216,221],[452,459],[129,138]],[[37,53],[3,5],[12,14],[63,65],[54,59],[69,80],[81,91],[92,104],[105,110],[444,451],[18,27]],[[370,386],[336,338],[335,337],[396,398],[387,392],[402,413],[414,424],[425,437],[438,443],[468,475],[351,360]]],r=0;r<4;r++){var s=this.controller.levelView.getDirectionName(r);n=Phaser.Animation.generateFrameNames("chicken",a[r][0][0],a[r][0][1],".png",4);for(var l=0;l<8;l++)n.push(o[r]);this.sprite.animations.add("idle"+s,n,12,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames("chicken",a[r][1][0],a[r][1][1],".png",4),this.sprite.animations.add("lookLeft"+s,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookLeft"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][1][1],a[r][1][0],".png",4),this.sprite.animations.add("lookLeft"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][2][0],a[r][2][1],".png",4),this.sprite.animations.add("lookRight"+s,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookRight"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][2][1],a[r][2][0],".png",4),this.sprite.animations.add("lookRight"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][3][0],a[r][3][1],".png",4),this.sprite.animations.add("lookAtCam"+s,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"lookAtCam"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][3][1],a[r][3][0],".png",4),this.sprite.animations.add("lookAtCam"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][4][0],a[r][4][1],".png",4),this.sprite.animations.add("lookDown"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][5][0],a[r][5][1],".png",4),this.sprite.animations.add("walk"+s,n,12,!0),n=Phaser.Animation.generateFrameNames("chicken",a[r][6][0],a[r][6][1],".png",4),this.sprite.animations.add("attack"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][7][0],a[r][7][1],".png",4),this.sprite.animations.add("hurt"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][8][0],a[r][8][1],".png",4),this.sprite.animations.add("die"+s,n,12,!1),n=this.controller.levelView.generateReverseFrames("chicken",a[r][9][0],a[r][9][1],".png",4),this.sprite.animations.add("bump"+s,n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][10][0],a[r][10][1],".png",4),this.sprite.animations.add("eat"+s,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"eat"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("chicken",a[r][10][1],a[r][10][0],".png",4),this.sprite.animations.add("eat"+s+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t}(r)},2725:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(794),s=i(1272).randomInt;e.exports=function(e){function t(i,a,r,s,l,c){n(this,t);var u=o(this,e.call(this,i,a,r,s,l,c));return u.offset=[-50,-84],u.prepareSprite(),u.sprite.sortOrder=u.controller.levelView.yToIndex(Number.MAX_SAFE_INTEGER),u.audioDelay=15,s<5?u.patrolA():u.patrolB(),u}return a(t,e),t.prototype.prepareSprite=function(){var e=this,t=function(e,t){return 1e3*(Math.random()*(t-e)+e)},i=this.controller.levelView.actionGroup,n=[];this.sprite=i.create(0,0,"ghast","Ghast0000.png"),this.sprite.scale.setTo(1,1);for(var o=[[[72,83],[84,95]],[[48,59],[60,71]],[[24,35],[36,47]],[[0,11],[12,23]]],a=0;a<4;a++){var r=this.controller.levelView.getDirectionName(a);n=Phaser.Animation.generateFrameNames("Ghast",o[a][0][0],o[a][0][1],".png",4);for(var l=s(2,n.length),c=[],u=0;u<l;++u)c.push(n[0]),n.splice(0,1);for(var p=0;p<c.length;++p)n.push(c[p]);for(var d=0;d<0;d++)n.push(n[0]);this.sprite.animations.add("idle"+r,n,12,!1).onComplete.add(function(){e.playRandomIdle(e.facing)}),n=Phaser.Animation.generateFrameNames("Ghast",o[a][1][0],o[a][1][1],".png",4),this.sprite.animations.add("shoot"+r,n,12,!1).onComplete.add(function(){e.sprite.animations.stop(),setTimeout(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"shoot"+e.controller.levelView.getDirectionName(e.facing)+"_2")},t(.2,1))}),n=Phaser.Animation.generateFrameNames("Ghast",o[a][1][1],o[a][1][0],".png",4),this.sprite.animations.add("shoot"+r+"_2",n,12,!1).onComplete.add(function(){e.controller.levelView.playScaledSpeed(e.sprite.animations,"idle"+e.controller.levelView.getDirectionName(e.facing))})}this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+this.controller.levelView.getDirectionName(this.facing)),this.sprite.x=this.offset[0]+40*this.position.x,this.sprite.y=this.offset[1]+40*this.position.y},t.prototype.canMoveThrough=function(){return!0},t.prototype.playRandomIdle=function(e){var t,i="";if(t=this.controller.levelView.getDirectionName(e),i+="idle",i+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,i),this.audioDelay>0)--this.audioDelay;else{this.audioDelay=5;if(0===Math.floor(5*Math.random())){var n=Math.floor(4*Math.random());this.playMoan(n)}}},t.prototype.playMoan=function(e){switch(e){case 0:this.controller.audioPlayer.play("moan2");break;case 1:this.controller.audioPlayer.play("moan3");break;case 2:this.controller.audioPlayer.play("moan6");break;default:this.controller.audioPlayer.play("moan7")}},t.prototype.patrolA=function(){var e,t,i=[Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0];(e=this.controller.levelView.addResettableTween(this.sprite)).to.apply(e,[{y:this.offset[1]+40*this.position.y+80},s(2500,3500)].concat(i)),(t=this.controller.levelView.addResettableTween(this.sprite)).to.apply(t,[{x:this.offset[0]+40*this.position.x+10},s(1500,2e3)].concat(i))},t.prototype.patrolB=function(){var e,t,i=[Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0];(e=this.controller.levelView.addResettableTween(this.sprite)).to.apply(e,[{y:this.offset[1]+40*this.position.y-80},s(2500,3500)].concat(i)),(t=this.controller.levelView.addResettableTween(this.sprite)).to.apply(t,[{x:this.offset[0]+40*this.position.x-10},s(1500,2e3)].concat(i))},t}(r)},2726:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.exports=function(){function e(t){n(this,e),this.controller=t,this.audioPlayer=t.audioPlayer,this.game=t.game,this.assetRoot=t.assetRoot,this.assets={entityShadow:{type:"image",path:this.assetRoot+"images/Character_Shadow.png"},selectionIndicator:{type:"image",path:this.assetRoot+"images/Selection_Indicator.png"},tallGrass:{type:"image",path:this.assetRoot+"images/TallGrass.png"},finishOverlay:{type:"image",path:this.assetRoot+"images/WhiteRect.png"},bed:{type:"image",path:this.assetRoot+"images/Bed.png"},playerSteve:{type:"atlasJSON",pngPath:this.assetRoot+"images/Steve1013.png",jsonPath:this.assetRoot+"images/Steve1013.json"},playerAlex:{type:"atlasJSON",pngPath:this.assetRoot+"images/Alex1013.png",jsonPath:this.assetRoot+"images/Alex1013.json"},playerSteveEvents:{type:"atlasJSON",pngPath:this.assetRoot+"images/Steve_2016.png",jsonPath:this.assetRoot+"images/Steve_2016.json"},playerAlexEvents:{type:"atlasJSON",pngPath:this.assetRoot+"images/DevAlex.png",jsonPath:this.assetRoot+"images/DevAlex.json"},playerAgent:{type:"atlasJSON",pngPath:this.assetRoot+"images/Agent.png",jsonPath:this.assetRoot+"images/Agent.json"},AO:{type:"atlasJSON",pngPath:this.assetRoot+"images/AO.png",jsonPath:this.assetRoot+"images/AO.json"},LavaGlow:{type:"atlasJSON",pngPath:this.assetRoot+"images/LavaGlow.png",jsonPath:this.assetRoot+"images/LavaGlow.json"},WaterAO:{type:"atlasJSON",pngPath:this.assetRoot+"images/WaterAO.png",jsonPath:this.assetRoot+"images/WaterAO.json"},blockShadows:{type:"atlasJSON",pngPath:this.assetRoot+"images/Block_Shadows.png",jsonPath:this.assetRoot+"images/Block_Shadows.json"},undergroundFow:{type:"atlasJSON",pngPath:this.assetRoot+"images/UndergroundFoW.png",jsonPath:this.assetRoot+"images/UndergroundFoW.json"},blocks:{type:"atlasJSON",pngPath:this.assetRoot+"images/Blocks.png",jsonPath:this.assetRoot+"images/Blocks.json"},leavesAcacia:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Acacia_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Acacia_Decay.json"},leavesBirch:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Birch_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Birch_Decay.json"},leavesJungle:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Jungle_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Jungle_Decay.json"},leavesOak:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Oak_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Oak_Decay.json"},leavesSpruce:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Spruce_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Spruce_Decay.json"},leavesSpruceSnowy:{type:"atlasJSON",pngPath:this.assetRoot+"images/Leaves_Spruce_Snowy_Decay.png",jsonPath:this.assetRoot+"images/Leaves_Spruce_Snowy_Decay.json"},sheep:{type:"atlasJSON",pngPath:this.assetRoot+"images/Sheep_2016.png",jsonPath:this.assetRoot+"images/Sheep_2016.json"},crops:{type:"atlasJSON",pngPath:this.assetRoot+"images/Crops.png",jsonPath:this.assetRoot+"images/Crops.json"},torch:{type:"atlasJSON",pngPath:this.assetRoot+"images/Torch.png",jsonPath:this.assetRoot+"images/Torch.json"},destroyOverlay:{type:"atlasJSON",pngPath:this.assetRoot+"images/Destroy_Overlay.png",jsonPath:this.assetRoot+"images/Destroy_Overlay.json"},blockExplode:{type:"atlasJSON",pngPath:this.assetRoot+"images/BlockExplode.png",jsonPath:this.assetRoot+"images/BlockExplode.json"},miningParticles:{type:"atlasJSON",pngPath:this.assetRoot+"images/MiningParticles.png",jsonPath:this.assetRoot+"images/MiningParticles.json"},miniBlocks:{type:"atlasJSON",pngPath:this.assetRoot+"images/Miniblocks.png",jsonPath:this.assetRoot+"images/Miniblocks.json"},lavaPop:{type:"atlasJSON",pngPath:this.assetRoot+"images/LavaPop.png",jsonPath:this.assetRoot+"images/LavaPop.json"},redstoneSparkle:{type:"atlasJSON",pngPath:this.assetRoot+"images/Redstone_Sparkle.png",jsonPath:this.assetRoot+"images/Redstone_Sparkle.json"},fire:{type:"atlasJSON",pngPath:this.assetRoot+"images/Fire.png",jsonPath:this.assetRoot+"images/Fire.json"},bubbles:{type:"atlasJSON",pngPath:this.assetRoot+"images/Bubbles.png",jsonPath:this.assetRoot+"images/Bubbles.json"},explosion:{type:"atlasJSON",pngPath:this.assetRoot+"images/Explosion.png",jsonPath:this.assetRoot+"images/Explosion.json"},door:{type:"atlasJSON",pngPath:this.assetRoot+"images/Door.png",jsonPath:this.assetRoot+"images/Door.json"},doorIron:{type:"atlasJSON",pngPath:this.assetRoot+"images/Door_Iron.png",jsonPath:this.assetRoot+"images/Door_Iron.json"},rails:{type:"atlasJSON",pngPath:this.assetRoot+"images/Rails.png",jsonPath:this.assetRoot+"images/Rails.json"},tnt:{type:"atlasJSON",pngPath:this.assetRoot+"images/TNT.png",jsonPath:this.assetRoot+"images/TNT.json"},burningInSun:{type:"atlasJSON",pngPath:this.assetRoot+"images/BurningInSun.png",jsonPath:this.assetRoot+"images/BurningInSun.json"},zombie:{type:"atlasJSON",pngPath:this.assetRoot+"images/Zombie.png",jsonPath:this.assetRoot+"images/Zombie.json"},ironGolem:{type:"atlasJSON",pngPath:this.assetRoot+"images/Iron_Golem.png",jsonPath:this.assetRoot+"images/Iron_Golem.json"},creeper:{type:"atlasJSON",pngPath:this.assetRoot+"images/Creeper_2016.png",jsonPath:this.assetRoot+"images/Creeper_2016.json"},cow:{type:"atlasJSON",pngPath:this.assetRoot+"images/Cow.png",jsonPath:this.assetRoot+"images/Cow.json"},chicken:{type:"atlasJSON",pngPath:this.assetRoot+"images/Chicken.png",jsonPath:this.assetRoot+"images/Chicken.json"},ghast:{type:"atlasJSON",pngPath:this.assetRoot+"images/Ghast.png",jsonPath:this.assetRoot+"images/Ghast.json"},dig_wood1:{type:"sound",mp3:this.assetRoot+"audio/dig_wood1.mp3",wav:this.assetRoot+"audio/dig_wood1.wav",ogg:this.assetRoot+"audio/dig_wood1.ogg"},stepGrass:{type:"sound",mp3:this.assetRoot+"audio/step_grass1.mp3",wav:this.assetRoot+"audio/step_grass1.wav",ogg:this.assetRoot+"audio/step_grass1.ogg"},stepWood:{type:"sound",mp3:this.assetRoot+"audio/wood2.mp3",ogg:this.assetRoot+"audio/wood2.ogg"},stepStone:{type:"sound",mp3:this.assetRoot+"audio/stone2.mp3",ogg:this.assetRoot+"audio/stone2.ogg"},stepGravel:{type:"sound",mp3:this.assetRoot+"audio/gravel1.mp3",ogg:this.assetRoot+"audio/gravel1.ogg"},stepFarmland:{type:"sound",mp3:this.assetRoot+"audio/cloth4.mp3",ogg:this.assetRoot+"audio/cloth4.ogg"},failure:{type:"sound",mp3:this.assetRoot+"audio/break.mp3",ogg:this.assetRoot+"audio/break.ogg"},success:{type:"sound",mp3:this.assetRoot+"audio/levelup.mp3",ogg:this.assetRoot+"audio/levelup.ogg"},fall:{type:"sound",mp3:this.assetRoot+"audio/fallsmall.mp3",ogg:this.assetRoot+"audio/fallsmall.ogg"},fuse:{type:"sound",mp3:this.assetRoot+"audio/fuse.mp3",ogg:this.assetRoot+"audio/fuse.ogg"},explode:{type:"sound",mp3:this.assetRoot+"audio/explode3.mp3",ogg:this.assetRoot+"audio/explode3.ogg"},placeBlock:{type:"sound",mp3:this.assetRoot+"audio/cloth1.mp3",ogg:this.assetRoot+"audio/cloth1.ogg"},collectedBlock:{type:"sound",mp3:this.assetRoot+"audio/pop.mp3",ogg:this.assetRoot+"audio/pop.ogg"},bump:{type:"sound",mp3:this.assetRoot+"audio/hit3.mp3",ogg:this.assetRoot+"audio/hit3.ogg"},punch:{type:"sound",mp3:this.assetRoot+"audio/cloth1.mp3",ogg:this.assetRoot+"audio/cloth1.ogg"},fizz:{type:"sound",mp3:this.assetRoot+"audio/fizz.mp3",ogg:this.assetRoot+"audio/fizz.ogg"},doorOpen:{type:"sound",mp3:this.assetRoot+"audio/door_open.mp3",ogg:this.assetRoot+"audio/door_open.ogg"},houseSuccess:{type:"sound",mp3:this.assetRoot+"audio/launch1.mp3",ogg:this.assetRoot+"audio/launch1.ogg"},minecart:{type:"sound",mp3:this.assetRoot+"audio/minecartBase.mp3",ogg:this.assetRoot+"audio/minecartBase.ogg"},sheepBaa:{type:"sound",mp3:this.assetRoot+"audio/say3.mp3",ogg:this.assetRoot+"audio/say3.ogg"},chickenHurt:{type:"sound",mp3:this.assetRoot+"audio/chickenhurt2.mp3",ogg:this.assetRoot+"audio/chickenhurt2.ogg"},chickenBawk:{type:"sound",mp3:this.assetRoot+"audio/chickensay3.mp3",ogg:this.assetRoot+"audio/chickensay3.ogg"},cowHuff:{type:"sound",mp3:this.assetRoot+"audio/cowhuff.mp3",ogg:this.assetRoot+"audio/cowhuff.ogg"},cowHurt:{type:"sound",mp3:this.assetRoot+"audio/cowhurt.mp3",ogg:this.assetRoot+"audio/cowhurt.ogg"},cowMoo:{type:"sound",mp3:this.assetRoot+"audio/cowmoo1.mp3",ogg:this.assetRoot+"audio/cowmoo1.ogg"},cowMooLong:{type:"sound",mp3:this.assetRoot+"audio/cowmoolong.mp3",ogg:this.assetRoot+"audio/cowmoolong.ogg"},creeperHiss:{type:"sound",mp3:this.assetRoot+"audio/creeper.mp3",ogg:this.assetRoot+"audio/creeper.ogg"},ironGolemHit:{type:"sound",mp3:this.assetRoot+"audio/irongolemhit.mp3",ogg:this.assetRoot+"audio/irongolemhit.ogg"},metalWhack:{type:"sound",mp3:this.assetRoot+"audio/metalwhack.mp3",ogg:this.assetRoot+"audio/metalwhack.ogg"},zombieBrains:{type:"sound",mp3:this.assetRoot+"audio/zombiebrains.mp3",ogg:this.assetRoot+"audio/zombiebrains.ogg"},zombieGroan:{type:"sound",mp3:this.assetRoot+"audio/zombiegroan.mp3",ogg:this.assetRoot+"audio/zombiegroan.ogg"},zombieHurt:{type:"sound",mp3:this.assetRoot+"audio/zombiehurt1.mp3",ogg:this.assetRoot+"audio/zombiehurt1.ogg"},pistonIn:{type:"sound",mp3:this.assetRoot+"audio/piston_in.mp3",ogg:this.assetRoot+"audio/piston_in.ogg"},zombieHurt2:{type:"sound",mp3:this.assetRoot+"audio/zombiehurt2.mp3",ogg:this.assetRoot+"audio/zombiehurt2.ogg"},pistonOut:{type:"sound",mp3:this.assetRoot+"audio/piston_out.mp3",ogg:this.assetRoot+"audio/piston_out.ogg"},portalAmbient:{type:"sound",mp3:this.assetRoot+"audio/portal.mp3",ogg:this.assetRoot+"audio/portal.ogg"},portalTravel:{type:"sound",mp3:this.assetRoot+"audio/travel_portal.mp3",ogg:this.assetRoot+"audio/travel_portal.ogg"},pressurePlateClick:{type:"sound",mp3:this.assetRoot+"audio/pressurePlateClick.mp3",ogg:this.assetRoot+"audio/pressurePlateClick.ogg"},moan2:{type:"sound",mp3:this.assetRoot+"audio/moan2.mp3",ogg:this.assetRoot+"audio/moan2.ogg"},moan3:{type:"sound",mp3:this.assetRoot+"audio/moan3.mp3",ogg:this.assetRoot+"audio/moan3.ogg"},moan6:{type:"sound",mp3:this.assetRoot+"audio/moan6.mp3",ogg:this.assetRoot+"audio/moan6.ogg"},moan7:{type:"sound",mp3:this.assetRoot+"audio/moan7.mp3",ogg:this.assetRoot+"audio/moan7.ogg"}};var i=["dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","minecart","sheepBaa","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","ironGolemHit","metalWhack","zombieBrains","zombieGroan","zombieHurt","pistonIn","pistonOut","portalAmbient","portalTravel","pressurePlateClick","moan2","moan3","moan6","moan7"],o=["chicken","entityShadow","selectionIndicator","AO","blockShadows","tallGrass","blocks","miniBlocks","stepGrass","failure","success"].concat(i);this.assetPacks={adventurerLevelOneAssets:["entityShadow","selectionIndicator","AO","blockShadows","leavesOak","leavesBirch","tallGrass","blocks","sheep","bump","stepGrass","failure","success"],adventurerLevelTwoAssets:["entityShadow","selectionIndicator","AO","blockShadows","leavesSpruce","tallGrass","blocks","sheep","bump","stepGrass","failure","playerSteve","success","miniBlocks","blockExplode","miningParticles","destroyOverlay","dig_wood1","collectedBlock","punch"],adventurerLevelThreeAssets:["entityShadow","selectionIndicator","AO","blockShadows","leavesOak","tallGrass","blocks","sheep","bump","stepGrass","failure","playerSteve","success","miniBlocks","blockExplode","miningParticles","destroyOverlay","dig_wood1","collectedBlock","sheepBaa","punch"],adventurerAllAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesOak","leavesSpruce","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","fire","bubbles","explosion","door","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa"],levelOneAssets:o,levelTwoAssets:o,levelThreeAssets:o,designerAllAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesJungle","leavesOak","leavesSpruce","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","fire","bubbles","explosion","door","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa","zombie","cow","chicken","ironGolem","burningInSun","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","ironGolemHit","metalWhack","zombieBrains","zombieGroan","zombieHurt","zombieHurt2"],heroAllAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesOak","leavesSpruce","leavesSpruceSnowy","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","redstoneSparkle","fire","bubbles","explosion","door","doorIron","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa","zombie","cow","chicken","burningInSun","ghast","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","metalWhack","zombieBrains","zombieGroan","zombieHurt","zombieHurt2","pistonIn","pistonOut","portalAmbient","portalTravel","pressurePlateClick","moan2","moan3","moan6","moan7"],allAssetsMinusPlayer:["entityShadow","selectionIndicator","tallGrass","finishOverlay","bed","AO","LavaGlow","WaterAO","blockShadows","undergroundFow","blocks","leavesAcacia","leavesBirch","leavesJungle","leavesOak","leavesSpruce","leavesSpruceSnowy","sheep","creeper","crops","torch","destroyOverlay","blockExplode","miningParticles","miniBlocks","lavaPop","redstoneSparkle","fire","bubbles","explosion","door","doorIron","rails","tnt","dig_wood1","stepGrass","stepWood","stepStone","stepGravel","stepFarmland","failure","success","fall","fuse","explode","placeBlock","collectedBlock","bump","punch","fizz","doorOpen","houseSuccess","minecart","sheepBaa","zombie","cow","chicken","ghast","ironGolem","burningInSun","chickenHurt","chickenBawk","cowHuff","cowHurt","cowMoo","cowMooLong","creeperHiss","ironGolemHit","metalWhack","zombieBrains","zombieGroan","zombieHurt","zombieHurt2","pistonIn","pistonOut","portalAmbient","portalTravel","pressurePlateClick","moan2","moan3","moan6","moan7"],playerSteve:["playerSteve"],playerAlex:["playerAlex"],playerSteveEvents:["playerSteveEvents"],playerAlexEvents:["playerAlexEvents"],playerAgent:["playerAgent"],grass:["tallGrass"]}}return e.prototype.loadPacks=function(e){var t=this;e.forEach(function(e){t.loadPack(e)})},e.prototype.loadPack=function(e){var t=this.assetPacks[e];this.loadAssets(t)},e.prototype.loadAssets=function(e){var t=this;e.forEach(function(e){var i=t.assets[e];t.loadAsset(e,i)})},e.prototype.loadAsset=function(e,t){switch(t.type){case"image":this.game.load.image(e,t.path);break;case"sound":this.audioPlayer.register({id:e,mp3:t.mp3,ogg:t.ogg});break;case"atlasJSON":this.game.load.atlasJSONHash(e,t.pngPath,t.jsonPath);break;default:throw"Asset "+e+" needs config.type set in configuration."}},e}()},2727:function(e,t,i){"use strict";var n=i(2728),o=i(2729),a=i(2730),r=i(2731),s=i(2732),l=i(2733),c=i(2734),u=i(2735),p=i(1016),d=i(2736);e.exports.get=function(e){return{startCommandCollection:function(){e.DEBUG&&console.log("Collecting commands.")},startAttempt:function(t){e.OnCompleteCallback=t,e.setPlayerActionDelayByQueueLength(),e.queue.begin(),e.run(),e.attemptRunning=!0,e.resultReported=!1},resetAttempt:function(){e.reset(),e.queue.reset(),e.OnCompleteCallback=null,e.attemptRunning=!1},registerEventCallback:function(t,i){e.events.push(i)},onEventTriggered:function(e,t,i,n){this.registerEventCallback(e,function(e){e.eventType===i&&e.targetType===t&&n(e)})},isEventTriggered:function(e,t){return e.eventType===t},moveDirection:function(t,i,n){e.addCommand(new l(e,t,i,n),i)},moveForward:function(t,i){e.addCommand(new r(e,t,i),i)},moveBackward:function(t,i){e.addCommand(new s(e,t,i),i)},moveAway:function(t,i,n){var o=new p(e,t,function(){e.moveAway(o,n)},i);e.addCommand(o)},moveToward:function(t,i,n){var o=new p(e,t,function(){e.moveToward(o,n)},i);e.addCommand(o)},flashEntity:function(t,i){var n=new p(e,t,function(){e.flashEntity(n)},i);e.addCommand(n)},explodeEntity:function(t,i){var n=new p(e,t,function(){e.explodeEntity(n)},i);e.addCommand(n)},use:function(t,i){var n=new p(e,t,function(){e.use(n,i)},i);e.addCommand(n)},playSound:function(t,i,n){var o=new p(e,t,function(){e.playSound(o,i)},n);e.addCommand(o)},turn:function(t,i,n){var o=new p(e,t,function(){e.turn(o,"right"===i?1:-1)},n);e.addCommand(o)},turnRandom:function(t,i){var n=new p(e,t,function(){e.turnRandom(n)},i);e.addCommand(n)},turnRight:function(e,t){this.turn(e,"right",t)},turnLeft:function(e,t){this.turn(e,"left",t)},destroyBlock:function(t,i){var n=new p(e,t,function(){e.destroyBlock(n)},i);e.addCommand(n)},placeBlock:function(t,i,o){e.addCommand(new n(e,t,i,o),o)},placeDirection:function(t,i,n,o){e.addCommand(new a(e,t,i,n,o),n,o)},placeInFront:function(t,i,n){e.addCommand(new o(e,t,i,n),n)},tillSoil:function(t,i){e.addCommand(new o(e,t,"watering",i))},whilePathAhead:function(t,i,n,o){e.addCommand(new c(e,t,i,n,o),n)},ifBlockAhead:function(t,i,n,o){e.addCommand(new u(e,t,i,n,o),n)},repeat:function(t,i,n,o){e.addCommand(new d(e,t,i,n,o))},repeatRandom:function(t,i,n){var o=Math.floor(10*Math.random())+1;e.addCommand(new d(e,t,i,o,n))},getScreenshot:function(){return e.getScreenshot()},spawnEntity:function(t,i,n){var o=new p(e,t,function(){e.spawnEntity(o,i,n)});e.addCommand(o)},destroyEntity:function(t,i){var n=new p(e,t,function(){e.destroyEntity(n,i)},i);e.addGlobalCommand(n)},drop:function(t,i,n){var o=new p(e,t,function(){e.drop(o,i)},n);e.addCommand(o)},startDay:function(t){var i=new p(e,t,function(){e.startDay(i)});e.addGlobalCommand(i)},startNight:function(t){var i=new p(e,t,function(){e.startNight(i)});e.addGlobalCommand(i)},wait:function(t,i,n){var o=new p(e,t,function(){e.wait(o,i)},n);e.addGlobalCommand(o)},attack:function(t,i){var n=new p(e,t,function(){e.attack(n)},i);e.addCommand(n)},setDayNightCycle:function(t,i,n){e.dayNightCycle||(e.dayNightCycle=!0,e.initiateDayNightCycle(t,i,n))},addScore:function(t,i,n){var o=new p(e,t,function(){e.addScore(o,i)},n);e.addGlobalCommand(o)},arrowDown:function(t){e.arrowDown(t)},arrowUp:function(t){e.arrowUp(t)},clickDown:function(){e.clickDown()},clickUp:function(){e.clickUp()}}}},2728:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r,s){n(this,t);var l=o(this,e.call(this,i,a,s));return l.BlockType=r,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.placeBlock(this,this.BlockType)},t}(r)},2729:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r,s){n(this,t);var l=o(this,e.call(this,i,a,s));return l.BlockType=r,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.placeBlockForward(this,this.BlockType)},t}(r)},2730:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r,s,l){n(this,t);var c=o(this,e.call(this,i,a,s));return c.BlockType=r,c.Direction=l,c}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.placeBlockDirection(this,this.BlockType,this.Direction)},t}(r)},2731:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r){return n(this,t),o(this,e.call(this,i,a,r))}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.moveForward(this)},t}(r)},2732:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r){return n(this,t),o(this,e.call(this,i,a,r))}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.moveBackward(this)},t}(r)},2733:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r,s){n(this,t);var l=o(this,e.call(this,i,a,r,s));return l.Direciton=s,l}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.moveDirection(this,this.Direciton)},t}(r)},2734:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(1270),s=i(1269),l=i(793);e.exports=function(e){function t(i,a,r,l,c){n(this,t);var u=o(this,e.call(this,i,a,l));return u.iterationsLeft=15,u.BlockType=r,u.WhileCode=c,u.queue=new s(i),u}return a(t,e),t.prototype.tick=function(){this.state===r.WORKING&&this.queue.tick(),this.queue.isFailed()&&(this.state=r.FAILURE),this.queue.isSucceeded()&&this.handleWhileCheck()},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.DEBUG&&console.log("WHILE command: BEGIN"),this.handleWhileCheck()},t.prototype.handleWhileCheck=function(){this.iterationsLeft<=0&&(this.state=r.FAILURE),this.GameController.isPathAhead(this.BlockType)?(this.queue.reset(),this.GameController.queue.setWhileCommandInsertState(this.queue),this.WhileCode(),this.GameController.queue.setWhileCommandInsertState(null),this.queue.begin()):this.state=r.SUCCESS,this.iterationsLeft--,this.GameController.DEBUG&&console.log("While command: Iterationsleft   "+this.iterationsLeft+" ")},t}(l)},2735:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(1270),s=i(1269),l=i(793);e.exports=function(e){function t(i,a,r,l,c){n(this,t);var u=o(this,e.call(this,i,a,l));return u.blockType=r,u.ifCodeCallback=c,u.queue=new s(i),u}return a(t,e),t.prototype.tick=function(){this.state===r.WORKING&&this.queue.tick(),this.queue.isFailed()&&(this.state=r.FAILURE),this.queue.isSucceeded()&&(this.state=r.SUCCESS)},t.prototype.begin=function(){e.prototype.begin.call(this),this.GameController.DEBUG&&console.log("WHILE command: BEGIN"),this.handleIfCheck()},t.prototype.handleIfCheck=function(){if(this.GameController.isPathAhead(this.blockType)){var e=this.GameController.getEntity(this.target).queue;this.queue.reset(),e.setWhileCommandInsertState(this.queue),this.ifCodeCallback(),e.setWhileCommandInsertState(null),this.queue.begin()}else this.state=r.SUCCESS},t}(l)},2736:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=i(793);e.exports=function(e){function t(i,a,r,s,l){n(this,t);var c=o(this,e.call(this,i,a,l));return c.actionCallback=r,c.iteration=s,c}return a(t,e),t.prototype.tick=function(){},t.prototype.begin=function(){e.prototype.begin.call(this),this.succeeded(),this.addRepeatCommand()},t.prototype.addRepeatCommand=function(){var e=this.GameController.levelEntity.entityMap.get(this.target);void 0===e?this.GameController.queue.addRepeatCommands(this.actionCallback,this.iteration):e.queue.addRepeatCommands(this.actionCallback,this.iteration)},t}(r)},2737:function(e,t,i){"use strict";var n=i(744);t.load=function(e,t){return n.load(e,t)}},2739:function(e,t,i){"use strict";var n=i(744);t.load=function(e,t){return n.load(e,t)}},2740:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(1),a=n(o),r=i(1737),s=n(r),l=i(788),c=n(l),u=i(40),p=i(819).default,d=i(824),h=function(e){return a.default.createElement("span",null,a.default.createElement(c.default,null,a.default.createElement("div",{id:"minecraft-frame"},a.default.createElement("div",{id:"phaser-game"}))),a.default.createElement(p,null,a.default.createElement(s.default,null),e.showFinishButton&&a.default.createElement("div",{id:"right-button-cell"},a.default.createElement("button",{id:"finishButton",className:"share mc-share-button"},a.default.createElement("div",null,u.finish())))),a.default.createElement(d,null))};h.propTypes={showFinishButton:o.PropTypes.bool.isRequired},e.exports=h},2741:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectLetsGetStarted() %></h1>\n\n<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',__filename="src/craft/agent/dialogs/playerSelection.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(1955);__append('\n<h1 class="minecraft-big-yellow-header" id="getting-started-header">'),__line=2,__append(escape(i18n.playerSelectLetsGetStarted())),__append('</h1>\n\n<h2 id="select-character-text">'),__line=4,__append(escape(i18n.playerSelectChooseCharacter())),__append('</h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select">'),__line=10,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select">'),__line=15,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n'),__line=20}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectLetsGetStarted() %></h1>\n\n<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',"src/craft/agent/dialogs/playerSelection.html.ejs",__line)}}},2742:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(744),a=n(o),r=i(2131),s=n(r);t.load=function(e,t){var i=a.default.load(e,t);return i.replaceInstructions=function(e){return e?e.replace(/{currentPlayerName}/g,s.default.getCurrentCharacter()):e},i.instructions2ImageSubstitutions={agent:"/blockly/media/craft/instructions/agent.png",NetherPortal:"/blockly/media/craft/instructions/NetherPortal.png",PressurePlate_Up:"/blockly/media/craft/instructions/PressurePlate_Up.png",Rails_Vertical:"/blockly/media/craft/instructions/Rails_Vertical.png",cactus:"/blockly/media/craft/instructions/cactus.png",door_iron:"/blockly/media/craft/instructions/door_iron.png",book_enchanted:"/blockly/media/craft/instructions/book_enchanted.png",compass:"/blockly/media/craft/instructions/compass.png",diamond_axe:"/blockly/media/craft/instructions/diamond_axe.png",diamond_pickaxe:"/blockly/media/craft/instructions/diamond_pickaxe.png",diamond_shovel:"/blockly/media/craft/instructions/diamond_shovel.png",flint_and_steel:"/blockly/media/craft/instructions/flint_and_steel.png",flint:"/blockly/media/craft/instructions/flint.png",map_empty:"/blockly/media/craft/instructions/map_empty.png",chest:"/blockly/media/craft/instructions/chest.png",bucket_empty:"/blockly/media/craft/instructions/bucket_empty.png",redstone_torch:"/blockly/media/craft/instructions/redstone_torch.png",minecart_normal:"/blockly/media/craft/instructions/minecart_normal.png"},i}},2744:function(e,t,i){"use strict";var n=i(744);t.load=function(e,t){return n.load(e,t)}},3032:function(e,t,i){i(151),i(152),e.exports=i(3033)},3033:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(3034),a=n(o);(0,n(i(820)).default)().then(a.default)},3034:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e){e.nativeVizWidth=434,e.vizAspectRatio=434/477,e.maxVisualizationWidth=600,e.level.isConnectionLevel?(window.Craft=O.default,e.skinsModule=V.default,e.blocksModule=L,(0,s.default)(window.Craft,x.default,e)):e.level.isAgentLevel?(window.Craft=S.default,e.skinsModule=R.default,e.blocksModule=T,(0,s.default)(window.Craft,M.default,e)):e.level.isEventLevel?(window.Craft=v.default,e.skinsModule=C.default,e.blocksModule=_,(0,s.default)(window.Craft,w.default,e)):(window.Craft=c.default,e.skinsModule=g.default,e.blocksModule=p.default,(0,s.default)(window.Craft,h.default,e))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=i(853),s=o(r),l=i(3035),c=o(l),u=i(2886),p=o(u),d=i(3041),h=o(d),f=i(2737),g=o(f),m=i(3042),v=o(m),y=i(2738),_=n(y),k=i(3046),w=o(k),b=i(2739),C=o(b),P=i(2131),S=o(P),A=i(2887),T=n(A),E=i(3047),M=o(E),B=i(2742),R=o(B),D=i(3048),O=o(D),I=i(2889),L=n(I),F=i(3054),x=o(F),N=i(2744),V=o(N);e.exports=t.default},3035:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function trySetLocalStorageItem(e,t){try{window.localStorage.setItem(e,t)}catch(t){console&&console.log&&console.log("Couldn't set local storage item for key "+e)}}var _jquery=__webpack_require__(35),_jquery2=_interopRequireDefault(_jquery),_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(32),_reactDom2=_interopRequireDefault(_reactDom),_trackEvent=__webpack_require__(601),_trackEvent2=_interopRequireDefault(_trackEvent),_CustomMarshalingInterpreter=__webpack_require__(850),_CustomMarshalingInterpreter2=_interopRequireDefault(_CustomMarshalingInterpreter),_GameController=__webpack_require__(1952),_GameController2=_interopRequireDefault(_GameController),_EventType=__webpack_require__(1159),_EventType2=_interopRequireDefault(_EventType),_Utils=__webpack_require__(1272),_redux=__webpack_require__(237),_Sounds=__webpack_require__(764),_Sounds2=_interopRequireDefault(_Sounds),_constants=__webpack_require__(216),_thumbnail=__webpack_require__(1158),_progressRedux=__webpack_require__(498),studioApp=__webpack_require__(597).singleton,craftMsg=__webpack_require__(1953),dom=__webpack_require__(594),houseLevels=__webpack_require__(3036),levelbuilderOverrides=__webpack_require__(3037),MusicController=__webpack_require__(1954),Provider=__webpack_require__(53).Provider,AppView=__webpack_require__(944),CraftVisualizationColumn=__webpack_require__(3038),MEDIA_URL="/blockly/media/craft/",Craft=module.exports,characters={Steve:{name:"Steve",staticAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Steve_Neutral.png",smallStaticAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Steve_Neutral.png",failureAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Steve_Fail.png",winAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Steve_Win.png"},Alex:{name:"Alex",staticAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Alex_Neutral.png",smallStaticAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Alex_Neutral.png",failureAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Alex_Fail.png",winAvatar:MEDIA_URL+"Sliced_Parts/Pop_Up_Character_Alex_Win.png"}},interfaceImages={DEFAULT:[MEDIA_URL+"Sliced_Parts/MC_Loading_Spinner.gif",MEDIA_URL+"Sliced_Parts/Frame_Large_Plus_Logo.png",MEDIA_URL+"Sliced_Parts/Pop_Up_Slice.png",MEDIA_URL+"Sliced_Parts/X_Button.png",MEDIA_URL+"Sliced_Parts/Button_Grey_Slice.png",MEDIA_URL+"Sliced_Parts/Run_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Run_Arrow_Icon_Smaller.png",MEDIA_URL+"Sliced_Parts/Run_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Reset_Arrow_Icon.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Callout_Tail.png"],1:[MEDIA_URL+"Sliced_Parts/Steve_Character_Select.png",MEDIA_URL+"Sliced_Parts/Alex_Character_Select.png",characters.Steve.staticAvatar,characters.Steve.smallStaticAvatar,characters.Alex.staticAvatar,characters.Alex.smallStaticAvatar],2:[characters.Alex.winAvatar,characters.Steve.winAvatar,characters.Alex.failureAvatar,characters.Steve.failureAvatar],6:[MEDIA_URL+"Sliced_Parts/House_Option_A_v3.png",MEDIA_URL+"Sliced_Parts/House_Option_B_v3.png",MEDIA_URL+"Sliced_Parts/House_Option_C_v3.png"]},MUSIC_METADATA=[{volume:1,hasOgg:!0,name:"vignette1"},{volume:1,hasOgg:!0,name:"vignette2-quiet"},{volume:1,hasOgg:!0,name:"vignette3"},{volume:1,hasOgg:!0,name:"vignette4-intro"},{volume:1,hasOgg:!0,name:"vignette5-shortpiano"},{volume:1,hasOgg:!0,name:"vignette7-funky-chirps-short"},{volume:1,hasOgg:!0,name:"vignette8-free-play"}],CHARACTER_STEVE="Steve",CHARACTER_ALEX="Alex",DEFAULT_CHARACTER=CHARACTER_STEVE;Craft.init=function(e){1===e.level.puzzle_number&&1===e.level.stage_total&&(e.level.puzzle_number=999),e.level.isTestLevel&&(e.level.customSlowMotion=.1),e.level.disableFinalStageMessage=!0;var t=function(){return document.documentMode}();t&&(0,_jquery2.default)("body").addClass("ieVersion"+t);var i=document.body;i.className=i.className+" minecraft",e.level.afterVideoBeforeInstructionsFn=function(t){Craft.beginBackgroundMusic(),e.level.showPopupOnLoad?"playerSelection"===e.level.showPopupOnLoad?Craft.showPlayerSelectionPopup(function(i){(0,_trackEvent2.default)("Minecraft","ChoseCharacter",i),Craft.clearPlayerState(),trySetLocalStorageItem("craftSelectedPlayer",i),Craft.updateUIForCharacter(i),Craft.initializeAppLevel(e.level),t()}):"houseLayoutSelection"===e.level.showPopupOnLoad&&Craft.showHouseSelectionPopup(function(i){(0,_trackEvent2.default)("Minecraft","ChoseHouse",i),a.edit_blocks||(Object.assign(e.level,houseLevels[i]),Blockly.mainBlockSpace.clear(),studioApp().setStartBlocks_(e,!0)),Craft.initializeAppLevel(e.level);var n=document.createEvent("Event");n.initEvent("houseLayoutSelected",!0,!0),document.dispatchEvent(n),t()}):t()},e.level.puzzle_number&&levelbuilderOverrides[e.level.puzzle_number]&&Object.assign(e.level,levelbuilderOverrides[e.level.puzzle_number]),Craft.initialConfig=e,studioApp().reset=this.reset.bind(this),studioApp().runButtonClick=this.runButtonClick.bind(this),Craft.level=e.level,Craft.skin=e.skin;var n=[];Craft.level.songs&&MUSIC_METADATA&&(n=MUSIC_METADATA.filter(function(e){return-1!==Craft.level.songs.indexOf(e.name)})),Craft.musicController=new MusicController(_Sounds2.default.getSingleton(),function(t){return e.skin.assetUrl("music/"+t)},n,n.length>1?7500:null),Craft.beginBackgroundMusic=function(){_Sounds2.default.getSingleton().whenAudioUnlocked(function(){var e=Craft.level.songs&&Craft.level.songs.length>1,t=e?Craft.level.songs[0]:null;Craft.musicController.play(t)})};var o=characters[Craft.getCurrentCharacter()];e.skin.staticAvatar=o.staticAvatar,e.skin.smallStaticAvatar=o.smallStaticAvatar,e.skin.failureAvatar=o.failureAvatar,e.skin.winAvatar=o.winAvatar;var a=e.level;switch(a.specialLevelType){case"houseWallBuild":a.blocksToStore=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","houseBottomA","houseBottomB","houseBottomC","houseBottomD","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}var r=function(){studioApp().init(Object.assign({},e,{forceInsertTopBlock:"when_run",appStrings:{generatedCodeDescription:craftMsg.generatedCodeDescription()},loadAudio:function(){},afterInject:function(){var t=parseFloat((location.search.split("customSlowMotion=")[1]||"").split("&")[0]);if(Craft.gameController=new _GameController2.default({Phaser:window.Phaser,containerId:"phaser-game",assetRoot:Craft.skin.assetUrl(""),audioPlayer:{register:studioApp().registerAudio.bind(studioApp()),play:studioApp().playAudio.bind(studioApp())},debug:!1,customSlowMotion:e.level.isTestLevel?.5:t,earlyLoadAssetPacks:Craft.earlyLoadAssetsForLevel(a.puzzle_number),afterAssetsLoaded:function(){Craft.musicController.preload()},earlyLoadNiceToHaveAssetPacks:Craft.niceToHaveAssetsForLevel(a.puzzle_number)}),e.level.showPopupOnLoad||Craft.initializeAppLevel(e.level),studioApp().hideSource){document.getElementById("visualizationColumn").style.width=this.nativeVizWidth+"px"}},twitter:{text:"Share on Twitter",hashtag:"Craft"}}));var t=[];t=t.concat(interfaceImages.DEFAULT),e.level.puzzle_number&&interfaceImages[e.level.puzzle_number]&&(t=t.concat(interfaceImages[e.level.puzzle_number])),t.forEach(function(e){preloadImage(e)});var i=(0,_jquery2.default)(".mc-share-button");i.length&&dom.addClickTouchEvent(i[0],function(){Craft.reportResult(!0)})};studioApp().setPageConstants(e,{isMinecraft:!0}),_reactDom2.default.render(_react2.default.createElement(Provider,{store:(0,_redux.getStore)()},_react2.default.createElement(AppView,{visualizationColumn:_react2.default.createElement(CraftVisualizationColumn,{showFinishButton:!e.level.isProjectLevel}),onMount:r})),document.getElementById(e.containerId))};var preloadImage=function(e){(new Image).src=e};Craft.characterAssetPackName=function(e){return"player"+e},Craft.getCurrentCharacter=function(){return window.localStorage.getItem("craftSelectedPlayer")||DEFAULT_CHARACTER},Craft.updateUIForCharacter=function(e){Craft.initialConfig.skin.staticAvatar=characters[e].staticAvatar,Craft.initialConfig.skin.smallStaticAvatar=characters[e].smallStaticAvatar,Craft.initialConfig.skin.failureAvatar=characters[e].failureAvatar,Craft.initialConfig.skin.winAvatar=characters[e].winAvatar,studioApp().setIconsFromSkin(Craft.initialConfig.skin),(0,_jquery2.default)("#prompt-icon").attr("src",characters[e].smallStaticAvatar)},Craft.showPlayerSelectionPopup=function(e){var t=DEFAULT_CHARACTER,i=document.createElement("div");i.innerHTML=__webpack_require__(3039)({image:studioApp().assetUrl()});var n=studioApp().createModalDialog({contentDiv:i,defaultBtnSelector:"#choose-steve",onHidden:function(){e(t)},id:"craft-popup-player-selection"});dom.addClickTouchEvent((0,_jquery2.default)("#close-character-select")[0],function(){n.hide()}.bind(this)),dom.addClickTouchEvent((0,_jquery2.default)("#choose-steve")[0],function(){t=CHARACTER_STEVE,(0,_trackEvent2.default)("Minecraft","ClickedCharacter",t),n.hide()}.bind(this)),dom.addClickTouchEvent((0,_jquery2.default)("#choose-alex")[0],function(){t=CHARACTER_ALEX,(0,_trackEvent2.default)("Minecraft","ClickedCharacter",t),n.hide()}.bind(this)),n.show()},Craft.showHouseSelectionPopup=function(e){var t=document.createElement("div");t.innerHTML=__webpack_require__(3040)({image:studioApp().assetUrl()});var i="houseA",n=studioApp().createModalDialog({contentDiv:t,defaultBtnSelector:"#choose-house-a",onHidden:function(){e(i)},id:"craft-popup-house-selection",icon:characters[Craft.getCurrentCharacter()].staticAvatar});dom.addClickTouchEvent((0,_jquery2.default)("#close-house-select")[0],function(){n.hide()}.bind(this)),dom.addClickTouchEvent((0,_jquery2.default)("#choose-house-a")[0],function(){i="houseA",(0,_trackEvent2.default)("Minecraft","ClickedHouse",i),n.hide()}.bind(this)),dom.addClickTouchEvent((0,_jquery2.default)("#choose-house-b")[0],function(){i="houseB",(0,_trackEvent2.default)("Minecraft","ClickedHouse",i),n.hide()}.bind(this)),dom.addClickTouchEvent((0,_jquery2.default)("#choose-house-c")[0],function(){i="houseC",(0,_trackEvent2.default)("Minecraft","ClickedHouse",i),n.hide()}.bind(this)),n.show()},Craft.clearPlayerState=function(){window.localStorage.removeItem("craftHouseBlocks"),window.localStorage.removeItem("craftPlayerInventory"),window.localStorage.removeItem("craftSelectedPlayer"),window.localStorage.removeItem("craftSelectedHouse")},Craft.onHouseSelected=function(e){trySetLocalStorageItem("craftSelectedHouse",e)},Craft.initializeAppLevel=function(levelConfig){(0,_Utils.convertActionPlaneEntitiesToConfig)(levelConfig);var houseBlocks=JSON.parse(window.localStorage.getItem("craftHouseBlocks"));Craft.foldInCustomHouseBlocks(houseBlocks,levelConfig);for(var fluffPlane=[],i=0;i<(levelConfig.gridWidth||10)*(levelConfig.gridHeight||10);i++)fluffPlane.push("");var levelAssetPacks={beforeLoad:Craft.minAssetsForLevelWithCharacter(levelConfig.puzzle_number),afterLoad:Craft.afterLoadAssetsForLevel(levelConfig.puzzle_number)};Craft.gameController.loadLevel({isDaytime:levelConfig.isDaytime,groundPlane:levelConfig.groundPlane,groundDecorationPlane:levelConfig.groundDecorationPlane,actionPlane:levelConfig.actionPlane,fluffPlane:fluffPlane,entities:levelConfig.entities,playerStartPosition:levelConfig.playerStartPosition,playerStartDirection:levelConfig.playerStartDirection,playerName:Craft.getCurrentCharacter(),assetPacks:levelAssetPacks,specialLevelType:levelConfig.specialLevelType,houseBottomRight:levelConfig.houseBottomRight,gridDimensions:levelConfig.gridWidth&&levelConfig.gridHeight?[levelConfig.gridWidth,levelConfig.gridHeight]:null,verificationFunction:eval("["+levelConfig.verificationFunction+"]")[0]})},Craft.minAssetsForLevelWithCharacter=function(e){return Craft.minAssetsForLevelNumber(e).concat([Craft.characterAssetPackName(Craft.getCurrentCharacter())])},Craft.minAssetsForLevelNumber=function(e){switch(e){case 1:return["adventurerLevelOneAssets"];case 2:return["adventurerLevelTwoAssets"];case 3:return["adventurerLevelThreeAssets"];default:return["adventurerAllAssetsMinusPlayer"]}},Craft.afterLoadAssetsForLevel=function(e){switch(e){case 1:return Craft.minAssetsForLevelNumber(2);case 2:return Craft.minAssetsForLevelNumber(3);default:return["adventurerAllAssetsMinusPlayer"]}},Craft.earlyLoadAssetsForLevel=function(e){switch(e){case 1:return Craft.minAssetsForLevelNumber(e);default:return Craft.minAssetsForLevelWithCharacter(e)}},Craft.niceToHaveAssetsForLevel=function(e){switch(e){case 1:return["playerSteve","playerAlex"];default:return["adventurerAllAssetsMinusPlayer"]}},Craft.foldInCustomHouseBlocks=function(e,t){[t.groundPlane,t.actionPlane].forEach(function(t){for(var i=0;i<t.length;i++){var n=t[i];n.match(/house/)&&(t[i]=e&&e[n]?e[n]:"planksBirch")}})},Craft.reset=function(e){e||((0,_thumbnail.captureThumbnailFromCanvas)((0,_jquery2.default)("#minecraft-frame canvas")[0]),Craft.gameController.codeOrgAPI.resetAttempt())},Craft.phaserLoaded=function(){return Craft.gameController&&Craft.gameController.game&&!Craft.gameController.game.load.isLoading},Craft.runButtonClick=function(){if(Craft.phaserLoaded()){var e=document.getElementById("runButton"),t=document.getElementById("resetButton");if(t.style.minWidth||(t.style.minWidth=e.offsetWidth+"px"),studioApp().toggleRunReset("reset"),Blockly.mainBlockSpace.traceOn(!0),studioApp().attempts++,Craft.executeUserCode(),Craft.level.freePlay&&!studioApp().hideSource){var i=(0,_jquery2.default)("#right-button-cell");if(i.length&&!i.hasClass("right-button-cell-enabled")){i.addClass("right-button-cell-enabled"),studioApp().onResize();var n=document.createEvent("Event");n.initEvent("finishButtonShown",!0,!0),document.dispatchEvent(n)}}}},Craft.executeUserCode=function(){if(Craft.initialConfig.level.edit_blocks)return void this.reportResult(!0);if(studioApp().hasUnwantedExtraTopBlocks())return void this.reportResult(!1);studioApp().playAudio("start"),Blockly.mainBlockSpace.traceOn(!0);var e=Craft.gameController.codeOrgAPI;e.startCommandCollection(),e.registerEventCallback(null,function(t){t.eventType===_EventType2.default.WhenUsed&&"sheep"===t.targetType&&e.drop(null,"wool",t.targetIdentifier),t.eventType===_EventType2.default.WhenTouched&&"creeper"===t.targetType&&(e.flashEntity(null,t.targetIdentifier),e.explodeEntity(null,t.targetIdentifier))});var t="",i=Blockly.mainBlockSpace.getTopBlocks(!0);studioApp().initializationBlocks&&(i=studioApp().initializationBlocks.concat(i)),t=Blockly.Generator.blocksToCode("JavaScript",i),_CustomMarshalingInterpreter2.default.evalWith(t,{moveForward:function(t){e.moveForward(studioApp().highlight.bind(studioApp(),t),"Player")},turnLeft:function(t){e.turnLeft(studioApp().highlight.bind(studioApp(),t),"Player")},turnRight:function(t){e.turnRight(studioApp().highlight.bind(studioApp(),t),"Player")},destroyBlock:function(t){e.destroyBlock(studioApp().highlight.bind(studioApp(),t),"Player")},shear:function(t){e.use(studioApp().highlight.bind(studioApp(),t),"Player")},tillSoil:function(t){e.tillSoil(studioApp().highlight.bind(studioApp(),t),"Player")},whilePathAhead:function(t,i){e.whilePathAhead(studioApp().highlight.bind(studioApp(),t),"","Player",i)},whileBlockAhead:function(t,i,n){e.whilePathAhead(studioApp().highlight.bind(studioApp(),t),i,"Player",n)},ifLavaAhead:function(t,i){e.ifBlockAhead(studioApp().highlight.bind(studioApp(),i),"lava","Player",t)},ifBlockAhead:function(t,i,n){e.ifBlockAhead(studioApp().highlight.bind(studioApp(),n),t,"Player",i)},placeBlock:function(t,i){e.placeBlock(studioApp().highlight.bind(studioApp(),i),t,"Player")},plantCrop:function(t){e.placeBlock(studioApp().highlight.bind(studioApp(),t),"cropWheat","Player")},placeTorch:function(t){e.placeBlock(studioApp().highlight.bind(studioApp(),t),"torch","Player")},placeBlockAhead:function(t,i){e.placeInFront(studioApp().highlight.bind(studioApp(),i),t,"Player")}},{legacy:!0}),e.startAttempt(function(e,t){if(!Craft.level.freePlay){this.reportResult(e);var i=Craft.initialConfig.level.blocksToStore;if(e&&i){for(var n=JSON.parse(window.localStorage.getItem("craftHouseBlocks"))||{},o=0;o<t.actionPlane.length;o++)""!==i[o]&&(n[i[o]]=t.actionPlane[o].blockType);trySetLocalStorageItem("craftHouseBlocks",JSON.stringify(n))}var a=t.getInventoryTypes(),r=JSON.parse(window.localStorage.getItem("craftPlayerInventory"))||[],s={};a.concat(r).forEach(function(e){s[e]=!0}),trySetLocalStorageItem("craftPlayerInventory",JSON.stringify(Object.keys(s)))}}.bind(this))},Craft.getTestResultFrom=function(e,t){return t===_constants.TestResults.LEVEL_INCOMPLETE_FAIL?_constants.TestResults.APP_SPECIFIC_FAIL:Craft.initialConfig.level.freePlay?_constants.TestResults.FREE_PLAY:t},Craft.reportResult=function(e){var t=studioApp().getTestResults(e),i=Craft.getTestResultFrom(e,t),n=Craft.initialConfig.level.freePlay?Craft.gameController.getScreenshot():null,o=n?encodeURIComponent(n.split(",")[1]):null;studioApp().report({app:"craft",level:Craft.initialConfig.level.id,result:!!Craft.initialConfig.level.freePlay||e,testResult:i,image:o,program:encodeURIComponent(Blockly.Xml.domToText(Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace))),onComplete:function(e){var t=(0,_redux.getStore)().getState().progress.signInState===_progressRedux.SignInState.SignedIn;studioApp().displayFeedback({feedbackType:i,response:e,level:Craft.initialConfig.level,defaultToContinue:Craft.shouldDefaultToContinue(i),appStrings:{reinfFeedbackMsg:craftMsg.reinfFeedbackMsg(),nextLevelMsg:craftMsg.nextLevelMsg({puzzleNumber:Craft.initialConfig.level.puzzle_number}),tooManyBlocksFailMsgFunction:craftMsg.tooManyBlocksFail,generatedCodeDescription:craftMsg.generatedCodeDescription()},feedbackImage:n,showingSharing:Craft.initialConfig.level.freePlay,saveToProjectGallery:!0,disableSaveToGallery:!t})}})},Craft.shouldDefaultToContinue=function(e){var t=e===_constants.TestResults.FREE_PLAY;return e>_constants.TestResults.APP_SPECIFIC_ACCEPTABLE_FAIL&&!t}},3036:function(e,t,i){"use strict";e.exports={houseA:{groundPlane:["grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","dirtCoarse","dirtCoarse","dirtCoarse","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass"],verificationFunction:function(e){return e.solutionMapMatchesResultMap(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","any","any","any","any","","","","","","","any","","","any","","","","","","","any","","","any","","","","","","","any","any","any","any","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""])}.toString(),blocksToStore:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","houseRightC","","","","","","","","","","houseRightB","","","","","","","houseLeftA","","","houseRightA","","","","","","","houseBottomA","houseBottomB","houseBottomC","houseBottomD","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],houseBottomRight:[5,5]},houseC:{groundPlane:["grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","dirtCoarse","dirtCoarse","dirtCoarse","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","dirtCoarse","dirtCoarse","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","dirtCoarse","dirtCoarse","dirtCoarse","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass"],groundDecorationPlane:["","","","","","tallGrass","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","tallGrass","","","","","","","","",""],actionPlane:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","houseBottomA","houseBottomB","houseBottomC","houseBottomD","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],verificationFunction:'function (verificationAPI) {\r\n      return verificationAPI.solutionMapMatchesResultMap(\r\n            [\r\n              "", "", "", "", "", "", "", "", "", "",\r\n              "", "", "", "", "", "", "", "", "", "",\r\n              "", "", "any", "any", "any", "any", "", "", "", "",\r\n              "", "", "any", "", "", "", "any", "", "", "",\r\n              "", "", "any", "any", "", "", "any", "", "", "",\r\n              "", "", "", "any", "", "", "any", "", "", "",\r\n              "", "", "", "any", "any", "any", "any", "", "", "",\r\n              "", "", "", "", "", "", "", "", "", "",\r\n              "", "", "", "", "", "", "", "", "", "",\r\n              "", "", "", "", "", "", "", "", "", ""\r\n            ]);\r\n}',startBlocks:'<xml><block type="when_run" deletable="false" movable="false"><next><block type="controls_repeat_dropdown"><title name="TIMES" config="2-10">2</title><statement name="DO"><block type="craft_moveForward"><next><block type="craft_placeBlock"><title name="TYPE">planksBirch</title></block></next></block></statement><next><block type="craft_turn"><title name="DIR">left</title><next><block type="craft_moveForward"><next><block type="craft_placeBlock"><title name="TYPE">planksBirch</title><next><block type="craft_turn"><title name="DIR">right</title></block></next></block></next></block></next></block></next></block></next></block></xml>',blocksToStore:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","houseRightC","","","","","","","","","","houseRightB","","","","","","","houseLeftA","","","houseRightA","","","","","","","houseBottomA","houseBottomB","houseBottomC","houseBottomD","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],houseBottomRight:[5,5]},houseB:{groundPlane:["grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","dirtCoarse","dirtCoarse","dirtCoarse","grass","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","dirtCoarse","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","grass","grass","dirtCoarse","grass","grass","grass","grass","grass","grass","dirtCoarse","dirtCoarse","dirtCoarse","dirtCoarse","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass","grass"],verificationFunction:'function (verificationAPI) {\r\n      return verificationAPI.solutionMapMatchesResultMap(\r\n            [\r\n              "", "", "", "", "", "", "", "", "", "",\r\n              "", "", "", "any", "any", "any", "", "", "", "",\r\n              "", "", "", "any", "", "any", "", "", "", "",\r\n              "", "", "", "any", "", "any", "", "", "", "",\r\n              "", "", "", "any", "", "any", "any", "", "", "",\r\n              "", "", "", "any", "", "", "any", "", "", "",\r\n              "", "", "", "any", "", "", "any", "", "", "",\r\n              "", "", "", "any", "any", "any", "any", "", "", "",\r\n              "", "", "", "", "", "", "", "", "", "",\r\n              "", "", "", "", "", "", "", "", "", ""\r\n            ]);\r\n}',startBlocks:'<xml><block type="when_run" deletable="false" movable="false"><next><block type="controls_repeat_dropdown"><title name="TIMES" config="2-10">6</title><statement name="DO"><block type="craft_moveForward"><next><block type="craft_placeBlock"><title name="TYPE">planksBirch</title></block></next></block></statement></block></next></block></xml>',blocksToStore:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","houseRightC","","","","","","","","","","houseRightB","","","","","","","houseLeftA","","","houseRightA","","","","","","","houseBottomA","houseBottomB","houseBottomC","houseBottomD","","","","","","","","","","","","","","","","","","","","","","",""],actionPlane:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","houseBottomA","houseBottomB","houseBottomC","houseBottomD","","","","","","","","","","","","","","","","","","","","","","",""],playerStartPosition:[3,7],houseBottomRight:[5,6]}}},3037:function(e,t,i){"use strict";var n=i(1953);e.exports={1:{appSpecificFailError:n.level1FailureMessage(),tooFewBlocksMsg:n.level1TooFewBlocksMessage(),songs:["vignette4-intro"]},2:{appSpecificFailError:n.level2FailureMessage(),tooFewBlocksMsg:n.level2TooFewBlocksMessage(),songs:["vignette5-shortpiano"]},3:{appSpecificFailError:n.level3FailureMessage(),tooFewBlocksMsg:n.level3TooFewBlocksMessage(),songs:["vignette2-quiet","vignette5-shortpiano","vignette4-intro"]},4:{appSpecificFailError:n.level4FailureMessage(),tooFewBlocksMsg:n.level4FailureMessage(),songs:["vignette3","vignette2-quiet","vignette5-shortpiano","vignette4-intro"],songDelay:4e3},5:{appSpecificFailError:n.level5FailureMessage(),tooFewBlocksMsg:n.level5FailureMessage(),songs:["vignette7-funky-chirps-short","vignette2-quiet","vignette4-intro","vignette3"]},6:{appSpecificFailError:n.level6FailureMessage(),tooFewBlocksMsg:n.level6FailureMessage(),songs:["vignette1","vignette2-quiet","vignette4-intro","vignette3"],songDelay:4e3},7:{appSpecificFailError:n.level7FailureMessage(),tooFewBlocksMsg:n.level7FailureMessage(),songs:["vignette2-quiet","vignette7-funky-chirps-short","vignette4-intro","vignette1","vignette3"]},8:{appSpecificFailError:n.level8FailureMessage(),tooFewBlocksMsg:n.level8FailureMessage(),songs:["vignette5-shortpiano","vignette2-quiet","vignette1","vignette4-intro","vignette3"]},9:{appSpecificFailError:n.level9FailureMessage(),tooFewBlocksMsg:n.level9FailureMessage(),songs:["vignette3","vignette5-shortpiano","vignette7-funky-chirps-short","vignette2-quiet","vignette4-intro","vignette1"]},10:{appSpecificFailError:n.level10FailureMessage(),tooFewBlocksMsg:n.level10FailureMessage(),songs:["vignette4-intro","vignette3","vignette5-shortpiano","vignette2-quiet","vignette7-funky-chirps-short"]},11:{appSpecificFailError:n.level11FailureMessage(),tooFewBlocksMsg:n.level11FailureMessage(),songs:["vignette7-funky-chirps-short","vignette3","vignette2-quiet"]},12:{appSpecificFailError:n.level12FailureMessage(),tooFewBlocksMsg:n.level12FailureMessage(),songs:["vignette5-shortpiano","vignette2-quiet","vignette4-intro","vignette1"]},13:{appSpecificFailError:n.level13FailureMessage(),tooFewBlocksMsg:n.level13FailureMessage(),songs:["vignette1","vignette3","vignette2-quiet","vignette4-intro"]},14:{songs:["vignette8-free-play","vignette3","vignette2-quiet","vignette4-intro","vignette1"]}}},3038:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=i(1),a=n(o),r=i(788),s=n(r),l=i(40),c=i(819).default,u=i(824),p=function(e){return a.default.createElement("span",null,a.default.createElement(s.default,null,a.default.createElement("div",{id:"minecraft-frame"},a.default.createElement("div",{id:"phaser-game"}))),a.default.createElement(c,null,e.showFinishButton&&a.default.createElement("div",{id:"right-button-cell"},a.default.createElement("button",{id:"rightButton",className:"share mc-share-button"},a.default.createElement("div",null,l.finish())))),a.default.createElement(u,null))};p.propTypes={showFinishButton:o.PropTypes.bool.isRequired},e.exports=p},3039:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectLetsGetStarted() %></h1>\n\n<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',__filename="src/craft/simple/dialogs/playerSelection.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(1953);__append('\n<h1 class="minecraft-big-yellow-header" id="getting-started-header">'),__line=2,__append(escape(i18n.playerSelectLetsGetStarted())),__append('</h1>\n\n<h2 id="select-character-text">'),__line=4,__append(escape(i18n.playerSelectChooseCharacter())),__append('</h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select">'),__line=10,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select">'),__line=15,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n'),__line=20}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectLetsGetStarted() %></h1>\n\n<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',"src/craft/simple/dialogs/playerSelection.html.ejs",__line)}}},3040:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.houseSelectLetsBuild() %></h1>\n\n<h2 id="select-house-text"><%= i18n.houseSelectChooseFloorPlan() %></h2>\n\n<div id="choose-house-container">\n  <div class="minecraft-house" id="choose-house-a">\n    <h1 class="minecraft-big-yellow-header"><%= i18n.houseSelectEasy() %></h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-a-picture"></div>\n    </div>\n    <div class="choose-house-button"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-house" id="choose-house-b">\n    <h1 class="minecraft-big-yellow-header"><%= i18n.houseSelectMedium() %></h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-b-picture"></div>\n    </div>\n    <div class="choose-house-button"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-house" id="choose-house-c">\n    <h1 class="minecraft-big-yellow-header"><%= i18n.houseSelectHard() %></h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-c-picture"></div>\n    </div>\n    <div class="choose-house-button"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-house-select"></div>\n',__filename="src/craft/simple/dialogs/houseSelection.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(1953);__append('\n<h1 class="minecraft-big-yellow-header" id="getting-started-header">'),__line=2,__append(escape(i18n.houseSelectLetsBuild())),__append('</h1>\n\n<h2 id="select-house-text">'),__line=4,__append(escape(i18n.houseSelectChooseFloorPlan())),__append('</h2>\n\n<div id="choose-house-container">\n  <div class="minecraft-house" id="choose-house-a">\n    <h1 class="minecraft-big-yellow-header">'),__line=8,__append(escape(i18n.houseSelectEasy())),__append('</h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-a-picture"></div>\n    </div>\n    <div class="choose-house-button">'),__line=12,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n  <div class="minecraft-house" id="choose-house-b">\n    <h1 class="minecraft-big-yellow-header">'),__line=15,__append(escape(i18n.houseSelectMedium())),__append('</h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-b-picture"></div>\n    </div>\n    <div class="choose-house-button">'),__line=19,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n  <div class="minecraft-house" id="choose-house-c">\n    <h1 class="minecraft-big-yellow-header">'),__line=22,__append(escape(i18n.houseSelectHard())),__append('</h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-c-picture"></div>\n    </div>\n    <div class="choose-house-button">'),__line=26,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n</div>\n\n<div id="close-house-select"></div>\n'),__line=31}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.houseSelectLetsBuild() %></h1>\n\n<h2 id="select-house-text"><%= i18n.houseSelectChooseFloorPlan() %></h2>\n\n<div id="choose-house-container">\n  <div class="minecraft-house" id="choose-house-a">\n    <h1 class="minecraft-big-yellow-header"><%= i18n.houseSelectEasy() %></h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-a-picture"></div>\n    </div>\n    <div class="choose-house-button"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-house" id="choose-house-b">\n    <h1 class="minecraft-big-yellow-header"><%= i18n.houseSelectMedium() %></h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-b-picture"></div>\n    </div>\n    <div class="choose-house-button"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-house" id="choose-house-c">\n    <h1 class="minecraft-big-yellow-header"><%= i18n.houseSelectHard() %></h1>\n    <div class="house-outline-container">\n      <div class="house-photo" id="house-c-picture"></div>\n    </div>\n    <div class="choose-house-button"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-house-select"></div>\n',"src/craft/simple/dialogs/houseSelection.html.ejs",__line)}}},3041:function(e,t,i){"use strict";var n=i(743);e.exports={custom:{requiredBlocks:[],freePlay:!1,toolbox:(0,n.createToolbox)('<block type="craft_moveForward"></block>\n  <block type="craft_turn">\n    <title name="DIR">left</title>\n  </block>\n  <block type="craft_turn">\n    <title name="DIR">right</title>\n  </block>')}}},3042:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function trySetLocalStorageItem(e,t){try{window.localStorage.setItem(e,t)}catch(t){console&&console.log&&console.log("Couldn't set local storage item for key "+e)}}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_jquery=__webpack_require__(35),_jquery2=_interopRequireDefault(_jquery),_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(32),_reactDom2=_interopRequireDefault(_reactDom),_lodash=__webpack_require__(82),_lodash2=_interopRequireDefault(_lodash),_hammerjs=__webpack_require__(2129),_hammerjs2=_interopRequireDefault(_hammerjs),_StudioApp=__webpack_require__(597),_locale=__webpack_require__(2130),_locale2=_interopRequireDefault(_locale),_CustomMarshalingInterpreter=__webpack_require__(850),_CustomMarshalingInterpreter2=_interopRequireDefault(_CustomMarshalingInterpreter),_GameController=__webpack_require__(1952),_GameController2=_interopRequireDefault(_GameController),_FacingDirection=__webpack_require__(799),_FacingDirection2=_interopRequireDefault(_FacingDirection),_Utils=__webpack_require__(1272),_dom=__webpack_require__(594),_dom2=_interopRequireDefault(_dom),_eventsLevelbuilderOverrides=__webpack_require__(3043),_eventsLevelbuilderOverrides2=_interopRequireDefault(_eventsLevelbuilderOverrides),_MusicController=__webpack_require__(1954),_MusicController2=_interopRequireDefault(_MusicController),_reactRedux=__webpack_require__(53),_AppView=__webpack_require__(944),_AppView2=_interopRequireDefault(_AppView),_CraftVisualizationColumn=__webpack_require__(3044),_CraftVisualizationColumn2=_interopRequireDefault(_CraftVisualizationColumn),_blocks=__webpack_require__(2738),_redux=__webpack_require__(237),_Sounds=__webpack_require__(764),_Sounds2=_interopRequireDefault(_Sounds),_constants=__webpack_require__(216),_trackEvent=__webpack_require__(601),_trackEvent2=_interopRequireDefault(_trackEvent),_thumbnail=__webpack_require__(1158),_progressRedux=__webpack_require__(498),MEDIA_URL="/blockly/media/craft/",FIRST_CHARACTER_LEVEL=4,ArrowIds={LEFT:"leftButton",UP:"upButton",RIGHT:"rightButton",DOWN:"downButton"},Craft=module.exports;window.Craft=Craft,window.Blockly=Blockly;var eventsCharacters={Steve:{name:"Steve",staticAvatar:MEDIA_URL+"Events/Pop_Up_Character_Steve_Neutral.png",smallStaticAvatar:MEDIA_URL+"Events/Pop_Up_Character_Steve_Neutral.png",failureAvatar:MEDIA_URL+"Events/Pop_Up_Character_Steve_Fail.png",winAvatar:MEDIA_URL+"Events/Pop_Up_Character_Steve_Win.png"},Alex:{name:"Alex",staticAvatar:MEDIA_URL+"Events/Pop_Up_Character_Alex_Neutral.png",smallStaticAvatar:MEDIA_URL+"Events/Pop_Up_Character_Alex_Neutral.png",failureAvatar:MEDIA_URL+"Events/Pop_Up_Character_Alex_Fail.png",winAvatar:MEDIA_URL+"Events/Pop_Up_Character_Alex_Win.png"},Chicken:{staticAvatar:MEDIA_URL+"Events/Pop_Up_Character_Chicken_Neutral.png",smallStaticAvatar:MEDIA_URL+"Events/Pop_Up_Character_Chicken_Neutral.png",failureAvatar:MEDIA_URL+"Events/Pop_Up_Character_Chicken_Fail.png",winAvatar:MEDIA_URL+"Events/Pop_Up_Character_Chicken_Win.png"}},CHICKEN_ASSETS=[eventsCharacters.Chicken.staticAvatar,eventsCharacters.Chicken.smallStaticAvatar,eventsCharacters.Chicken.winAvatar,eventsCharacters.Chicken.failureAvatar],CHARACTER_ASSETS=[MEDIA_URL+"Events/Steve_Character_Select.png",MEDIA_URL+"Events/Alex_Character_Select.png",eventsCharacters.Steve.staticAvatar,eventsCharacters.Steve.smallStaticAvatar,eventsCharacters.Alex.staticAvatar,eventsCharacters.Alex.smallStaticAvatar],COMMON_UI_ASSETS=[MEDIA_URL+"Sliced_Parts/MC_Loading_Spinner.gif",MEDIA_URL+"Sliced_Parts/Frame_Large_Plus_Logo.png",MEDIA_URL+"Sliced_Parts/Pop_Up_Slice.png",MEDIA_URL+"Sliced_Parts/X_Button.png",MEDIA_URL+"Sliced_Parts/Button_Grey_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Button_Pressed.png",MEDIA_URL+"Sliced_Parts/Run_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/Run_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Run_Arrow_Icon_Smaller.png",MEDIA_URL+"Sliced_Parts/MC_Up_Arrow_Icon.png",MEDIA_URL+"Sliced_Parts/MC_Down_Arrow_Icon.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Up_Slice.png",MEDIA_URL+"Sliced_Parts/MC_Reset_Arrow_Icon.png",MEDIA_URL+"Sliced_Parts/Reset_Button_Down_Slice.png",MEDIA_URL+"Sliced_Parts/Callout_Tail.png"],interfaceImages={DEFAULT:COMMON_UI_ASSETS,1:CHICKEN_ASSETS,2:CHICKEN_ASSETS,3:CHICKEN_ASSETS,4:CHARACTER_ASSETS,5:CHARACTER_ASSETS,6:CHARACTER_ASSETS,7:CHARACTER_ASSETS,8:CHARACTER_ASSETS,9:CHARACTER_ASSETS,10:CHARACTER_ASSETS,11:CHARACTER_ASSETS,12:CHARACTER_ASSETS},MUSIC_METADATA=[{volume:1,hasOgg:!0,name:"vignette1",group:"day"},{volume:1,hasOgg:!0,name:"vignette2-quiet",group:"night"},{volume:1,hasOgg:!0,name:"vignette3",group:"night"},{volume:1,hasOgg:!0,name:"vignette4-intro",group:"day"},{volume:1,hasOgg:!0,name:"vignette5-shortpiano",group:"day"},{volume:1,hasOgg:!0,name:"vignette7-funky-chirps-short",group:"day"},{volume:1,hasOgg:!0,name:"vignette8-free-play",group:"day"}],CHARACTER_STEVE="Steve",CHARACTER_ALEX="Alex",DEFAULT_CHARACTER=CHARACTER_ALEX;Craft.init=function(e){1===e.level.puzzle_number&&1===e.level.stage_total&&(e.level.puzzle_number=999),e.level.isTestLevel&&(e.level.customSlowMotion=.1),e.level.disableFinalStageMessage=!0,e.showInstructionsInTopPane=!0;var t=function(){return document.documentMode}();t&&(0,_jquery2.default)("body").addClass("ieVersion"+t),e.level.useScore&&(0,_jquery2.default)("body").addClass("minecraft-scoring"),e.level.isEventLevel&&(0,_jquery2.default)("body").addClass("minecraft-events");var i=document.body;i.className=i.className+" minecraft",e.level.afterVideoBeforeInstructionsFn=function(t){Craft.beginBackgroundMusic(),e.level.showPopupOnLoad?"playerSelection"===e.level.showPopupOnLoad&&Craft.showPlayerSelectionPopup(function(i){(0,_trackEvent2.default)("MinecraftDesigner","ChoseCharacter",i),Craft.clearPlayerState(),trySetLocalStorageItem("craftSelectedPlayer",i),Craft.updateUIForCharacter(i),Craft.initializeAppLevel(e.level),t()}):t()},e.level.puzzle_number&&_eventsLevelbuilderOverrides2.default[e.level.puzzle_number]&&Object.assign(e.level,_eventsLevelbuilderOverrides2.default[e.level.puzzle_number]),Craft.initialConfig=e,(0,_StudioApp.singleton)().reset=this.reset.bind(this),(0,_StudioApp.singleton)().runButtonClick=this.runButtonClick.bind(this),Craft.level=e.level,Craft.skin=e.skin;var n=[];Craft.level.songs&&MUSIC_METADATA&&(n=MUSIC_METADATA.filter(function(e){return-1!==Craft.level.songs.indexOf(e.name)})),Craft.musicController=new _MusicController2.default(_Sounds2.default.getSingleton(),function(t){return e.skin.assetUrl("music/"+t)},n,e.level.dayNightCycleTime?100:n.length>1?7500:null),Craft.beginBackgroundMusic=function(){_Sounds2.default.getSingleton().whenAudioUnlocked(function(){var e=Craft.level.songs&&Craft.level.songs.length>1,t=e?Craft.level.songs[0]:null;Craft.musicController.play(t)})};var o=e.level.usePlayer?eventsCharacters[Craft.getCurrentCharacter()]:eventsCharacters.Chicken;e.skin.staticAvatar=o.staticAvatar,e.skin.smallStaticAvatar=o.smallStaticAvatar,e.skin.failureAvatar=o.failureAvatar,e.skin.winAvatar=o.winAvatar;var a=function(){(0,_StudioApp.singleton)().init(_extends({},e,{forceInsertTopBlock:null,appStrings:{generatedCodeDescription:_locale2.default.generatedCodeDescription()},enableShowCode:!1,enableShowBlockCount:!1,loadAudio:function(){},afterInject:function(){var t;e.level.showMovementBanner&&(0,_StudioApp.singleton)().displayWorkspaceAlert("warning",_react2.default.createElement("div",null,_locale2.default.useArrowKeys()));var i=parseFloat((location.search.split("customSlowMotion=")[1]||"").split("&")[0]);if(Craft.gameController=new _GameController2.default({Phaser:window.Phaser,containerId:"phaser-game",onScoreUpdate:e.level.useScore?function(e){return(0,_jquery2.default)("#score-number").text(e)}:null,assetRoot:Craft.skin.assetUrl(""),audioPlayer:{register:(0,_StudioApp.singleton)().registerAudio.bind((0,_StudioApp.singleton)()),play:(0,_StudioApp.singleton)().playAudio.bind((0,_StudioApp.singleton)())},debug:!1,customSlowMotion:i,earlyLoadAssetPacks:Craft.earlyLoadAssetsForLevel(e.level.puzzle_number),afterAssetsLoaded:function(){Craft.musicController.preload()},earlyLoadNiceToHaveAssetPacks:Craft.niceToHaveAssetsForLevel(e.level.puzzle_number)}),e.level.showPopupOnLoad||Craft.initializeAppLevel(e.level),(0,_StudioApp.singleton)().hideSource){document.getElementById("visualizationColumn").style.width=this.nativeVizWidth+"px"}for(var n in ArrowIds)_dom2.default.addMouseUpTouchEvent(document.getElementById(ArrowIds[n]),function(e){return function(){Craft.onArrowButtonUp(ArrowIds[e])}}(n)),_dom2.default.addMouseDownTouchEvent(document.getElementById(ArrowIds[n]),function(e){return function(t){Craft.onArrowButtonDown(t,ArrowIds[e])}}(n));_dom2.default.addMouseUpTouchEvent(document,Craft.onDocumentMouseUp,!1),(0,_jquery2.default)("#soft-buttons").removeClass("soft-buttons-none").addClass("soft-buttons-4"),Craft.hideSoftButtons();var o=document.getElementById("phaser-game"),a=(t={},_defineProperty(t,_hammerjs2.default.DIRECTION_LEFT,"leftButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_RIGHT,"rightButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_UP,"upButton"),_defineProperty(t,_hammerjs2.default.DIRECTION_DOWN,"downButton"),t),r=function(e){a[e.direction]&&Craft.gameController.codeOrgAPI.arrowDown(directionToFacing[a[e.direction]]),e.preventDefault()},s=function(e){a[e.direction]&&Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[a[e.direction]]),e.preventDefault()},l=new _hammerjs2.default.Manager(o);l.add(new _hammerjs2.default.Pan({direction:_hammerjs2.default.DIRECTION_ALL})),l.add(new _hammerjs2.default.Press({time:150})),l.add(new _hammerjs2.default.Tap),l.on("pan",r),l.on("panend pancancel",s),l.on("press",function(){return Craft.gameController.codeOrgAPI.clickDown(function(){})}),l.on("tap",function(){Craft.gameController.codeOrgAPI.clickDown(function(){}),Craft.gameController.codeOrgAPI.clickUp(function(){})}),l.on("pressup",function(){return Craft.gameController.codeOrgAPI.clickUp(function(){})})},twitter:{text:"Share on Twitter",hashtag:"Craft"}}));var t=[];t=t.concat(interfaceImages.DEFAULT),e.level.puzzle_number&&interfaceImages[e.level.puzzle_number]&&(t=t.concat(interfaceImages[e.level.puzzle_number])),t.forEach(function(e){preloadImage(e)});var i=(0,_jquery2.default)(".mc-share-button");i.length&&_dom2.default.addClickTouchEvent(i[0],function(){Craft.reportResult(!0)})};(0,_StudioApp.singleton)().setPageConstants(e,{isMinecraft:!0}),_reactDom2.default.render(_react2.default.createElement(_reactRedux.Provider,{store:(0,_redux.getStore)()},_react2.default.createElement(_AppView2.default,{visualizationColumn:_react2.default.createElement(_CraftVisualizationColumn2.default,{showFinishButton:!e.level.isProjectLevel,showScore:!!e.level.useScore}),onMount:a})),document.getElementById(e.containerId))};var directionToFacing={upButton:_FacingDirection2.default.North,downButton:_FacingDirection2.default.South,leftButton:_FacingDirection2.default.West,rightButton:_FacingDirection2.default.East};Craft.onArrowButtonDown=function(e,t){Craft.gameController.codeOrgAPI.arrowDown(directionToFacing[t]),e.preventDefault()},Craft.onArrowButtonUp=function(e){Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[e])},Craft.onDocumentMouseUp=function(){if(Craft.phaserLoaded()&&Craft.levelInitialized())for(var e in directionToFacing)Craft.gameController.codeOrgAPI.arrowUp(directionToFacing[e])};var preloadImage=function(e){(new Image).src=e};Craft.characterAssetPackName=function(e){return"player"+e+"Events"},Craft.getCurrentCharacter=function(){return window.localStorage.getItem("craftSelectedPlayer")||DEFAULT_CHARACTER},Craft.updateUIForCharacter=function(e){var t=eventsCharacters;Craft.initialConfig.skin.staticAvatar=t[e].staticAvatar,Craft.initialConfig.skin.smallStaticAvatar=t[e].smallStaticAvatar,Craft.initialConfig.skin.failureAvatar=t[e].failureAvatar,Craft.initialConfig.skin.winAvatar=t[e].winAvatar,(0,_StudioApp.singleton)().setIconsFromSkin(Craft.initialConfig.skin),(0,_jquery2.default)("#prompt-icon").attr("src",t[e].smallStaticAvatar)},Craft.showPlayerSelectionPopup=function(e){var t=DEFAULT_CHARACTER,i=document.createElement("div");i.innerHTML=__webpack_require__(3045)({image:(0,_StudioApp.singleton)().assetUrl()});var n=(0,_StudioApp.singleton)().createModalDialog({contentDiv:i,defaultBtnSelector:"#choose-steve",onHidden:function(){e(t)},id:"craft-popup-player-selection"});_dom2.default.addClickTouchEvent((0,_jquery2.default)("#close-character-select")[0],function(){n.hide()}.bind(this)),_dom2.default.addClickTouchEvent((0,_jquery2.default)("#choose-steve")[0],function(){t=CHARACTER_STEVE,(0,_trackEvent2.default)("MinecraftDesigner","ClickedCharacter",t),n.hide()}.bind(this)),_dom2.default.addClickTouchEvent((0,_jquery2.default)("#choose-alex")[0],function(){t=CHARACTER_ALEX,(0,_trackEvent2.default)("MinecraftDesigner","ClickedCharacter",t),n.hide()}.bind(this)),n.show()},Craft.clearPlayerState=function(){window.localStorage.removeItem("craftSelectedPlayer")},Craft.initializeAppLevel=function(levelConfig){(0,_Utils.convertActionPlaneEntitiesToConfig)(levelConfig);for(var fluffPlane=[],i=0;i<(levelConfig.gridWidth||10)*(levelConfig.gridHeight||10);i++)fluffPlane.push("");var levelAssetPacks={beforeLoad:Craft.minAssetsForLevelWithCharacter(levelConfig.puzzle_number),afterLoad:Craft.afterLoadAssetsForLevel(levelConfig.puzzle_number)},doNotShowPlayer=!1===levelConfig.usePlayer;Craft.gameController.loadLevel({onDayCallback:function(){Craft.musicController.setGroup("day"),Craft.musicController.fadeOut()},onNightCallback:function(){Craft.musicController.setGroup("night"),Craft.musicController.fadeOut()},levelVerificationTimeout:levelConfig.levelVerificationTimeout,isDaytime:levelConfig.isDaytime,groundPlane:levelConfig.groundPlane,usePlayer:!doNotShowPlayer,useScore:levelConfig.useScore,entities:levelConfig.entities,isEventLevel:levelConfig.isEventLevel,groundDecorationPlane:levelConfig.groundDecorationPlane,actionPlane:levelConfig.actionPlane,fluffPlane:fluffPlane,playerStartPosition:levelConfig.playerStartPosition,playerStartDirection:levelConfig.playerStartDirection,playerName:Craft.getCurrentCharacter()+"Events",assetPacks:levelAssetPacks,gridDimensions:levelConfig.gridWidth&&levelConfig.gridHeight?[levelConfig.gridWidth,levelConfig.gridHeight]:null,verificationFunction:eval("["+levelConfig.verificationFunction+"]")[0],failureCheckFunction:eval("["+levelConfig.failureCheckFunction+"]")[0],timeoutResult:eval("["+(levelConfig.timeoutVerificationFunction||"function() { return false; }")+"]")[0]})},Craft.minAssetsForLevelWithCharacter=function(e){var t=e>=FIRST_CHARACTER_LEVEL?[Craft.characterAssetPackName(Craft.getCurrentCharacter())]:[];return Craft.minAssetsForLevelNumber(e).concat(t)},Craft.minAssetsForLevelNumber=function(e){switch(e){case 1:return["levelOneAssets"];case 2:return["levelTwoAssets"];case 3:return["levelThreeAssets"];default:return["designerAllAssetsMinusPlayer"]}},Craft.afterLoadAssetsForLevel=function(e){switch(e){case 1:return Craft.minAssetsForLevelNumber(2);default:return["designerAllAssetsMinusPlayer"]}},Craft.earlyLoadAssetsForLevel=function(e){return e<=FIRST_CHARACTER_LEVEL?Craft.minAssetsForLevelNumber(e):Craft.minAssetsForLevelWithCharacter(e)},Craft.niceToHaveAssetsForLevel=function(e){return e===FIRST_CHARACTER_LEVEL?["playerSteveEvents","playerAlexEvents"]:["designerAllAssetsMinusPlayer"]},Craft.hideSoftButtons=function(){(0,_jquery2.default)("#soft-buttons").hide(),(0,_StudioApp.singleton)().resizePinnedBelowVisualizationArea()},Craft.showSoftButtons=function(){(0,_jquery2.default)("#soft-buttons").show(),(0,_StudioApp.singleton)().resizePinnedBelowVisualizationArea()},Craft.reset=function(e){e||(Craft.level.usePlayer&&Craft.hideSoftButtons(),(0,_thumbnail.captureThumbnailFromCanvas)((0,_jquery2.default)("#minecraft-frame canvas")[0]),Craft.gameController.codeOrgAPI.resetAttempt())},Craft.phaserLoaded=function(){return Craft.gameController&&Craft.gameController.game&&Craft.gameController.game.load&&!Craft.gameController.game.load.isLoading},Craft.levelInitialized=function(){return Craft.gameController&&Craft.gameController.levelModel},Craft.runButtonClick=function(){if(Craft.phaserLoaded()){Craft.level.usePlayer&&Craft.showSoftButtons();var e=document.getElementById("runButton"),t=document.getElementById("resetButton");if(t.style.minWidth||(t.style.minWidth=e.offsetWidth+"px"),(0,_StudioApp.singleton)().toggleRunReset("reset"),Blockly.mainBlockSpace.traceOn(!0),(0,_StudioApp.singleton)().attempts++,Craft.executeUserCode(),Craft.level.freePlay&&!(0,_StudioApp.singleton)().hideSource){var i=(0,_jquery2.default)("#right-button-cell");if(i.length&&!i.hasClass("right-button-cell-enabled")){i.addClass("right-button-cell-enabled"),(0,_StudioApp.singleton)().onResize();var n=document.createEvent("Event");n.initEvent("finishButtonShown",!0,!0),document.dispatchEvent(n)}}}},Craft.executeUserCode=function(){if(Craft.initialConfig.level.edit_blocks)return void this.reportResult(!0);if((0,_StudioApp.singleton)().hasUnwantedExtraTopBlocks())return void this.reportResult(!1);(0,_StudioApp.singleton)().playAudio("start"),Blockly.mainBlockSpace.traceOn(!0);var e=Craft.gameController.codeOrgAPI;e.startCommandCollection();var t=Blockly.mainBlockSpace.getTopBlocks(!0);(0,_StudioApp.singleton)().initializationBlocks&&(t=(0,_StudioApp.singleton)().initializationBlocks.concat(t));var i=Blockly.Generator.blocksToCode("JavaScript",t),n={moveForward:function(t){e.moveForward((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),t))},onEventTriggered:function(t,i,n,o){e.registerEventCallback((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),o),function(e){e.eventType===i&&e.targetType===t&&n(e)})},onGlobalEventTriggered:function(t,i,n){e.registerEventCallback((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),function(e){e.eventType===t&&i(e)})},drop:function(t,i,n){e.drop((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),t,i)},turnLeft:function(t){e.turn((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),t),"left")},turnRight:function(t){e.turn((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),t),"right")},destroyBlock:function(t){e.destroyBlock((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),t))},repeat:function(t,i,n,o){e.repeat((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),t),i,n,o)},repeatRandom:function(t,i,n){e.repeatRandom((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),t),i,n)},playSound:function(t,i,n){e.playSound((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),t,i)},addScore:function(t,i){e.addScore((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),parseInt(t))},moveDirection:function(t,i,n){var o={up:_FacingDirection2.default.North,down:_FacingDirection2.default.South,left:_FacingDirection2.default.West,right:_FacingDirection2.default.East};e.moveDirection((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),o[t],i)},spawnEntity:function(t,i,n){e.spawnEntity((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),t,i)},wait:function(t,i,n){e.wait((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),"random"===t?_lodash2.default.random(.1,3,!0):t,i)},spawnEntityRandom:function(t,i){var n=["up","middle","right","down","left"],o=_lodash2.default.sample(n);e.spawnEntity((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),i),t,o)}};_blocks.ENTITY_ACTION_BLOCKS.concat(["turnLeft","turnRight","turnRandom"]).forEach(function(t){n[t]=function(i,n){e[t]((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),n),i)}}),_blocks.ENTITY_TARGET_ACTION_BLOCKS.forEach(function(t){n[t]=function(i,n,o){e[t]((0,_StudioApp.singleton)().highlight.bind((0,_StudioApp.singleton)(),o),i,n)}}),_CustomMarshalingInterpreter2.default.evalWith(i,n,{legacy:!0}),e.startAttempt(function(e){Craft.hideSoftButtons(),Craft.level.freePlay||this.reportResult(e)}.bind(this)),Craft.initialConfig.level.dayNightCycleTime&&e.setDayNightCycle(Craft.initialConfig.level.dayNightCycleStart,Craft.initialConfig.level.dayNightCycleTime||0,Craft.initialConfig.level.isDaytime?"night":"day")},Craft.getTestResultFrom=function(e,t){return t===_constants.TestResults.LEVEL_INCOMPLETE_FAIL?_constants.TestResults.APP_SPECIFIC_FAIL:Craft.initialConfig.level.freePlay?_constants.TestResults.FREE_PLAY:t},Craft.reportResult=function(e){var t=(0,_StudioApp.singleton)().getTestResults(e),i=Craft.getTestResultFrom(e,t),n=Craft.initialConfig.level.freePlay?Craft.gameController.getScreenshot():null,o=n?encodeURIComponent(n.split(",")[1]):null;(0,_StudioApp.singleton)().report({app:"craft",level:Craft.initialConfig.level.id,result:!!Craft.initialConfig.level.freePlay||e,testResult:i,image:o,program:encodeURIComponent(Blockly.Xml.domToText(Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace))),onComplete:function(e){var t=(0,_redux.getStore)().getState().progress.signInState===_progressRedux.SignInState.SignedIn;(0,_StudioApp.singleton)().displayFeedback({feedbackType:i,response:e,level:Craft.initialConfig.level,defaultToContinue:Craft.shouldDefaultToContinue(i),appStrings:{reinfFeedbackMsg:_locale2.default.reinfFeedbackMsg(),nextLevelMsg:_locale2.default.nextLevelMsg({puzzleNumber:Craft.initialConfig.level.puzzle_number}),tooManyBlocksFailMsgFunction:_locale2.default.tooManyBlocksFail,generatedCodeDescription:_locale2.default.generatedCodeDescription()},feedbackImage:n,showingSharing:Craft.initialConfig.level.freePlay,saveToProjectGallery:!0,disableSaveToGallery:!t})}})},Craft.shouldDefaultToContinue=function(e){var t=e===_constants.TestResults.FREE_PLAY;return e>_constants.TestResults.APP_SPECIFIC_ACCEPTABLE_FAIL&&!t}},3043:function(e,t,i){"use strict";e.exports={1:{songs:["vignette4-intro"]},2:{songs:["vignette5-shortpiano"]},3:{songs:["vignette5-shortpiano","vignette4-intro"]},4:{songs:["vignette5-shortpiano","vignette4-intro"],songDelay:4e3,showMovementBanner:!0},5:{songs:["vignette7-funky-chirps-short","vignette4-intro"]},6:{songs:["vignette1","vignette4-intro"],songDelay:4e3},7:{songs:["vignette7-funky-chirps-short","vignette4-intro","vignette1"]},8:{songs:["vignette5-shortpiano","vignette1","vignette4-intro","vignette2-quiet","vignette3"]},9:{songs:["vignette5-shortpiano","vignette7-funky-chirps-short","vignette4-intro","vignette1"]},10:{songs:["vignette4-intro","vignette5-shortpiano","vignette7-funky-chirps-short","vignette2-quiet","vignette3"]}}},3044:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),l=n(s),c=i(40),u=n(c),p=i(2130),d=n(p),h=i(819),f=n(h),g=i(824),m=n(g),v=i(1737),y=n(v),_=i(788),k=n(_),w=function(e){function t(){return o(this,t),a(this,e.apply(this,arguments))}return r(t,e),t.prototype.render=function(){return l.default.createElement("span",null,l.default.createElement(k.default,null,l.default.createElement("div",{id:"minecraft-frame"},l.default.createElement("div",{id:"phaser-game"}),this.props.showScore&&l.default.createElement("div",{id:"score-container"},l.default.createElement("div",{id:"score-inner"},l.default.createElement("span",null,d.default.score(),": "),l.default.createElement("span",{id:"score-number"},"0"))))),l.default.createElement(f.default,null,l.default.createElement(y.default,null),this.props.showFinishButton&&l.default.createElement("div",{id:"right-button-cell"},l.default.createElement("button",{id:"rightButton",className:"share mc-share-button"},l.default.createElement("div",null,u.default.finish())))),l.default.createElement(m.default,null))},t}(l.default.Component);w.propTypes={showFinishButton:s.PropTypes.bool.isRequired,showScore:s.PropTypes.bool.isRequired},t.default=w,e.exports=t.default},3045:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 style="color: #e7e8ea; margin-bottom: 23px;" class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectChooseCharacter() %></h1>\n\n\x3c!--<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>--\x3e\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',__filename="src/craft/designer/dialogs/playerSelection.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(2130);__append('\n<h1 style="color: #e7e8ea; margin-bottom: 23px;" class="minecraft-big-yellow-header" id="getting-started-header">'),__line=2,__append(escape(i18n.playerSelectChooseCharacter())),__append('</h1>\n\n\x3c!--<h2 id="select-character-text">'),__line=4,__append(escape(i18n.playerSelectChooseCharacter())),__append('</h2>--\x3e\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select">'),__line=10,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select">'),__line=15,__append(escape(i18n.selectChooseButton())),__append('</div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n'),__line=20}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 style="color: #e7e8ea; margin-bottom: 23px;" class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.playerSelectChooseCharacter() %></h1>\n\n\x3c!--<h2 id="select-character-text"><%= i18n.playerSelectChooseCharacter() %></h2>--\x3e\n\n<div id="choose-character-container">\n  <div class="minecraft-character" id="choose-alex">\n    <h1 class="minecraft-big-yellow-header">Alex</h1>\n    <div class="character-portrait" id="alex-portrait"></div>\n    <div class="choose-character-button" id="choose-alex-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n  <div class="minecraft-character" id="choose-steve">\n    <h1 class="minecraft-big-yellow-header">Steve</h1>\n    <div class="character-portrait" id="steve-portrait"></div>\n    <div class="choose-character-button" id="choose-steve-select"><%= i18n.selectChooseButton() %></div>\n  </div>\n</div>\n\n<div id="close-character-select"></div>\n',"src/craft/designer/dialogs/playerSelection.html.ejs",__line)}}},3046:function(e,t,i){"use strict";var n=i(743);e.exports={custom:{requiredBlocks:[],freePlay:!1,toolbox:(0,n.createToolbox)('<block type="craft_moveForward"></block>\n  <block type="craft_turn">\n    <title name="DIR">left</title>\n  </block>\n  <block type="craft_turn">\n    <title name="DIR">right</title>\n  </block>')}}},3047:function(e,t,i){"use strict";var n=i(743);e.exports={custom:{requiredBlocks:[],freePlay:!1,toolbox:(0,n.createToolbox)('<block type="craft_moveForward"></block>\n  <block type="craft_turn">\n    <title name="DIR">left</title>\n  </block>\n  <block type="craft_turn">\n    <title name="DIR">right</title>\n  </block>')}}},3048:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return e.hasOwnProperty("name")&&(e=e.name),e}Object.defineProperty(t,"__esModule",{value:!0}),t.executeUserCode=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s=i(1),l=n(s),c=i(32),u=n(c),p=i(53),d=i(597),h=i(850),f=n(h),g=i(237),m=i(944),v=n(m),y=i(3049),_=n(y),k=i(3050),w=n(k),b=i(594),C=n(b),P=i(2888),S=n(P),A="/blockly/media/craft/",T=new w.default(8080),E=[A+"Sliced_Parts/MC_Loading_Spinner.gif",A+"Sliced_Parts/Frame_Large_Plus_Logo.png",A+"Sliced_Parts/Pop_Up_Slice.png",A+"Sliced_Parts/X_Button.png",A+"Sliced_Parts/Button_Grey_Slice.png",A+"Sliced_Parts/MC_Button_Pressed.png",A+"Sliced_Parts/Run_Button_Up_Slice.png",A+"Sliced_Parts/Run_Button_Down_Slice.png",A+"Sliced_Parts/MC_Run_Arrow_Icon_Smaller.png",A+"Sliced_Parts/MC_Up_Arrow_Icon.png",A+"Sliced_Parts/MC_Down_Arrow_Icon.png",A+"Sliced_Parts/Reset_Button_Up_Slice.png",A+"Sliced_Parts/MC_Reset_Arrow_Icon.png",A+"Sliced_Parts/Reset_Button_Down_Slice.png",A+"Sliced_Parts/Callout_Tail.png"],M=function(e){(new Image).src=e},B=t.executeUserCode=function(e,t){function i(t,i,o,a,r){(0,d.singleton)().highlight(t);var s=Object.keys(a),l=[];s.forEach(function(e){var t=a[e];null!==t&&l.push(e+"="+t)});var c=i;l.length>0&&(c=c+"?"+l.join("&")),e.async_command(c,function(e){var t=document.getElementById("code-connection-log");t.innerText+=i+" command executed.",null!==o&&(t.innerText+=" "+o+": "+e),t.innerText+="\n",t.scrollTop=t.scrollHeight,r(e),!0===(0,d.singleton)().isRunning()&&n.run()},o)}var n=void 0,o={move:function(e,t,n){i(e,"move","success",{direction:t},n)},turn:function(e,t,n){i(e,"turn","success",{direction:t},n)},place:function(e,t,n,o){i(e,"place","success",{slotNum:t,direction:n},o)},till:function(e,t,n){i(e,"till","success",{direction:t},n)},attack:function(e,t,n){i(e,"attack","success",{direction:t},n)},destroy:function(e,t,n){i(e,"destroy","success",{direction:t},n)},collect:function(e,t,n){i(e,"collect","success",{item:a(t)},n)},collectall:function(e,t){i(e,"collect","success",{item:"all"},t)},drop:function(e,t,n,o,a){i(e,"drop","success",{slotNum:t,quantity:n,direction:o},a)},dropall:function(e,t,n){i(e,"dropall","success",{direction:t},n)},detect:function(e,t,n){i(e,"detect","result",{direction:t},n)},inspect:function(e,t,n){i(e,"inspect","blockName",{direction:t},n)},inspectdata:function(e,t,n){i(e,"inspectdata","data",{direction:t},n)},detectredstone:function(e,t,n){i(e,"detectredstone","result",{direction:t},n)},getitemdetail:function(e,t,n){i(e,"getitemdetail","itemName",{slotNum:t},n)},getitemspace:function(e,t,n){i(e,"getitemspace","spaceCount",{slotNum:t},n)},getitemcount:function(e,t,n){i(e,"getitemcount","stackCount",{slotNum:t},n)},transfer:function(e,t,n,o,a){i(e,"transfer","success",{srcSlotNum:t,quantity:n,dstSlotNum:o},a)},tptoplayer:function(e,t){i(e,"tptoplayer",null,{},t)},wait:function(e,t,i){(0,d.singleton)().highlight(e),setTimeout(function(){i(),n.run()},t)},executeasother:function(e,t,n,o,a){i(e,"executeasother","success",{origin:t,position:n,command:o},a)},executedetect:function(e,t,n,o,a,r,s,l){i(e,"executedetect","success",{origin:t,position:n,detectBlock:o,detectData:a,detectPos:r,command:s},l)},timesetbyname:function(e,t,n){i(e,"timesetbyname","success",{time:t},n)},timesetbynumber:function(e,t,n){i(e,"timesetbynumber","success",{time:t},n)},weather:function(e,t,n){i(e,"weather","success",{type:t},n)},tptotarget:function(e,t,n,o){i(e,"tptargettotarget","success",{victim:t,destination:n},o)},tptopos:function(e,t,n,o){i(e,"tptargettopos","success",{victim:t,destination:n},o)},fill:function(e,t,n,o,a,r){i(e,"fill","fillCount",{from:t,to:n,tileName:o,tileData:a},r)},give:function(e,t,n,o,a){i(e,"give","itemAmount",{player:t,itemName:n.name,data:n.data,amount:o},a)},kill:function(e,t,n){i(e,"kill",null,{target:t},n)},setblock:function(e,t,n,o,a){i(e,"setblock",null,{position:t,tileName:n.name,tileData:n.data,oldBlockHandling:o},a)},summon:function(e,t,n,o){i(e,"summon","wasSpawned",{entityType:t,spawnPos:n},o)},testforblock:function(e,t,n,o){i(e,"testforblock","matches",{position:t,tileName:n.name,dataValue:n.data},o)},testforblocks:function(e,t,n,o,a,r){i(e,"testforblocks","matches",{begin:t,end:n,destination:o,mode:a},r)},clone:function(e,t,n,o,a,r,s){i(e,"clone","count",{begin:t,end:n,destination:o,maskMode:a,cloneMode:r},s)},clonefiltered:function(e,t,n,o,a,r,s){i(e,"clone","count",{begin:t,end:n,destination:o,maskMode:"filtered",cloneMode:a,tileName:r.name,tileData:r.data},s)}},s={item:function(e,t,i){return(0,d.singleton)().highlight(e),{name:t,data:i}},createBlockPos:function(e,t,i,n){return encodeURIComponent(""+n+e+" "+n+t+" "+n+i)},createBlockPosFromVec3:function(e,t){return encodeURIComponent(""+t+e.x+" "+t+e.y+" "+t+e.z)},getVec3:function(e,t,i){return{x:""+e,y:""+t,z:""+i}}};n=f.default.evalWith(t,r({},o,s),{asyncFunctionList:Object.values(o)})},R=function(){function e(){o(this,e)}return e.init=function(t){t.level.disableFinalStageMessage=!0,t.showInstructionsInTopPane=!0,document.body.className+=" minecraft",e.initialConfig=t,T.connectionStatusUpdate(function(t){!1===t&&e.showConnectToCodeConnectionPopup()}),(0,d.singleton)().reset=e.reset,(0,d.singleton)().runButtonClick=e.runButtonClick,(0,d.singleton)().setPageConstants(t,{isMinecraft:!0}),e.render(t)},e.render=function(e){var t=function(){(0,d.singleton)().init(r({enableShowCode:!1},e)),Object.keys(S.default).forEach(function(e){S.default[e].forEach(function(e){M(e[0])})}),E.forEach(function(e){M(e)})};u.default.render(l.default.createElement(p.Provider,{store:(0,g.getStore)()},l.default.createElement(v.default,{visualizationColumn:l.default.createElement(_.default,{showScore:!!e.level.useScore}),onMount:t})),document.getElementById(e.containerId))},e.reset=function(e){e||console.log("reset")},e.runButtonClick=function(){T.connectionStatusUpdate(function(t){if(!0===t){console.log("run");var i=document.getElementById("runButton"),n=document.getElementById("resetButton");n.style.minWidth||(n.style.minWidth=i.offsetWidth+"px"),(0,d.singleton)().toggleRunReset("reset"),Blockly.mainBlockSpace.traceOn(!0),(0,d.singleton)().attempts++;var o=Blockly.mainBlockSpace.getTopBlocks(!0),a=Blockly.Generator.blocksToCode("JavaScript",o);B(T,a)}else e.showConnectToCodeConnectionPopup()})},e}();R.showConnectToCodeConnectionPopup=function(){var e=document.createElement("div");e.innerHTML=i(3051)({image:(0,d.singleton)().assetUrl()});var t=(0,d.singleton)().createModalDialog({contentDiv:e,onHidden:function(){},id:"craft-popup-connect"});C.default.addClickTouchEvent(document.getElementById("download-button"),function(){window.open("https://education.minecraft.net/get-started/download","_blank").focus(),t.hide()}.bind(this)),C.default.addClickTouchEvent(document.getElementById("close-popup"),function(){t.hide()}.bind(this)),t.show()},R.showImportFromShareLinkPopup=function(e){var t=void 0,n=document.createElement("div");n.innerHTML=i(3052)();var o=(0,d.singleton)().createModalDialog({contentDiv:n,onHidden:function(){e(t)},id:"craft-popup-import"});C.default.addClickTouchEvent(document.getElementById("import-button"),function(){t=$("#share-link").val(),o.hide()}),C.default.addClickTouchEvent(document.getElementById("close-popup"),function(){o.hide()}),C.default.addClickTouchEvent(document.getElementById("cancel-button"),function(){o.hide()}),o.show()},R.showErrorMessagePopup=function(e,t){var n=document.createElement("div");n.innerHTML=i(3053)({title:e,message:t});var o=(0,d.singleton)().createModalDialog({contentDiv:n,onHidden:function(){},id:"craft-popup-error"});C.default.addClickTouchEvent(document.getElementById("close-popup"),function(){o.hide()}),o.show()},t.default=R},3049:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),l=n(s),c=i(819),u=n(c),p=i(824),d=n(p),h=i(788),f=n(h),g=function(e){function t(){return o(this,t),a(this,e.apply(this,arguments))}return r(t,e),t.prototype.render=function(){return l.default.createElement("span",null,l.default.createElement(f.default,null,l.default.createElement("div",{id:"minecraft-frame"},l.default.createElement("div",{id:"code-connection-log"}))),l.default.createElement(u.default,null),l.default.createElement(d.default,null))},t}(l.default.Component);g.propTypes={showScore:s.PropTypes.bool.isRequired},t.default=g,e.exports=t.default},3050:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=i(35),a=function(e){return e&&e.__esModule?e:{default:e}}(o),r="http://localhost:",s=function(){function e(t){var i=this;n(this,e),this.callbackRef=null,this.keyRef=null,this.port=t,void 0!==window.ipcRenderer&&window.ipcRenderer.on("responseFromApp",function(e,t){var n=JSON.parse(t);"basic"===n.api&&(null!==i.keyRef?i.callbackRef(n[i.keyRef]):i.callbackRef())})}return e.prototype.connectionStatusUpdate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;void 0!==window.ipcRenderer?e(void 0!==window.ipcRenderer):a.default.ajax({type:"GET",url:""+r+this.port+"/connected",timeout:t,success:function(t){e(t)},error:function(t,i,n){e(!1)}})},e.prototype.async_command=function(e,t,i){void 0!==window.ipcRenderer?(window.ipcRenderer.sendToHost("sendToApp",{api:"basic",url:""+r+this.port+"/"+e}),this.callbackRef=t,this.keyRef=i):a.default.ajax({type:"GET",url:""+r+this.port+"/"+e,success:function(n){console.log("Command : "+e+" success result : "+n.toString()),null!==i?t(JSON.parse(n)[i]):t()},error:function(i,n,o){console.log("Command : "+e+" fail",o),t()}})},e}();t.default=s,e.exports=t.default},3051:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.minecraftNotConnected() %></h1>\n\n<h2 id="download-text"><%= i18n.connectToCodeConnection() %></h2>\n\n<div class="download-button" id="download-button"><%= i18n.downloadButton() %></div>\n\n<div id="close-popup"></div>\n',__filename="src/craft/code-connection/dialogs/connectToCodeConnection.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(2743);__append('\n<h1 class="minecraft-big-yellow-header" id="getting-started-header">'),__line=2,__append(escape(i18n.minecraftNotConnected())),__append('</h1>\n\n<h2 id="download-text">'),__line=4,__append(escape(i18n.connectToCodeConnection())),__append('</h2>\n\n<div class="download-button" id="download-button">'),__line=6,__append(escape(i18n.downloadButton())),__append('</div>\n\n<div id="close-popup"></div>\n'),__line=9}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="getting-started-header"><%= i18n.minecraftNotConnected() %></h1>\n\n<h2 id="download-text"><%= i18n.connectToCodeConnection() %></h2>\n\n<div class="download-button" id="download-button"><%= i18n.downloadButton() %></div>\n\n<div id="close-popup"></div>\n',"src/craft/code-connection/dialogs/connectToCodeConnection.html.ejs",__line)}}},3052:function(module,exports,__webpack_require__){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="import-header"><%= i18n.importShareLinkHeader() %></h1>\n\n<h2><%= i18n.importShareLinkBody() %></h2>\n\n<input type="text" id="share-link" placeholder="Example: https://studio.code.org/c/999999999" />\n<div class="button" id="import-button"><%= i18n.import() %></div>\n\n<br />\n\n<div class="button" id="cancel-button"><%= i18n.cancel() %></div>\n\n<div id="close-popup"></div>\n',__filename="src/craft/code-connection/dialogs/importFromShareLink.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){var i18n=__webpack_require__(2743);__append('\n<h1 class="minecraft-big-yellow-header" id="import-header">'),__line=2,__append(escape(i18n.importShareLinkHeader())),__append("</h1>\n\n<h2>"),__line=4,__append(escape(i18n.importShareLinkBody())),__append('</h2>\n\n<input type="text" id="share-link" placeholder="Example: https://studio.code.org/c/999999999" />\n<div class="button" id="import-button">'),__line=7,__append(escape(i18n.import())),__append('</div>\n\n<br />\n\n<div class="button" id="cancel-button">'),__line=11,__append(escape(i18n.cancel())),__append('</div>\n\n<div id="close-popup"></div>\n'),__line=14}return __output.join("")}catch(e){rethrow(e,'<% var i18n = require(\'../locale\'); %>\n<h1 class="minecraft-big-yellow-header" id="import-header"><%= i18n.importShareLinkHeader() %></h1>\n\n<h2><%= i18n.importShareLinkBody() %></h2>\n\n<input type="text" id="share-link" placeholder="Example: https://studio.code.org/c/999999999" />\n<div class="button" id="import-button"><%= i18n.import() %></div>\n\n<br />\n\n<div class="button" id="cancel-button"><%= i18n.cancel() %></div>\n\n<div id="close-popup"></div>\n',"src/craft/code-connection/dialogs/importFromShareLink.html.ejs",__line)}}},3053:function(module,exports){module.exports=function anonymous(locals,escape,include,rethrow){function encode_char(e){return _ENCODE_HTML_RULES[e]||e}rethrow=rethrow||function(e,t,i,n){var o=t.split("\n"),a=Math.max(n-3,0),r=Math.min(o.length,n+3),s=o.slice(a,r).map(function(e,t){var i=t+a+1;return(i==n?" >> ":"    ")+i+"| "+e}).join("\n");throw e.path=i,e.message=(i||"ejs")+":"+n+"\n"+s+"\n\n"+e.message,e},escape=escape||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<h1 class="minecraft-big-yellow-header" id="error-message"><%= title %></h1>\n\n<h2><%= message %></h2>\n\n<div id="close-popup"></div>\n',__filename="src/craft/code-connection/dialogs/errorMessage.html.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{})__append('<h1 class="minecraft-big-yellow-header" id="error-message">'),__append(escape(title)),__append("</h1>\n\n<h2>"),__line=3,__append(escape(message)),__append('</h2>\n\n<div id="close-popup"></div>\n'),__line=6;return __output.join("")}catch(e){rethrow(e,'<h1 class="minecraft-big-yellow-header" id="error-message"><%= title %></h1>\n\n<h2><%= message %></h2>\n\n<div id="close-popup"></div>\n',"src/craft/code-connection/dialogs/errorMessage.html.ejs",__line)}}},3054:function(e,t,i){"use strict";function n(e){return a("craft_"+e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")}function o(e,t){return"<category name='"+e+"' "+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+">"+t+"</category>"}function a(e){return"<block type='"+e+"'>"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")+"</block>"}function r(e,t,i){return n("vecThree","<value name='X'><block type=\"math_number\"><title name='NUM'>"+e+"</title></block></value>\n                                <value name='Y'><block type=\"math_number\"><title name='NUM'>"+t+"</title></block></value>\n                                <value name='Z'><block type=\"math_number\"><title name='NUM'>"+i+"</title></block></value>")}var s=i(743);e.exports={custom:{requiredBlocks:[],freePlay:!1,disable_variable_editing:!1,toolbox:(0,s.createToolbox)(o("Agent",n("move")+n("turn")+n("tptoplayer")+n("place","<value name='SLOTNUM'><block type=\"math_number\"><title name='NUM'>0</title></block></value>")+n("destroy")+n("till")+n("attack")+n("collect","<value name='ITEM'>"+n("block")+"</value>")+n("collectall")+n("drop","<value name='SLOTNUM'><block type=\"math_number\"><title name='NUM'>0</title></block></value>\n                            <value name='QUANTITY'><block type=\"math_number\"><title name='NUM'>1</title></block></value>")+n("dropall")+n("detect")+n("inspect")+n("inspectdata")+n("getitemdetail","<value name='SLOTNUM'><block type=\"math_number\"><title name='NUM'>0</title></block></value>")+n("getitemspace","<value name='SLOTNUM'><block type=\"math_number\"><title name='NUM'>0</title></block></value>")+n("getitemcount","<value name='SLOTNUM'><block type=\"math_number\"><title name='NUM'>0</title></block></value>")+n("transfer","<value name='SRCSLOTNUM'><block type=\"math_number\"><title name='NUM'>0</title></block></value>\n                                <value name='DSTSLOTNUM'><block type=\"math_number\"><title name='NUM'>1</title></block></value>\n                                <value name='QUANTITY'><block type=\"math_number\"><title name='NUM'>1</title></block></value>")+n("detectredstone"))+o("Item",n("block")+n("miscellaneous")+n("tool")+n("decoration")+n("getnameof","<value name='ITEM'>"+n("block")+"</value>")+n("getdataof","<value name='ITEM'>"+n("block")+"</value>")+n("createblock","<value name='BLOCKTYPE'>"+n("block")+"</value>\n                                     <value name='BLOCKDATA'>"+n("block")+"</value>"))+o("Blocks",n("tptotarget")+n("tptopos","<value name='VEC3'>"+r(1,1,1)+"</value>")+n("fill","<value name='ITEM'>"+n("block")+"</value>\n                            <value name='FROM_VEC3'>"+r(1,1,1)+"</value>\n                            <value name='TO_VEC3'>"+r(5,5,5)+"</value>")+n("give","<value name='ITEM'>"+n("block")+"</value>\n                            <value name='AMOUNT'><block type=\"math_number\"><title name='NUM'>10</title></block></value>")+n("kill")+n("setblock","<value name='ITEM'>"+n("block")+"</value>\n                               <value name='VEC3'>"+r(1,1,1)+"</value>")+n("summon","<value name='VEC3'>"+r(1,1,1)+"</value>")+n("testforblock","<value name='ITEM'>"+n("block")+"</value>\n                                    <value name='VEC3'>"+r(1,1,1)+"</value>")+n("testforblocks","<value name='FROM_VEC3'>"+r(1,1,1)+"</value>\n                                     <value name='TO_VEC3'>"+r(5,5,5)+"</value>\n                                     <value name='VEC3'>"+r(10,10,10)+"</value>")+n("clone","<value name='FROM_VEC3'>"+r(1,1,1)+"</value>\n                             <value name='TO_VEC3'>"+r(5,5,5)+"</value>\n                             <value name='VEC3'>"+r(10,10,10)+"</value>")+n("clonefiltered","<value name='ITEM'>"+n("block")+"</value>\n                                     <value name='FROM_VEC3'>"+r(1,1,1)+"</value>\n                                     <value name='TO_VEC3'>"+r(5,5,5)+"</value>\n                                     <value name='VEC3'>"+r(10,10,10)+"</value>")+n("executeasother","<value name='VEC3'>"+r(1,1,1)+"</value>")+n("timesetbyname")+n("timesetbynumber","<value name='TIME'><block type=\"math_number\"><title name='NUM'>1200</title></block></value>")+n("weather"))+o("Logic",a("logic_compare")+a("logic_operation")+a("logic_negate")+a("logic_boolean")+a("text"))+o("Control",a("controls_if")+a("controls_if","<mutation else='1'></mutation>")+a("controls_for")+a("controls_whileUntil")+a("controls_repeat_ext","<value name='TIMES'>"+a("math_number",'<field name="NUM">10</field>')+"</value>")+n("wait"))+o("Variables","",'custom="VARIABLE"')+o("Functions","",'custom="PROCEDURE"')+o("Math",a("math_number")+a("math_arithmetic")+n("vecThree","<value name='X'><block type=\"math_number\"><title name='NUM'>0</title></block></value>\n                                <value name='Y'><block type=\"math_number\"><title name='NUM'>0</title></block></value>\n                                <value name='Z'><block type=\"math_number\"><title name='NUM'>0</title></block></value>")+a("math_random_int","<value name='FROM'>"+a("math_number",'<field name="FROM">1</field>')+"</value><value name='TO'>"+a("math_number",'<field name="TO">10</field>')+"</value>")))}}},793:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(1270);e.exports=function(){function e(t,i,a){n(this,e),this.GameController=t,this.Game=t.game,this.HighlightCallback=i,this.state=o.NOT_STARTED,this.target=a,this.repeat=!1}return e.prototype.tick=function(){},e.prototype.begin=function(){this.HighlightCallback&&this.HighlightCallback(),this.state=o.WORKING},e.prototype.isStarted=function(){return this.state!==o.NOT_STARTED},e.prototype.isFinished=function(){return this.isSucceeded()||this.isFailed()},e.prototype.isSucceeded=function(){return this.state===o.SUCCESS},e.prototype.isFailed=function(){return this.state===o.FAILURE},e.prototype.succeeded=function(){this.state=o.SUCCESS},e.prototype.failed=function(){this.state=o.FAILURE},e}()},794:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(1269),a=i(799),r=i(838),s=i(1159),l=i(1016),c=i(1271);e.exports=function(){function e(t,i,a,s,l,c){n(this,e),this.queue=new o(t),this.controller=t,this.game=t.game,this.position=new r(s,l),this.type=i,this.facing=c,this.offset=[-22,-12],this.identifier=a,this.healthPoint=3,this.underTree={state:!1,treeIndex:-1}}return e.prototype.tick=function(){this.queue.tick()},e.prototype.reset=function(){},e.prototype.canMoveThrough=function(){return!1},e.prototype.canPlaceBlock=function(){return!1},e.prototype.canTriggerPressurePlates=function(){return!1},e.prototype.shouldUpdateSelectionIndicator=function(){return!1},e.prototype.setMovePosition=function(e){this.position=e},e.prototype.getSortOrderOffset=function(){return 5},e.prototype.addCommand=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.queue.addCommand(e,t),this.queue.begin()},e.prototype.getWalkAnimation=function(){return"walk"+this.controller.levelView.getDirectionName(this.facing)},e.prototype.getIdleAnimation=function(){return"idle"+this.controller.levelView.getDirectionName(this.facing)},e.prototype.playMoveForwardAnimation=function(e,t,i,n){var o,r=this,s=this.controller.levelView,l=e[1]+(t===a.North?1:0);this.sprite.sortOrder=this.controller.levelView.yToIndex(l)+1,s.playBlockSound(n),s.playScaledSpeed(this.sprite.animations,this.getWalkAnimation()),setTimeout(function(){o=r.controller.levelView.addResettableTween(r.sprite).to({x:r.offset[0]+40*e[0],y:r.offset[1]+40*e[1]},300,Phaser.Easing.Linear.None),o.onComplete.add(function(){s.playScaledSpeed(r.sprite.animations,r.getIdleAnimation()),i.succeeded()}),o.start()},50/this.controller.tweenTimeScale)},e.prototype.walkableCheck=function(){},e.prototype.updateHidingTree=function(){var e=this.controller.levelView;if(this.underTree.state){var t=this.underTree.treeIndex,i=this.controller.levelEntity.entityMap;e.isUnderTree(t,this.position)||(function(e,t,i){var n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value,c=l[1];if(!(c===e)&&c.underTree.treeIndex===i)return!0}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return!1}(this,i,t)||e.changeTreeAlpha(t,1),this.underTree={state:!1,treeIndex:-1})}else for(var n=e.trees,o=0;o<n.length;o++)if(e.isUnderTree(o,this.position)){e.changeTreeAlpha(o,.8),this.underTree={state:!0,treeIndex:o};break}},e.prototype.updateHidingBlock=function(e){var t=this.controller.levelView,i=this.controller.levelModel.actionPlane;this.isOnBlock||function(e,n){var o=r.south(n),a=i.getBlockAt(o);if(a&&!a.isTransparent){var s=t.actionPlaneBlocks[t.coordinatesToIndex(o)];if(null!==s){e.controller.levelView.addResettableTween(s).to({alpha:.8},300,Phaser.Easing.Linear.None).start()}}}(this,this.position),void 0!==e&&function(e,i){var n=r.south(i);if(n.y<10){var o=t.actionPlaneBlocks[t.coordinatesToIndex(n)];if(null!==o){e.controller.levelView.addResettableTween(o).to({alpha:1},300,Phaser.Easing.Linear.None).start()}}}(this,e)},e.prototype.doMoveForward=function(e,t){var i=this.controller.levelModel,n=this.position;this.position=t;var o=i.groundPlane.getBlockAt(this.position).blockType;this.playMoveForwardAnimation(t,this.facing,e,o,function(){}),this.updateHidingTree(),this.updateHidingBlock(n)},e.prototype.bump=function(e){var t=this,i=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"bump"+i);var n=this.controller.levelModel.getMoveForwardPosition(this),o=this.controller.levelEntity.getEntityAt(n);null!==o&&(this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenTouched,targetType:t.type,targetIdentifier:t.identifier,eventSenderIdentifier:o.identifier})}),this.queue.endPushHighPriorityCommands()),this.controller.delayPlayerMoveBy(400,800,function(){e.succeeded()})},e.prototype.callBumpEvents=function(e){for(var t=this,i=1;i<e.length;i++)"frontEntity"===e[i]&&(this.controller.events.forEach(function(n){return n({eventType:s.WhenTouched,targetType:e[i+1].type,eventSenderIdentifier:t.identifier,targetIdentifier:e[i+1].identifier})}),i++)},e.prototype.moveDirection=function(e,t){this.controller.levelModel.turnToDirection(this,t),this.moveForward(e,!1)},e.prototype.moveForward=function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.controller.addCommandRecord("moveForward",this.type,e.repeat);var t=this.controller.levelModel.getMoveForwardPosition(this),i=this.controller.levelModel.canMoveForward(this);if(i[0]){var n=r.directionToOffsetPosition(this.facing),o=r.directionToOffsetPosition(a.opposite(this.facing)),s=this.handleMoveOnPressurePlate(n);this.doMoveForward(e,t),s||this.handleMoveOffPressurePlate(o),this.handleMoveOffIronDoor(o),this.handleMoveAwayFromPiston(o)}else this.bump(e),this.callBumpEvents(i)},e.prototype.moveBackward=function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.controller.addCommandRecord("moveBackward",this.type,e.repeat);var t=this.controller.levelModel.getMoveDirectionPosition(this,2),i=this.controller.levelModel.canMoveBackward(this);if(i[0]){var n=r.directionToOffsetPosition(a.opposite(this.facing)),o=r.directionToOffsetPosition(this.facing),s=this.handleMoveOnPressurePlate(n);this.doMoveBackward(e,t),s||this.handleMoveOffPressurePlate(o),this.handleMoveOffIronDoor(o),this.handleMoveAwayFromPiston(o)}else this.bump(e),this.callBumpEvents(i)},e.prototype.canPlaceBlockOver=function(){return{canPlace:!1,plane:""}},e.prototype.moveAway=function(e,t){this.controller.addCommandRecord("moveAway",this.type,e.repeat);var i=t.position,n=[],o=function(e,t,i){return r.absoluteDistanceSquare(t[1],e)<r.absoluteDistanceSquare(i[1],e)?i:t},s=r.absoluteDistanceSquare(i,this.position);i.x<=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.East)[0]&&(n=[a.East,r.east(this.position)]),i.x>=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.West)[0]&&(n=n.length>0?o(i,n,[a.West,r.west(this.position)]):[a.West,r.west(this.position)]),i.y>=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.North)[0]&&(n=n.length>0?o(i,n,[a.North,r.north(this.position)]):[a.North,r.north(this.position)]),i.y<=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.South)[0]&&(n=n.length>0?o(i,n,[a.South,r.south(this.position)]):[a.South,r.south(this.position)]),0===n.length||s>=r.absoluteDistanceSquare(i,n[1])?e.succeeded():this.moveDirection(e,n[0])},e.prototype.moveToward=function(e,t){this.controller.addCommandRecord("moveToward",this.type,e.repeat);var i=t.position,n=[],o=function(e,t,i){return r.absoluteDistanceSquare(t[1],e)>r.absoluteDistanceSquare(i[1],e)?i:t};return i.x>=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.East)[0]&&(n=[a.East,r.east(this.position)]),i.x<=this.position.x&&this.controller.levelModel.canMoveDirection(this,a.West)[0]&&(n=n.length>0?o(i,n,[a.West,r.west(this.position)]):[a.West,r.west(this.position)]),i.y<=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.North)[0]&&(n=n.length>0?o(i,n,[a.North,r.north(this.position)]):[a.North,r.north(this.position)]),i.y>=this.position.y&&this.controller.levelModel.canMoveDirection(this,a.South)[0]&&(n=n.length>0?o(i,n,[a.South,r.south(this.position)]):[a.South,r.south(this.position)]),1===r.absoluteDistanceSquare(this.position,i)?(this.position.x<i.x?this.facing=a.East:this.position.x>i.x?this.facing=a.West:this.position.y<i.y?this.facing=a.South:this.position.y>i.y&&(this.facing=a.North),this.updateAnimationDirection(),this.bump(e),!1):0===n.length?(e.succeeded(),!1):(this.moveDirection(e,n[0]),!0)},e.prototype.moveTo=function(e,t){var i=this;if(1===r.absoluteDistanceSquare(t.position,this.position))t.position.y-this.position.y==-1?this.moveDirection(e,a.North):t.position.y-this.position.y==1?this.moveDirection(e,a.South):t.position.x-this.position.x==1?this.moveDirection(e,a.East):this.moveDirection(e,a.West);else if(this.moveToward(e,t)){var n=new l(this.controller,function(){},function(){i.moveTo(n,t)},this.identifier);this.addCommand(n)}else this.bump(e)},e.prototype.turn=function(e,t){(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&this.controller.addCommandRecord("turn",this.type,e.repeat),-1===t&&this.controller.levelModel.turnLeft(this),1===t&&this.controller.levelModel.turnRight(this),this.updateAnimationDirection(),this.controller.delayPlayerMoveBy(200,800,function(){e.succeeded()})},e.prototype.turnRandom=function(e){this.controller.addCommandRecord("turnRandom",this.type,e.repeat);var t=0===function(e,t){return Math.floor(Math.random()*(t-e+1))+e}(0,1)?1:-1;this.turn(e,t,!1)},e.prototype.use=function(e,t){var i=this,n="lookAtCam"+this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,n),this.queue.startPushHighPriorityCommands(),this.controller.events.forEach(function(e){return e({eventType:s.WhenUsed,targetType:i.type,eventSenderIdentifier:t.identifier,targetIdentifier:i.identifier})}),this.queue.endPushHighPriorityCommands(),e.succeeded()},e.prototype.drop=function(e,t){var i=this;this.controller.addCommandRecord("drop",this.type,e.repeat),this.controller.levelView.playItemDropAnimation(this.position,t,function(){if(e.succeeded(),i.controller.levelModel.usePlayer){var t=i.controller.levelModel.player.queue.currentCommand;t&&t.waitForOtherQueue&&t.succeeded()}})},e.prototype.attack=function(e){var t=this;this.controller.addCommandRecord("attack",this.type,e.repeat);var i=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"attack"+i),setTimeout(function(i){var n=i.controller.levelEntity.getEntityAt(i.controller.levelModel.getMoveForwardPosition(i));if(n){var o=new l(i.controller,function(){},function(){n.takeDamage(o)},n);n.addCommand(o)}setTimeout(function(t,i,o){null!==i&&(n.queue.startPushHighPriorityCommands(),t.events.forEach(function(e){return e({eventType:s.WhenAttacked,targetType:i.type,eventSenderIdentifier:o.identifier,targetIdentifier:i.identifier})}),n.queue.endPushHighPriorityCommands()),e.succeeded()},300/t.controller.tweenTimeScale,i.controller,n,i)},200/this.controller.tweenTimeScale,this)},e.prototype.pushBack=function(e,t,i,n){var o=this,a=this.controller.levelModel,s=r.forward(this.position,t);if(a.isPositionEmpty(s)[0]){this.updateHidingBlock(this.position),this.position=s,this.updateHidingTree();var l=this.controller.levelView.addResettableTween(this.sprite).to({x:this.offset[0]+40*this.position[0],y:this.offset[1]+40*this.position[1]},i,Phaser.Easing.Linear.None);l.onComplete.add(function(){setTimeout(function(){e.succeeded(),void 0!==n&&n(o)},i/o.controller.tweenTimeScale)}),l.start()}else e.succeeded(),void 0!==n&&n(this)},e.prototype.takeDamage=function(e){var t=this,i=this.controller.levelView,n=i.getDirectionName(this.facing);this.healthPoint>1?(i.playScaledSpeed(this.sprite.animations,"hurt"+n),setTimeout(function(){t.healthPoint--,e.succeeded()},1500/this.controller.tweenTimeScale)):(this.healthPoint--,this.sprite.animations.stop(null,!0),this.controller.levelView.playScaledSpeed(this.sprite.animations,"die"+n),setTimeout(function(){var e=t.controller.levelView.addResettableTween(t.sprite).to({alpha:0},300,Phaser.Easing.Linear.None);e.onComplete.add(function(){t.controller.levelEntity.destroyEntity(t.identifier)}),e.start()},1500/this.controller.tweenTimeScale))},e.prototype.playRandomIdle=function(e){var t,i="";switch(t=this.controller.levelView.getDirectionName(e),Math.trunc(5*Math.random())+1){case 1:i+="idle";break;case 2:i+="lookLeft";break;case 3:i+="lookRight";break;case 4:i+="lookAtCam";break;case 5:i+="lookDown"}i+=t,this.controller.levelView.playScaledSpeed(this.sprite.animations,i)},e.prototype.updateAnimationDirection=function(){var e=this.controller.levelView.getDirectionName(this.facing);this.controller.levelView.playScaledSpeed(this.sprite.animations,"idle"+e)},e.prototype.getDistance=function(e){return r.absoluteDistanceSquare(this.position,e.position)},e.prototype.blowUp=function(e,t){var i=a.South;t[0]>this.position[0]?(i=a.West,this.facing=a.East,this.updateAnimationDirection()):t[0]<this.position[0]?(i=a.East,this.facing=a.West,this.updateAnimationDirection()):t[1]>this.position[1]?(i=a.North,this.facing=a.South,this.updateAnimationDirection()):t[1]<this.position[1]&&(i=a.South,this.facing=a.North,this.updateAnimationDirection()),this.pushBack(e,i,150,function(t){var i=new l(t.controller,function(){},function(){t.controller.destroyEntity(i,t.identifier)},t.identifier);t.queue.startPushHighPriorityCommands(),t.addCommand(i,e.repeat),t.queue.endPushHighPriorityCommands()})},e.prototype.hasPermissionToWalk=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(e.isWalkable||void 0!==t&&t.isOnBlock&&!e.isEmpty)&&(void 0===t||t.canMoveThrough())&&"water"!==i.blockType&&"lava"!==i.blockType},e.prototype.handleMoveOffPressurePlate=function(e){var t=this,i=r.add(this.position,e),n="pressurePlateDown"===this.controller.levelModel.actionPlane.getBlockAt(i).blockType,o=this.controller.levelModel.actionPlane.getBlockAt(this.position),a=!1;if(void 0!==o&&o.isWalkable||(a=!0),this.controller.levelEntity.entityMap.forEach(function(e){e.identifier!==t.identifier&&e.canTriggerPressurePlates()&&t.controller.positionEquivalence(e.position,i)&&(a=!0)}),n&&!a){this.controller.audioPlayer.play("pressurePlateClick");var s=new c("pressurePlateUp");this.controller.levelModel.actionPlane.setBlockAt(i,s,e[0],e[1])}},e.prototype.handleMoveOnPressurePlate=function(e){var t=r.add(this.position,e);if("pressurePlateUp"===this.controller.levelModel.actionPlane.getBlockAt(t).blockType){this.controller.audioPlayer.play("pressurePlateClick");var i=new c("pressurePlateDown");return this.controller.levelModel.actionPlane.setBlockAt(t,i),!0}return!1},e.prototype.handleMoveOffIronDoor=function(e){var t=r.add(this.position,e);if(this.controller.levelModel.inBounds(t)){var i="doorIron"===this.controller.levelModel.actionPlane.getBlockAt(t).blockType,n="doorIron"===this.controller.levelModel.actionPlane.getBlockAt(this.position).blockType;i&&!n&&this.controller.levelModel.actionPlane.findDoorToAnimate(new r(-1,-1))}},e.prototype.handleMoveAwayFromPiston=function(e){var t=this,i=r.add(this.position,e);r.getOrthogonalPositions(i).forEach(function(e){if(t.controller.levelModel.actionPlane.inBounds(e)){var i=t.controller.levelModel.actionPlane.getBlockAt(e);i.blockType.startsWith("piston")&&i.isPowered&&t.controller.levelModel.actionPlane.activatePiston(e)}})},e.prototype.handleGetOnRails=function(e){this.getOffTrack=!1,this.handleMoveOffPressurePlate(new r(0,0)),this.controller.levelView.playTrack(this.position,e,!0,this,null)},e}()},799:function(e,t,i){"use strict";var n=Object.freeze({North:0,East:1,South:2,West:3,opposite:function(e){switch(e){case n.North:return n.South;case n.South:return n.North;case n.East:return n.West;case n.West:return n.East}},left:function(e){return this.turn(e,"left")},right:function(e){return this.turn(e,"right")},turnDirection:function(e,t){switch(e){case n.North:return t===n.East?"right":"left";case n.South:return t===n.West?"right":"left";case n.East:return t===n.South?"right":"left";case n.West:return t===n.North?"right":"left"}},turn:function(e,t){return(e+4+("right"===t?1:-1))%4},directionToOffset:function(e){switch(e){case n.North:return[0,-1];case n.South:return[0,1];case n.East:return[1,0];case n.West:return[-1,0]}},directionToRelative:function(e){switch(e){case n.North:return"Up";case n.South:return"Down";case n.East:return"Right";case n.West:return"Left"}}});e.exports=n},838:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(799),a=[o.North,o.East,o.South,o.West];e.exports=function(){function e(t,i){n(this,e),this.x=t,this.y=i,this[0]=t,this[1]=i}return e.add=function(t,i){return new e(t[0]+i[0],t[1]+i[1])},e.subtract=function(t,i){return new e(t[0]-i[0],t[1]-i[1])},e.equals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.directionToOffsetPosition=function(t){var i=o.directionToOffset(t);if(i)return e.fromArray(i)},e.isAdjacent=function(t,i){return a.map(e.directionToOffsetPosition).some(function(n){return e.equals(e.add(t,n),i)})},e.forward=function(t,i){return e.add(t,e.directionToOffsetPosition(i))},e.north=function(t){return e.forward(t,o.North)},e.east=function(t){return e.forward(t,o.East)},e.south=function(t){return e.forward(t,o.South)},e.west=function(t){return e.forward(t,o.West)},e.getOrthogonalPositions=function(t){return a.map(function(i){return e.forward(t,i)})},e.manhattanDistance=function(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},e.absoluteDistanceSquare=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},e.getSurroundingPositions=function(t){return e.getOrthogonalPositions(t).concat([e.north(e.east(t)),e.north(e.west(t)),e.south(e.east(t)),e.south(e.west(t))])},e.fromArray=function(t){return new e(t[0],t[1])},e}()}},[3032]);