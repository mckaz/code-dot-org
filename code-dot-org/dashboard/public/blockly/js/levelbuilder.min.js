webpackJsonp([29],{3371:function(e,t,n){n(151),n(152),e.exports=n(3372)},3372:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var a=n(82),r=o(a),l=n(852),i=o(l),u=n(732),c=o(u),s=n(831),d=o(s);window.levelbuilder=window.levelbuilder||{},r.default.extend(window.levelbuilder,{initializeCodeMirror:n(2087),initializeBlockPreview:n(2968),jsonEditor:n(3385),acapela:n(3386),ajaxSubmit:n(3387)}),window.levelbuilder.installBlocks=function(e,t,o){var a=n(2969)("./"+e+"/blocks");n(1813).install(t,o),a.install(t,o)},window.CodeMirror=i.default,window.marked=c.default,window.renderer=d.default},3385:function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(35),r=function(e){return e&&e.__esModule?e:{default:e}}(a),l=n(852);e.exports=function(e,t){function n(e,a){r.default.each(e,function(t,r){if(r&&"object"===(void 0===r?"undefined":o(r)))n(r,a);else{var l=a.find("."+t);"checkbox"===l.prop("type")?l.prop("checked",e[t]):l.val(e[t])}}),t.onNewSpace&&t.onNewSpace(a)}function a(e,t){r.default.each(e,function(n,r){if("object"===(void 0===r?"undefined":o(r)))a(r,t);else{var l=t.find("."+n);r="checkbox"===l.prop("type")?l.prop("checked"):l.val(),e[n]="number"==typeof e[n]?+r:r}})}function i(){var n=[];e.find(t.form_container).find(t.value_space).each(function(){var e=r.default.extend(!0,{},t.model);a(e,(0,r.default)(this)),n.push(e)}),c.setValue(JSON.stringify(n,null," "))}function u(){var n=e.find(t.template).children(":first").clone();return e.find(t.form_container).append(n),n}e=(0,r.default)(e);var c=l.fromTextArea(e.find(t.json_textarea).get(0),{mode:"javascript",viewportMargin:1/0,matchBrackets:!0});if(c.getValue().length>0){var s=JSON.parse(c.getValue());r.default.each(s,function(e,t){n(t,u())})}t.up_button&&e.on("click",t.up_button,function(){var e=(0,r.default)(this).closest(t.value_space);e.prev().length&&(e.insertBefore(e.prev()),i())}),t.down_button&&e.on("click",t.down_button,function(){var e=(0,r.default)(this).closest(t.value_space);e.next().length&&(e.insertAfter(e.next()),i())}),e.on("click",t.add_button,function(){n(r.default.extend(!0,{},t.model),u()),i()}),e.on("click",t.remove_button,function(){(0,r.default)(this).closest(t.value_space).remove(),i()}),e.on("change",t.wrapper,function(){i()})}},3386:function(e,t,n){"use strict";var o=n(35),a=function(e){return e&&e.__esModule?e:{default:e}}(o);e.exports={listenForGetAudio:function(e){(0,a.default)("button.tts").click(function(){var t;switch(this.id){case"tts-instructions":t=(0,a.default)("#level_tts_instructions_override").val()||(0,a.default)("#level_instructions").val();break;case"tts-markdown-instructions":t=(0,a.default)("#level_tts_markdown_instructions_override").val()||(0,a.default)("#markdown-instructions-preview").text()}a.default.getJSON("https://vaas.acapela-group.com/Services/UrlMaker?jsoncallback=?",{cl_login:e.login,cl_app:e.app,cl_pwd:e.pwd,req_voice:(0,a.default)("#level_tts_voice").val(),req_text:t},function(e){(0,a.default)("#tts-error").hide(),e.err_msg&&((0,a.default)("#alert-content").text(unescape(e.err_msg)),(0,a.default)("#tts-error").show()),e.snd_url&&(0,a.default)("#tts-audio").attr({src:e.snd_url,controls:"controls"})})})},populateVoicesList:function(e){a.default.getJSON("https://vaas.acapela-group.com/Services/Voices.json?jsoncallback=?",{cl_login:e.login,cl_app:e.app,fields_selection:"language_desc;speaker",frequency:"22050",technology:"HQ"},function(e){var t=Object.keys(e.voices).reduce(function(t,n){var o={speaker:e.voices[n].speaker,id:n};return t[e.voices[n].language_desc]?t[e.voices[n].language_desc].push(o):t[e.voices[n].language_desc]=[o],t},{}),n=Object.keys(t).map(function(e){return"<optgroup label='"+e+"'>"+t[e].map(function(e){return"<option value='"+e.id+"'>"+e.speaker+"</option>"}).join("")+"</optgroup>"});(0,a.default)("#level_tts_voice").html(n.join("")),(0,a.default)("#level_tts_voice").find('option[value="sharon22k"]').attr("selected",!0)})}}},3387:function(e,t,n){"use strict";var o=n(35),a=function(e){return e&&e.__esModule?e:{default:e}}(o);e.exports=function(e){(0,a.default)(document).ready(function(){(0,a.default)(e).on("ajax:beforeSend",function(e,t){(0,a.default)(".validation-error").empty().hide();var n=(0,a.default)('meta[name="csrf-token"]').attr("content");t.setRequestHeader("X-CSRF-TOKEN",n)}),(0,a.default)(e).on("ajax:complete",function(e,t){200===parseInt(t.status,10)&&(localStorage.removeItem("markdown_"+window.location.pathname.split("/").reverse()[1]),window.location.href=JSON.parse(t.responseText).redirect)}),(0,a.default)(e).on("ajax:error",function(e,t,n,o){var r;try{r=a.default.parseJSON(t.responseText)}catch(e){r={message:"Error ("+o+"): "+t.responseText}}(0,a.default)(".validation-error").show().html("<p>Couldn't create level:</p>").append((0,a.default)("<ul/>").append(Object.keys(r).map(function(e){return(0,a.default)("<li/>").text(e+": "+r[e])})))})})}}},[3371]);