!function(a,b){"function"==typeof define&&define.amd?define("p5.play",["p5"],function(a){b(a)}):b("object"==typeof exports?require("../p5"):a.p5)}(this,function(a){function b(b,c){Object.defineProperty(a.prototype,b,{configurable:!0,enumerable:!0,get:function(){var d=this instanceof a&&!this._isGlobal?this:window;return void 0===d._p5PlayProperties&&(d._p5PlayProperties={}),b in d._p5PlayProperties||(d._p5PlayProperties[b]=c.call(d)),d._p5PlayProperties[b]}})}function c(a){if("function"!=typeof a)throw new Error("constructor must be a function");return function(){function b(){var b=Array.prototype.slice.call(arguments);return a.apply(this,[c].concat(b))}var c=this;return b.prototype=a.prototype,b}}function d(a){return function(b){var c=a[b];if("function"!=typeof c)throw new Error('"'+b+'" is not a p5 method');return c.bind(a)}}function e(b,c,f,g,h){var i=d(b),k=i("createVector"),m=i("color"),n=i("random"),o=i("print"),p=i("push"),t=i("pop"),u=i("colorMode"),v=i("noStroke"),w=i("rectMode"),x=i("ellipseMode"),y=i("imageMode"),z=i("translate"),A=i("scale"),B=i("rotate"),C=i("stroke"),D=i("strokeWeight"),E=i("line"),F=i("noFill"),G=i("fill"),H=i("textAlign"),I=i("textSize"),J=i("text"),K=i("rect"),L=i("cos"),M=i("sin"),N=i("atan2"),O=b.quadTree,P=b.camera,Q=a.prototype.RGB,R=a.prototype.CENTER,S=a.prototype.LEFT,T=a.prototype.BOTTOM;this.position=k(c,f),this.previousPosition=k(c,f),this.newPosition=k(c,f),this.deltaX=0,this.deltaY=0,this.velocity=k(0,0),this.maxSpeed=-1,this.friction=0,this.collider=void 0,this.touching={},this.touching.left=!1,this.touching.right=!1,this.touching.top=!1,this.touching.bottom=!1,this.mass=1,this.immovable=!1,this.restitution=1,Object.defineProperty(this,"rotation",{enumerable:!0,get:function(){return this._rotation},set:function(a){this._rotation=a,this.rotateToDirection&&this.setSpeed(this.getSpeed(),a)}}),this._rotation=0,this.rotationSpeed=0,this.rotateToDirection=!1,this.depth=0,this.scale=1;var U=1,V=1;this.visible=!0,this.mouseActive=!1,this.mouseIsOver=!1,this.mouseIsPressed=!1,this._internalWidth=g,this._internalHeight=h,Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return this._internalWidth},set:function(a){this._internalWidth=a}}),this.width=void 0===g?100:g,Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return this._internalHeight},set:function(a){this._internalHeight=a}}),this.height=void 0===h?100:h,this.originalWidth=this._internalWidth,this.originalHeight=this._internalHeight,this.removed=!1,this.life=-1,this.debug=!1,this.shapeColor=m(n(255),n(255),n(255)),this.groups=[];var W={},X="";this.animation=void 0,this._sweptCollider=void 0,this._getBroadPhaseCollider=function(){return this.velocity.magSq()>0?this._sweptCollider:this.collider},this._doSweptCollidersOverlap=function(a){var b=this._getBroadPhaseCollider().collide(a._getBroadPhaseCollider());return 0!==b.x||0!==b.y},this._syncAnimationSizes=function(a,b){(a[b].frameChanged||void 0===this.width||void 0===this.height)&&(this._internalWidth=a[b].getWidth()*q(this._getScaleX()),this._internalHeight=a[b].getHeight()*q(this._getScaleY()))},this.update=function(){this.removed||(this._sweptCollider&&this.velocity.magSq()>0&&this._sweptCollider.updateSweptColliderFromSprite(this),this.newPosition!==this.position?this.previousPosition=k(this.newPosition.x,this.newPosition.y):this.previousPosition=k(this.position.x,this.position.y),this.velocity.x*=1-this.friction,this.velocity.y*=1-this.friction,-1!==this.maxSpeed&&this.limitSpeed(this.maxSpeed),this.rotateToDirection&&this.velocity.mag()>0&&(this._rotation=this.getDirection()),this.rotation+=this.rotationSpeed,this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.newPosition=k(this.position.x,this.position.y),this.deltaX=this.position.x-this.previousPosition.x,this.deltaY=this.position.y-this.previousPosition.y,W[X]&&(W[X].update(),this._syncAnimationSizes(W,X)),this.collider&&this.collider.updateFromSprite(this),this.mouseActive?(this.collider||this.setDefaultCollider(),this.mouseUpdate()):"function"!=typeof this.onMouseOver&&"function"!=typeof this.onMouseOut&&"function"!=typeof this.onMousePressed&&"function"!=typeof this.onMouseReleased||(this.mouseActive=!0,this.collider||this.setDefaultCollider(),this.mouseUpdate()),this.life>0&&this.life--,0===this.life&&this.remove())},this.setDefaultCollider=function(){W[X]&&1===W[X].getWidth()&&1===W[X].getHeight()||this.setCollider("rectangle")},this.mouseUpdate=function(){var c=this.mouseIsOver,d=this.mouseIsPressed;if(this.mouseIsOver=!1,this.mouseIsPressed=!1,this.collider){var e;e=P.active?k(P.mouseX,P.mouseY):k(b.mouseX,b.mouseY),this.mouseIsOver=this.collider.overlap(new a.PointCollider(e)),this.mouseIsOver&&b.mouseIsPressed&&(this.mouseIsPressed=!0),!c&&this.mouseIsOver&&void 0!==this.onMouseOver&&("function"==typeof this.onMouseOver?this.onMouseOver.call(this,this):o("Warning: onMouseOver should be a function")),c&&!this.mouseIsOver&&void 0!==this.onMouseOut&&("function"==typeof this.onMouseOut?this.onMouseOut.call(this,this):o("Warning: onMouseOut should be a function")),!d&&this.mouseIsPressed&&void 0!==this.onMousePressed&&("function"==typeof this.onMousePressed?this.onMousePressed.call(this,this):o("Warning: onMousePressed should be a function")),!d||b.mouseIsPressed||this.mouseIsPressed||void 0===this.onMouseReleased||("function"==typeof this.onMouseReleased?this.onMouseReleased.call(this,this):o("Warning: onMouseReleased should be a function"))}},this.setCollider=function(b,c,d,e,f,g){var h=b?b.toLowerCase():"";if("rectangle"===h&&(h="obb"),"point"!==h&&"circle"!==h&&"obb"!==h&&"aabb"!==h)throw new TypeError('setCollider expects the first argument to be one of "point", "circle", "rectangle", "aabb" or "obb"');if("point"===h&&1!==arguments.length&&3!==arguments.length)throw new TypeError('Usage: setCollider("'+b+'"[, offsetX, offsetY])');if("circle"===h&&1!==arguments.length&&3!==arguments.length&&4!==arguments.length)throw new TypeError('Usage: setCollider("'+b+'"[, offsetX, offsetY[, radius]])');if("aabb"===h&&1!==arguments.length&&3!==arguments.length&&5!==arguments.length)throw new TypeError('Usage: setCollider("'+b+'"[, offsetX, offsetY[, width, height]])');if("obb"===h&&1!==arguments.length&&3!==arguments.length&&5!==arguments.length&&6!==arguments.length)throw new TypeError('Usage: setCollider("'+b+'"[, offsetX, offsetY[, width, height[, rotation]]])');var i=k(c,d);"point"===h?this.collider=a.PointCollider.createFromSprite(this,i):"circle"===h?this.collider=a.CircleCollider.createFromSprite(this,i,e):"aabb"===h?this.collider=a.AxisAlignedBoundingBoxCollider.createFromSprite(this,i,e,f):"obb"===h&&(this.collider=a.OrientedBoundingBoxCollider.createFromSprite(this,i,e,f,r(g))),this._sweptCollider=new a.OrientedBoundingBoxCollider},this.mirrorX=function(a){if(1!==a&&-1!==a)return U;U=a},this.mirrorY=function(a){if(1!==a&&-1!==a)return V;V=a},this._getScaleX=function(){return this.scale},this._getScaleY=function(){return this.scale},this.display=function(){this.visible&&!this.removed&&(p(),u(Q),v(),w(R),x(R),y(R),z(this.position.x,this.position.y),A(this._getScaleX()*U,this._getScaleY()*V),B(b._angleMode===b.RADIANS?r(this.rotation):this.rotation),this.draw(),t(),this.debug&&(p(),C(0,255,0),D(1),E(this.position.x-10,this.position.y,this.position.x+10,this.position.y),E(this.position.x,this.position.y-10,this.position.x,this.position.y+10),F(),v(),G(0,255,0),H(S,T),I(16),J(this.depth+"",this.position.x+4,this.position.y-2),F(),C(0,255,0),void 0===this.collider&&this.setDefaultCollider(),this.collider&&this.collider.draw(b),t()))},this.draw=function(){""!==X&&W?W[X]&&W[X].draw(0,0,0):(v(),G(this.shapeColor),K(0,0,this._internalWidth,this._internalHeight))},this.remove=function(){for(this.removed=!0,O.removeObject(this);this.groups.length>0;)this.groups[0].remove(this)},this.setVelocity=function(a,b){this.velocity.x=a,this.velocity.y=b},this.getSpeed=function(){return this.velocity.mag()},this.getDirection=function(){var a=N(this.velocity.y,this.velocity.x);return isNaN(a)&&(a=0),b._angleMode===b.RADIANS&&(a=s(a)),a},this.addToGroup=function(a){a instanceof Array?a.add(this):o("addToGroup error: "+a+" is not a group")},this.limitSpeed=function(a){var b=this.getSpeed();if(q(b)>a){var c=a/q(b);this.velocity.x*=c,this.velocity.y*=c}},this.setSpeed=function(a,c){var d;d=void 0===c?0!==this.velocity.x||0!==this.velocity.y?b.atan2(this.velocity.y,this.velocity.x):b._angleMode===b.RADIANS?r(this._rotation):this._rotation:b._angleMode===b.RADIANS?r(c):c,this.velocity.x=L(d)*a,this.velocity.y=M(d)*a},this.addSpeed=function(a,c){var d;d=b._angleMode===b.RADIANS?r(c):c,this.velocity.x+=L(d)*a,this.velocity.y+=M(d)*a},this.attractionPoint=function(a,b,c){var d=N(c-this.position.y,b-this.position.x);this.velocity.x+=L(d)*a,this.velocity.y+=M(d)*a},this.addImage=function(){if("string"==typeof arguments[0]&&arguments[1]instanceof a.Image)this.addAnimation(arguments[0],arguments[1]);else{if(!(arguments[0]instanceof a.Image))throw"addImage error: allowed usages are <image> or <label>, <image>";this.addAnimation("normal",arguments[0])}},this.addAnimation=function(a){var c;if("string"!=typeof a)return o("Sprite.addAnimation error: the first argument must be a label (String)"),-1;if(arguments.length<2)return o("addAnimation error: you must specify a label and n frame images"),-1;if(arguments[1]instanceof j){var d=arguments[1],e=d.clone();return W[a]=e,""===X&&(X=a,this.animation=e),e.isSpriteAnimation=!0,this._internalWidth=e.getWidth()*q(this._getScaleX()),this._internalHeight=e.getHeight()*q(this._getScaleY()),e}for(var f=[],g=1;g<arguments.length;g++)f.push(arguments[g]);return c=l(b.Animation,f),W[a]=c,""===X&&(X=a,this.animation=c),c.isSpriteAnimation=!0,this._internalWidth=c.getWidth()*q(this._getScaleX()),this._internalHeight=c.getHeight()*q(this._getScaleY()),c},this.changeImage=function(a){this.changeAnimation(a)},this.getAnimationLabel=function(){return X},this.changeAnimation=function(a){W[a]?(X=a,this.animation=W[a]):o("changeAnimation error: no animation labeled "+a)},this.overlapPixel=function(a,b){var c=k(a,b),d=this.animation.getFrameImage();if(c.x-=this.position.x-d.width/2,c.y-=this.position.y-d.height/2,c.x<0||c.x>d.width||c.y<0||c.y>d.height)return!1;if(0===this.rotation&&1===this.scale){return 255===d.get(c.x,c.y)[3]}return o("Error: overlapPixel doesn't work with scaled or rotated sprites yet"),!1},this.overlapPoint=function(b,c){if(this.collider||this.setDefaultCollider(),this.collider){var d=new a.PointCollider(new a.Vector(b,c));return this.collider.overlap(d)}return!1},this.overlap=function(a,b){return this._collideWith("overlap",a,b)},this.collide=function(a,b){return this._collideWith("collide",a,b)},this.displace=function(a,b){return this._collideWith("displace",a,b)},this.bounce=function(a,b){return this._collideWith("bounce",a,b)},this._collideWith=function(a,c,d){this.touching.left=!1,this.touching.right=!1,this.touching.top=!1,this.touching.bottom=!1;var f=[];if(c instanceof e)f.push(c);else{if(!(c instanceof Array))throw"Error: overlap can only be checked between sprites or groups";void 0!==b.quadTree&&b.quadTree.active&&(f=b.quadTree.retrieveFromGroup(this,c)),0===f.length&&(f=c)}for(var g=!1,h=0;h<f.length;h++)g=this._collideWithOne(a,f[h],d)||g;return g},this._collideWithOne=function(b,c,d){if(c===this)return!1;if(void 0===this.collider&&this.setDefaultCollider(),void 0===c.collider&&c.setDefaultCollider(),!this.collider||!c.collider)return!1;var e=this._findDisplacement(c);if(0===e.x&&0===e.y)return!1;if(("collide"===b||"displace"===b||"bounce"===b)&&("displace"!==b||c.immovable?"collide"!==b&&"bounce"!==b||this.immovable||(this.position.add(e),this.previousPosition=k(this.position.x,this.position.y),this.newPosition=k(this.position.x,this.position.y),this.collider.updateFromSprite(this)):c.position.sub(e),e.x>0&&(this.touching.left=!0),e.x<0&&(this.touching.right=!0),e.y<0&&(this.touching.bottom=!0),e.y>0&&(this.touching.top=!0),"bounce"===b)){var f=a.Vector.project(this.velocity,e),g=a.Vector.project(c.velocity,e),h=this.mass,i=c.mass;this.immovable?(h=1,i=0):c.immovable&&(h=0,i=1);var j=h+i,l=this.restitution*c.restitution,m=a.Vector.add(a.Vector.mult(f,h),a.Vector.mult(g,i)),n=a.Vector.sub(g,f).mult(i*l).add(m).div(j),o=a.Vector.sub(f,g).mult(h*l).add(m).div(j);this.velocity.sub(f).add(n),c.velocity.sub(g).add(o)}return"function"==typeof d&&d.call(this,this,c),!0},this._findDisplacement=function(b){if(this._doSweptCollidersOverlap(b)){var c=Math.max(this.collider._getMinRadius(),b.collider._getMinRadius()),d=a.Vector.sub(this.velocity,b.velocity).mag(),e=Math.max(.015,c/d);if(e<1){var f=this.position.copy(),g=b.position.copy();this.position.set(this.previousPosition),b.position.set(b.previousPosition);for(var h=a.Vector.sub(f,this.previousPosition).mult(e),i=a.Vector.sub(g,b.previousPosition).mult(e),j=e;j<1;j+=e){this.position.add(h),b.position.add(i),this.collider.updateFromSprite(this),b.collider.updateFromSprite(b);var k=this.collider.collide(b.collider);if(0!==k.x||0!==k.y)return this.immovable&&this.position.set(f),b.immovable&&b.position.set(g),k}this.position.set(f),b.position.set(g)}}return this.collider.updateFromSprite(this),b.collider.updateFromSprite(b),this.collider.collide(b.collider)}}function f(a,b,c,d){this.position=a.createVector(b,c),this.zoom=d,this.mouseX=a.mouseX,this.mouseY=a.mouseY,this.active=!1,this.on=function(){this.active||(g.call(a),this.active=!0)},this.off=function(){this.active&&(h.call(a),this.active=!1)}}function g(){var a=this,b=a.camera;b.init||0!==b.position.x||0!==b.position.y||(b.position.x=a.width/2,b.position.y=a.height/2,b.init=!0),b.mouseX=a.mouseX+b.position.x-a.width/2,b.mouseY=a.mouseY+b.position.y-a.height/2,b.active||(b.active=!0,a.push(),a.scale(b.zoom),a.translate(-b.position.x+a.width/2/b.zoom,-b.position.y+a.height/2/b.zoom))}function h(){var a=this;a.camera.active&&(a.pop(),a.camera.active=!1)}function i(){function a(a,b){return null===a||null===b?null===a&&null===b:"string"==typeof a?a===b:"object"!=typeof a?a===b:a.equals instanceof Function?a.equals(b):a===b}function b(a,b,c){for(var d=!1,e=0;e<this.size();e++)d=this.get(e)._collideWith(a,b,c)||d;return d}var c=[];return c.get=function(a){return c[a]},c.contains=function(a){return this.indexOf(a)>-1},c.indexOf=function(b){for(var d=0,e=c.length;d<e;++d)if(a(b,c[d]))return d;return-1},c.add=function(a){if(!(a instanceof e))throw"Error: you can only add sprites to a group";-1===this.indexOf(a)&&(c.push(a),a.groups.push(this))},c.size=function(){return c.length},c.removeSprites=function(){for(;c.length>0;)c[0].remove()},c.clear=function(){c.length=0},c.remove=function(a){if(!(a instanceof e))throw"Error: you can only remove sprites from a group";var b,d=!1;for(b=c.length-1;b>=0;b--)c[b]===a&&(c.splice(b,1),d=!0);if(d)for(b=a.groups.length-1;b>=0;b--)a.groups[b]===this&&a.groups.splice(b,1);return d},c.toArray=function(){return c.slice(0)},c.maxDepth=function(){return 0===c.length?0:c.reduce(function(a,b){return Math.max(a,b.depth)},-1/0)},c.minDepth=function(){return 0===c.length?99999:c.reduce(function(a,b){return Math.min(a,b.depth)},1/0)},c.draw=function(){this.sort(function(a,b){return a.depth-b.depth});for(var a=0;a<this.size();a++)this.get(a).display()},c.overlap=b.bind(c,"overlap"),c.collide=b.bind(c,"collide"),c.displace=b.bind(c,"displace"),c.bounce=b.bind(c,"bounce"),c}function j(b){var c,d=Array.prototype.slice.call(arguments,1),e=a.prototype.CENTER;this.images=[];var f=0,g=0,h=-1;if(this.offX=0,this.offY=0,this.frameDelay=4,this.playing=!0,this.visible=!0,this.looping=!0,this.frameChanged=!1,this.imageCollider=!1,2===d.length&&"string"==typeof d[0]&&"string"==typeof d[1]){var i=d[0],l=d[1];".png"!==i.substring(i.length-4,i.length)&&(b.print("Animation error: you need to use .png files (filename "+i+")"),i=-1);if(".png"!==l.substring(l.length-4,l.length)&&(b.print("Animation error: you need to use .png files (filename "+l+")"),l=-1),-1!==i&&-1!==l){var m=0,n=0;for(c=i.length-5;c>=0;c--)i.charAt(c)>="0"&&i.charAt(c)<="9"&&m++;for(c=l.length-5;c>=0;c--)l.charAt(c)>="0"&&l.charAt(c)<="9"&&n++;var o=i.substring(0,i.length-(4+m)),p=l.substring(0,l.length-(4+n)),q=parseInt(i.substring(i.length-(4+m),i.length-4),10),s=parseInt(l.substring(l.length-(4+n),l.length-4),10);if(s<q){var t=s;s=q,q=t}if(o!==p)this.images.push(b.loadImage(i)),this.images.push(b.loadImage(l));else{var u;if(m===n)for(c=q;c<=s;c++)u=o+b.nf(c,m)+".png",this.images.push(b.loadImage(u));else for(c=q;c<=s;c++)u=o+c+".png",this.images.push(b.loadImage(u))}}}else if(1===d.length&&d[0]instanceof k)this.spriteSheet=d[0],this.images=this.spriteSheet.frames.map(function(a){return a.frame});else if(0!==d.length)for(c=0;c<d.length;c++)d[c]instanceof a.Image?this.images.push(d[c]):this.images.push(b.loadImage(d[c]));this.clone=function(){var a=new j(b);return a.images=[],this.spriteSheet&&(a.spriteSheet=this.spriteSheet.clone()),a.images=this.images.slice(),a.offX=this.offX,a.offY=this.offY,a.frameDelay=this.frameDelay,a.playing=this.playing,a.looping=this.looping,a},this.draw=function(a,c,d){if(this.xpos=a,this.ypos=c,this.rotation=d||0,this.visible){if(this.isSpriteAnimation||this.update(),b.push(),b.imageMode(e),b.translate(this.xpos,this.ypos),b._angleMode===b.RADIANS?b.rotate(r(this.rotation)):b.rotate(this.rotation),void 0!==this.images[f])if(this.spriteSheet){var g=this.images[f];b.image(this.spriteSheet.image,g.x,g.y,g.width,g.height,this.offX,this.offY,g.width,g.height)}else b.image(this.images[f],this.offX,this.offY);else b.print("Warning undefined frame "+f);b.pop()}},this.update=function(){g++;var a=f;this.frameChanged=!1,1===this.images.length&&(this.playing=!1,f=0),this.playing&&g%this.frameDelay==0&&(h>f&&-1!==h?f++:h<f&&-1!==h?f--:h===f&&-1!==h?this.playing=!1:this.looping?f>=this.images.length-1?f=0:f++:f<this.images.length-1?f++:this.playing=!1),a!==f&&(this.frameChanged=!0)},this.play=function(){this.playing=!0,h=-1},this.stop=function(){this.playing=!1},this.rewind=function(){f=0},this.changeFrame=function(a){f=a<this.images.length?a:this.images.length-1,h=-1},this.nextFrame=function(){f<this.images.length-1?f+=1:this.looping&&(f=0),h=-1,this.playing=!1},this.previousFrame=function(){f>0?f-=1:this.looping&&(f=this.images.length-1),h=-1,this.playing=!1},this.goToFrame=function(a){a<0||a>=this.images.length||(h=a)!==f&&(this.playing=!0)},this.getFrame=function(){return f},this.getLastFrame=function(){return this.images.length-1},this.getFrameImage=function(){return this.images[f]},this.getImageAt=function(a){return this.images[a]},this.getWidth=function(){return this.images[f]?this.images[f].width:1},this.getHeight=function(){return this.images[f]?this.images[f].height:1}}function k(b){var c=Array.prototype.slice.call(arguments,1);this.image=null,this.frames=[],this.frame_width=0,this.frame_height=0,this.num_frames=0,this._generateSheetFrames=function(){for(var a=0,b=0,c=0;c<this.num_frames;c++)this.frames.push({name:c,frame:{x:a,y:b,width:this.frame_width,height:this.frame_height}}),(a+=this.frame_width)>=this.image.width&&(a=0,(b+=this.frame_height)>=this.image.height&&(b=0))},2===c.length&&Array.isArray(c[1])?(this.frames=c[1],this.num_frames=this.frames.length):4===c.length&&"number"==typeof c[1]&&"number"==typeof c[2]&&"number"==typeof c[3]&&(this.frame_width=c[1],this.frame_height=c[2],this.num_frames=c[3]),c[0]instanceof a.Image?(this.image=c[0],4===c.length&&this._generateSheetFrames()):2===c.length?this.image=b.loadImage(c[0]):4===c.length&&(this.image=b.loadImage(c[0],this._generateSheetFrames.bind(this))),this.drawFrame=function(a,c,d,e,f){var g;if("number"==typeof a)g=this.frames[a].frame;else for(var h=0;h<this.frames.length;h++)if(this.frames[h].name===a){g=this.frames[h].frame;break}var i=e||g.width,j=f||g.height;b.image(this.image,g.x,g.y,g.width,g.height,c,d,i,j)},this.clone=function(){for(var a=new k(b),c=0;c<this.frames.length;c++){var d=this.frames[c].frame,e={name:d.name,frame:{x:d.x,y:d.y,width:d.width,height:d.height}};a.frames.push(e)}return a.image=this.image,a.frame_width=this.frame_width,a.frame_height=this.frame_height,a.num_frames=this.num_frames,a}}function l(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}function m(a,b,c,d){this.active=!0,this.max_objects=b||10,this.max_levels=c||4,this.level=d||0,this.bounds=a,this.objects=[],this.object_refs=[],this.nodes=[]}function n(){this.quadTree.active&&(this.quadTree.updateBounds(),this.quadTree.cleanup())}function o(a){return a.filter(function(b,c){return!a.some(function(a,d){return c<d&&b.isParallel(a)})})}function p(a){return a=+a,0===a||isNaN(a)?Number(a):a>0?1:-1}a.prototype.registerMethod("init",function(){this.camera=new f(this,0,0,1),this.camera.init=!1});var q=a.prototype.abs,r=a.prototype.radians,s=a.prototype.degrees;a.Vector.project=function(b,c){return a.Vector.mult(c,a.Vector.dot(b,c)/a.Vector.dot(c,c))},a.Vector.prototype.isParallel=function(a,b){return b="number"==typeof b?b:1e-14,Math.abs(this.x)<b&&Math.abs(a.x)<b||Math.abs(this.y)<b&&Math.abs(a.y)<b||Math.abs(this.x/a.x-this.y/a.y)<b},b("allSprites",function(){return new a.prototype.Group}),a.prototype.spriteUpdate=!0,a.prototype.createSprite=function(a,b,c,d){var f=new e(this,a,b,c,d);return f.depth=this.allSprites.maxDepth()+1,this.allSprites.add(f),f},a.prototype.removeSprite=function(a){a.remove()},a.prototype.updateSprites=function(a){if(!1===a&&(this.spriteUpdate=!1),!0===a&&(this.spriteUpdate=!0),this.spriteUpdate)for(var b=0;b<this.allSprites.size();b++)this.allSprites.get(b).update()},a.prototype.getSprites=function(){if(0===arguments.length)return this.allSprites.toArray();for(var a=[],b=0;b<arguments.length;b++)for(var c=0;c<this.allSprites.size();c++)this.allSprites.get(c).isTagged(arguments[b])&&a.push(this.allSprites.get(c));return a},a.prototype.drawSprites=function(a){if(a=a||this.allSprites,"function"!=typeof a.draw)throw"Error: with drawSprites you can only draw all sprites or a group";a.draw()},a.prototype.drawSprite=function(a){a&&a.display()},a.prototype.loadAnimation=function(){return l(this.Animation,arguments)},a.prototype.loadSpriteSheet=function(){return l(this.SpriteSheet,arguments)},a.prototype.animation=function(a,b,c){a.draw(b,c)},b("_p5play",function(){return{keyStates:{},mouseStates:{}}});a.prototype.keyWentDown=function(a){return this._isKeyInState(a,1)},a.prototype.keyWentUp=function(a){return this._isKeyInState(a,3)},a.prototype.keyDown=function(a){return this._isKeyInState(a,2)},a.prototype._isKeyInState=function(a,b){var c,d=this._p5play.keyStates;return c="string"==typeof a?this._keyCodeFromAlias(a):a,void 0===d[c]&&(this.keyIsDown(c)?d[c]=2:d[c]=0),d[c]===b},a.prototype.mouseDown=function(a){return this._isMouseButtonInState(a,2)},a.prototype.mouseUp=function(a){return this._isMouseButtonInState(a,0)},a.prototype.mouseWentUp=function(a){return this._isMouseButtonInState(a,3)},a.prototype.mouseWentDown=function(a){return this._isMouseButtonInState(a,1)},a.prototype._isMouseButtonInState=function(a,b){var c=this._p5play.mouseStates;return void 0===a&&(a=this.LEFT),void 0===c[a]&&(this.mouseIsPressed&&this.mouseButton===a?c[a]=2:c[a]=0),c[a]===b},a.prototype.KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32," ":32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,LEFT:37,UP_ARROW:38,UP:38,RIGHT_ARROW:39,RIGHT:39,DOWN_ARROW:40,DOWN:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"0NUMPAD":96,"1NUMPAD":97,"2NUMPAD":98,"3NUMPAD":99,"4NUMPAD":100,"5NUMPAD":101,"6NUMPAD":102,"7NUMPAD":103,"8NUMPAD":104,"9NUMPAD":105,MULTIPLY:106,PLUS:107,MINUS:109,DOT:110,SLASH1:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,EQUAL:187,COMMA:188,SLASH:191,BACKSLASH:220},a.prototype.KEY_DEPRECATIONS={MINUT:"MINUS",COMA:"COMMA"},a.prototype._keyCodeFromAlias=function(a){return a=a.toUpperCase(),this.KEY_DEPRECATIONS[a]&&(this._warn('Key literal "'+a+'" is deprecated and may be removed in a future version of p5.play. Please use "'+this.KEY_DEPRECATIONS[a]+'" instead.'),a=this.KEY_DEPRECATIONS[a]),this.KEY[a]},a.prototype.readPresses=function(){var a=this._p5play.keyStates,b=this._p5play.mouseStates;for(var c in a)this.keyIsDown(c)?0===a[c]?a[c]=1:a[c]=2:2===a[c]?a[c]=3:a[c]=0;for(var d in b)this.mouseIsPressed&&this.mouseButton===d?0===b[d]?b[d]=1:b[d]=2:2===b[d]?b[d]=3:b[d]=0},a.prototype.useQuadTree=function(a){return void 0!==this.quadTree&&(void 0===a?this.quadTree.active:void(this.quadTree.active=!!a))},b("quadTree",function(){return new m({x:0,y:0,width:0,height:0},4)}),b("Sprite",c(e)),b("Camera",c(f)),a.prototype.Group=i,b("Animation",c(j)),b("SpriteSheet",c(k)),m.prototype.updateBounds=function(){for(var a=this.getAll(),b=1e4,c=1e4,d=-1e4,e=-1e4,f=0;f<a.length;f++)a[f].position.x<b&&(b=a[f].position.x),a[f].position.y<c&&(c=a[f].position.y),a[f].position.x>d&&(d=a[f].position.x),a[f].position.y>e&&(e=a[f].position.y);this.bounds={x:b,y:c,width:d,height:e}},m.prototype.split=function(){var a=this.level+1,b=Math.round(this.bounds.width/2),c=Math.round(this.bounds.height/2),d=Math.round(this.bounds.x),e=Math.round(this.bounds.y);this.nodes[0]=new m({x:d+b,y:e,width:b,height:c},this.max_objects,this.max_levels,a),this.nodes[1]=new m({x:d,y:e,width:b,height:c},this.max_objects,this.max_levels,a),this.nodes[2]=new m({x:d,y:e+c,width:b,height:c},this.max_objects,this.max_levels,a),this.nodes[3]=new m({x:d+b,y:e+c,width:b,height:c},this.max_objects,this.max_levels,a)},m.prototype.getIndex=function(a){if(a.collider){var b=a.collider.getBoundingBox(),c=-1,d=this.bounds.x+this.bounds.width/2,e=this.bounds.y+this.bounds.height/2,f=b.top<e&&b.bottom<e,g=b.top>e;return b.left<d&&b.right<d?f?c=1:g&&(c=2):b.left>d&&(f?c=0:g&&(c=3)),c}return-1},m.prototype.insert=function(a){if(-1===this.objects.indexOf(a)){var b,c=0;if(void 0!==this.nodes[0]&&-1!==(b=this.getIndex(a)))return void this.nodes[b].insert(a);if(this.objects.push(a),this.objects.length>this.max_objects&&this.level<this.max_levels)for(void 0===this.nodes[0]&&this.split();c<this.objects.length;)b=this.getIndex(this.objects[c]),-1!==b?this.nodes[b].insert(this.objects.splice(c,1)[0]):c+=1}},m.prototype.retrieve=function(a){var b=this.getIndex(a),c=this.objects;if(void 0!==this.nodes[0])if(-1!==b)c=c.concat(this.nodes[b].retrieve(a));else for(var d=0;d<this.nodes.length;d+=1)c=c.concat(this.nodes[d].retrieve(a));return c},m.prototype.retrieveFromGroup=function(a,b){for(var c=[],d=this.retrieve(a),e=0;e<d.length;e++)b.contains(d[e])&&c.push(d[e]);return c},m.prototype.getAll=function(){for(var a=this.objects,b=0;b<this.nodes.length;b+=1)a=a.concat(this.nodes[b].getAll());return a},m.prototype.getObjectNode=function(a){var b;if(!this.nodes.length)return this;if(-1===(b=this.getIndex(a)))return this;var c=this.nodes[b].getObjectNode(a);return c||!1},m.prototype.removeObject=function(a){var b=this.getObjectNode(a),c=b.objects.indexOf(a);if(-1===c)return!1;b.objects.splice(c,1)},m.prototype.clear=function(){if(this.objects=[],this.nodes.length){for(var a=0;a<this.nodes.length;a+=1)this.nodes[a].clear();this.nodes=[]}},m.prototype.cleanup=function(){var a=this.getAll();this.clear();for(var b=0;b<a.length;b++)this.insert(a[b])},a.prototype.registerMethod("pre",a.prototype.readPresses),a.prototype.registerMethod("pre",a.prototype.updateSprites),a.prototype.registerMethod("post",n),a.prototype.registerMethod("pre",g),a.prototype.registerMethod("post",h),a.prototype._warn=function(a){var b=window.console;b&&("function"==typeof b.warn?b.warn(a):"function"==typeof b.log&&b.log("Warning: "+a))},a.CollisionShape=function(b,c){this._localTransform=new a.Transform2D,c&&this._localTransform.rotate(c),b&&this._localTransform.translate(b),this._parentTransform=new a.Transform2D,this._center=new a.Vector,this._offset=new a.Vector,this._rotation=0,this._scale=new a.Vector(1,1),this.getsDimensionsFromSprite=!1,Object.defineProperties(this,{center:{enumerable:!0,get:function(){return this._center.copy()}.bind(this),set:function(b){this._localTransform.translate(a.Vector.mult(this._center,-1)).translate(b),this._onTransformChanged()}.bind(this)},offset:{enumerable:!0,get:function(){return this._offset.copy()}.bind(this),set:function(b){this._localTransform.translate(a.Vector.mult(this._offset,-1)).translate(b),this._onTransformChanged()}.bind(this)},rotation:{enumerable:!0,get:function(){return this._rotation}.bind(this),set:function(a){this._localTransform.clear().scale(this._scale).rotate(a).translate(this._offset),this._onTransformChanged()}.bind(this)},scale:{enumerable:!0,get:function(){return this._scale.copy()}.bind(this),set:function(a){this._localTransform.clear().scale(a).rotate(this._rotation).translate(this._offset),this._onTransformChanged()}.bind(this)}}),this._onTransformChanged()},a.CollisionShape.prototype.updateFromSprite=function(a){this.setParentTransform(a)},a.CollisionShape.prototype.setParentTransform=function(b){if(b instanceof e)this._parentTransform.clear().scale(b._getScaleX(),b._getScaleY()).rotate(r(b.rotation)).translate(b.position);else{if(!(b instanceof a.Transform2D))throw new TypeError("Bad argument to setParentTransform: "+b);this._parentTransform=b.copy()}this._onTransformChanged()},a.CollisionShape.prototype._onTransformChanged=function(){this._rotation=this._localTransform.getRotation(),this._scale=this._localTransform.getScale(),this._offset.set(0,0).transform(this._localTransform),this._center.set(this._offset.x,this._offset.y).transform(this._parentTransform)},a.CollisionShape.prototype.collide=function(b){for(var c,d,e,f=this,g=b,h=1/0,i=null,j=a.Vector.sub(g.center,f.center),k=a.CollisionShape._getCandidateAxesForShapes(f,g),l=0;l<k.length;l++){c=k[l],d=a.Vector.project(j,c),e=d.mag();var m=f._getRadiusOnAxis(c),n=g._getRadiusOnAxis(c),o=m+n-e;if(o<=0)return new a.Vector;o<h&&(h=o,i=0===d.x&&0===d.y?c:d)}return i.copy().setMag(-h)},a.CollisionShape.prototype.overlap=function(a){var b=this.collide(a);return 0!==b.x||0!==b.y},a.CollisionShape._getCandidateAxesForShapes=function(b,c){return o(b._getCandidateAxes(c).concat(c._getCandidateAxes(b)).map(function(b){return 0===b.x&&0===b.y?a.CollisionShape.X_AXIS:b}))},a.CollisionShape.prototype._getCandidateAxes=function(){return[]},a.CollisionShape.prototype._getRadiusOnAxis=function(){return 0},a.CollisionShape.prototype._getMinRadius=function(){return 0},a.CollisionShape.X_AXIS=new a.Vector(1,0),a.CollisionShape.Y_AXIS=new a.Vector(0,1),a.CollisionShape.WORLD_AXES=[a.CollisionShape.X_AXIS,a.CollisionShape.Y_AXIS],a.CollisionShape.prototype.getBoundingBox=function(){var b=this._getRadiusOnAxis(a.CollisionShape.X_AXIS),c=this._getRadiusOnAxis(a.CollisionShape.Y_AXIS);return{top:this.center.y-c,bottom:this.center.y+c,left:this.center.x-b,right:this.center.x+b,width:2*b,height:2*c}},a.PointCollider=function(b){a.CollisionShape.call(this,b)},a.PointCollider.prototype=Object.create(a.CollisionShape.prototype),a.PointCollider.createFromSprite=function(b,c){var d=new a.PointCollider(c);return d.setParentTransform(b),d},a.PointCollider.prototype.draw=function(a){a.push(),a.rectMode(a.CENTER),a.translate(this.center.x,this.center.y),a.noStroke(),a.fill(0,255,0),a.ellipse(0,0,2,2),a.pop()},a.CircleCollider=function(b,c){a.CollisionShape.call(this,b),this.radius=c,this._scaledRadius=0,this._computeScaledRadius()},a.CircleCollider.prototype=Object.create(a.CollisionShape.prototype),a.CircleCollider.createFromSprite=function(b,c,d){var e="number"==typeof d,f=new a.CircleCollider(c,e?d:1);return f.getsDimensionsFromSprite=!e,f.updateFromSprite(b),f},a.CircleCollider.prototype.updateFromSprite=function(a){
this.getsDimensionsFromSprite&&(a.animation?this.radius=Math.max(a.animation.getWidth(),a.animation.getHeight())/2:this.radius=Math.max(a.width,a.height)/2),this.setParentTransform(a)},a.CircleCollider.prototype._onTransformChanged=function(){a.CollisionShape.prototype._onTransformChanged.call(this),this._computeScaledRadius()},a.CircleCollider.prototype._computeScaledRadius=function(){this._scaledRadius=new a.Vector(this.radius,0).transform(this._localTransform).transform(this._parentTransform).sub(this.center).mag()},a.CircleCollider.prototype.draw=function(a){a.push(),a.noFill(),a.stroke(0,255,0),a.rectMode(a.CENTER),a.ellipse(this.center.x,this.center.y,2*this._scaledRadius,2*this._scaledRadius),a.pop()},a.CircleCollider.prototype.setParentTransform=function(b){if(b instanceof e)this._parentTransform.clear().scale(Math.max(b._getScaleX(),b._getScaleY())).rotate(r(b.rotation)).translate(b.position);else{if(!(b instanceof a.Transform2D))throw new TypeError("Bad argument to setParentTransform: "+b);this._parentTransform=b.copy()}this._onTransformChanged()},a.CircleCollider.prototype._getCandidateAxes=function(b){if(b instanceof a.OrientedBoundingBoxCollider||b instanceof a.AxisAlignedBoundingBoxCollider){var c=1/0,d=null,e=b.halfDiagonals;return[a.Vector.add(b.center,e[0]),a.Vector.add(b.center,e[1]),a.Vector.sub(b.center,e[0]),a.Vector.sub(b.center,e[1])].map(function(a){return a.sub(this.center)}.bind(this)).forEach(function(a){var b=a.magSq();b<c&&(c=b,d=a)}),[d]}return[a.Vector.sub(b.center,this.center)]},a.CircleCollider.prototype._getRadiusOnAxis=function(){return this._scaledRadius},a.CircleCollider.prototype._getMinRadius=function(){return this._scaledRadius},a.AxisAlignedBoundingBoxCollider=function(b,c,d){a.CollisionShape.call(this,b),this._width=c,this._height=d,this._halfDiagonals=[],Object.defineProperties(this,{width:{enumerable:!0,get:function(){return this._width}.bind(this),set:function(a){this._width=a,this._halfDiagonals=this._computeHalfDiagonals()}.bind(this)},height:{enumerable:!0,get:function(){return this._height}.bind(this),set:function(a){this._height=a,this._halfDiagonals=this._computeHalfDiagonals()}.bind(this)},halfDiagonals:{enumerable:!0,get:function(){return this._halfDiagonals}.bind(this)}}),this._computeHalfDiagonals()},a.AxisAlignedBoundingBoxCollider.prototype=Object.create(a.CollisionShape.prototype),a.AxisAlignedBoundingBoxCollider.createFromSprite=function(b,c,d,e){var f="number"==typeof d&&"number"==typeof e,g=new a.AxisAlignedBoundingBoxCollider(c,f?d:1,f?e:1);return g.getsDimensionsFromSprite=!f,g.updateFromSprite(b),g},a.AxisAlignedBoundingBoxCollider.prototype.updateFromSprite=function(a){this.getsDimensionsFromSprite&&(a.animation?(this._width=a.animation.getWidth(),this._height=a.animation.getHeight()):(this._width=a.width,this._height=a.height)),this.setParentTransform(a)},a.AxisAlignedBoundingBoxCollider.prototype._onTransformChanged=function(){a.CollisionShape.prototype._onTransformChanged.call(this),this._computeHalfDiagonals()},a.AxisAlignedBoundingBoxCollider.prototype._computeHalfDiagonals=function(){var b=a.Transform2D.mult(this._parentTransform,this._localTransform),c=[new a.Vector(this._width/2,-this._height/2),new a.Vector(this._width/2,this._height/2),new a.Vector(-this._width/2,this._height/2)].map(function(a){return a.transform(b).sub(this.center)}.bind(this)),d=Math.max(Math.abs(c[0].x),Math.abs(c[1].x)),e=Math.max(Math.abs(c[1].y),Math.abs(c[2].y));this._halfDiagonals=[new a.Vector(d,-e),new a.Vector(d,e)]},a.AxisAlignedBoundingBoxCollider.prototype.draw=function(a){a.push(),a.rectMode(a.CENTER),a.translate(this.center.x,this.center.y),a.noFill(),a.stroke(0,255,0),a.strokeWeight(1),a.rect(0,0,2*Math.abs(this._halfDiagonals[0].x),2*Math.abs(this._halfDiagonals[0].y)),a.pop()},a.AxisAlignedBoundingBoxCollider.prototype._getCandidateAxes=function(){return a.CollisionShape.WORLD_AXES},a.AxisAlignedBoundingBoxCollider.prototype._getRadiusOnAxis=function(b){return Math.max(a.Vector.project(this._halfDiagonals[0],b).mag(),a.Vector.project(this._halfDiagonals[1],b).mag())},a.AxisAlignedBoundingBoxCollider.prototype._getMinRadius=function(){return Math.min(this._width,this._height)},a.OrientedBoundingBoxCollider=function(b,c,d,e){a.CollisionShape.call(this,b,e),this._width=c,this._height=d,this._potentialAxes=[],this._halfDiagonals=[],Object.defineProperties(this,{width:{enumerable:!0,get:function(){return this._width}.bind(this),set:function(a){this._width=a,this._onTransformChanged()}.bind(this)},height:{enumerable:!0,get:function(){return this._height}.bind(this),set:function(a){this._height=a,this._onTransformChanged()}.bind(this)},halfDiagonals:{enumerable:!0,get:function(){return this._halfDiagonals}.bind(this)}}),this._onTransformChanged()},a.OrientedBoundingBoxCollider.prototype=Object.create(a.CollisionShape.prototype),a.OrientedBoundingBoxCollider.createFromSprite=function(b,c,d,e,f){var g="number"==typeof d&&"number"==typeof e,h=new a.OrientedBoundingBoxCollider(c,g?d:1,g?e:1,f);return h.getsDimensionsFromSprite=!g,h.updateFromSprite(b),h},a.OrientedBoundingBoxCollider.prototype.updateFromSprite=a.AxisAlignedBoundingBoxCollider.prototype.updateFromSprite,a.OrientedBoundingBoxCollider.prototype.updateSweptColliderFromSprite=function(b){var c=b.velocity.mag(),d=new a.Vector(b.velocity.y,-b.velocity.x);this._width=c+2*b.collider._getRadiusOnAxis(b.velocity),this._height=2*b.collider._getRadiusOnAxis(d);var e=r(b.getDirection()),f=new a.Vector(b.newPosition.x+.5*b.velocity.x,b.newPosition.y+.5*b.velocity.y);this._localTransform.clear().scale(this._scale).rotate(e).translate(this._offset).translate(a.Vector.mult(this._center,-1)).translate(f),this._onTransformChanged()},a.OrientedBoundingBoxCollider.prototype._onTransformChanged=function(){a.CollisionShape.prototype._onTransformChanged.call(this);var b=a.Transform2D.mult(this._parentTransform,this._localTransform),c=[new a.Vector(this._width/2,-this._height/2),new a.Vector(this._width/2,this._height/2),new a.Vector(-this._width/2,this._height/2)].map(function(a){return a.transform(b)});this._halfDiagonals=[a.Vector.sub(c[0],this.center),a.Vector.sub(c[1],this.center)],this._potentialAxes=[a.Vector.sub(c[1],c[2]),a.Vector.sub(c[1],c[0])]},a.OrientedBoundingBoxCollider.prototype.draw=function(b){var c=a.Transform2D.mult(this._localTransform,this._parentTransform),d=c.getScale(),e=c.getRotation();b.push(),b.translate(this.center.x,this.center.y),b.scale(d.x,d.y),b._angleMode===b.RADIANS?b.rotate(e):b.rotate(s(e)),b.noFill(),b.stroke(0,255,0),b.strokeWeight(1),b.rectMode(b.CENTER),b.rect(0,0,this._width,this._height),b.pop()},a.OrientedBoundingBoxCollider.prototype._getCandidateAxes=function(){return this._potentialAxes},a.OrientedBoundingBoxCollider.prototype._getRadiusOnAxis=a.AxisAlignedBoundingBoxCollider.prototype._getRadiusOnAxis,a.OrientedBoundingBoxCollider.prototype._getMinRadius=a.AxisAlignedBoundingBoxCollider.prototype._getMinRadius,a.Transform2D=function(a){if(a=a||[1,0,0,0,1,0],6!==a.length)throw new TypeError("Transform2D must have six components");this.length=6,this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5]},a.Transform2D.prototype=Object.create(Array.prototype),a.Transform2D.prototype.clear=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this},a.Transform2D.prototype.copy=function(){return new a.Transform2D(this)},a.Transform2D.prototype.equals=function(b){if(!(b instanceof a.Transform2D||Array.isArray(b)))return!1;for(var c=0;c<6;c++)if(this[c]!==b[c])return!1;return!0},a.Transform2D.mult=function(b,c,d){d=d||new a.Transform2D;var e,f,g,h,i,j;e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=b[5];var k,l,m,n,o,p;return k=c[0],l=c[1],m=c[2],n=c[3],o=c[4],p=c[5],d[0]=e*k+f*n,d[1]=e*l+f*o,d[2]=e*m+f*p+g,d[3]=h*k+i*n,d[4]=h*l+i*o,d[5]=h*m+i*p+j,d},a.Transform2D.prototype.mult=function(b){return a.Transform2D.mult(this,b,this)},a.Transform2D.prototype.translate=function(b,c){var d,e;if(b instanceof a.Vector)d=b.x,e=b.y;else{if("number"!=typeof b||"number"!=typeof c){for(var f="",g=0;g<arguments.length;g++)f+=arguments[g]+", ";throw new TypeError("Invalid arguments to Transform2D.translate: "+f)}d=b,e=c}return a.Transform2D.mult([1,0,d,0,1,e],this,this)},a.Transform2D.prototype.getTranslation=function(){return new a.Vector(this[2],this[5])},a.Transform2D.prototype.scale=function(b,c){var d,e;if(b instanceof a.Vector)d=b.x,e=b.y;else if("number"==typeof b&&"number"==typeof c)d=b,e=c;else{if("number"!=typeof b)throw new TypeError("Invalid arguments to Transform2D.scale: "+arguments);d=b,e=b}return a.Transform2D.mult([d,0,0,0,e,0],this,this)},a.Transform2D.prototype.getScale=function(){var b=this[0],c=this[1],d=this[3],e=this[4];return new a.Vector(p(b)*Math.sqrt(b*b+c*c),p(e)*Math.sqrt(d*d+e*e))},a.Transform2D.prototype.rotate=function(b){if("number"!=typeof b)throw new TypeError("Invalid arguments to Transform2D.rotate: "+arguments);var c=Math.sin(b),d=Math.cos(b);return a.Transform2D.mult([d,-c,0,c,d,0],this,this)},a.Transform2D.prototype.getRotation=function(){return Math.atan2(-this[1],this[0])},a.Vector.transform=function(a,b){return a.copy().transform(b)},a.Vector.prototype.transform=function(a){var b=this.x,c=this.y;return this.x=a[0]*b+a[1]*c+a[2],this.y=a[3]*b+a[4]*c+a[5],this}});